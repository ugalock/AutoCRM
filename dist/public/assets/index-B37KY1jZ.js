function ET(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const s in r)if(s!=="default"&&!(s in t)){const i=Object.getOwnPropertyDescriptor(r,s);i&&Object.defineProperty(t,s,i.get?i:{enumerable:!0,get:()=>r[s]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const s of document.querySelectorAll('link[rel="modulepreload"]'))r(s);new MutationObserver(s=>{for(const i of s)if(i.type==="childList")for(const a of i.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(s){const i={};return s.integrity&&(i.integrity=s.integrity),s.referrerPolicy&&(i.referrerPolicy=s.referrerPolicy),s.crossOrigin==="use-credentials"?i.credentials="include":s.crossOrigin==="anonymous"?i.credentials="omit":i.credentials="same-origin",i}function r(s){if(s.ep)return;s.ep=!0;const i=n(s);fetch(s.href,i)}})();var Pn=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function Xa(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}function AT(t){if(t.__esModule)return t;var e=t.default;if(typeof e=="function"){var n=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};n.prototype=e.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(t).forEach(function(r){var s=Object.getOwnPropertyDescriptor(t,r);Object.defineProperty(n,r,s.get?s:{enumerable:!0,get:function(){return t[r]}})}),n}var S1={exports:{}},af={},k1={exports:{}},ye={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var ll=Symbol.for("react.element"),TT=Symbol.for("react.portal"),CT=Symbol.for("react.fragment"),PT=Symbol.for("react.strict_mode"),OT=Symbol.for("react.profiler"),NT=Symbol.for("react.provider"),IT=Symbol.for("react.context"),RT=Symbol.for("react.forward_ref"),jT=Symbol.for("react.suspense"),$T=Symbol.for("react.memo"),LT=Symbol.for("react.lazy"),fb=Symbol.iterator;function MT(t){return t===null||typeof t!="object"?null:(t=fb&&t[fb]||t["@@iterator"],typeof t=="function"?t:null)}var E1={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},A1=Object.assign,T1={};function Ya(t,e,n){this.props=t,this.context=e,this.refs=T1,this.updater=n||E1}Ya.prototype.isReactComponent={};Ya.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};Ya.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function C1(){}C1.prototype=Ya.prototype;function Bg(t,e,n){this.props=t,this.context=e,this.refs=T1,this.updater=n||E1}var Ug=Bg.prototype=new C1;Ug.constructor=Bg;A1(Ug,Ya.prototype);Ug.isPureReactComponent=!0;var hb=Array.isArray,P1=Object.prototype.hasOwnProperty,zg={current:null},O1={key:!0,ref:!0,__self:!0,__source:!0};function N1(t,e,n){var r,s={},i=null,a=null;if(e!=null)for(r in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(i=""+e.key),e)P1.call(e,r)&&!O1.hasOwnProperty(r)&&(s[r]=e[r]);var o=arguments.length-2;if(o===1)s.children=n;else if(1<o){for(var u=Array(o),l=0;l<o;l++)u[l]=arguments[l+2];s.children=u}if(t&&t.defaultProps)for(r in o=t.defaultProps,o)s[r]===void 0&&(s[r]=o[r]);return{$$typeof:ll,type:t,key:i,ref:a,props:s,_owner:zg.current}}function DT(t,e){return{$$typeof:ll,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function qg(t){return typeof t=="object"&&t!==null&&t.$$typeof===ll}function FT(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var pb=/\/+/g;function fh(t,e){return typeof t=="object"&&t!==null&&t.key!=null?FT(""+t.key):e.toString(36)}function Oc(t,e,n,r,s){var i=typeof t;(i==="undefined"||i==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(i){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case ll:case TT:a=!0}}if(a)return a=t,s=s(a),t=r===""?"."+fh(a,0):r,hb(s)?(n="",t!=null&&(n=t.replace(pb,"$&/")+"/"),Oc(s,e,n,"",function(l){return l})):s!=null&&(qg(s)&&(s=DT(s,n+(!s.key||a&&a.key===s.key?"":(""+s.key).replace(pb,"$&/")+"/")+t)),e.push(s)),1;if(a=0,r=r===""?".":r+":",hb(t))for(var o=0;o<t.length;o++){i=t[o];var u=r+fh(i,o);a+=Oc(i,e,n,u,s)}else if(u=MT(t),typeof u=="function")for(t=u.call(t),o=0;!(i=t.next()).done;)i=i.value,u=r+fh(i,o++),a+=Oc(i,e,n,u,s);else if(i==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Ll(t,e,n){if(t==null)return t;var r=[],s=0;return Oc(t,r,"","",function(i){return e.call(n,i,s++)}),r}function BT(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var Bt={current:null},Nc={transition:null},UT={ReactCurrentDispatcher:Bt,ReactCurrentBatchConfig:Nc,ReactCurrentOwner:zg};ye.Children={map:Ll,forEach:function(t,e,n){Ll(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Ll(t,function(){e++}),e},toArray:function(t){return Ll(t,function(e){return e})||[]},only:function(t){if(!qg(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ye.Component=Ya;ye.Fragment=CT;ye.Profiler=OT;ye.PureComponent=Bg;ye.StrictMode=PT;ye.Suspense=jT;ye.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=UT;ye.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var r=A1({},t.props),s=t.key,i=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(i=e.ref,a=zg.current),e.key!==void 0&&(s=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(u in e)P1.call(e,u)&&!O1.hasOwnProperty(u)&&(r[u]=e[u]===void 0&&o!==void 0?o[u]:e[u])}var u=arguments.length-2;if(u===1)r.children=n;else if(1<u){o=Array(u);for(var l=0;l<u;l++)o[l]=arguments[l+2];r.children=o}return{$$typeof:ll,type:t.type,key:s,ref:i,props:r,_owner:a}};ye.createContext=function(t){return t={$$typeof:IT,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:NT,_context:t},t.Consumer=t};ye.createElement=N1;ye.createFactory=function(t){var e=N1.bind(null,t);return e.type=t,e};ye.createRef=function(){return{current:null}};ye.forwardRef=function(t){return{$$typeof:RT,render:t}};ye.isValidElement=qg;ye.lazy=function(t){return{$$typeof:LT,_payload:{_status:-1,_result:t},_init:BT}};ye.memo=function(t,e){return{$$typeof:$T,type:t,compare:e===void 0?null:e}};ye.startTransition=function(t){var e=Nc.transition;Nc.transition={};try{t()}finally{Nc.transition=e}};ye.unstable_act=function(){throw Error("act(...) is not supported in production builds of React.")};ye.useCallback=function(t,e){return Bt.current.useCallback(t,e)};ye.useContext=function(t){return Bt.current.useContext(t)};ye.useDebugValue=function(){};ye.useDeferredValue=function(t){return Bt.current.useDeferredValue(t)};ye.useEffect=function(t,e){return Bt.current.useEffect(t,e)};ye.useId=function(){return Bt.current.useId()};ye.useImperativeHandle=function(t,e,n){return Bt.current.useImperativeHandle(t,e,n)};ye.useInsertionEffect=function(t,e){return Bt.current.useInsertionEffect(t,e)};ye.useLayoutEffect=function(t,e){return Bt.current.useLayoutEffect(t,e)};ye.useMemo=function(t,e){return Bt.current.useMemo(t,e)};ye.useReducer=function(t,e,n){return Bt.current.useReducer(t,e,n)};ye.useRef=function(t){return Bt.current.useRef(t)};ye.useState=function(t){return Bt.current.useState(t)};ye.useSyncExternalStore=function(t,e,n){return Bt.current.useSyncExternalStore(t,e,n)};ye.useTransition=function(){return Bt.current.useTransition()};ye.version="18.0.0-fc46dba67-20220329";k1.exports=ye;var v=k1.exports;const Lr=Xa(v),zT=ET({__proto__:null,default:Lr},[v]);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var qT=v,HT=Symbol.for("react.element"),VT=Symbol.for("react.fragment"),WT=Object.prototype.hasOwnProperty,GT=qT.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,ZT={key:!0,ref:!0,__self:!0,__source:!0};function I1(t,e,n){var r,s={},i=null,a=null;n!==void 0&&(i=""+n),e.key!==void 0&&(i=""+e.key),e.ref!==void 0&&(a=e.ref);for(r in e)WT.call(e,r)&&!ZT.hasOwnProperty(r)&&(s[r]=e[r]);if(t&&t.defaultProps)for(r in e=t.defaultProps,e)s[r]===void 0&&(s[r]=e[r]);return{$$typeof:HT,type:t,key:i,ref:a,props:s,_owner:GT.current}}af.Fragment=VT;af.jsx=I1;af.jsxs=I1;S1.exports=af;var g=S1.exports,Fp={},R1={exports:{}},bn={},j1={exports:{}},$1={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(A,C){var M=A.length;A.push(C);e:for(;0<M;){var W=M-1>>>1,J=A[W];if(0<s(J,C))A[W]=C,A[M]=J,M=W;else break e}}function n(A){return A.length===0?null:A[0]}function r(A){if(A.length===0)return null;var C=A[0],M=A.pop();if(M!==C){A[0]=M;e:for(var W=0,J=A.length,fe=J>>>1;W<fe;){var pe=2*(W+1)-1,me=A[pe],De=pe+1,ee=A[De];if(0>s(me,M))De<J&&0>s(ee,me)?(A[W]=ee,A[De]=M,W=De):(A[W]=me,A[pe]=M,W=pe);else if(De<J&&0>s(ee,M))A[W]=ee,A[De]=M,W=De;else break e}}return C}function s(A,C){var M=A.sortIndex-C.sortIndex;return M!==0?M:A.id-C.id}if(typeof performance=="object"&&typeof performance.now=="function"){var i=performance;t.unstable_now=function(){return i.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var u=[],l=[],c=1,d=null,f=3,h=!1,m=!1,y=!1,w=typeof setTimeout=="function"?setTimeout:null,p=typeof clearTimeout=="function"?clearTimeout:null,b=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function _(A){for(var C=n(l);C!==null;){if(C.callback===null)r(l);else if(C.startTime<=A)r(l),C.sortIndex=C.expirationTime,e(u,C);else break;C=n(l)}}function x(A){if(y=!1,_(A),!m)if(n(u)!==null)m=!0,L(S);else{var C=n(l);C!==null&&F(x,C.startTime-A)}}function S(A,C){m=!1,y&&(y=!1,p(T),T=-1),h=!0;var M=f;try{for(_(C),d=n(u);d!==null&&(!(d.expirationTime>C)||A&&!H());){var W=d.callback;if(typeof W=="function"){d.callback=null,f=d.priorityLevel;var J=W(d.expirationTime<=C);C=t.unstable_now(),typeof J=="function"?d.callback=J:d===n(u)&&r(u),_(C)}else r(u);d=n(u)}if(d!==null)var fe=!0;else{var pe=n(l);pe!==null&&F(x,pe.startTime-C),fe=!1}return fe}finally{d=null,f=M,h=!1}}var E=!1,k=null,T=-1,$=5,j=-1;function H(){return!(t.unstable_now()-j<$)}function q(){if(k!==null){var A=t.unstable_now();j=A;var C=!0;try{C=k(!0,A)}finally{C?X():(E=!1,k=null)}}else E=!1}var X;if(typeof b=="function")X=function(){b(q)};else if(typeof MessageChannel<"u"){var O=new MessageChannel,I=O.port2;O.port1.onmessage=q,X=function(){I.postMessage(null)}}else X=function(){w(q,0)};function L(A){k=A,E||(E=!0,X())}function F(A,C){T=w(function(){A(t.unstable_now())},C)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(A){A.callback=null},t.unstable_continueExecution=function(){m||h||(m=!0,L(S))},t.unstable_forceFrameRate=function(A){0>A||125<A?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):$=0<A?Math.floor(1e3/A):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return n(u)},t.unstable_next=function(A){switch(f){case 1:case 2:case 3:var C=3;break;default:C=f}var M=f;f=C;try{return A()}finally{f=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(A,C){switch(A){case 1:case 2:case 3:case 4:case 5:break;default:A=3}var M=f;f=A;try{return C()}finally{f=M}},t.unstable_scheduleCallback=function(A,C,M){var W=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?W+M:W):M=W,A){case 1:var J=-1;break;case 2:J=250;break;case 5:J=1073741823;break;case 4:J=1e4;break;default:J=5e3}return J=M+J,A={id:c++,callback:C,priorityLevel:A,startTime:M,expirationTime:J,sortIndex:-1},M>W?(A.sortIndex=M,e(l,A),n(u)===null&&A===n(l)&&(y?(p(T),T=-1):y=!0,F(x,M-W))):(A.sortIndex=J,e(u,A),m||h||(m=!0,L(S))),A},t.unstable_shouldYield=H,t.unstable_wrapCallback=function(A){var C=f;return function(){var M=f;f=C;try{return A.apply(this,arguments)}finally{f=M}}}})($1);j1.exports=$1;var JT=j1.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var L1=v,mn=JT;function U(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var M1=new Set,bu={};function Oi(t,e){Oa(t,e),Oa(t+"Capture",e)}function Oa(t,e){for(bu[t]=e,t=0;t<e.length;t++)M1.add(e[t])}var Zr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Bp=Object.prototype.hasOwnProperty,KT=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,mb={},gb={};function QT(t){return Bp.call(gb,t)?!0:Bp.call(mb,t)?!1:KT.test(t)?gb[t]=!0:(mb[t]=!0,!1)}function XT(t,e,n,r){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function YT(t,e,n,r){if(e===null||typeof e>"u"||XT(t,e,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Ut(t,e,n,r,s,i,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=r,this.attributeNamespace=s,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=i,this.removeEmptyString=a}var vt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){vt[t]=new Ut(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];vt[e]=new Ut(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){vt[t]=new Ut(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){vt[t]=new Ut(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){vt[t]=new Ut(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){vt[t]=new Ut(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){vt[t]=new Ut(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){vt[t]=new Ut(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){vt[t]=new Ut(t,5,!1,t.toLowerCase(),null,!1,!1)});var Hg=/[\-:]([a-z])/g;function Vg(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Hg,Vg);vt[e]=new Ut(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Hg,Vg);vt[e]=new Ut(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Hg,Vg);vt[e]=new Ut(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){vt[t]=new Ut(t,1,!1,t.toLowerCase(),null,!1,!1)});vt.xlinkHref=new Ut("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){vt[t]=new Ut(t,1,!1,t.toLowerCase(),null,!0,!0)});function Wg(t,e,n,r){var s=vt.hasOwnProperty(e)?vt[e]:null;(s!==null?s.type!==0:r||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(YT(e,n,s,r)&&(n=null),r||s===null?QT(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):s.mustUseProperty?t[s.propertyName]=n===null?s.type===3?!1:"":n:(e=s.attributeName,r=s.attributeNamespace,n===null?t.removeAttribute(e):(s=s.type,n=s===3||s===4&&n===!0?"":""+n,r?t.setAttributeNS(r,e,n):t.setAttribute(e,n))))}var ts=L1.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,Ml=Symbol.for("react.element"),ea=Symbol.for("react.portal"),ta=Symbol.for("react.fragment"),Gg=Symbol.for("react.strict_mode"),Up=Symbol.for("react.profiler"),D1=Symbol.for("react.provider"),F1=Symbol.for("react.context"),Zg=Symbol.for("react.forward_ref"),zp=Symbol.for("react.suspense"),qp=Symbol.for("react.suspense_list"),Jg=Symbol.for("react.memo"),fs=Symbol.for("react.lazy"),B1=Symbol.for("react.offscreen"),yb=Symbol.iterator;function ko(t){return t===null||typeof t!="object"?null:(t=yb&&t[yb]||t["@@iterator"],typeof t=="function"?t:null)}var Je=Object.assign,hh;function Bo(t){if(hh===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);hh=e&&e[1]||""}return`
`+hh+t}var ph=!1;function mh(t,e){if(!t||ph)return"";ph=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(l){var r=l}Reflect.construct(t,[],e)}else{try{e.call()}catch(l){r=l}t.call(e.prototype)}else{try{throw Error()}catch(l){r=l}t()}}catch(l){if(l&&r&&typeof l.stack=="string"){for(var s=l.stack.split(`
`),i=r.stack.split(`
`),a=s.length-1,o=i.length-1;1<=a&&0<=o&&s[a]!==i[o];)o--;for(;1<=a&&0<=o;a--,o--)if(s[a]!==i[o]){if(a!==1||o!==1)do if(a--,o--,0>o||s[a]!==i[o]){var u=`
`+s[a].replace(" at new "," at ");return t.displayName&&u.includes("<anonymous>")&&(u=u.replace("<anonymous>",t.displayName)),u}while(1<=a&&0<=o);break}}}finally{ph=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Bo(t):""}function eC(t){switch(t.tag){case 5:return Bo(t.type);case 16:return Bo("Lazy");case 13:return Bo("Suspense");case 19:return Bo("SuspenseList");case 0:case 2:case 15:return t=mh(t.type,!1),t;case 11:return t=mh(t.type.render,!1),t;case 1:return t=mh(t.type,!0),t;default:return""}}function Hp(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ta:return"Fragment";case ea:return"Portal";case Up:return"Profiler";case Gg:return"StrictMode";case zp:return"Suspense";case qp:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case F1:return(t.displayName||"Context")+".Consumer";case D1:return(t._context.displayName||"Context")+".Provider";case Zg:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Jg:return e=t.displayName||null,e!==null?e:Hp(t.type)||"Memo";case fs:e=t._payload,t=t._init;try{return Hp(t(e))}catch{}}return null}function tC(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Hp(e);case 8:return e===Gg?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function Ps(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function U1(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function nC(t){var e=U1(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),r=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var s=n.get,i=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return s.call(this)},set:function(a){r=""+a,i.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function Dl(t){t._valueTracker||(t._valueTracker=nC(t))}function z1(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),r="";return t&&(r=U1(t)?t.checked?"true":"false":t.value),t=r,t!==n?(e.setValue(t),!0):!1}function nd(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Vp(t,e){var n=e.checked;return Je({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function bb(t,e){var n=e.defaultValue==null?"":e.defaultValue,r=e.checked!=null?e.checked:e.defaultChecked;n=Ps(e.value!=null?e.value:n),t._wrapperState={initialChecked:r,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function q1(t,e){e=e.checked,e!=null&&Wg(t,"checked",e,!1)}function Wp(t,e){q1(t,e);var n=Ps(e.value),r=e.type;if(n!=null)r==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(r==="submit"||r==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Gp(t,e.type,n):e.hasOwnProperty("defaultValue")&&Gp(t,e.type,Ps(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function wb(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var r=e.type;if(!(r!=="submit"&&r!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Gp(t,e,n){(e!=="number"||nd(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Uo=Array.isArray;function ga(t,e,n,r){if(t=t.options,e){e={};for(var s=0;s<n.length;s++)e["$"+n[s]]=!0;for(n=0;n<t.length;n++)s=e.hasOwnProperty("$"+t[n].value),t[n].selected!==s&&(t[n].selected=s),s&&r&&(t[n].defaultSelected=!0)}else{for(n=""+Ps(n),e=null,s=0;s<t.length;s++){if(t[s].value===n){t[s].selected=!0,r&&(t[s].defaultSelected=!0);return}e!==null||t[s].disabled||(e=t[s])}e!==null&&(e.selected=!0)}}function Zp(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(U(91));return Je({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function _b(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(U(92));if(Uo(n)){if(1<n.length)throw Error(U(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:Ps(n)}}function H1(t,e){var n=Ps(e.value),r=Ps(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),r!=null&&(t.defaultValue=""+r)}function vb(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function V1(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Jp(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?V1(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var Fl,W1=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,r,s){MSApp.execUnsafeLocalFunction(function(){return t(e,n,r,s)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(Fl=Fl||document.createElement("div"),Fl.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=Fl.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function wu(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var tu={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},rC=["Webkit","ms","Moz","O"];Object.keys(tu).forEach(function(t){rC.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),tu[e]=tu[t]})});function G1(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||tu.hasOwnProperty(t)&&tu[t]?(""+e).trim():e+"px"}function Z1(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var r=n.indexOf("--")===0,s=G1(n,e[n],r);n==="float"&&(n="cssFloat"),r?t.setProperty(n,s):t[n]=s}}var sC=Je({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Kp(t,e){if(e){if(sC[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(U(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(U(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(U(61))}if(e.style!=null&&typeof e.style!="object")throw Error(U(62))}}function Qp(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Xp=null;function Kg(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Yp=null,ya=null,ba=null;function xb(t){if(t=fl(t)){if(typeof Yp!="function")throw Error(U(280));var e=t.stateNode;e&&(e=df(e),Yp(t.stateNode,t.type,e))}}function J1(t){ya?ba?ba.push(t):ba=[t]:ya=t}function K1(){if(ya){var t=ya,e=ba;if(ba=ya=null,xb(t),e)for(t=0;t<e.length;t++)xb(e[t])}}function Q1(t,e){return t(e)}function X1(){}var gh=!1;function Y1(t,e,n){if(gh)return t(e,n);gh=!0;try{return Q1(t,e,n)}finally{gh=!1,(ya!==null||ba!==null)&&(X1(),K1())}}function _u(t,e){var n=t.stateNode;if(n===null)return null;var r=df(n);if(r===null)return null;n=r[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(t=t.type,r=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!r;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(U(231,e,typeof n));return n}var em=!1;if(Zr)try{var Eo={};Object.defineProperty(Eo,"passive",{get:function(){em=!0}}),window.addEventListener("test",Eo,Eo),window.removeEventListener("test",Eo,Eo)}catch{em=!1}function iC(t,e,n,r,s,i,a,o,u){var l=Array.prototype.slice.call(arguments,3);try{e.apply(n,l)}catch(c){this.onError(c)}}var nu=!1,rd=null,sd=!1,tm=null,aC={onError:function(t){nu=!0,rd=t}};function oC(t,e,n,r,s,i,a,o,u){nu=!1,rd=null,iC.apply(aC,arguments)}function uC(t,e,n,r,s,i,a,o,u){if(oC.apply(this,arguments),nu){if(nu){var l=rd;nu=!1,rd=null}else throw Error(U(198));sd||(sd=!0,tm=l)}}function Ni(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function ex(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function Sb(t){if(Ni(t)!==t)throw Error(U(188))}function lC(t){var e=t.alternate;if(!e){if(e=Ni(t),e===null)throw Error(U(188));return e!==t?null:t}for(var n=t,r=e;;){var s=n.return;if(s===null)break;var i=s.alternate;if(i===null){if(r=s.return,r!==null){n=r;continue}break}if(s.child===i.child){for(i=s.child;i;){if(i===n)return Sb(s),t;if(i===r)return Sb(s),e;i=i.sibling}throw Error(U(188))}if(n.return!==r.return)n=s,r=i;else{for(var a=!1,o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a){for(o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a)throw Error(U(189))}}if(n.alternate!==r)throw Error(U(190))}if(n.tag!==3)throw Error(U(188));return n.stateNode.current===n?t:e}function tx(t){return t=lC(t),t!==null?nx(t):null}function nx(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=nx(t);if(e!==null)return e;t=t.sibling}return null}var rx=mn.unstable_scheduleCallback,kb=mn.unstable_cancelCallback,cC=mn.unstable_shouldYield,dC=mn.unstable_requestPaint,Qe=mn.unstable_now,fC=mn.unstable_getCurrentPriorityLevel,Qg=mn.unstable_ImmediatePriority,sx=mn.unstable_UserBlockingPriority,id=mn.unstable_NormalPriority,hC=mn.unstable_LowPriority,ix=mn.unstable_IdlePriority,of=null,vr=null;function pC(t){if(vr&&typeof vr.onCommitFiberRoot=="function")try{vr.onCommitFiberRoot(of,t,void 0,(t.current.flags&128)===128)}catch{}}var Gn=Math.clz32?Math.clz32:yC,mC=Math.log,gC=Math.LN2;function yC(t){return t>>>=0,t===0?32:31-(mC(t)/gC|0)|0}var Bl=64,Ul=4194304;function zo(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function ad(t,e){var n=t.pendingLanes;if(n===0)return 0;var r=0,s=t.suspendedLanes,i=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~s;o!==0?r=zo(o):(i&=a,i!==0&&(r=zo(i)))}else a=n&~s,a!==0?r=zo(a):i!==0&&(r=zo(i));if(r===0)return 0;if(e!==0&&e!==r&&!(e&s)&&(s=r&-r,i=e&-e,s>=i||s===16&&(i&4194240)!==0))return e;if(r&4&&(r|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=r;0<e;)n=31-Gn(e),s=1<<n,r|=t[n],e&=~s;return r}function bC(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function wC(t,e){for(var n=t.suspendedLanes,r=t.pingedLanes,s=t.expirationTimes,i=t.pendingLanes;0<i;){var a=31-Gn(i),o=1<<a,u=s[a];u===-1?(!(o&n)||o&r)&&(s[a]=bC(o,e)):u<=e&&(t.expiredLanes|=o),i&=~o}}function nm(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function yh(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function cl(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-Gn(e),t[e]=n}function _C(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var r=t.eventTimes;for(t=t.expirationTimes;0<n;){var s=31-Gn(n),i=1<<s;e[s]=0,r[s]=-1,t[s]=-1,n&=~i}}function Xg(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var r=31-Gn(n),s=1<<r;s&e|t[r]&e&&(t[r]|=e),n&=~s}}var Ie=0;function ax(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var ox,Yg,ux,lx,cx,rm=!1,zl=[],Ss=null,ks=null,Es=null,vu=new Map,xu=new Map,ys=[],vC="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Eb(t,e){switch(t){case"focusin":case"focusout":Ss=null;break;case"dragenter":case"dragleave":ks=null;break;case"mouseover":case"mouseout":Es=null;break;case"pointerover":case"pointerout":vu.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":xu.delete(e.pointerId)}}function Ao(t,e,n,r,s,i){return t===null||t.nativeEvent!==i?(t={blockedOn:e,domEventName:n,eventSystemFlags:r,nativeEvent:i,targetContainers:[s]},e!==null&&(e=fl(e),e!==null&&Yg(e)),t):(t.eventSystemFlags|=r,e=t.targetContainers,s!==null&&e.indexOf(s)===-1&&e.push(s),t)}function xC(t,e,n,r,s){switch(e){case"focusin":return Ss=Ao(Ss,t,e,n,r,s),!0;case"dragenter":return ks=Ao(ks,t,e,n,r,s),!0;case"mouseover":return Es=Ao(Es,t,e,n,r,s),!0;case"pointerover":var i=s.pointerId;return vu.set(i,Ao(vu.get(i)||null,t,e,n,r,s)),!0;case"gotpointercapture":return i=s.pointerId,xu.set(i,Ao(xu.get(i)||null,t,e,n,r,s)),!0}return!1}function dx(t){var e=li(t.target);if(e!==null){var n=Ni(e);if(n!==null){if(e=n.tag,e===13){if(e=ex(n),e!==null){t.blockedOn=e,cx(t.priority,function(){ux(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Ic(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=sm(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var r=new n.constructor(n.type,n);Xp=r,n.target.dispatchEvent(r),Xp=null}else return e=fl(n),e!==null&&Yg(e),t.blockedOn=n,!1;e.shift()}return!0}function Ab(t,e,n){Ic(t)&&n.delete(e)}function SC(){rm=!1,Ss!==null&&Ic(Ss)&&(Ss=null),ks!==null&&Ic(ks)&&(ks=null),Es!==null&&Ic(Es)&&(Es=null),vu.forEach(Ab),xu.forEach(Ab)}function To(t,e){t.blockedOn===e&&(t.blockedOn=null,rm||(rm=!0,mn.unstable_scheduleCallback(mn.unstable_NormalPriority,SC)))}function Su(t){function e(s){return To(s,t)}if(0<zl.length){To(zl[0],t);for(var n=1;n<zl.length;n++){var r=zl[n];r.blockedOn===t&&(r.blockedOn=null)}}for(Ss!==null&&To(Ss,t),ks!==null&&To(ks,t),Es!==null&&To(Es,t),vu.forEach(e),xu.forEach(e),n=0;n<ys.length;n++)r=ys[n],r.blockedOn===t&&(r.blockedOn=null);for(;0<ys.length&&(n=ys[0],n.blockedOn===null);)dx(n),n.blockedOn===null&&ys.shift()}var wa=ts.ReactCurrentBatchConfig;function kC(t,e,n,r){var s=Ie,i=wa.transition;wa.transition=null;try{Ie=1,e0(t,e,n,r)}finally{Ie=s,wa.transition=i}}function EC(t,e,n,r){var s=Ie,i=wa.transition;wa.transition=null;try{Ie=4,e0(t,e,n,r)}finally{Ie=s,wa.transition=i}}function e0(t,e,n,r){var s=sm(t,e,n,r);if(s===null)Th(t,e,r,od,n),Eb(t,r);else if(xC(s,t,e,n,r))r.stopPropagation();else if(Eb(t,r),e&4&&-1<vC.indexOf(t)){for(;s!==null;){var i=fl(s);if(i!==null&&ox(i),i=sm(t,e,n,r),i===null&&Th(t,e,r,od,n),i===s)break;s=i}s!==null&&r.stopPropagation()}else Th(t,e,r,null,n)}var od=null;function sm(t,e,n,r){if(od=null,t=Kg(r),t=li(t),t!==null)if(e=Ni(t),e===null)t=null;else if(n=e.tag,n===13){if(t=ex(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return od=t,null}function fx(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(fC()){case Qg:return 1;case sx:return 4;case id:case hC:return 16;case ix:return 536870912;default:return 16}default:return 16}}var _s=null,t0=null,Rc=null;function hx(){if(Rc)return Rc;var t,e=t0,n=e.length,r,s="value"in _s?_s.value:_s.textContent,i=s.length;for(t=0;t<n&&e[t]===s[t];t++);var a=n-t;for(r=1;r<=a&&e[n-r]===s[i-r];r++);return Rc=s.slice(t,1<r?1-r:void 0)}function jc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function ql(){return!0}function Tb(){return!1}function wn(t){function e(n,r,s,i,a){this._reactName=n,this._targetInst=s,this.type=r,this.nativeEvent=i,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(i):i[o]);return this.isDefaultPrevented=(i.defaultPrevented!=null?i.defaultPrevented:i.returnValue===!1)?ql:Tb,this.isPropagationStopped=Tb,this}return Je(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=ql)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=ql)},persist:function(){},isPersistent:ql}),e}var eo={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},n0=wn(eo),dl=Je({},eo,{view:0,detail:0}),AC=wn(dl),bh,wh,Co,uf=Je({},dl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:r0,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Co&&(Co&&t.type==="mousemove"?(bh=t.screenX-Co.screenX,wh=t.screenY-Co.screenY):wh=bh=0,Co=t),bh)},movementY:function(t){return"movementY"in t?t.movementY:wh}}),Cb=wn(uf),TC=Je({},uf,{dataTransfer:0}),CC=wn(TC),PC=Je({},dl,{relatedTarget:0}),_h=wn(PC),OC=Je({},eo,{animationName:0,elapsedTime:0,pseudoElement:0}),NC=wn(OC),IC=Je({},eo,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),RC=wn(IC),jC=Je({},eo,{data:0}),Pb=wn(jC),$C={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},LC={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},MC={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function DC(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=MC[t])?!!e[t]:!1}function r0(){return DC}var FC=Je({},dl,{key:function(t){if(t.key){var e=$C[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=jc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?LC[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:r0,charCode:function(t){return t.type==="keypress"?jc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?jc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),BC=wn(FC),UC=Je({},uf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Ob=wn(UC),zC=Je({},dl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:r0}),qC=wn(zC),HC=Je({},eo,{propertyName:0,elapsedTime:0,pseudoElement:0}),VC=wn(HC),WC=Je({},uf,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),GC=wn(WC),ZC=[9,13,27,32],s0=Zr&&"CompositionEvent"in window,ru=null;Zr&&"documentMode"in document&&(ru=document.documentMode);var JC=Zr&&"TextEvent"in window&&!ru,px=Zr&&(!s0||ru&&8<ru&&11>=ru),Nb=" ",Ib=!1;function mx(t,e){switch(t){case"keyup":return ZC.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function gx(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var na=!1;function KC(t,e){switch(t){case"compositionend":return gx(e);case"keypress":return e.which!==32?null:(Ib=!0,Nb);case"textInput":return t=e.data,t===Nb&&Ib?null:t;default:return null}}function QC(t,e){if(na)return t==="compositionend"||!s0&&mx(t,e)?(t=hx(),Rc=t0=_s=null,na=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return px&&e.locale!=="ko"?null:e.data;default:return null}}var XC={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Rb(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!XC[t.type]:e==="textarea"}function yx(t,e,n,r){J1(r),e=ud(e,"onChange"),0<e.length&&(n=new n0("onChange","change",null,n,r),t.push({event:n,listeners:e}))}var su=null,ku=null;function YC(t){Cx(t,0)}function lf(t){var e=ia(t);if(z1(e))return t}function eP(t,e){if(t==="change")return e}var bx=!1;if(Zr){var vh;if(Zr){var xh="oninput"in document;if(!xh){var jb=document.createElement("div");jb.setAttribute("oninput","return;"),xh=typeof jb.oninput=="function"}vh=xh}else vh=!1;bx=vh&&(!document.documentMode||9<document.documentMode)}function $b(){su&&(su.detachEvent("onpropertychange",wx),ku=su=null)}function wx(t){if(t.propertyName==="value"&&lf(ku)){var e=[];yx(e,ku,t,Kg(t)),Y1(YC,e)}}function tP(t,e,n){t==="focusin"?($b(),su=e,ku=n,su.attachEvent("onpropertychange",wx)):t==="focusout"&&$b()}function nP(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return lf(ku)}function rP(t,e){if(t==="click")return lf(e)}function sP(t,e){if(t==="input"||t==="change")return lf(e)}function iP(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var kr=typeof Object.is=="function"?Object.is:iP;function Eu(t,e){if(kr(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),r=Object.keys(e);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var s=n[r];if(!Bp.call(e,s)||!kr(t[s],e[s]))return!1}return!0}function Lb(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Mb(t,e){var n=Lb(t);t=0;for(var r;n;){if(n.nodeType===3){if(r=t+n.textContent.length,t<=e&&r>=e)return{node:n,offset:e-t};t=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Lb(n)}}function _x(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?_x(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function vx(){for(var t=window,e=nd();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=nd(t.document)}return e}function i0(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function aP(t){var e=vx(),n=t.focusedElem,r=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&_x(n.ownerDocument.documentElement,n)){if(r!==null&&i0(n)){if(e=r.start,t=r.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var s=n.textContent.length,i=Math.min(r.start,s);r=r.end===void 0?i:Math.min(r.end,s),!t.extend&&i>r&&(s=r,r=i,i=s),s=Mb(n,i);var a=Mb(n,r);s&&a&&(t.rangeCount!==1||t.anchorNode!==s.node||t.anchorOffset!==s.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(s.node,s.offset),t.removeAllRanges(),i>r?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var oP=Zr&&"documentMode"in document&&11>=document.documentMode,ra=null,im=null,iu=null,am=!1;function Db(t,e,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;am||ra==null||ra!==nd(r)||(r=ra,"selectionStart"in r&&i0(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),iu&&Eu(iu,r)||(iu=r,r=ud(im,"onSelect"),0<r.length&&(e=new n0("onSelect","select",null,e,n),t.push({event:e,listeners:r}),e.target=ra)))}function Hl(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var sa={animationend:Hl("Animation","AnimationEnd"),animationiteration:Hl("Animation","AnimationIteration"),animationstart:Hl("Animation","AnimationStart"),transitionend:Hl("Transition","TransitionEnd")},Sh={},xx={};Zr&&(xx=document.createElement("div").style,"AnimationEvent"in window||(delete sa.animationend.animation,delete sa.animationiteration.animation,delete sa.animationstart.animation),"TransitionEvent"in window||delete sa.transitionend.transition);function cf(t){if(Sh[t])return Sh[t];if(!sa[t])return t;var e=sa[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in xx)return Sh[t]=e[n];return t}var Sx=cf("animationend"),kx=cf("animationiteration"),Ex=cf("animationstart"),Ax=cf("transitionend"),Tx=new Map,Fb="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function qs(t,e){Tx.set(t,e),Oi(e,[t])}for(var kh=0;kh<Fb.length;kh++){var Eh=Fb[kh],uP=Eh.toLowerCase(),lP=Eh[0].toUpperCase()+Eh.slice(1);qs(uP,"on"+lP)}qs(Sx,"onAnimationEnd");qs(kx,"onAnimationIteration");qs(Ex,"onAnimationStart");qs("dblclick","onDoubleClick");qs("focusin","onFocus");qs("focusout","onBlur");qs(Ax,"onTransitionEnd");Oa("onMouseEnter",["mouseout","mouseover"]);Oa("onMouseLeave",["mouseout","mouseover"]);Oa("onPointerEnter",["pointerout","pointerover"]);Oa("onPointerLeave",["pointerout","pointerover"]);Oi("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Oi("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Oi("onBeforeInput",["compositionend","keypress","textInput","paste"]);Oi("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Oi("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Oi("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var qo="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),cP=new Set("cancel close invalid load scroll toggle".split(" ").concat(qo));function Bb(t,e,n){var r=t.type||"unknown-event";t.currentTarget=n,uC(r,e,void 0,t),t.currentTarget=null}function Cx(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var r=t[n],s=r.event;r=r.listeners;e:{var i=void 0;if(e)for(var a=r.length-1;0<=a;a--){var o=r[a],u=o.instance,l=o.currentTarget;if(o=o.listener,u!==i&&s.isPropagationStopped())break e;Bb(s,o,l),i=u}else for(a=0;a<r.length;a++){if(o=r[a],u=o.instance,l=o.currentTarget,o=o.listener,u!==i&&s.isPropagationStopped())break e;Bb(s,o,l),i=u}}}if(sd)throw t=tm,sd=!1,tm=null,t}function Be(t,e){var n=e[cm];n===void 0&&(n=e[cm]=new Set);var r=t+"__bubble";n.has(r)||(Px(e,t,2,!1),n.add(r))}function Ah(t,e,n){var r=0;e&&(r|=4),Px(n,t,r,e)}var Vl="_reactListening"+Math.random().toString(36).slice(2);function Au(t){if(!t[Vl]){t[Vl]=!0,M1.forEach(function(n){n!=="selectionchange"&&(cP.has(n)||Ah(n,!1,t),Ah(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[Vl]||(e[Vl]=!0,Ah("selectionchange",!1,e))}}function Px(t,e,n,r){switch(fx(e)){case 1:var s=kC;break;case 4:s=EC;break;default:s=e0}n=s.bind(null,e,n,t),s=void 0,!em||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(s=!0),r?s!==void 0?t.addEventListener(e,n,{capture:!0,passive:s}):t.addEventListener(e,n,!0):s!==void 0?t.addEventListener(e,n,{passive:s}):t.addEventListener(e,n,!1)}function Th(t,e,n,r,s){var i=r;if(!(e&1)&&!(e&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===s||o.nodeType===8&&o.parentNode===s)break;if(a===4)for(a=r.return;a!==null;){var u=a.tag;if((u===3||u===4)&&(u=a.stateNode.containerInfo,u===s||u.nodeType===8&&u.parentNode===s))return;a=a.return}for(;o!==null;){if(a=li(o),a===null)return;if(u=a.tag,u===5||u===6){r=i=a;continue e}o=o.parentNode}}r=r.return}Y1(function(){var l=i,c=Kg(n),d=[];e:{var f=Tx.get(t);if(f!==void 0){var h=n0,m=t;switch(t){case"keypress":if(jc(n)===0)break e;case"keydown":case"keyup":h=BC;break;case"focusin":m="focus",h=_h;break;case"focusout":m="blur",h=_h;break;case"beforeblur":case"afterblur":h=_h;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":h=Cb;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":h=CC;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":h=qC;break;case Sx:case kx:case Ex:h=NC;break;case Ax:h=VC;break;case"scroll":h=AC;break;case"wheel":h=GC;break;case"copy":case"cut":case"paste":h=RC;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":h=Ob}var y=(e&4)!==0,w=!y&&t==="scroll",p=y?f!==null?f+"Capture":null:f;y=[];for(var b=l,_;b!==null;){_=b;var x=_.stateNode;if(_.tag===5&&x!==null&&(_=x,p!==null&&(x=_u(b,p),x!=null&&y.push(Tu(b,x,_)))),w)break;b=b.return}0<y.length&&(f=new h(f,m,null,n,c),d.push({event:f,listeners:y}))}}if(!(e&7)){e:{if(f=t==="mouseover"||t==="pointerover",h=t==="mouseout"||t==="pointerout",f&&n!==Xp&&(m=n.relatedTarget||n.fromElement)&&(li(m)||m[Jr]))break e;if((h||f)&&(f=c.window===c?c:(f=c.ownerDocument)?f.defaultView||f.parentWindow:window,h?(m=n.relatedTarget||n.toElement,h=l,m=m?li(m):null,m!==null&&(w=Ni(m),m!==w||m.tag!==5&&m.tag!==6)&&(m=null)):(h=null,m=l),h!==m)){if(y=Cb,x="onMouseLeave",p="onMouseEnter",b="mouse",(t==="pointerout"||t==="pointerover")&&(y=Ob,x="onPointerLeave",p="onPointerEnter",b="pointer"),w=h==null?f:ia(h),_=m==null?f:ia(m),f=new y(x,b+"leave",h,n,c),f.target=w,f.relatedTarget=_,x=null,li(c)===l&&(y=new y(p,b+"enter",m,n,c),y.target=_,y.relatedTarget=w,x=y),w=x,h&&m)t:{for(y=h,p=m,b=0,_=y;_;_=Mi(_))b++;for(_=0,x=p;x;x=Mi(x))_++;for(;0<b-_;)y=Mi(y),b--;for(;0<_-b;)p=Mi(p),_--;for(;b--;){if(y===p||p!==null&&y===p.alternate)break t;y=Mi(y),p=Mi(p)}y=null}else y=null;h!==null&&Ub(d,f,h,y,!1),m!==null&&w!==null&&Ub(d,w,m,y,!0)}}e:{if(f=l?ia(l):window,h=f.nodeName&&f.nodeName.toLowerCase(),h==="select"||h==="input"&&f.type==="file")var S=eP;else if(Rb(f))if(bx)S=sP;else{S=nP;var E=tP}else(h=f.nodeName)&&h.toLowerCase()==="input"&&(f.type==="checkbox"||f.type==="radio")&&(S=rP);if(S&&(S=S(t,l))){yx(d,S,n,c);break e}E&&E(t,f,l),t==="focusout"&&(E=f._wrapperState)&&E.controlled&&f.type==="number"&&Gp(f,"number",f.value)}switch(E=l?ia(l):window,t){case"focusin":(Rb(E)||E.contentEditable==="true")&&(ra=E,im=l,iu=null);break;case"focusout":iu=im=ra=null;break;case"mousedown":am=!0;break;case"contextmenu":case"mouseup":case"dragend":am=!1,Db(d,n,c);break;case"selectionchange":if(oP)break;case"keydown":case"keyup":Db(d,n,c)}var k;if(s0)e:{switch(t){case"compositionstart":var T="onCompositionStart";break e;case"compositionend":T="onCompositionEnd";break e;case"compositionupdate":T="onCompositionUpdate";break e}T=void 0}else na?mx(t,n)&&(T="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(T="onCompositionStart");T&&(px&&n.locale!=="ko"&&(na||T!=="onCompositionStart"?T==="onCompositionEnd"&&na&&(k=hx()):(_s=c,t0="value"in _s?_s.value:_s.textContent,na=!0)),E=ud(l,T),0<E.length&&(T=new Pb(T,t,null,n,c),d.push({event:T,listeners:E}),k?T.data=k:(k=gx(n),k!==null&&(T.data=k)))),(k=JC?KC(t,n):QC(t,n))&&(l=ud(l,"onBeforeInput"),0<l.length&&(c=new Pb("onBeforeInput","beforeinput",null,n,c),d.push({event:c,listeners:l}),c.data=k))}Cx(d,e)})}function Tu(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ud(t,e){for(var n=e+"Capture",r=[];t!==null;){var s=t,i=s.stateNode;s.tag===5&&i!==null&&(s=i,i=_u(t,n),i!=null&&r.unshift(Tu(t,i,s)),i=_u(t,e),i!=null&&r.push(Tu(t,i,s))),t=t.return}return r}function Mi(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ub(t,e,n,r,s){for(var i=e._reactName,a=[];n!==null&&n!==r;){var o=n,u=o.alternate,l=o.stateNode;if(u!==null&&u===r)break;o.tag===5&&l!==null&&(o=l,s?(u=_u(n,i),u!=null&&a.unshift(Tu(n,u,o))):s||(u=_u(n,i),u!=null&&a.push(Tu(n,u,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var dP=/\r\n?/g,fP=/\u0000|\uFFFD/g;function zb(t){return(typeof t=="string"?t:""+t).replace(dP,`
`).replace(fP,"")}function Wl(t,e,n){if(e=zb(e),zb(t)!==e&&n)throw Error(U(425))}function ld(){}var om=null;function um(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var lm=typeof setTimeout=="function"?setTimeout:void 0,hP=typeof clearTimeout=="function"?clearTimeout:void 0,qb=typeof Promise=="function"?Promise:void 0,pP=typeof queueMicrotask=="function"?queueMicrotask:typeof qb<"u"?function(t){return qb.resolve(null).then(t).catch(mP)}:lm;function mP(t){setTimeout(function(){throw t})}function Ch(t,e){var n=e,r=0;do{var s=n.nextSibling;if(t.removeChild(n),s&&s.nodeType===8)if(n=s.data,n==="/$"){if(r===0){t.removeChild(s),Su(e);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=s}while(n);Su(e)}function Ur(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Hb(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var to=Math.random().toString(36).slice(2),hr="__reactFiber$"+to,Cu="__reactProps$"+to,Jr="__reactContainer$"+to,cm="__reactEvents$"+to,gP="__reactListeners$"+to,yP="__reactHandles$"+to;function li(t){var e=t[hr];if(e)return e;for(var n=t.parentNode;n;){if(e=n[Jr]||n[hr]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Hb(t);t!==null;){if(n=t[hr])return n;t=Hb(t)}return e}t=n,n=t.parentNode}return null}function fl(t){return t=t[hr]||t[Jr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function ia(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(U(33))}function df(t){return t[Cu]||null}var dm=[],aa=-1;function Hs(t){return{current:t}}function Ue(t){0>aa||(t.current=dm[aa],dm[aa]=null,aa--)}function Me(t,e){aa++,dm[aa]=t.current,t.current=e}var Os={},Pt=Hs(Os),Xt=Hs(!1),vi=Os;function Na(t,e){var n=t.type.contextTypes;if(!n)return Os;var r=t.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===e)return r.__reactInternalMemoizedMaskedChildContext;var s={},i;for(i in n)s[i]=e[i];return r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=s),s}function Yt(t){return t=t.childContextTypes,t!=null}function cd(){Ue(Xt),Ue(Pt)}function Vb(t,e,n){if(Pt.current!==Os)throw Error(U(168));Me(Pt,e),Me(Xt,n)}function Ox(t,e,n){var r=t.stateNode;if(e=e.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var s in r)if(!(s in e))throw Error(U(108,tC(t)||"Unknown",s));return Je({},n,r)}function dd(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||Os,vi=Pt.current,Me(Pt,t),Me(Xt,Xt.current),!0}function Wb(t,e,n){var r=t.stateNode;if(!r)throw Error(U(169));n?(t=Ox(t,e,vi),r.__reactInternalMemoizedMergedChildContext=t,Ue(Xt),Ue(Pt),Me(Pt,t)):Ue(Xt),Me(Xt,n)}var Fr=null,ff=!1,Ph=!1;function Nx(t){Fr===null?Fr=[t]:Fr.push(t)}function bP(t){ff=!0,Nx(t)}function Vs(){if(!Ph&&Fr!==null){Ph=!0;var t=0,e=Ie;try{var n=Fr;for(Ie=1;t<n.length;t++){var r=n[t];do r=r(!0);while(r!==null)}Fr=null,ff=!1}catch(s){throw Fr!==null&&(Fr=Fr.slice(t+1)),rx(Qg,Vs),s}finally{Ie=e,Ph=!1}}return null}var wP=ts.ReactCurrentBatchConfig;function Bn(t,e){if(t&&t.defaultProps){e=Je({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}var fd=Hs(null),hd=null,oa=null,a0=null;function o0(){a0=oa=hd=null}function u0(t){var e=fd.current;Ue(fd),t._currentValue=e}function fm(t,e,n){for(;t!==null;){var r=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,r!==null&&(r.childLanes|=e)):r!==null&&(r.childLanes&e)!==e&&(r.childLanes|=e),t===n)break;t=t.return}}function _a(t,e){hd=t,a0=oa=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(dn=!0),t.firstContext=null)}function On(t){var e=t._currentValue;if(a0!==t)if(t={context:t,memoizedValue:e,next:null},oa===null){if(hd===null)throw Error(U(308));oa=t,hd.dependencies={lanes:0,firstContext:t}}else oa=oa.next=t;return e}var yr=null,hs=!1;function l0(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Ix(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function Vr(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function As(t,e){var n=t.updateQueue;n!==null&&(n=n.shared,st!==null&&t.mode&1&&!(xe&2)?(t=n.interleaved,t===null?(e.next=e,yr===null?yr=[n]:yr.push(n)):(e.next=t.next,t.next=e),n.interleaved=e):(t=n.pending,t===null?e.next=e:(e.next=t.next,t.next=e),n.pending=e))}function $c(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Xg(t,n)}}function Gb(t,e){var n=t.updateQueue,r=t.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var s=null,i=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};i===null?s=i=a:i=i.next=a,n=n.next}while(n!==null);i===null?s=i=e:i=i.next=e}else s=i=e;n={baseState:r.baseState,firstBaseUpdate:s,lastBaseUpdate:i,shared:r.shared,effects:r.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function pd(t,e,n,r){var s=t.updateQueue;hs=!1;var i=s.firstBaseUpdate,a=s.lastBaseUpdate,o=s.shared.pending;if(o!==null){s.shared.pending=null;var u=o,l=u.next;u.next=null,a===null?i=l:a.next=l,a=u;var c=t.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=l:o.next=l,c.lastBaseUpdate=u))}if(i!==null){var d=s.baseState;a=0,c=l=u=null,o=i;do{var f=o.lane,h=o.eventTime;if((r&f)===f){c!==null&&(c=c.next={eventTime:h,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var m=t,y=o;switch(f=e,h=n,y.tag){case 1:if(m=y.payload,typeof m=="function"){d=m.call(h,d,f);break e}d=m;break e;case 3:m.flags=m.flags&-65537|128;case 0:if(m=y.payload,f=typeof m=="function"?m.call(h,d,f):m,f==null)break e;d=Je({},d,f);break e;case 2:hs=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,f=s.effects,f===null?s.effects=[o]:f.push(o))}else h={eventTime:h,lane:f,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(l=c=h,u=d):c=c.next=h,a|=f;if(o=o.next,o===null){if(o=s.shared.pending,o===null)break;f=o,o=f.next,f.next=null,s.lastBaseUpdate=f,s.shared.pending=null}}while(!0);if(c===null&&(u=d),s.baseState=u,s.firstBaseUpdate=l,s.lastBaseUpdate=c,e=s.shared.interleaved,e!==null){s=e;do a|=s.lane,s=s.next;while(s!==e)}else i===null&&(s.shared.lanes=0);La|=a,t.lanes=a,t.memoizedState=d}}function Zb(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var r=t[e],s=r.callback;if(s!==null){if(r.callback=null,r=n,typeof s!="function")throw Error(U(191,s));s.call(r)}}}var Rx=new L1.Component().refs;function hm(t,e,n,r){e=t.memoizedState,n=n(r,e),n=n==null?e:Je({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var hf={isMounted:function(t){return(t=t._reactInternals)?Ni(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var r=Mt(),s=Cs(t),i=Vr(r,s);i.payload=e,n!=null&&(i.callback=n),As(t,i),e=Cn(t,s,r),e!==null&&$c(e,t,s)},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var r=Mt(),s=Cs(t),i=Vr(r,s);i.tag=1,i.payload=e,n!=null&&(i.callback=n),As(t,i),e=Cn(t,s,r),e!==null&&$c(e,t,s)},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Mt(),r=Cs(t),s=Vr(n,r);s.tag=2,e!=null&&(s.callback=e),As(t,s),e=Cn(t,r,n),e!==null&&$c(e,t,r)}};function Jb(t,e,n,r,s,i,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(r,i,a):e.prototype&&e.prototype.isPureReactComponent?!Eu(n,r)||!Eu(s,i):!0}function jx(t,e,n){var r=!1,s=Os,i=e.contextType;return typeof i=="object"&&i!==null?i=On(i):(s=Yt(e)?vi:Pt.current,r=e.contextTypes,i=(r=r!=null)?Na(t,s):Os),e=new e(n,i),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=hf,t.stateNode=e,e._reactInternals=t,r&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=s,t.__reactInternalMemoizedMaskedChildContext=i),e}function Kb(t,e,n,r){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,r),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,r),e.state!==t&&hf.enqueueReplaceState(e,e.state,null)}function pm(t,e,n,r){var s=t.stateNode;s.props=n,s.state=t.memoizedState,s.refs=Rx,l0(t);var i=e.contextType;typeof i=="object"&&i!==null?s.context=On(i):(i=Yt(e)?vi:Pt.current,s.context=Na(t,i)),s.state=t.memoizedState,i=e.getDerivedStateFromProps,typeof i=="function"&&(hm(t,e,i,n),s.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof s.getSnapshotBeforeUpdate=="function"||typeof s.UNSAFE_componentWillMount!="function"&&typeof s.componentWillMount!="function"||(e=s.state,typeof s.componentWillMount=="function"&&s.componentWillMount(),typeof s.UNSAFE_componentWillMount=="function"&&s.UNSAFE_componentWillMount(),e!==s.state&&hf.enqueueReplaceState(s,s.state,null),pd(t,n,s,r),s.state=t.memoizedState),typeof s.componentDidMount=="function"&&(t.flags|=4194308)}var ua=[],la=0,md=null,gd=0,xn=[],Sn=0,xi=null,zr=1,qr="";function Xs(t,e){ua[la++]=gd,ua[la++]=md,md=t,gd=e}function $x(t,e,n){xn[Sn++]=zr,xn[Sn++]=qr,xn[Sn++]=xi,xi=t;var r=zr;t=qr;var s=32-Gn(r)-1;r&=~(1<<s),n+=1;var i=32-Gn(e)+s;if(30<i){var a=s-s%5;i=(r&(1<<a)-1).toString(32),r>>=a,s-=a,zr=1<<32-Gn(e)+s|n<<s|r,qr=i+t}else zr=1<<i|n<<s|r,qr=t}function c0(t){t.return!==null&&(Xs(t,1),$x(t,1,0))}function d0(t){for(;t===md;)md=ua[--la],ua[la]=null,gd=ua[--la],ua[la]=null;for(;t===xi;)xi=xn[--Sn],xn[Sn]=null,qr=xn[--Sn],xn[Sn]=null,zr=xn[--Sn],xn[Sn]=null}var fn=null,Kt=null,He=!1,qn=null;function Lx(t,e){var n=kn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function Qb(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,fn=t,Kt=Ur(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,fn=t,Kt=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=xi!==null?{id:zr,overflow:qr}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=kn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,fn=t,Kt=null,!0):!1;default:return!1}}function mm(t){return(t.mode&1)!==0&&(t.flags&128)===0}function gm(t){if(He){var e=Kt;if(e){var n=e;if(!Qb(t,e)){if(mm(t))throw Error(U(418));e=Ur(n.nextSibling);var r=fn;e&&Qb(t,e)?Lx(r,n):(t.flags=t.flags&-4097|2,He=!1,fn=t)}}else{if(mm(t))throw Error(U(418));t.flags=t.flags&-4097|2,He=!1,fn=t}}}function Xb(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;fn=t}function Po(t){if(t!==fn)return!1;if(!He)return Xb(t),He=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!um(t.type,t.memoizedProps)),e&&(e=Kt)){if(mm(t)){for(t=Kt;t;)t=Ur(t.nextSibling);throw Error(U(418))}for(;e;)Lx(t,e),e=Ur(e.nextSibling)}if(Xb(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(U(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){Kt=Ur(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}Kt=null}}else Kt=fn?Ur(t.stateNode.nextSibling):null;return!0}function Ia(){Kt=fn=null,He=!1}function f0(t){qn===null?qn=[t]:qn.push(t)}function Oo(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(U(309));var r=n.stateNode}if(!r)throw Error(U(147,t));var s=r,i=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===i?e.ref:(e=function(a){var o=s.refs;o===Rx&&(o=s.refs={}),a===null?delete o[i]:o[i]=a},e._stringRef=i,e)}if(typeof t!="string")throw Error(U(284));if(!n._owner)throw Error(U(290,t))}return t}function Gl(t,e){throw t=Object.prototype.toString.call(e),Error(U(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function Yb(t){var e=t._init;return e(t._payload)}function Mx(t){function e(p,b){if(t){var _=p.deletions;_===null?(p.deletions=[b],p.flags|=16):_.push(b)}}function n(p,b){if(!t)return null;for(;b!==null;)e(p,b),b=b.sibling;return null}function r(p,b){for(p=new Map;b!==null;)b.key!==null?p.set(b.key,b):p.set(b.index,b),b=b.sibling;return p}function s(p,b){return p=Ns(p,b),p.index=0,p.sibling=null,p}function i(p,b,_){return p.index=_,t?(_=p.alternate,_!==null?(_=_.index,_<b?(p.flags|=2,b):_):(p.flags|=2,b)):(p.flags|=1048576,b)}function a(p){return t&&p.alternate===null&&(p.flags|=2),p}function o(p,b,_,x){return b===null||b.tag!==6?(b=$h(_,p.mode,x),b.return=p,b):(b=s(b,_),b.return=p,b)}function u(p,b,_,x){var S=_.type;return S===ta?c(p,b,_.props.children,x,_.key):b!==null&&(b.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fs&&Yb(S)===b.type)?(x=s(b,_.props),x.ref=Oo(p,b,_),x.return=p,x):(x=Bc(_.type,_.key,_.props,null,p.mode,x),x.ref=Oo(p,b,_),x.return=p,x)}function l(p,b,_,x){return b===null||b.tag!==4||b.stateNode.containerInfo!==_.containerInfo||b.stateNode.implementation!==_.implementation?(b=Lh(_,p.mode,x),b.return=p,b):(b=s(b,_.children||[]),b.return=p,b)}function c(p,b,_,x,S){return b===null||b.tag!==7?(b=gi(_,p.mode,x,S),b.return=p,b):(b=s(b,_),b.return=p,b)}function d(p,b,_){if(typeof b=="string"&&b!==""||typeof b=="number")return b=$h(""+b,p.mode,_),b.return=p,b;if(typeof b=="object"&&b!==null){switch(b.$$typeof){case Ml:return _=Bc(b.type,b.key,b.props,null,p.mode,_),_.ref=Oo(p,null,b),_.return=p,_;case ea:return b=Lh(b,p.mode,_),b.return=p,b;case fs:var x=b._init;return d(p,x(b._payload),_)}if(Uo(b)||ko(b))return b=gi(b,p.mode,_,null),b.return=p,b;Gl(p,b)}return null}function f(p,b,_,x){var S=b!==null?b.key:null;if(typeof _=="string"&&_!==""||typeof _=="number")return S!==null?null:o(p,b,""+_,x);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case Ml:return _.key===S?u(p,b,_,x):null;case ea:return _.key===S?l(p,b,_,x):null;case fs:return S=_._init,f(p,b,S(_._payload),x)}if(Uo(_)||ko(_))return S!==null?null:c(p,b,_,x,null);Gl(p,_)}return null}function h(p,b,_,x,S){if(typeof x=="string"&&x!==""||typeof x=="number")return p=p.get(_)||null,o(b,p,""+x,S);if(typeof x=="object"&&x!==null){switch(x.$$typeof){case Ml:return p=p.get(x.key===null?_:x.key)||null,u(b,p,x,S);case ea:return p=p.get(x.key===null?_:x.key)||null,l(b,p,x,S);case fs:var E=x._init;return h(p,b,_,E(x._payload),S)}if(Uo(x)||ko(x))return p=p.get(_)||null,c(b,p,x,S,null);Gl(b,x)}return null}function m(p,b,_,x){for(var S=null,E=null,k=b,T=b=0,$=null;k!==null&&T<_.length;T++){k.index>T?($=k,k=null):$=k.sibling;var j=f(p,k,_[T],x);if(j===null){k===null&&(k=$);break}t&&k&&j.alternate===null&&e(p,k),b=i(j,b,T),E===null?S=j:E.sibling=j,E=j,k=$}if(T===_.length)return n(p,k),He&&Xs(p,T),S;if(k===null){for(;T<_.length;T++)k=d(p,_[T],x),k!==null&&(b=i(k,b,T),E===null?S=k:E.sibling=k,E=k);return He&&Xs(p,T),S}for(k=r(p,k);T<_.length;T++)$=h(k,p,T,_[T],x),$!==null&&(t&&$.alternate!==null&&k.delete($.key===null?T:$.key),b=i($,b,T),E===null?S=$:E.sibling=$,E=$);return t&&k.forEach(function(H){return e(p,H)}),He&&Xs(p,T),S}function y(p,b,_,x){var S=ko(_);if(typeof S!="function")throw Error(U(150));if(_=S.call(_),_==null)throw Error(U(151));for(var E=S=null,k=b,T=b=0,$=null,j=_.next();k!==null&&!j.done;T++,j=_.next()){k.index>T?($=k,k=null):$=k.sibling;var H=f(p,k,j.value,x);if(H===null){k===null&&(k=$);break}t&&k&&H.alternate===null&&e(p,k),b=i(H,b,T),E===null?S=H:E.sibling=H,E=H,k=$}if(j.done)return n(p,k),He&&Xs(p,T),S;if(k===null){for(;!j.done;T++,j=_.next())j=d(p,j.value,x),j!==null&&(b=i(j,b,T),E===null?S=j:E.sibling=j,E=j);return He&&Xs(p,T),S}for(k=r(p,k);!j.done;T++,j=_.next())j=h(k,p,T,j.value,x),j!==null&&(t&&j.alternate!==null&&k.delete(j.key===null?T:j.key),b=i(j,b,T),E===null?S=j:E.sibling=j,E=j);return t&&k.forEach(function(q){return e(p,q)}),He&&Xs(p,T),S}function w(p,b,_,x){if(typeof _=="object"&&_!==null&&_.type===ta&&_.key===null&&(_=_.props.children),typeof _=="object"&&_!==null){switch(_.$$typeof){case Ml:e:{for(var S=_.key,E=b;E!==null;){if(E.key===S){if(S=_.type,S===ta){if(E.tag===7){n(p,E.sibling),b=s(E,_.props.children),b.return=p,p=b;break e}}else if(E.elementType===S||typeof S=="object"&&S!==null&&S.$$typeof===fs&&Yb(S)===E.type){n(p,E.sibling),b=s(E,_.props),b.ref=Oo(p,E,_),b.return=p,p=b;break e}n(p,E);break}else e(p,E);E=E.sibling}_.type===ta?(b=gi(_.props.children,p.mode,x,_.key),b.return=p,p=b):(x=Bc(_.type,_.key,_.props,null,p.mode,x),x.ref=Oo(p,b,_),x.return=p,p=x)}return a(p);case ea:e:{for(E=_.key;b!==null;){if(b.key===E)if(b.tag===4&&b.stateNode.containerInfo===_.containerInfo&&b.stateNode.implementation===_.implementation){n(p,b.sibling),b=s(b,_.children||[]),b.return=p,p=b;break e}else{n(p,b);break}else e(p,b);b=b.sibling}b=Lh(_,p.mode,x),b.return=p,p=b}return a(p);case fs:return E=_._init,w(p,b,E(_._payload),x)}if(Uo(_))return m(p,b,_,x);if(ko(_))return y(p,b,_,x);Gl(p,_)}return typeof _=="string"&&_!==""||typeof _=="number"?(_=""+_,b!==null&&b.tag===6?(n(p,b.sibling),b=s(b,_),b.return=p,p=b):(n(p,b),b=$h(_,p.mode,x),b.return=p,p=b),a(p)):n(p,b)}return w}var Ra=Mx(!0),Dx=Mx(!1),hl={},xr=Hs(hl),Pu=Hs(hl),Ou=Hs(hl);function ci(t){if(t===hl)throw Error(U(174));return t}function h0(t,e){switch(Me(Ou,e),Me(Pu,t),Me(xr,hl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Jp(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Jp(e,t)}Ue(xr),Me(xr,e)}function ja(){Ue(xr),Ue(Pu),Ue(Ou)}function Fx(t){ci(Ou.current);var e=ci(xr.current),n=Jp(e,t.type);e!==n&&(Me(Pu,t),Me(xr,n))}function p0(t){Pu.current===t&&(Ue(xr),Ue(Pu))}var Ze=Hs(0);function yd(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var Oh=[];function m0(){for(var t=0;t<Oh.length;t++)Oh[t]._workInProgressVersionPrimary=null;Oh.length=0}var Lc=ts.ReactCurrentDispatcher,An=ts.ReactCurrentBatchConfig,$a=0,Ke=null,Tt=null,mt=null,bd=!1,au=!1,Nu=0,_P=0;function kt(){throw Error(U(321))}function g0(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!kr(t[n],e[n]))return!1;return!0}function y0(t,e,n,r,s,i){if($a=i,Ke=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Lc.current=t===null||t.memoizedState===null?kP:EP,t=n(r,s),au){i=0;do{if(au=!1,Nu=0,25<=i)throw Error(U(301));i+=1,mt=Tt=null,e.updateQueue=null,Lc.current=AP,t=n(r,s)}while(au)}if(Lc.current=wd,e=Tt!==null&&Tt.next!==null,$a=0,mt=Tt=Ke=null,bd=!1,e)throw Error(U(300));return t}function b0(){var t=Nu!==0;return Nu=0,t}function Mr(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return mt===null?Ke.memoizedState=mt=t:mt=mt.next=t,mt}function Cr(){if(Tt===null){var t=Ke.alternate;t=t!==null?t.memoizedState:null}else t=Tt.next;var e=mt===null?Ke.memoizedState:mt.next;if(e!==null)mt=e,Tt=t;else{if(t===null)throw Error(U(310));Tt=t,t={memoizedState:Tt.memoizedState,baseState:Tt.baseState,baseQueue:Tt.baseQueue,queue:Tt.queue,next:null},mt===null?Ke.memoizedState=mt=t:mt=mt.next=t}return mt}function pi(t,e){return typeof e=="function"?e(t):e}function Zl(t){var e=Cr(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=Tt,s=r.baseQueue,i=n.pending;if(i!==null){if(s!==null){var a=s.next;s.next=i.next,i.next=a}r.baseQueue=s=i,n.pending=null}if(s!==null){i=s.next,r=r.baseState;var o=a=null,u=null,l=i;do{var c=l.lane;if(($a&c)===c)u!==null&&(u=u.next={lane:0,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null}),r=l.hasEagerState?l.eagerState:t(r,l.action);else{var d={lane:c,action:l.action,hasEagerState:l.hasEagerState,eagerState:l.eagerState,next:null};u===null?(o=u=d,a=r):u=u.next=d,Ke.lanes|=c,La|=c}l=l.next}while(l!==null&&l!==i);u===null?a=r:u.next=o,kr(r,e.memoizedState)||(dn=!0),e.memoizedState=r,e.baseState=a,e.baseQueue=u,n.lastRenderedState=r}if(t=n.interleaved,t!==null){s=t;do i=s.lane,Ke.lanes|=i,La|=i,s=s.next;while(s!==t)}else s===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function Jl(t){var e=Cr(),n=e.queue;if(n===null)throw Error(U(311));n.lastRenderedReducer=t;var r=n.dispatch,s=n.pending,i=e.memoizedState;if(s!==null){n.pending=null;var a=s=s.next;do i=t(i,a.action),a=a.next;while(a!==s);kr(i,e.memoizedState)||(dn=!0),e.memoizedState=i,e.baseQueue===null&&(e.baseState=i),n.lastRenderedState=i}return[i,r]}function Bx(){}function Ux(t,e){var n=Ke,r=Cr(),s=e(),i=!kr(r.memoizedState,s);if(i&&(r.memoizedState=s,dn=!0),r=r.queue,Ru(Hx.bind(null,n,r,t),[t]),r.getSnapshot!==e||i||mt!==null&&mt.memoizedState.tag&1){if(n.flags|=2048,Iu(9,qx.bind(null,n,r,s,e),void 0,null),st===null)throw Error(U(349));$a&30||zx(n,e,s)}return s}function zx(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function qx(t,e,n,r){e.value=n,e.getSnapshot=r,Vx(e)&&Cn(t,1,-1)}function Hx(t,e,n){return n(function(){Vx(e)&&Cn(t,1,-1)})}function Vx(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!kr(t,n)}catch{return!0}}function Nh(t){var e=Mr();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:pi,lastRenderedState:t},e.queue=t,t=t.dispatch=SP.bind(null,Ke,t),[e.memoizedState,t]}function Iu(t,e,n,r){return t={tag:t,create:e,destroy:n,deps:r,next:null},e=Ke.updateQueue,e===null?(e={lastEffect:null,stores:null},Ke.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(r=n.next,n.next=t,t.next=r,e.lastEffect=t)),t}function Wx(){return Cr().memoizedState}function Mc(t,e,n,r){var s=Mr();Ke.flags|=t,s.memoizedState=Iu(1|e,n,void 0,r===void 0?null:r)}function pf(t,e,n,r){var s=Cr();r=r===void 0?null:r;var i=void 0;if(Tt!==null){var a=Tt.memoizedState;if(i=a.destroy,r!==null&&g0(r,a.deps)){s.memoizedState=Iu(e,n,i,r);return}}Ke.flags|=t,s.memoizedState=Iu(1|e,n,i,r)}function Ih(t,e){return Mc(8390656,8,t,e)}function Ru(t,e){return pf(2048,8,t,e)}function Gx(t,e){return pf(4,2,t,e)}function Zx(t,e){return pf(4,4,t,e)}function Jx(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function Kx(t,e,n){return n=n!=null?n.concat([t]):null,pf(4,4,Jx.bind(null,e,t),n)}function w0(){}function Qx(t,e){var n=Cr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&g0(e,r[1])?r[0]:(n.memoizedState=[t,e],t)}function Xx(t,e){var n=Cr();e=e===void 0?null:e;var r=n.memoizedState;return r!==null&&e!==null&&g0(e,r[1])?r[0]:(t=t(),n.memoizedState=[t,e],t)}function vP(t,e){var n=Ie;Ie=n!==0&&4>n?n:4,t(!0);var r=An.transition;An.transition={};try{t(!1),e()}finally{Ie=n,An.transition=r}}function Yx(){return Cr().memoizedState}function xP(t,e,n){var r=Cs(t);n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},e2(t)?t2(e,n):(n2(t,e,n),n=Mt(),t=Cn(t,r,n),t!==null&&r2(t,e,r))}function SP(t,e,n){var r=Cs(t),s={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(e2(t))t2(e,s);else{n2(t,e,s);var i=t.alternate;if(t.lanes===0&&(i===null||i.lanes===0)&&(i=e.lastRenderedReducer,i!==null))try{var a=e.lastRenderedState,o=i(a,n);if(s.hasEagerState=!0,s.eagerState=o,kr(o,a))return}catch{}finally{}n=Mt(),t=Cn(t,r,n),t!==null&&r2(t,e,r)}}function e2(t){var e=t.alternate;return t===Ke||e!==null&&e===Ke}function t2(t,e){au=bd=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function n2(t,e,n){st!==null&&t.mode&1&&!(xe&2)?(t=e.interleaved,t===null?(n.next=n,yr===null?yr=[e]:yr.push(e)):(n.next=t.next,t.next=n),e.interleaved=n):(t=e.pending,t===null?n.next=n:(n.next=t.next,t.next=n),e.pending=n)}function r2(t,e,n){if(n&4194240){var r=e.lanes;r&=t.pendingLanes,n|=r,e.lanes=n,Xg(t,n)}}var wd={readContext:On,useCallback:kt,useContext:kt,useEffect:kt,useImperativeHandle:kt,useInsertionEffect:kt,useLayoutEffect:kt,useMemo:kt,useReducer:kt,useRef:kt,useState:kt,useDebugValue:kt,useDeferredValue:kt,useTransition:kt,useMutableSource:kt,useSyncExternalStore:kt,useId:kt,unstable_isNewReconciler:!1},kP={readContext:On,useCallback:function(t,e){return Mr().memoizedState=[t,e===void 0?null:e],t},useContext:On,useEffect:Ih,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Mc(4194308,4,Jx.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Mc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Mc(4,2,t,e)},useMemo:function(t,e){var n=Mr();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var r=Mr();return e=n!==void 0?n(e):e,r.memoizedState=r.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},r.queue=t,t=t.dispatch=xP.bind(null,Ke,t),[r.memoizedState,t]},useRef:function(t){var e=Mr();return t={current:t},e.memoizedState=t},useState:Nh,useDebugValue:w0,useDeferredValue:function(t){var e=Nh(t),n=e[0],r=e[1];return Ih(function(){var s=An.transition;An.transition={};try{r(t)}finally{An.transition=s}},[t]),n},useTransition:function(){var t=Nh(!1),e=t[0];return t=vP.bind(null,t[1]),Mr().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var r=Ke,s=Mr();if(He){if(n===void 0)throw Error(U(407));n=n()}else{if(n=e(),st===null)throw Error(U(349));$a&30||zx(r,e,n)}s.memoizedState=n;var i={value:n,getSnapshot:e};return s.queue=i,Ih(Hx.bind(null,r,i,t),[t]),r.flags|=2048,Iu(9,qx.bind(null,r,i,n,e),void 0,null),n},useId:function(){var t=Mr(),e=st.identifierPrefix;if(He){var n=qr,r=zr;n=(r&~(1<<32-Gn(r)-1)).toString(32)+n,e=":"+e+"R"+n,n=Nu++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=_P++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},EP={readContext:On,useCallback:Qx,useContext:On,useEffect:Ru,useImperativeHandle:Kx,useInsertionEffect:Gx,useLayoutEffect:Zx,useMemo:Xx,useReducer:Zl,useRef:Wx,useState:function(){return Zl(pi)},useDebugValue:w0,useDeferredValue:function(t){var e=Zl(pi),n=e[0],r=e[1];return Ru(function(){var s=An.transition;An.transition={};try{r(t)}finally{An.transition=s}},[t]),n},useTransition:function(){var t=Zl(pi)[0],e=Cr().memoizedState;return[t,e]},useMutableSource:Bx,useSyncExternalStore:Ux,useId:Yx,unstable_isNewReconciler:!1},AP={readContext:On,useCallback:Qx,useContext:On,useEffect:Ru,useImperativeHandle:Kx,useInsertionEffect:Gx,useLayoutEffect:Zx,useMemo:Xx,useReducer:Jl,useRef:Wx,useState:function(){return Jl(pi)},useDebugValue:w0,useDeferredValue:function(t){var e=Jl(pi),n=e[0],r=e[1];return Ru(function(){var s=An.transition;An.transition={};try{r(t)}finally{An.transition=s}},[t]),n},useTransition:function(){var t=Jl(pi)[0],e=Cr().memoizedState;return[t,e]},useMutableSource:Bx,useSyncExternalStore:Ux,useId:Yx,unstable_isNewReconciler:!1};function _0(t,e){try{var n="",r=e;do n+=eC(r),r=r.return;while(r);var s=n}catch(i){s=`
Error generating stack: `+i.message+`
`+i.stack}return{value:t,source:e,stack:s}}function ym(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var TP=typeof WeakMap=="function"?WeakMap:Map;function s2(t,e,n){n=Vr(-1,n),n.tag=3,n.payload={element:null};var r=e.value;return n.callback=function(){xd||(xd=!0,Am=r),ym(t,e)},n}function i2(t,e,n){n=Vr(-1,n),n.tag=3;var r=t.type.getDerivedStateFromError;if(typeof r=="function"){var s=e.value;n.payload=function(){return r(s)},n.callback=function(){ym(t,e)}}var i=t.stateNode;return i!==null&&typeof i.componentDidCatch=="function"&&(n.callback=function(){ym(t,e),typeof r!="function"&&(Ts===null?Ts=new Set([this]):Ts.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function ew(t,e,n){var r=t.pingCache;if(r===null){r=t.pingCache=new TP;var s=new Set;r.set(e,s)}else s=r.get(e),s===void 0&&(s=new Set,r.set(e,s));s.has(n)||(s.add(n),t=UP.bind(null,t,e,n),e.then(t,t))}function tw(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function nw(t,e,n,r,s){return t.mode&1?(t.flags|=65536,t.lanes=s,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=Vr(-1,1),e.tag=2,As(n,e))),n.lanes|=1),t)}var a2,bm,o2,u2;a2=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};bm=function(){};o2=function(t,e,n,r){var s=t.memoizedProps;if(s!==r){t=e.stateNode,ci(xr.current);var i=null;switch(n){case"input":s=Vp(t,s),r=Vp(t,r),i=[];break;case"select":s=Je({},s,{value:void 0}),r=Je({},r,{value:void 0}),i=[];break;case"textarea":s=Zp(t,s),r=Zp(t,r),i=[];break;default:typeof s.onClick!="function"&&typeof r.onClick=="function"&&(t.onclick=ld)}Kp(n,r);var a;n=null;for(l in s)if(!r.hasOwnProperty(l)&&s.hasOwnProperty(l)&&s[l]!=null)if(l==="style"){var o=s[l];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else l!=="dangerouslySetInnerHTML"&&l!=="children"&&l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&l!=="autoFocus"&&(bu.hasOwnProperty(l)?i||(i=[]):(i=i||[]).push(l,null));for(l in r){var u=r[l];if(o=s?.[l],r.hasOwnProperty(l)&&u!==o&&(u!=null||o!=null))if(l==="style")if(o){for(a in o)!o.hasOwnProperty(a)||u&&u.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in u)u.hasOwnProperty(a)&&o[a]!==u[a]&&(n||(n={}),n[a]=u[a])}else n||(i||(i=[]),i.push(l,n)),n=u;else l==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,o=o?o.__html:void 0,u!=null&&o!==u&&(i=i||[]).push(l,u)):l==="children"?typeof u!="string"&&typeof u!="number"||(i=i||[]).push(l,""+u):l!=="suppressContentEditableWarning"&&l!=="suppressHydrationWarning"&&(bu.hasOwnProperty(l)?(u!=null&&l==="onScroll"&&Be("scroll",t),i||o===u||(i=[])):(i=i||[]).push(l,u))}n&&(i=i||[]).push("style",n);var l=i;(e.updateQueue=l)&&(e.flags|=4)}};u2=function(t,e,n,r){n!==r&&(e.flags|=4)};function No(t,e){if(!He)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:r.sibling=null}}function Et(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,r=0;if(e)for(var s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags&14680064,r|=s.flags&14680064,s.return=t,s=s.sibling;else for(s=t.child;s!==null;)n|=s.lanes|s.childLanes,r|=s.subtreeFlags,r|=s.flags,s.return=t,s=s.sibling;return t.subtreeFlags|=r,t.childLanes=n,e}function CP(t,e,n){var r=e.pendingProps;switch(d0(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Et(e),null;case 1:return Yt(e.type)&&cd(),Et(e),null;case 3:return r=e.stateNode,ja(),Ue(Xt),Ue(Pt),m0(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(t===null||t.child===null)&&(Po(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,qn!==null&&(Pm(qn),qn=null))),bm(t,e),Et(e),null;case 5:p0(e);var s=ci(Ou.current);if(n=e.type,t!==null&&e.stateNode!=null)o2(t,e,n,r,s),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!r){if(e.stateNode===null)throw Error(U(166));return Et(e),null}if(t=ci(xr.current),Po(e)){r=e.stateNode,n=e.type;var i=e.memoizedProps;switch(r[hr]=e,r[Cu]=i,t=(e.mode&1)!==0,n){case"dialog":Be("cancel",r),Be("close",r);break;case"iframe":case"object":case"embed":Be("load",r);break;case"video":case"audio":for(s=0;s<qo.length;s++)Be(qo[s],r);break;case"source":Be("error",r);break;case"img":case"image":case"link":Be("error",r),Be("load",r);break;case"details":Be("toggle",r);break;case"input":bb(r,i),Be("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!i.multiple},Be("invalid",r);break;case"textarea":_b(r,i),Be("invalid",r)}Kp(n,i),s=null;for(var a in i)if(i.hasOwnProperty(a)){var o=i[a];a==="children"?typeof o=="string"?r.textContent!==o&&(Wl(r.textContent,o,t),s=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(Wl(r.textContent,o,t),s=["children",""+o]):bu.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Be("scroll",r)}switch(n){case"input":Dl(r),wb(r,i,!0);break;case"textarea":Dl(r),vb(r);break;case"select":case"option":break;default:typeof i.onClick=="function"&&(r.onclick=ld)}r=s,e.updateQueue=r,r!==null&&(e.flags|=4)}else{a=s.nodeType===9?s:s.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=V1(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof r.is=="string"?t=a.createElement(n,{is:r.is}):(t=a.createElement(n),n==="select"&&(a=t,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):t=a.createElementNS(t,n),t[hr]=e,t[Cu]=r,a2(t,e,!1,!1),e.stateNode=t;e:{switch(a=Qp(n,r),n){case"dialog":Be("cancel",t),Be("close",t),s=r;break;case"iframe":case"object":case"embed":Be("load",t),s=r;break;case"video":case"audio":for(s=0;s<qo.length;s++)Be(qo[s],t);s=r;break;case"source":Be("error",t),s=r;break;case"img":case"image":case"link":Be("error",t),Be("load",t),s=r;break;case"details":Be("toggle",t),s=r;break;case"input":bb(t,r),s=Vp(t,r),Be("invalid",t);break;case"option":s=r;break;case"select":t._wrapperState={wasMultiple:!!r.multiple},s=Je({},r,{value:void 0}),Be("invalid",t);break;case"textarea":_b(t,r),s=Zp(t,r),Be("invalid",t);break;default:s=r}Kp(n,s),o=s;for(i in o)if(o.hasOwnProperty(i)){var u=o[i];i==="style"?Z1(t,u):i==="dangerouslySetInnerHTML"?(u=u?u.__html:void 0,u!=null&&W1(t,u)):i==="children"?typeof u=="string"?(n!=="textarea"||u!=="")&&wu(t,u):typeof u=="number"&&wu(t,""+u):i!=="suppressContentEditableWarning"&&i!=="suppressHydrationWarning"&&i!=="autoFocus"&&(bu.hasOwnProperty(i)?u!=null&&i==="onScroll"&&Be("scroll",t):u!=null&&Wg(t,i,u,a))}switch(n){case"input":Dl(t),wb(t,r,!1);break;case"textarea":Dl(t),vb(t);break;case"option":r.value!=null&&t.setAttribute("value",""+Ps(r.value));break;case"select":t.multiple=!!r.multiple,i=r.value,i!=null?ga(t,!!r.multiple,i,!1):r.defaultValue!=null&&ga(t,!!r.multiple,r.defaultValue,!0);break;default:typeof s.onClick=="function"&&(t.onclick=ld)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return Et(e),null;case 6:if(t&&e.stateNode!=null)u2(t,e,t.memoizedProps,r);else{if(typeof r!="string"&&e.stateNode===null)throw Error(U(166));if(n=ci(Ou.current),ci(xr.current),Po(e)){if(r=e.stateNode,n=e.memoizedProps,r[hr]=e,(i=r.nodeValue!==n)&&(t=fn,t!==null))switch(a=(t.mode&1)!==0,t.tag){case 3:Wl(r.nodeValue,n,a);break;case 5:t.memoizedProps[void 0]!==!0&&Wl(r.nodeValue,n,a)}i&&(e.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[hr]=e,e.stateNode=r}return Et(e),null;case 13:if(Ue(Ze),r=e.memoizedState,He&&Kt!==null&&e.mode&1&&!(e.flags&128)){for(r=Kt;r;)r=Ur(r.nextSibling);return Ia(),e.flags|=98560,e}if(r!==null&&r.dehydrated!==null){if(r=Po(e),t===null){if(!r)throw Error(U(318));if(r=e.memoizedState,r=r!==null?r.dehydrated:null,!r)throw Error(U(317));r[hr]=e}else Ia(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;return Et(e),null}return qn!==null&&(Pm(qn),qn=null),e.flags&128?(e.lanes=n,e):(r=r!==null,n=!1,t===null?Po(e):n=t.memoizedState!==null,r&&!n&&(e.child.flags|=8192,e.mode&1&&(t===null||Ze.current&1?ct===0&&(ct=3):A0())),e.updateQueue!==null&&(e.flags|=4),Et(e),null);case 4:return ja(),bm(t,e),t===null&&Au(e.stateNode.containerInfo),Et(e),null;case 10:return u0(e.type._context),Et(e),null;case 17:return Yt(e.type)&&cd(),Et(e),null;case 19:if(Ue(Ze),i=e.memoizedState,i===null)return Et(e),null;if(r=(e.flags&128)!==0,a=i.rendering,a===null)if(r)No(i,!1);else{if(ct!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=yd(t),a!==null){for(e.flags|=128,No(i,!1),r=a.updateQueue,r!==null&&(e.updateQueue=r,e.flags|=4),e.subtreeFlags=0,r=n,n=e.child;n!==null;)i=n,t=r,i.flags&=14680066,a=i.alternate,a===null?(i.childLanes=0,i.lanes=t,i.child=null,i.subtreeFlags=0,i.memoizedProps=null,i.memoizedState=null,i.updateQueue=null,i.dependencies=null,i.stateNode=null):(i.childLanes=a.childLanes,i.lanes=a.lanes,i.child=a.child,i.subtreeFlags=0,i.deletions=null,i.memoizedProps=a.memoizedProps,i.memoizedState=a.memoizedState,i.updateQueue=a.updateQueue,i.type=a.type,t=a.dependencies,i.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Me(Ze,Ze.current&1|2),e.child}t=t.sibling}i.tail!==null&&Qe()>Ma&&(e.flags|=128,r=!0,No(i,!1),e.lanes=4194304)}else{if(!r)if(t=yd(a),t!==null){if(e.flags|=128,r=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),No(i,!0),i.tail===null&&i.tailMode==="hidden"&&!a.alternate&&!He)return Et(e),null}else 2*Qe()-i.renderingStartTime>Ma&&n!==1073741824&&(e.flags|=128,r=!0,No(i,!1),e.lanes=4194304);i.isBackwards?(a.sibling=e.child,e.child=a):(n=i.last,n!==null?n.sibling=a:e.child=a,i.last=a)}return i.tail!==null?(e=i.tail,i.rendering=e,i.tail=e.sibling,i.renderingStartTime=Qe(),e.sibling=null,n=Ze.current,Me(Ze,r?n&1|2:n&1),e):(Et(e),null);case 22:case 23:return E0(),r=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==r&&(e.flags|=8192),r&&e.mode&1?ln&1073741824&&(Et(e),e.subtreeFlags&6&&(e.flags|=8192)):Et(e),null;case 24:return null;case 25:return null}throw Error(U(156,e.tag))}var PP=ts.ReactCurrentOwner,dn=!1;function Rt(t,e,n,r){e.child=t===null?Dx(e,null,n,r):Ra(e,t.child,n,r)}function rw(t,e,n,r,s){n=n.render;var i=e.ref;return _a(e,s),r=y0(t,e,n,r,i,s),n=b0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kr(t,e,s)):(He&&n&&c0(e),e.flags|=1,Rt(t,e,r,s),e.child)}function sw(t,e,n,r,s){if(t===null){var i=n.type;return typeof i=="function"&&!T0(i)&&i.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=i,l2(t,e,i,r,s)):(t=Bc(n.type,null,r,e,e.mode,s),t.ref=e.ref,t.return=e,e.child=t)}if(i=t.child,!(t.lanes&s)){var a=i.memoizedProps;if(n=n.compare,n=n!==null?n:Eu,n(a,r)&&t.ref===e.ref)return Kr(t,e,s)}return e.flags|=1,t=Ns(i,r),t.ref=e.ref,t.return=e,e.child=t}function l2(t,e,n,r,s){if(t!==null&&Eu(t.memoizedProps,r)&&t.ref===e.ref)if(dn=!1,(t.lanes&s)!==0)t.flags&131072&&(dn=!0);else return e.lanes=t.lanes,Kr(t,e,s);return wm(t,e,n,r,s)}function c2(t,e,n){var r=e.pendingProps,s=r.children,i=t!==null?t.memoizedState:null;if(r.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null},Me(ca,ln),ln|=n;else if(n&1073741824)e.memoizedState={baseLanes:0,cachePool:null},r=i!==null?i.baseLanes:n,Me(ca,ln),ln|=r;else return t=i!==null?i.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null},e.updateQueue=null,Me(ca,ln),ln|=t,null;else i!==null?(r=i.baseLanes|n,e.memoizedState=null):r=n,Me(ca,ln),ln|=r;return Rt(t,e,s,n),e.child}function d2(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function wm(t,e,n,r,s){var i=Yt(n)?vi:Pt.current;return i=Na(e,i),_a(e,s),n=y0(t,e,n,r,i,s),r=b0(),t!==null&&!dn?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~s,Kr(t,e,s)):(He&&r&&c0(e),e.flags|=1,Rt(t,e,n,s),e.child)}function iw(t,e,n,r,s){if(Yt(n)){var i=!0;dd(e)}else i=!1;if(_a(e,s),e.stateNode===null)t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),jx(e,n,r),pm(e,n,r,s),r=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var u=a.context,l=n.contextType;typeof l=="object"&&l!==null?l=On(l):(l=Yt(n)?vi:Pt.current,l=Na(e,l));var c=n.getDerivedStateFromProps,d=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";d||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||u!==l)&&Kb(e,a,r,l),hs=!1;var f=e.memoizedState;a.state=f,pd(e,r,a,s),u=e.memoizedState,o!==r||f!==u||Xt.current||hs?(typeof c=="function"&&(hm(e,n,c,r),u=e.memoizedState),(o=hs||Jb(e,n,o,r,f,u,l))?(d||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=r,e.memoizedState=u),a.props=r,a.state=u,a.context=l,r=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),r=!1)}else{a=e.stateNode,Ix(t,e),o=e.memoizedProps,l=e.type===e.elementType?o:Bn(e.type,o),a.props=l,d=e.pendingProps,f=a.context,u=n.contextType,typeof u=="object"&&u!==null?u=On(u):(u=Yt(n)?vi:Pt.current,u=Na(e,u));var h=n.getDerivedStateFromProps;(c=typeof h=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==d||f!==u)&&Kb(e,a,r,u),hs=!1,f=e.memoizedState,a.state=f,pd(e,r,a,s);var m=e.memoizedState;o!==d||f!==m||Xt.current||hs?(typeof h=="function"&&(hm(e,n,h,r),m=e.memoizedState),(l=hs||Jb(e,n,l,r,f,m,u)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,m,u),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,m,u)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),e.memoizedProps=r,e.memoizedState=m),a.props=r,a.state=m,a.context=u,r=l):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&f===t.memoizedState||(e.flags|=1024),r=!1)}return _m(t,e,n,r,i,s)}function _m(t,e,n,r,s,i){d2(t,e);var a=(e.flags&128)!==0;if(!r&&!a)return s&&Wb(e,n,!1),Kr(t,e,i);r=e.stateNode,PP.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return e.flags|=1,t!==null&&a?(e.child=Ra(e,t.child,null,i),e.child=Ra(e,null,o,i)):Rt(t,e,o,i),e.memoizedState=r.state,s&&Wb(e,n,!0),e.child}function f2(t){var e=t.stateNode;e.pendingContext?Vb(t,e.pendingContext,e.pendingContext!==e.context):e.context&&Vb(t,e.context,!1),h0(t,e.containerInfo)}function aw(t,e,n,r,s){return Ia(),f0(s),e.flags|=256,Rt(t,e,n,r),e.child}var Kl={dehydrated:null,treeContext:null,retryLane:0};function Ql(t){return{baseLanes:t,cachePool:null}}function h2(t,e,n){var r=e.pendingProps,s=Ze.current,i=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(s&2)!==0),o?(i=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(s|=1),Me(Ze,s&1),t===null)return gm(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(s=r.children,t=r.fallback,i?(r=e.mode,i=e.child,s={mode:"hidden",children:s},!(r&1)&&i!==null?(i.childLanes=0,i.pendingProps=s):i=Ed(s,r,0,null),t=gi(t,r,n,null),i.return=e,t.return=e,i.sibling=t,e.child=i,e.child.memoizedState=Ql(n),e.memoizedState=Kl,t):vm(e,s));if(s=t.memoizedState,s!==null){if(o=s.dehydrated,o!==null){if(a)return e.flags&256?(e.flags&=-257,Xl(t,e,n,Error(U(422)))):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(i=r.fallback,s=e.mode,r=Ed({mode:"visible",children:r.children},s,0,null),i=gi(i,s,n,null),i.flags|=2,r.return=e,i.return=e,r.sibling=i,e.child=r,e.mode&1&&Ra(e,t.child,null,n),e.child.memoizedState=Ql(n),e.memoizedState=Kl,i);if(!(e.mode&1))e=Xl(t,e,n,null);else if(o.data==="$!")e=Xl(t,e,n,Error(U(419)));else if(r=(n&t.childLanes)!==0,dn||r){if(r=st,r!==null){switch(n&-n){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}r=i&(r.suspendedLanes|n)?0:i,r!==0&&r!==s.retryLane&&(s.retryLane=r,Cn(t,r,-1))}A0(),e=Xl(t,e,n,Error(U(421)))}else o.data==="$?"?(e.flags|=128,e.child=t.child,e=zP.bind(null,t),o._reactRetry=e,e=null):(n=s.treeContext,Kt=Ur(o.nextSibling),fn=e,He=!0,qn=null,n!==null&&(xn[Sn++]=zr,xn[Sn++]=qr,xn[Sn++]=xi,zr=n.id,qr=n.overflow,xi=e),e=vm(e,e.pendingProps.children),e.flags|=4096);return e}return i?(r=uw(t,e,r.children,r.fallback,n),i=e.child,s=t.child.memoizedState,i.memoizedState=s===null?Ql(n):{baseLanes:s.baseLanes|n,cachePool:null},i.childLanes=t.childLanes&~n,e.memoizedState=Kl,r):(n=ow(t,e,r.children,n),e.memoizedState=null,n)}return i?(r=uw(t,e,r.children,r.fallback,n),i=e.child,s=t.child.memoizedState,i.memoizedState=s===null?Ql(n):{baseLanes:s.baseLanes|n,cachePool:null},i.childLanes=t.childLanes&~n,e.memoizedState=Kl,r):(n=ow(t,e,r.children,n),e.memoizedState=null,n)}function vm(t,e){return e=Ed({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function ow(t,e,n,r){var s=t.child;return t=s.sibling,n=Ns(s,{mode:"visible",children:n}),!(e.mode&1)&&(n.lanes=r),n.return=e,n.sibling=null,t!==null&&(r=e.deletions,r===null?(e.deletions=[t],e.flags|=16):r.push(t)),e.child=n}function uw(t,e,n,r,s){var i=e.mode;t=t.child;var a=t.sibling,o={mode:"hidden",children:n};return!(i&1)&&e.child!==t?(n=e.child,n.childLanes=0,n.pendingProps=o,e.deletions=null):(n=Ns(t,o),n.subtreeFlags=t.subtreeFlags&14680064),a!==null?r=Ns(a,r):(r=gi(r,i,s,null),r.flags|=2),r.return=e,n.return=e,n.sibling=r,e.child=n,r}function Xl(t,e,n,r){return r!==null&&f0(r),Ra(e,t.child,null,n),t=vm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function lw(t,e,n){t.lanes|=e;var r=t.alternate;r!==null&&(r.lanes|=e),fm(t.return,e,n)}function Rh(t,e,n,r,s){var i=t.memoizedState;i===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:s}:(i.isBackwards=e,i.rendering=null,i.renderingStartTime=0,i.last=r,i.tail=n,i.tailMode=s)}function p2(t,e,n){var r=e.pendingProps,s=r.revealOrder,i=r.tail;if(Rt(t,e,r.children,n),r=Ze.current,r&2)r=r&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&lw(t,n,e);else if(t.tag===19)lw(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}r&=1}if(Me(Ze,r),!(e.mode&1))e.memoizedState=null;else switch(s){case"forwards":for(n=e.child,s=null;n!==null;)t=n.alternate,t!==null&&yd(t)===null&&(s=n),n=n.sibling;n=s,n===null?(s=e.child,e.child=null):(s=n.sibling,n.sibling=null),Rh(e,!1,s,n,i);break;case"backwards":for(n=null,s=e.child,e.child=null;s!==null;){if(t=s.alternate,t!==null&&yd(t)===null){e.child=s;break}t=s.sibling,s.sibling=n,n=s,s=t}Rh(e,!0,n,null,i);break;case"together":Rh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Kr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),La|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(U(153));if(e.child!==null){for(t=e.child,n=Ns(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=Ns(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function OP(t,e,n){switch(e.tag){case 3:f2(e),Ia();break;case 5:Fx(e);break;case 1:Yt(e.type)&&dd(e);break;case 4:h0(e,e.stateNode.containerInfo);break;case 10:var r=e.type._context,s=e.memoizedProps.value;Me(fd,r._currentValue),r._currentValue=s;break;case 13:if(r=e.memoizedState,r!==null)return r.dehydrated!==null?(Me(Ze,Ze.current&1),e.flags|=128,null):n&e.child.childLanes?h2(t,e,n):(Me(Ze,Ze.current&1),t=Kr(t,e,n),t!==null?t.sibling:null);Me(Ze,Ze.current&1);break;case 19:if(r=(n&e.childLanes)!==0,t.flags&128){if(r)return p2(t,e,n);e.flags|=128}if(s=e.memoizedState,s!==null&&(s.rendering=null,s.tail=null,s.lastEffect=null),Me(Ze,Ze.current),r)break;return null;case 22:case 23:return e.lanes=0,c2(t,e,n)}return Kr(t,e,n)}function NP(t,e){switch(d0(e),e.tag){case 1:return Yt(e.type)&&cd(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return ja(),Ue(Xt),Ue(Pt),m0(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return p0(e),null;case 13:if(Ue(Ze),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(U(340));Ia()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Ue(Ze),null;case 4:return ja(),null;case 10:return u0(e.type._context),null;case 22:case 23:return E0(),null;case 24:return null;default:return null}}var Yl=!1,di=!1,IP=typeof WeakSet=="function"?WeakSet:Set,G=null;function _d(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){Qt(t,e,r)}else n.current=null}function xm(t,e,n){try{n()}catch(r){Qt(t,e,r)}}var cw=!1;function RP(t,e){if(t=vx(),i0(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var s=r.anchorOffset,i=r.focusNode;r=r.focusOffset;try{n.nodeType,i.nodeType}catch{n=null;break e}var a=0,o=-1,u=-1,l=0,c=0,d=t,f=null;t:for(;;){for(var h;d!==n||s!==0&&d.nodeType!==3||(o=a+s),d!==i||r!==0&&d.nodeType!==3||(u=a+r),d.nodeType===3&&(a+=d.nodeValue.length),(h=d.firstChild)!==null;)f=d,d=h;for(;;){if(d===t)break t;if(f===n&&++l===s&&(o=a),f===i&&++c===r&&(u=a),(h=d.nextSibling)!==null)break;d=f,f=d.parentNode}d=h}n=o===-1||u===-1?null:{start:o,end:u}}else n=null}n=n||{start:0,end:0}}else n=null;for(om={focusedElem:t,selectionRange:n},G=e;G!==null;)if(e=G,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,G=t;else for(;G!==null;){e=G;try{var m=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(m!==null){var y=m.memoizedProps,w=m.memoizedState,p=e.stateNode,b=p.getSnapshotBeforeUpdate(e.elementType===e.type?y:Bn(e.type,y),w);p.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var _=e.stateNode.containerInfo;if(_.nodeType===1)_.textContent="";else if(_.nodeType===9){var x=_.body;x!=null&&(x.textContent="")}break;case 5:case 6:case 4:case 17:break;default:throw Error(U(163))}}catch(S){Qt(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,G=t;break}G=e.return}return m=cw,cw=!1,m}function ju(t,e,n){var r=e.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var s=r=r.next;do{if((s.tag&t)===t){var i=s.destroy;s.destroy=void 0,i!==void 0&&xm(e,n,i)}s=s.next}while(s!==r)}}function mf(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var r=n.create;n.destroy=r()}n=n.next}while(n!==e)}}function Sm(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function dw(t,e,n){if(vr&&typeof vr.onCommitFiberUnmount=="function")try{vr.onCommitFiberUnmount(of,e)}catch{}switch(e.tag){case 0:case 11:case 14:case 15:if(t=e.updateQueue,t!==null&&(t=t.lastEffect,t!==null)){var r=t=t.next;do{var s=r,i=s.destroy;s=s.tag,i!==void 0&&(s&2||s&4)&&xm(e,n,i),r=r.next}while(r!==t)}break;case 1:if(_d(e,n),t=e.stateNode,typeof t.componentWillUnmount=="function")try{t.props=e.memoizedProps,t.state=e.memoizedState,t.componentWillUnmount()}catch(a){Qt(e,n,a)}break;case 5:_d(e,n);break;case 4:y2(t,e,n)}}function m2(t){var e=t.alternate;e!==null&&(t.alternate=null,m2(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[hr],delete e[Cu],delete e[cm],delete e[gP],delete e[yP])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function g2(t){return t.tag===5||t.tag===3||t.tag===4}function fw(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||g2(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function hw(t){e:{for(var e=t.return;e!==null;){if(g2(e))break e;e=e.return}throw Error(U(160))}var n=e;switch(n.tag){case 5:e=n.stateNode,n.flags&32&&(wu(e,""),n.flags&=-33),n=fw(t),Em(t,n,e);break;case 3:case 4:e=n.stateNode.containerInfo,n=fw(t),km(t,n,e);break;default:throw Error(U(161))}}function km(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=ld));else if(r!==4&&(t=t.child,t!==null))for(km(t,e,n),t=t.sibling;t!==null;)km(t,e,n),t=t.sibling}function Em(t,e,n){var r=t.tag;if(r===5||r===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(r!==4&&(t=t.child,t!==null))for(Em(t,e,n),t=t.sibling;t!==null;)Em(t,e,n),t=t.sibling}function y2(t,e,n){for(var r=e,s=!1,i,a;;){if(!s){s=r.return;e:for(;;){if(s===null)throw Error(U(160));switch(i=s.stateNode,s.tag){case 5:a=!1;break e;case 3:i=i.containerInfo,a=!0;break e;case 4:i=i.containerInfo,a=!0;break e}s=s.return}s=!0}if(r.tag===5||r.tag===6){e:for(var o=t,u=r,l=n,c=u;;)if(dw(o,c,l),c.child!==null&&c.tag!==4)c.child.return=c,c=c.child;else{if(c===u)break e;for(;c.sibling===null;){if(c.return===null||c.return===u)break e;c=c.return}c.sibling.return=c.return,c=c.sibling}a?(o=i,u=r.stateNode,o.nodeType===8?o.parentNode.removeChild(u):o.removeChild(u)):i.removeChild(r.stateNode)}else if(r.tag===18)a?(o=i,u=r.stateNode,o.nodeType===8?Ch(o.parentNode,u):o.nodeType===1&&Ch(o,u),Su(o)):Ch(i,r.stateNode);else if(r.tag===4){if(r.child!==null){i=r.stateNode.containerInfo,a=!0,r.child.return=r,r=r.child;continue}}else if(dw(t,r,n),r.child!==null){r.child.return=r,r=r.child;continue}if(r===e)break;for(;r.sibling===null;){if(r.return===null||r.return===e)return;r=r.return,r.tag===4&&(s=!1)}r.sibling.return=r.return,r=r.sibling}}function jh(t,e){switch(e.tag){case 0:case 11:case 14:case 15:ju(3,e,e.return),mf(3,e),ju(5,e,e.return);return;case 1:return;case 5:var n=e.stateNode;if(n!=null){var r=e.memoizedProps,s=t!==null?t.memoizedProps:r;t=e.type;var i=e.updateQueue;if(e.updateQueue=null,i!==null){for(t==="input"&&r.type==="radio"&&r.name!=null&&q1(n,r),Qp(t,s),e=Qp(t,r),s=0;s<i.length;s+=2){var a=i[s],o=i[s+1];a==="style"?Z1(n,o):a==="dangerouslySetInnerHTML"?W1(n,o):a==="children"?wu(n,o):Wg(n,a,o,e)}switch(t){case"input":Wp(n,r);break;case"textarea":H1(n,r);break;case"select":t=n._wrapperState.wasMultiple,n._wrapperState.wasMultiple=!!r.multiple,i=r.value,i!=null?ga(n,!!r.multiple,i,!1):t!==!!r.multiple&&(r.defaultValue!=null?ga(n,!!r.multiple,r.defaultValue,!0):ga(n,!!r.multiple,r.multiple?[]:"",!1))}n[Cu]=r}}return;case 6:if(e.stateNode===null)throw Error(U(162));e.stateNode.nodeValue=e.memoizedProps;return;case 3:t!==null&&t.memoizedState.isDehydrated&&Su(e.stateNode.containerInfo);return;case 12:return;case 13:pw(e);return;case 19:pw(e);return;case 17:return}throw Error(U(163))}function pw(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new IP),e.forEach(function(r){var s=qP.bind(null,t,r);n.has(r)||(n.add(r),r.then(s,s))})}}function jP(t,e){for(G=e;G!==null;){e=G;var n=e.deletions;if(n!==null)for(var r=0;r<n.length;r++){var s=n[r];try{y2(t,s,e);var i=s.alternate;i!==null&&(i.return=null),s.return=null}catch(T){Qt(s,e,T)}}if(n=e.child,e.subtreeFlags&12854&&n!==null)n.return=e,G=n;else for(;G!==null;){e=G;try{var a=e.flags;if(a&32&&wu(e.stateNode,""),a&512){var o=e.alternate;if(o!==null){var u=o.ref;u!==null&&(typeof u=="function"?u(null):u.current=null)}}if(a&8192)switch(e.tag){case 13:if(e.memoizedState!==null){var l=e.alternate;(l===null||l.memoizedState===null)&&(S0=Qe())}break;case 22:var c=e.memoizedState!==null,d=e.alternate,f=d!==null&&d.memoizedState!==null;n=e;e:{r=n,s=c;for(var h=null,m=r;;){if(m.tag===5){if(h===null){h=m;var y=m.stateNode;if(s){var w=y.style;typeof w.setProperty=="function"?w.setProperty("display","none","important"):w.display="none"}else{var p=m.stateNode,b=m.memoizedProps.style,_=b!=null&&b.hasOwnProperty("display")?b.display:null;p.style.display=G1("display",_)}}}else if(m.tag===6)h===null&&(m.stateNode.nodeValue=s?"":m.memoizedProps);else if((m.tag!==22&&m.tag!==23||m.memoizedState===null||m===r)&&m.child!==null){m.child.return=m,m=m.child;continue}if(m===r)break;for(;m.sibling===null;){if(m.return===null||m.return===r)break e;h===m&&(h=null),m=m.return}h===m&&(h=null),m.sibling.return=m.return,m=m.sibling}}if(c&&!f&&n.mode&1){G=n;for(var x=n.child;x!==null;){for(n=G=x;G!==null;){r=G;var S=r.child;switch(r.tag){case 0:case 11:case 14:case 15:ju(4,r,r.return);break;case 1:_d(r,r.return);var E=r.stateNode;if(typeof E.componentWillUnmount=="function"){var k=r.return;try{E.props=r.memoizedProps,E.state=r.memoizedState,E.componentWillUnmount()}catch(T){Qt(r,k,T)}}break;case 5:_d(r,r.return);break;case 22:if(r.memoizedState!==null){gw(n);continue}}S!==null?(S.return=r,G=S):gw(n)}x=x.sibling}}}switch(a&4102){case 2:hw(e),e.flags&=-3;break;case 6:hw(e),e.flags&=-3,jh(e.alternate,e);break;case 4096:e.flags&=-4097;break;case 4100:e.flags&=-4097,jh(e.alternate,e);break;case 4:jh(e.alternate,e)}}catch(T){Qt(e,e.return,T)}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}}function $P(t,e,n){G=t,b2(t)}function b2(t,e,n){for(var r=(t.mode&1)!==0;G!==null;){var s=G,i=s.child;if(s.tag===22&&r){var a=s.memoizedState!==null||Yl;if(!a){var o=s.alternate,u=o!==null&&o.memoizedState!==null||di;o=Yl;var l=di;if(Yl=a,(di=u)&&!l)for(G=s;G!==null;)a=G,u=a.child,a.tag===22&&a.memoizedState!==null?yw(s):u!==null?(u.return=a,G=u):yw(s);for(;i!==null;)G=i,b2(i),i=i.sibling;G=s,Yl=o,di=l}mw(t)}else s.subtreeFlags&8772&&i!==null?(i.return=s,G=i):mw(t)}}function mw(t){for(;G!==null;){var e=G;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:di||mf(5,e);break;case 1:var r=e.stateNode;if(e.flags&4&&!di)if(n===null)r.componentDidMount();else{var s=e.elementType===e.type?n.memoizedProps:Bn(e.type,n.memoizedProps);r.componentDidUpdate(s,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var i=e.updateQueue;i!==null&&Zb(e,i,r);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Zb(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var u=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":u.autoFocus&&n.focus();break;case"img":u.src&&(n.src=u.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var l=e.alternate;if(l!==null){var c=l.memoizedState;if(c!==null){var d=c.dehydrated;d!==null&&Su(d)}}}break;case 19:case 17:case 21:case 22:case 23:break;default:throw Error(U(163))}di||e.flags&512&&Sm(e)}catch(f){Qt(e,e.return,f)}}if(e===t){G=null;break}if(n=e.sibling,n!==null){n.return=e.return,G=n;break}G=e.return}}function gw(t){for(;G!==null;){var e=G;if(e===t){G=null;break}var n=e.sibling;if(n!==null){n.return=e.return,G=n;break}G=e.return}}function yw(t){for(;G!==null;){var e=G;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{mf(4,e)}catch(u){Qt(e,n,u)}break;case 1:var r=e.stateNode;if(typeof r.componentDidMount=="function"){var s=e.return;try{r.componentDidMount()}catch(u){Qt(e,s,u)}}var i=e.return;try{Sm(e)}catch(u){Qt(e,i,u)}break;case 5:var a=e.return;try{Sm(e)}catch(u){Qt(e,a,u)}}}catch(u){Qt(e,e.return,u)}if(e===t){G=null;break}var o=e.sibling;if(o!==null){o.return=e.return,G=o;break}G=e.return}}var LP=Math.ceil,vd=ts.ReactCurrentDispatcher,v0=ts.ReactCurrentOwner,Tn=ts.ReactCurrentBatchConfig,xe=0,st=null,rt=null,_t=0,ln=0,ca=Hs(0),ct=0,$u=null,La=0,gf=0,x0=0,ou=null,Gt=null,S0=0,Ma=1/0,xd=!1,Am=null,Ts=null,ec=!1,vs=null,Sd=0,uu=0,Tm=null,Dc=-1,Fc=0;function Mt(){return xe&6?Qe():Dc!==-1?Dc:Dc=Qe()}function Cs(t){return t.mode&1?xe&2&&_t!==0?_t&-_t:wP.transition!==null?(Fc===0&&(t=Bl,Bl<<=1,!(Bl&4194240)&&(Bl=64),Fc=t),Fc):(t=Ie,t!==0||(t=window.event,t=t===void 0?16:fx(t.type)),t):1}function Cn(t,e,n){if(50<uu)throw uu=0,Tm=null,Error(U(185));var r=yf(t,e);return r===null?null:(cl(r,e,n),(!(xe&2)||r!==st)&&(r===st&&(!(xe&2)&&(gf|=e),ct===4&&bs(r,_t)),en(r,n),e===1&&xe===0&&!(t.mode&1)&&(Ma=Qe()+500,ff&&Vs())),r)}function yf(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}function en(t,e){var n=t.callbackNode;wC(t,e);var r=ad(t,t===st?_t:0);if(r===0)n!==null&&kb(n),t.callbackNode=null,t.callbackPriority=0;else if(e=r&-r,t.callbackPriority!==e){if(n!=null&&kb(n),e===1)t.tag===0?bP(bw.bind(null,t)):Nx(bw.bind(null,t)),pP(function(){xe===0&&Vs()}),n=null;else{switch(ax(r)){case 1:n=Qg;break;case 4:n=sx;break;case 16:n=id;break;case 536870912:n=ix;break;default:n=id}n=A2(n,w2.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function w2(t,e){if(Dc=-1,Fc=0,xe&6)throw Error(U(327));var n=t.callbackNode;if(va()&&t.callbackNode!==n)return null;var r=ad(t,t===st?_t:0);if(r===0)return null;if(r&30||r&t.expiredLanes||e)e=kd(t,r);else{e=r;var s=xe;xe|=2;var i=v2();(st!==t||_t!==e)&&(Ma=Qe()+500,mi(t,e));do try{FP();break}catch(o){_2(t,o)}while(!0);o0(),vd.current=i,xe=s,rt!==null?e=0:(st=null,_t=0,e=ct)}if(e!==0){if(e===2&&(s=nm(t),s!==0&&(r=s,e=Cm(t,s))),e===1)throw n=$u,mi(t,0),bs(t,r),en(t,Qe()),n;if(e===6)bs(t,r);else{if(s=t.current.alternate,!(r&30)&&!MP(s)&&(e=kd(t,r),e===2&&(i=nm(t),i!==0&&(r=i,e=Cm(t,i))),e===1))throw n=$u,mi(t,0),bs(t,r),en(t,Qe()),n;switch(t.finishedWork=s,t.finishedLanes=r,e){case 0:case 1:throw Error(U(345));case 2:Ys(t,Gt);break;case 3:if(bs(t,r),(r&130023424)===r&&(e=S0+500-Qe(),10<e)){if(ad(t,0)!==0)break;if(s=t.suspendedLanes,(s&r)!==r){Mt(),t.pingedLanes|=t.suspendedLanes&s;break}t.timeoutHandle=lm(Ys.bind(null,t,Gt),e);break}Ys(t,Gt);break;case 4:if(bs(t,r),(r&4194240)===r)break;for(e=t.eventTimes,s=-1;0<r;){var a=31-Gn(r);i=1<<a,a=e[a],a>s&&(s=a),r&=~i}if(r=s,r=Qe()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*LP(r/1960))-r,10<r){t.timeoutHandle=lm(Ys.bind(null,t,Gt),r);break}Ys(t,Gt);break;case 5:Ys(t,Gt);break;default:throw Error(U(329))}}}return en(t,Qe()),t.callbackNode===n?w2.bind(null,t):null}function Cm(t,e){var n=ou;return t.current.memoizedState.isDehydrated&&(mi(t,e).flags|=256),t=kd(t,e),t!==2&&(e=Gt,Gt=n,e!==null&&Pm(e)),t}function Pm(t){Gt===null?Gt=t:Gt.push.apply(Gt,t)}function MP(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var s=n[r],i=s.getSnapshot;s=s.value;try{if(!kr(i(),s))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function bs(t,e){for(e&=~x0,e&=~gf,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-Gn(e),r=1<<n;t[n]=-1,e&=~r}}function bw(t){if(xe&6)throw Error(U(327));va();var e=ad(t,0);if(!(e&1))return en(t,Qe()),null;var n=kd(t,e);if(t.tag!==0&&n===2){var r=nm(t);r!==0&&(e=r,n=Cm(t,r))}if(n===1)throw n=$u,mi(t,0),bs(t,e),en(t,Qe()),n;if(n===6)throw Error(U(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Ys(t,Gt),en(t,Qe()),null}function k0(t,e){var n=xe;xe|=1;try{return t(e)}finally{xe=n,xe===0&&(Ma=Qe()+500,ff&&Vs())}}function Si(t){vs!==null&&vs.tag===0&&!(xe&6)&&va();var e=xe;xe|=1;var n=Tn.transition,r=Ie;try{if(Tn.transition=null,Ie=1,t)return t()}finally{Ie=r,Tn.transition=n,xe=e,!(xe&6)&&Vs()}}function E0(){ln=ca.current,Ue(ca)}function mi(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,hP(n)),rt!==null)for(n=rt.return;n!==null;){var r=n;switch(d0(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&cd();break;case 3:ja(),Ue(Xt),Ue(Pt),m0();break;case 5:p0(r);break;case 4:ja();break;case 13:Ue(Ze);break;case 19:Ue(Ze);break;case 10:u0(r.type._context);break;case 22:case 23:E0()}n=n.return}if(st=t,rt=t=Ns(t.current,null),_t=ln=e,ct=0,$u=null,x0=gf=La=0,Gt=ou=null,yr!==null){for(e=0;e<yr.length;e++)if(n=yr[e],r=n.interleaved,r!==null){n.interleaved=null;var s=r.next,i=n.pending;if(i!==null){var a=i.next;i.next=s,r.next=a}n.pending=r}yr=null}return t}function _2(t,e){do{var n=rt;try{if(o0(),Lc.current=wd,bd){for(var r=Ke.memoizedState;r!==null;){var s=r.queue;s!==null&&(s.pending=null),r=r.next}bd=!1}if($a=0,mt=Tt=Ke=null,au=!1,Nu=0,v0.current=null,n===null||n.return===null){ct=1,$u=e,rt=null;break}e:{var i=t,a=n.return,o=n,u=e;if(e=_t,o.flags|=32768,u!==null&&typeof u=="object"&&typeof u.then=="function"){var l=u,c=o,d=c.tag;if(!(c.mode&1)&&(d===0||d===11||d===15)){var f=c.alternate;f?(c.updateQueue=f.updateQueue,c.memoizedState=f.memoizedState,c.lanes=f.lanes):(c.updateQueue=null,c.memoizedState=null)}var h=tw(a);if(h!==null){h.flags&=-257,nw(h,a,o,i,e),h.mode&1&&ew(i,l,e),e=h,u=l;var m=e.updateQueue;if(m===null){var y=new Set;y.add(u),e.updateQueue=y}else m.add(u);break e}else{if(!(e&1)){ew(i,l,e),A0();break e}u=Error(U(426))}}else if(He&&o.mode&1){var w=tw(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),nw(w,a,o,i,e),f0(u);break e}}i=u,ct!==4&&(ct=2),ou===null?ou=[i]:ou.push(i),u=_0(u,o),o=a;do{switch(o.tag){case 3:o.flags|=65536,e&=-e,o.lanes|=e;var p=s2(o,u,e);Gb(o,p);break e;case 1:i=u;var b=o.type,_=o.stateNode;if(!(o.flags&128)&&(typeof b.getDerivedStateFromError=="function"||_!==null&&typeof _.componentDidCatch=="function"&&(Ts===null||!Ts.has(_)))){o.flags|=65536,e&=-e,o.lanes|=e;var x=i2(o,i,e);Gb(o,x);break e}}o=o.return}while(o!==null)}S2(n)}catch(S){e=S,rt===n&&n!==null&&(rt=n=n.return);continue}break}while(!0)}function v2(){var t=vd.current;return vd.current=wd,t===null?wd:t}function A0(){(ct===0||ct===3||ct===2)&&(ct=4),st===null||!(La&268435455)&&!(gf&268435455)||bs(st,_t)}function kd(t,e){var n=xe;xe|=2;var r=v2();st===t&&_t===e||mi(t,e);do try{DP();break}catch(s){_2(t,s)}while(!0);if(o0(),xe=n,vd.current=r,rt!==null)throw Error(U(261));return st=null,_t=0,ct}function DP(){for(;rt!==null;)x2(rt)}function FP(){for(;rt!==null&&!cC();)x2(rt)}function x2(t){var e=E2(t.alternate,t,ln);t.memoizedProps=t.pendingProps,e===null?S2(t):rt=e,v0.current=null}function S2(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=NP(n,e),n!==null){n.flags&=32767,rt=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{ct=6,rt=null;return}}else if(n=CP(n,e,ln),n!==null){rt=n;return}if(e=e.sibling,e!==null){rt=e;return}rt=e=t}while(e!==null);ct===0&&(ct=5)}function Ys(t,e){var n=Ie,r=Tn.transition;try{Tn.transition=null,Ie=1,BP(t,e,n)}finally{Tn.transition=r,Ie=n}return null}function BP(t,e,n){do va();while(vs!==null);if(xe&6)throw Error(U(327));var r=t.finishedWork,s=t.finishedLanes;if(r===null)return null;if(t.finishedWork=null,t.finishedLanes=0,r===t.current)throw Error(U(177));t.callbackNode=null,t.callbackPriority=0;var i=r.lanes|r.childLanes;if(_C(t,i),t===st&&(rt=st=null,_t=0),!(r.subtreeFlags&2064)&&!(r.flags&2064)||ec||(ec=!0,A2(id,function(){return va(),null})),i=(r.flags&15990)!==0,r.subtreeFlags&15990||i){i=Tn.transition,Tn.transition=null;var a=Ie;Ie=1;var o=xe;xe|=4,v0.current=null,RP(t,r),jP(t,r),aP(om),om=null,t.current=r,$P(r),dC(),xe=o,Ie=a,Tn.transition=i}else t.current=r;if(ec&&(ec=!1,vs=t,Sd=s),i=t.pendingLanes,i===0&&(Ts=null),pC(r.stateNode),en(t,Qe()),e!==null)for(n=t.onRecoverableError,r=0;r<e.length;r++)n(e[r]);if(xd)throw xd=!1,t=Am,Am=null,t;return Sd&1&&t.tag!==0&&va(),i=t.pendingLanes,i&1?t===Tm?uu++:(uu=0,Tm=t):uu=0,Vs(),null}function va(){if(vs!==null){var t=ax(Sd),e=Tn.transition,n=Ie;try{if(Tn.transition=null,Ie=16>t?16:t,vs===null)var r=!1;else{if(t=vs,vs=null,Sd=0,xe&6)throw Error(U(331));var s=xe;for(xe|=4,G=t.current;G!==null;){var i=G,a=i.child;if(G.flags&16){var o=i.deletions;if(o!==null){for(var u=0;u<o.length;u++){var l=o[u];for(G=l;G!==null;){var c=G;switch(c.tag){case 0:case 11:case 15:ju(8,c,i)}var d=c.child;if(d!==null)d.return=c,G=d;else for(;G!==null;){c=G;var f=c.sibling,h=c.return;if(m2(c),c===l){G=null;break}if(f!==null){f.return=h,G=f;break}G=h}}}var m=i.alternate;if(m!==null){var y=m.child;if(y!==null){m.child=null;do{var w=y.sibling;y.sibling=null,y=w}while(y!==null)}}G=i}}if(i.subtreeFlags&2064&&a!==null)a.return=i,G=a;else e:for(;G!==null;){if(i=G,i.flags&2048)switch(i.tag){case 0:case 11:case 15:ju(9,i,i.return)}var p=i.sibling;if(p!==null){p.return=i.return,G=p;break e}G=i.return}}var b=t.current;for(G=b;G!==null;){a=G;var _=a.child;if(a.subtreeFlags&2064&&_!==null)_.return=a,G=_;else e:for(a=b;G!==null;){if(o=G,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:mf(9,o)}}catch(S){Qt(o,o.return,S)}if(o===a){G=null;break e}var x=o.sibling;if(x!==null){x.return=o.return,G=x;break e}G=o.return}}if(xe=s,Vs(),vr&&typeof vr.onPostCommitFiberRoot=="function")try{vr.onPostCommitFiberRoot(of,t)}catch{}r=!0}return r}finally{Ie=n,Tn.transition=e}}return!1}function ww(t,e,n){e=_0(n,e),e=s2(t,e,1),As(t,e),e=Mt(),t=yf(t,1),t!==null&&(cl(t,1,e),en(t,e))}function Qt(t,e,n){if(t.tag===3)ww(t,t,n);else for(;e!==null;){if(e.tag===3){ww(e,t,n);break}else if(e.tag===1){var r=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ts===null||!Ts.has(r))){t=_0(n,t),t=i2(e,t,1),As(e,t),t=Mt(),e=yf(e,1),e!==null&&(cl(e,1,t),en(e,t));break}}e=e.return}}function UP(t,e,n){var r=t.pingCache;r!==null&&r.delete(e),e=Mt(),t.pingedLanes|=t.suspendedLanes&n,st===t&&(_t&n)===n&&(ct===4||ct===3&&(_t&130023424)===_t&&500>Qe()-S0?mi(t,0):x0|=n),en(t,e)}function k2(t,e){e===0&&(t.mode&1?(e=Ul,Ul<<=1,!(Ul&130023424)&&(Ul=4194304)):e=1);var n=Mt();t=yf(t,e),t!==null&&(cl(t,e,n),en(t,n))}function zP(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),k2(t,n)}function qP(t,e){var n=0;switch(t.tag){case 13:var r=t.stateNode,s=t.memoizedState;s!==null&&(n=s.retryLane);break;case 19:r=t.stateNode;break;default:throw Error(U(314))}r!==null&&r.delete(e),k2(t,n)}var E2;E2=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Xt.current)dn=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return dn=!1,OP(t,e,n);dn=!!(t.flags&131072)}else dn=!1,He&&e.flags&1048576&&$x(e,gd,e.index);switch(e.lanes=0,e.tag){case 2:var r=e.type;t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps;var s=Na(e,Pt.current);_a(e,n),s=y0(null,e,r,t,s,n);var i=b0();return e.flags|=1,typeof s=="object"&&s!==null&&typeof s.render=="function"&&s.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Yt(r)?(i=!0,dd(e)):i=!1,e.memoizedState=s.state!==null&&s.state!==void 0?s.state:null,l0(e),s.updater=hf,e.stateNode=s,s._reactInternals=e,pm(e,r,t,n),e=_m(null,e,r,!0,i,n)):(e.tag=0,He&&i&&c0(e),Rt(null,e,s,n),e=e.child),e;case 16:r=e.elementType;e:{switch(t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),t=e.pendingProps,s=r._init,r=s(r._payload),e.type=r,s=e.tag=VP(r),t=Bn(r,t),s){case 0:e=wm(null,e,r,t,n);break e;case 1:e=iw(null,e,r,t,n);break e;case 11:e=rw(null,e,r,t,n);break e;case 14:e=sw(null,e,r,Bn(r.type,t),n);break e}throw Error(U(306,r,""))}return e;case 0:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Bn(r,s),wm(t,e,r,s,n);case 1:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Bn(r,s),iw(t,e,r,s,n);case 3:e:{if(f2(e),t===null)throw Error(U(387));r=e.pendingProps,i=e.memoizedState,s=i.element,Ix(t,e),pd(e,r,null,n);var a=e.memoizedState;if(r=a.element,i.isDehydrated)if(i={element:r,isDehydrated:!1,cache:a.cache,transitions:a.transitions},e.updateQueue.baseState=i,e.memoizedState=i,e.flags&256){s=Error(U(423)),e=aw(t,e,r,n,s);break e}else if(r!==s){s=Error(U(424)),e=aw(t,e,r,n,s);break e}else for(Kt=Ur(e.stateNode.containerInfo.firstChild),fn=e,He=!0,qn=null,n=Dx(e,null,r,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(Ia(),r===s){e=Kr(t,e,n);break e}Rt(t,e,r,n)}e=e.child}return e;case 5:return Fx(e),t===null&&gm(e),r=e.type,s=e.pendingProps,i=t!==null?t.memoizedProps:null,a=s.children,um(r,s)?a=null:i!==null&&um(r,i)&&(e.flags|=32),d2(t,e),Rt(t,e,a,n),e.child;case 6:return t===null&&gm(e),null;case 13:return h2(t,e,n);case 4:return h0(e,e.stateNode.containerInfo),r=e.pendingProps,t===null?e.child=Ra(e,null,r,n):Rt(t,e,r,n),e.child;case 11:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Bn(r,s),rw(t,e,r,s,n);case 7:return Rt(t,e,e.pendingProps,n),e.child;case 8:return Rt(t,e,e.pendingProps.children,n),e.child;case 12:return Rt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(r=e.type._context,s=e.pendingProps,i=e.memoizedProps,a=s.value,Me(fd,r._currentValue),r._currentValue=a,i!==null)if(kr(i.value,a)){if(i.children===s.children&&!Xt.current){e=Kr(t,e,n);break e}}else for(i=e.child,i!==null&&(i.return=e);i!==null;){var o=i.dependencies;if(o!==null){a=i.child;for(var u=o.firstContext;u!==null;){if(u.context===r){if(i.tag===1){u=Vr(-1,n&-n),u.tag=2;var l=i.updateQueue;if(l!==null){l=l.shared;var c=l.pending;c===null?u.next=u:(u.next=c.next,c.next=u),l.pending=u}}i.lanes|=n,u=i.alternate,u!==null&&(u.lanes|=n),fm(i.return,n,e),o.lanes|=n;break}u=u.next}}else if(i.tag===10)a=i.type===e.type?null:i.child;else if(i.tag===18){if(a=i.return,a===null)throw Error(U(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),fm(a,n,e),a=i.sibling}else a=i.child;if(a!==null)a.return=i;else for(a=i;a!==null;){if(a===e){a=null;break}if(i=a.sibling,i!==null){i.return=a.return,a=i;break}a=a.return}i=a}Rt(t,e,s.children,n),e=e.child}return e;case 9:return s=e.type,r=e.pendingProps.children,_a(e,n),s=On(s),r=r(s),e.flags|=1,Rt(t,e,r,n),e.child;case 14:return r=e.type,s=Bn(r,e.pendingProps),s=Bn(r.type,s),sw(t,e,r,s,n);case 15:return l2(t,e,e.type,e.pendingProps,n);case 17:return r=e.type,s=e.pendingProps,s=e.elementType===r?s:Bn(r,s),t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2),e.tag=1,Yt(r)?(t=!0,dd(e)):t=!1,_a(e,n),jx(e,r,s),pm(e,r,s,n),_m(null,e,r,!0,t,n);case 19:return p2(t,e,n);case 22:return c2(t,e,n)}throw Error(U(156,e.tag))};function A2(t,e){return rx(t,e)}function HP(t,e,n,r){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function kn(t,e,n,r){return new HP(t,e,n,r)}function T0(t){return t=t.prototype,!(!t||!t.isReactComponent)}function VP(t){if(typeof t=="function")return T0(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Zg)return 11;if(t===Jg)return 14}return 2}function Ns(t,e){var n=t.alternate;return n===null?(n=kn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Bc(t,e,n,r,s,i){var a=2;if(r=t,typeof t=="function")T0(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ta:return gi(n.children,s,i,e);case Gg:a=8,s|=8;break;case Up:return t=kn(12,n,e,s|2),t.elementType=Up,t.lanes=i,t;case zp:return t=kn(13,n,e,s),t.elementType=zp,t.lanes=i,t;case qp:return t=kn(19,n,e,s),t.elementType=qp,t.lanes=i,t;case B1:return Ed(n,s,i,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case D1:a=10;break e;case F1:a=9;break e;case Zg:a=11;break e;case Jg:a=14;break e;case fs:a=16,r=null;break e}throw Error(U(130,t==null?t:typeof t,""))}return e=kn(a,n,e,s),e.elementType=t,e.type=r,e.lanes=i,e}function gi(t,e,n,r){return t=kn(7,t,r,e),t.lanes=n,t}function Ed(t,e,n,r){return t=kn(22,t,r,e),t.elementType=B1,t.lanes=n,t.stateNode={},t}function $h(t,e,n){return t=kn(6,t,null,e),t.lanes=n,t}function Lh(t,e,n){return e=kn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function WP(t,e,n,r,s){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=yh(0),this.expirationTimes=yh(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=yh(0),this.identifierPrefix=r,this.onRecoverableError=s,this.mutableSourceEagerHydrationData=null}function C0(t,e,n,r,s,i,a,o,u){return t=new WP(t,e,n,o,u),e===1?(e=1,i===!0&&(e|=8)):e=0,i=kn(3,null,null,e),t.current=i,i.stateNode=t,i.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null},l0(i),t}function GP(t,e,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:ea,key:r==null?null:""+r,children:t,containerInfo:e,implementation:n}}function T2(t){if(!t)return Os;t=t._reactInternals;e:{if(Ni(t)!==t||t.tag!==1)throw Error(U(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Yt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(U(171))}if(t.tag===1){var n=t.type;if(Yt(n))return Ox(t,n,e)}return e}function C2(t,e,n,r,s,i,a,o,u){return t=C0(n,r,!0,t,s,i,a,o,u),t.context=T2(null),n=t.current,r=Mt(),s=Cs(n),i=Vr(r,s),i.callback=e??null,As(n,i),t.current.lanes=s,cl(t,s,r),en(t,r),t}function bf(t,e,n,r){var s=e.current,i=Mt(),a=Cs(s);return n=T2(n),e.context===null?e.context=n:e.pendingContext=n,e=Vr(i,a),e.payload={element:t},r=r===void 0?null:r,r!==null&&(e.callback=r),As(s,e),t=Cn(s,a,i),t!==null&&$c(t,s,a),a}function Ad(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function _w(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function P0(t,e){_w(t,e),(t=t.alternate)&&_w(t,e)}var P2=typeof reportError=="function"?reportError:function(t){console.error(t)};function O0(t){this._internalRoot=t}wf.prototype.render=O0.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(U(409));bf(t,e,null,null)};wf.prototype.unmount=O0.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Si(function(){bf(null,t,null,null)}),e[Jr]=null}};function wf(t){this._internalRoot=t}wf.prototype.unstable_scheduleHydration=function(t){if(t){var e=lx();t={blockedOn:null,target:t,priority:e};for(var n=0;n<ys.length&&e!==0&&e<ys[n].priority;n++);ys.splice(n,0,t),n===0&&dx(t)}};function N0(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function _f(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function vw(){}function ZP(t,e,n,r,s){if(s){if(typeof r=="function"){var i=r;r=function(){var l=Ad(a);i.call(l)}}var a=C2(e,r,t,0,null,!1,!1,"",vw);return t._reactRootContainer=a,t[Jr]=a.current,Au(t.nodeType===8?t.parentNode:t),Si(),a}for(;s=t.lastChild;)t.removeChild(s);if(typeof r=="function"){var o=r;r=function(){var l=Ad(u);o.call(l)}}var u=C0(t,0,!1,null,null,!1,!1,"",vw);return t._reactRootContainer=u,t[Jr]=u.current,Au(t.nodeType===8?t.parentNode:t),Si(function(){bf(e,u,n,r)}),u}function vf(t,e,n,r,s){var i=n._reactRootContainer;if(i){var a=i;if(typeof s=="function"){var o=s;s=function(){var u=Ad(a);o.call(u)}}bf(e,a,t,s)}else a=ZP(n,e,t,s,r);return Ad(a)}ox=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=zo(e.pendingLanes);n!==0&&(Xg(e,n|1),en(e,Qe()),!(xe&6)&&(Ma=Qe()+500,Vs()))}break;case 13:var r=Mt();Si(function(){return Cn(t,1,r)}),P0(t,1)}};Yg=function(t){if(t.tag===13){var e=Mt();Cn(t,134217728,e),P0(t,134217728)}};ux=function(t){if(t.tag===13){var e=Mt(),n=Cs(t);Cn(t,n,e),P0(t,n)}};lx=function(){return Ie};cx=function(t,e){var n=Ie;try{return Ie=t,e()}finally{Ie=n}};Yp=function(t,e,n){switch(e){case"input":if(Wp(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var r=n[e];if(r!==t&&r.form===t.form){var s=df(r);if(!s)throw Error(U(90));z1(r),Wp(r,s)}}}break;case"textarea":H1(t,n);break;case"select":e=n.value,e!=null&&ga(t,!!n.multiple,e,!1)}};Q1=k0;X1=Si;var JP={usingClientEntryPoint:!1,Events:[fl,ia,df,J1,K1,k0]},Io={findFiberByHostInstance:li,bundleType:0,version:"18.0.0-fc46dba67-20220329",rendererPackageName:"react-dom"},KP={bundleType:Io.bundleType,version:Io.version,rendererPackageName:Io.rendererPackageName,rendererConfig:Io.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:ts.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=tx(t),t===null?null:t.stateNode},findFiberByHostInstance:Io.findFiberByHostInstance,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.0.0-fc46dba67-20220329"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var tc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!tc.isDisabled&&tc.supportsFiber)try{of=tc.inject(KP),vr=tc}catch{}}bn.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=JP;bn.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!N0(e))throw Error(U(200));return GP(t,e,null,n)};bn.createRoot=function(t,e){if(!N0(t))throw Error(U(299));var n=!1,r="",s=P2;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(r=e.identifierPrefix),e.onRecoverableError!==void 0&&(s=e.onRecoverableError)),e=C0(t,1,!1,null,null,n,!1,r,s),t[Jr]=e.current,Au(t.nodeType===8?t.parentNode:t),new O0(e)};bn.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(U(188)):(t=Object.keys(t).join(","),Error(U(268,t)));return t=tx(e),t=t===null?null:t.stateNode,t};bn.flushSync=function(t){return Si(t)};bn.hydrate=function(t,e,n){if(!_f(e))throw Error(U(200));return vf(null,t,e,!0,n)};bn.hydrateRoot=function(t,e,n){if(!N0(t))throw Error(U(405));var r=n!=null&&n.hydratedSources||null,s=!1,i="",a=P2;if(n!=null&&(n.unstable_strictMode===!0&&(s=!0),n.identifierPrefix!==void 0&&(i=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=C2(e,null,t,1,n??null,s,!1,i,a),t[Jr]=e.current,Au(t),r)for(t=0;t<r.length;t++)n=r[t],s=n._getVersion,s=s(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,s]:e.mutableSourceEagerHydrationData.push(n,s);return new wf(e)};bn.render=function(t,e,n){if(!_f(e))throw Error(U(200));return vf(null,t,e,!1,n)};bn.unmountComponentAtNode=function(t){if(!_f(t))throw Error(U(40));return t._reactRootContainer?(Si(function(){vf(null,null,t,!1,function(){t._reactRootContainer=null,t[Jr]=null})}),!0):!1};bn.unstable_batchedUpdates=k0;bn.unstable_renderSubtreeIntoContainer=function(t,e,n,r){if(!_f(n))throw Error(U(200));if(t==null||t._reactInternals===void 0)throw Error(U(38));return vf(t,e,n,!1,r)};bn.version="18.0.0-fc46dba67-20220329";function O2(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(O2)}catch(t){console.error(t)}}O2(),R1.exports=bn;var no=R1.exports;const QP=Xa(no);var xw=no;Fp.createRoot=xw.createRoot,Fp.hydrateRoot=xw.hydrateRoot;var I0={};Object.defineProperty(I0,"__esModule",{value:!0});I0.parse=sO;I0.serialize=iO;const XP=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,YP=/^[\u0021-\u003A\u003C-\u007E]*$/,eO=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,tO=/^[\u0020-\u003A\u003D-\u007E]*$/,nO=Object.prototype.toString,rO=(()=>{const t=function(){};return t.prototype=Object.create(null),t})();function sO(t,e){const n=new rO,r=t.length;if(r<2)return n;const s=e?.decode||aO;let i=0;do{const a=t.indexOf("=",i);if(a===-1)break;const o=t.indexOf(";",i),u=o===-1?r:o;if(a>u){i=t.lastIndexOf(";",a-1)+1;continue}const l=Sw(t,i,a),c=kw(t,a,l),d=t.slice(l,c);if(n[d]===void 0){let f=Sw(t,a+1,u),h=kw(t,u,f);const m=s(t.slice(f,h));n[d]=m}i=u+1}while(i<r);return n}function Sw(t,e,n){do{const r=t.charCodeAt(e);if(r!==32&&r!==9)return e}while(++e<n);return n}function kw(t,e,n){for(;e>n;){const r=t.charCodeAt(--e);if(r!==32&&r!==9)return e+1}return n}function iO(t,e,n){const r=n?.encode||encodeURIComponent;if(!XP.test(t))throw new TypeError(`argument name is invalid: ${t}`);const s=r(e);if(!YP.test(s))throw new TypeError(`argument val is invalid: ${e}`);let i=t+"="+s;if(!n)return i;if(n.maxAge!==void 0){if(!Number.isInteger(n.maxAge))throw new TypeError(`option maxAge is invalid: ${n.maxAge}`);i+="; Max-Age="+n.maxAge}if(n.domain){if(!eO.test(n.domain))throw new TypeError(`option domain is invalid: ${n.domain}`);i+="; Domain="+n.domain}if(n.path){if(!tO.test(n.path))throw new TypeError(`option path is invalid: ${n.path}`);i+="; Path="+n.path}if(n.expires){if(!oO(n.expires)||!Number.isFinite(n.expires.valueOf()))throw new TypeError(`option expires is invalid: ${n.expires}`);i+="; Expires="+n.expires.toUTCString()}if(n.httpOnly&&(i+="; HttpOnly"),n.secure&&(i+="; Secure"),n.partitioned&&(i+="; Partitioned"),n.priority)switch(typeof n.priority=="string"?n.priority.toLowerCase():void 0){case"low":i+="; Priority=Low";break;case"medium":i+="; Priority=Medium";break;case"high":i+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${n.priority}`)}if(n.sameSite)switch(typeof n.sameSite=="string"?n.sameSite.toLowerCase():n.sameSite){case!0:case"strict":i+="; SameSite=Strict";break;case"lax":i+="; SameSite=Lax";break;case"none":i+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${n.sameSite}`)}return i}function aO(t){if(t.indexOf("%")===-1)return t;try{return decodeURIComponent(t)}catch{return t}}function oO(t){return nO.call(t)==="[object Date]"}/**
 * react-router v7.1.3
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var Ew="popstate";function uO(t={}){function e(r,s){let{pathname:i,search:a,hash:o}=r.location;return Om("",{pathname:i,search:a,hash:o},s.state&&s.state.usr||null,s.state&&s.state.key||"default")}function n(r,s){return typeof s=="string"?s:Lu(s)}return cO(e,n,null,t)}function Ve(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function Nn(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function lO(){return Math.random().toString(36).substring(2,10)}function Aw(t,e){return{usr:t.state,key:t.key,idx:e}}function Om(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?ro(e):e,state:n,key:e&&e.key||r||lO()}}function Lu({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function ro(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function cO(t,e,n,r={}){let{window:s=document.defaultView,v5Compat:i=!1}=r,a=s.history,o="POP",u=null,l=c();l==null&&(l=0,a.replaceState({...a.state,idx:l},""));function c(){return(a.state||{idx:null}).idx}function d(){o="POP";let w=c(),p=w==null?null:w-l;l=w,u&&u({action:o,location:y.location,delta:p})}function f(w,p){o="PUSH";let b=Om(y.location,w,p);l=c()+1;let _=Aw(b,l),x=y.createHref(b);try{a.pushState(_,"",x)}catch(S){if(S instanceof DOMException&&S.name==="DataCloneError")throw S;s.location.assign(x)}i&&u&&u({action:o,location:y.location,delta:1})}function h(w,p){o="REPLACE";let b=Om(y.location,w,p);l=c();let _=Aw(b,l),x=y.createHref(b);a.replaceState(_,"",x),i&&u&&u({action:o,location:y.location,delta:0})}function m(w){let p=s.location.origin!=="null"?s.location.origin:s.location.href,b=typeof w=="string"?w:Lu(w);return b=b.replace(/ $/,"%20"),Ve(p,`No window.location.(origin|href) available to create URL for href: ${b}`),new URL(b,p)}let y={get action(){return o},get location(){return t(s,a)},listen(w){if(u)throw new Error("A history only accepts one active listener");return s.addEventListener(Ew,d),u=w,()=>{s.removeEventListener(Ew,d),u=null}},createHref(w){return e(s,w)},createURL:m,encodeLocation(w){let p=m(w);return{pathname:p.pathname,search:p.search,hash:p.hash}},push:f,replace:h,go(w){return a.go(w)}};return y}function N2(t,e,n="/"){return dO(t,e,n,!1)}function dO(t,e,n,r){let s=typeof e=="string"?ro(e):e,i=Is(s.pathname||"/",n);if(i==null)return null;let a=I2(t);fO(a);let o=null;for(let u=0;o==null&&u<a.length;++u){let l=SO(i);o=vO(a[u],l,r)}return o}function I2(t,e=[],n=[],r=""){let s=(i,a,o)=>{let u={relativePath:o===void 0?i.path||"":o,caseSensitive:i.caseSensitive===!0,childrenIndex:a,route:i};u.relativePath.startsWith("/")&&(Ve(u.relativePath.startsWith(r),`Absolute route path "${u.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),u.relativePath=u.relativePath.slice(r.length));let l=Wr([r,u.relativePath]),c=n.concat(u);i.children&&i.children.length>0&&(Ve(i.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${l}".`),I2(i.children,e,c,l)),!(i.path==null&&!i.index)&&e.push({path:l,score:wO(l,i.index),routesMeta:c})};return t.forEach((i,a)=>{if(i.path===""||!i.path?.includes("?"))s(i,a);else for(let o of R2(i.path))s(i,a,o)}),e}function R2(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,s=n.endsWith("?"),i=n.replace(/\?$/,"");if(r.length===0)return s?[i,""]:[i];let a=R2(r.join("/")),o=[];return o.push(...a.map(u=>u===""?i:[i,u].join("/"))),s&&o.push(...a),o.map(u=>t.startsWith("/")&&u===""?"/":u)}function fO(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:_O(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var hO=/^:[\w-]+$/,pO=3,mO=2,gO=1,yO=10,bO=-2,Tw=t=>t==="*";function wO(t,e){let n=t.split("/"),r=n.length;return n.some(Tw)&&(r+=bO),e&&(r+=mO),n.filter(s=>!Tw(s)).reduce((s,i)=>s+(hO.test(i)?pO:i===""?gO:yO),r)}function _O(t,e){return t.length===e.length&&t.slice(0,-1).every((r,s)=>r===e[s])?t[t.length-1]-e[e.length-1]:0}function vO(t,e,n=!1){let{routesMeta:r}=t,s={},i="/",a=[];for(let o=0;o<r.length;++o){let u=r[o],l=o===r.length-1,c=i==="/"?e:e.slice(i.length)||"/",d=Td({path:u.relativePath,caseSensitive:u.caseSensitive,end:l},c),f=u.route;if(!d&&l&&n&&!r[r.length-1].route.index&&(d=Td({path:u.relativePath,caseSensitive:u.caseSensitive,end:!1},c)),!d)return null;Object.assign(s,d.params),a.push({params:s,pathname:Wr([i,d.pathname]),pathnameBase:TO(Wr([i,d.pathnameBase])),route:f}),d.pathnameBase!=="/"&&(i=Wr([i,d.pathnameBase]))}return a}function Td(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=xO(t.path,t.caseSensitive,t.end),s=e.match(n);if(!s)return null;let i=s[0],a=i.replace(/(.)\/+$/,"$1"),o=s.slice(1);return{params:r.reduce((l,{paramName:c,isOptional:d},f)=>{if(c==="*"){let m=o[f]||"";a=i.slice(0,i.length-m.length).replace(/(.)\/+$/,"$1")}const h=o[f];return d&&!h?l[c]=void 0:l[c]=(h||"").replace(/%2F/g,"/"),l},{}),pathname:i,pathnameBase:a,pattern:t}}function xO(t,e=!1,n=!0){Nn(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],s="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,u)=>(r.push({paramName:o,isOptional:u!=null}),u?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),s+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?s+="\\/*$":t!==""&&t!=="/"&&(s+="(?:(?=\\/|$))"),[new RegExp(s,e?void 0:"i"),r]}function SO(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return Nn(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function Is(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function kO(t,e="/"){let{pathname:n,search:r="",hash:s=""}=typeof t=="string"?ro(t):t;return{pathname:n?n.startsWith("/")?n:EO(n,e):e,search:CO(r),hash:PO(s)}}function EO(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(s=>{s===".."?n.length>1&&n.pop():s!=="."&&n.push(s)}),n.length>1?n.join("/"):"/"}function Mh(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function AO(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function R0(t){let e=AO(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function j0(t,e,n,r=!1){let s;typeof t=="string"?s=ro(t):(s={...t},Ve(!s.pathname||!s.pathname.includes("?"),Mh("?","pathname","search",s)),Ve(!s.pathname||!s.pathname.includes("#"),Mh("#","pathname","hash",s)),Ve(!s.search||!s.search.includes("#"),Mh("#","search","hash",s)));let i=t===""||s.pathname==="",a=i?"/":s.pathname,o;if(a==null)o=n;else{let d=e.length-1;if(!r&&a.startsWith("..")){let f=a.split("/");for(;f[0]==="..";)f.shift(),d-=1;s.pathname=f.join("/")}o=d>=0?e[d]:"/"}let u=kO(s,o),l=a&&a!=="/"&&a.endsWith("/"),c=(i||a===".")&&n.endsWith("/");return!u.pathname.endsWith("/")&&(l||c)&&(u.pathname+="/"),u}var Wr=t=>t.join("/").replace(/\/\/+/g,"/"),TO=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),CO=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,PO=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function OO(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var j2=["POST","PUT","PATCH","DELETE"];new Set(j2);var NO=["GET",...j2];new Set(NO);var so=v.createContext(null);so.displayName="DataRouter";var xf=v.createContext(null);xf.displayName="DataRouterState";var $2=v.createContext({isTransitioning:!1});$2.displayName="ViewTransition";var IO=v.createContext(new Map);IO.displayName="Fetchers";var RO=v.createContext(null);RO.displayName="Await";var nr=v.createContext(null);nr.displayName="Navigation";var pl=v.createContext(null);pl.displayName="Location";var rr=v.createContext({outlet:null,matches:[],isDataRoute:!1});rr.displayName="Route";var $0=v.createContext(null);$0.displayName="RouteError";function jO(t,{relative:e}={}){Ve(io(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=v.useContext(nr),{hash:s,pathname:i,search:a}=ml(t,{relative:e}),o=i;return n!=="/"&&(o=i==="/"?n:Wr([n,i])),r.createHref({pathname:o,search:a,hash:s})}function io(){return v.useContext(pl)!=null}function ns(){return Ve(io(),"useLocation() may be used only in the context of a <Router> component."),v.useContext(pl).location}var L2="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function M2(t){v.useContext(nr).static||v.useLayoutEffect(t)}function Ii(){let{isDataRoute:t}=v.useContext(rr);return t?ZO():$O()}function $O(){Ve(io(),"useNavigate() may be used only in the context of a <Router> component.");let t=v.useContext(so),{basename:e,navigator:n}=v.useContext(nr),{matches:r}=v.useContext(rr),{pathname:s}=ns(),i=JSON.stringify(R0(r)),a=v.useRef(!1);return M2(()=>{a.current=!0}),v.useCallback((u,l={})=>{if(Nn(a.current,L2),!a.current)return;if(typeof u=="number"){n.go(u);return}let c=j0(u,JSON.parse(i),s,l.relative==="path");t==null&&e!=="/"&&(c.pathname=c.pathname==="/"?e:Wr([e,c.pathname])),(l.replace?n.replace:n.push)(c,l.state,l)},[e,n,i,s,t])}v.createContext(null);function LO(){let{matches:t}=v.useContext(rr),e=t[t.length-1];return e?e.params:{}}function ml(t,{relative:e}={}){let{matches:n}=v.useContext(rr),{pathname:r}=ns(),s=JSON.stringify(R0(n));return v.useMemo(()=>j0(t,JSON.parse(s),r,e==="path"),[t,s,r,e])}function MO(t,e){return D2(t,e)}function D2(t,e,n,r){Ve(io(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:s}=v.useContext(nr),{matches:i}=v.useContext(rr),a=i[i.length-1],o=a?a.params:{},u=a?a.pathname:"/",l=a?a.pathnameBase:"/",c=a&&a.route;{let p=c&&c.path||"";F2(u,!c||p.endsWith("*")||p.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${u}" (under <Route path="${p}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${p}"> to <Route path="${p==="/"?"*":`${p}/*`}">.`)}let d=ns(),f;if(e){let p=typeof e=="string"?ro(e):e;Ve(l==="/"||p.pathname?.startsWith(l),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${l}" but pathname "${p.pathname}" was given in the \`location\` prop.`),f=p}else f=d;let h=f.pathname||"/",m=h;if(l!=="/"){let p=l.replace(/^\//,"").split("/");m="/"+h.replace(/^\//,"").split("/").slice(p.length).join("/")}let y=N2(t,{pathname:m});Nn(c||y!=null,`No routes matched location "${f.pathname}${f.search}${f.hash}" `),Nn(y==null||y[y.length-1].route.element!==void 0||y[y.length-1].route.Component!==void 0||y[y.length-1].route.lazy!==void 0,`Matched leaf route at location "${f.pathname}${f.search}${f.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let w=zO(y&&y.map(p=>Object.assign({},p,{params:Object.assign({},o,p.params),pathname:Wr([l,s.encodeLocation?s.encodeLocation(p.pathname).pathname:p.pathname]),pathnameBase:p.pathnameBase==="/"?l:Wr([l,s.encodeLocation?s.encodeLocation(p.pathnameBase).pathname:p.pathnameBase])})),i,n,r);return e&&w?v.createElement(pl.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...f},navigationType:"POP"}},w):w}function DO(){let t=GO(),e=OO(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",s={padding:"0.5rem",backgroundColor:r},i={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",t),a=v.createElement(v.Fragment,null,v.createElement("p",null," Hey developer "),v.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",v.createElement("code",{style:i},"ErrorBoundary")," or"," ",v.createElement("code",{style:i},"errorElement")," prop on your route.")),v.createElement(v.Fragment,null,v.createElement("h2",null,"Unexpected Application Error!"),v.createElement("h3",{style:{fontStyle:"italic"}},e),n?v.createElement("pre",{style:s},n):null,a)}var FO=v.createElement(DO,null),BO=class extends v.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?v.createElement(rr.Provider,{value:this.props.routeContext},v.createElement($0.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function UO({routeContext:t,match:e,children:n}){let r=v.useContext(so);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),v.createElement(rr.Provider,{value:t},n)}function zO(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let s=t,i=n?.errors;if(i!=null){let u=s.findIndex(l=>l.route.id&&i?.[l.route.id]!==void 0);Ve(u>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(i).join(",")}`),s=s.slice(0,Math.min(s.length,u+1))}let a=!1,o=-1;if(n)for(let u=0;u<s.length;u++){let l=s[u];if((l.route.HydrateFallback||l.route.hydrateFallbackElement)&&(o=u),l.route.id){let{loaderData:c,errors:d}=n,f=l.route.loader&&!c.hasOwnProperty(l.route.id)&&(!d||d[l.route.id]===void 0);if(l.route.lazy||f){a=!0,o>=0?s=s.slice(0,o+1):s=[s[0]];break}}}return s.reduceRight((u,l,c)=>{let d,f=!1,h=null,m=null;n&&(d=i&&l.route.id?i[l.route.id]:void 0,h=l.route.errorElement||FO,a&&(o<0&&c===0?(F2("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),f=!0,m=null):o===c&&(f=!0,m=l.route.hydrateFallbackElement||null)));let y=e.concat(s.slice(0,c+1)),w=()=>{let p;return d?p=h:f?p=m:l.route.Component?p=v.createElement(l.route.Component,null):l.route.element?p=l.route.element:p=u,v.createElement(UO,{match:l,routeContext:{outlet:u,matches:y,isDataRoute:n!=null},children:p})};return n&&(l.route.ErrorBoundary||l.route.errorElement||c===0)?v.createElement(BO,{location:n.location,revalidation:n.revalidation,component:h,error:d,children:w(),routeContext:{outlet:null,matches:y,isDataRoute:!0}}):w()},null)}function L0(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function qO(t){let e=v.useContext(so);return Ve(e,L0(t)),e}function HO(t){let e=v.useContext(xf);return Ve(e,L0(t)),e}function VO(t){let e=v.useContext(rr);return Ve(e,L0(t)),e}function M0(t){let e=VO(t),n=e.matches[e.matches.length-1];return Ve(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function WO(){return M0("useRouteId")}function GO(){let t=v.useContext($0),e=HO("useRouteError"),n=M0("useRouteError");return t!==void 0?t:e.errors?.[n]}function ZO(){let{router:t}=qO("useNavigate"),e=M0("useNavigate"),n=v.useRef(!1);return M2(()=>{n.current=!0}),v.useCallback(async(s,i={})=>{Nn(n.current,L2),n.current&&(typeof s=="number"?t.navigate(s):await t.navigate(s,{fromRouteId:e,...i}))},[t,e])}var Cw={};function F2(t,e,n){!e&&!Cw[t]&&(Cw[t]=!0,Nn(!1,n))}v.memo(JO);function JO({routes:t,future:e,state:n}){return D2(t,void 0,n,e)}function B2({to:t,replace:e,state:n,relative:r}){Ve(io(),"<Navigate> may be used only in the context of a <Router> component.");let{static:s}=v.useContext(nr);Nn(!s,"<Navigate> must not be used on the initial render in a <StaticRouter>. This is a no-op, but you should modify your code so the <Navigate> is only ever rendered in response to some user interaction or state change.");let{matches:i}=v.useContext(rr),{pathname:a}=ns(),o=Ii(),u=j0(t,R0(i),a,r==="path"),l=JSON.stringify(u);return v.useEffect(()=>{o(JSON.parse(l),{replace:e,state:n,relative:r})},[o,l,r,e,n]),null}function ei(t){Ve(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function KO({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:s,static:i=!1}){Ve(!io(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=t.replace(/^\/*/,"/"),o=v.useMemo(()=>({basename:a,navigator:s,static:i,future:{}}),[a,s,i]);typeof n=="string"&&(n=ro(n));let{pathname:u="/",search:l="",hash:c="",state:d=null,key:f="default"}=n,h=v.useMemo(()=>{let m=Is(u,a);return m==null?null:{location:{pathname:m,search:l,hash:c,state:d,key:f},navigationType:r}},[a,u,l,c,d,f,r]);return Nn(h!=null,`<Router basename="${a}"> is not able to match the URL "${u}${l}${c}" because it does not start with the basename, so the <Router> won't render anything.`),h==null?null:v.createElement(nr.Provider,{value:o},v.createElement(pl.Provider,{children:e,value:h}))}function QO({children:t,location:e}){return MO(Nm(t),e)}function Nm(t,e=[]){let n=[];return v.Children.forEach(t,(r,s)=>{if(!v.isValidElement(r))return;let i=[...e,s];if(r.type===v.Fragment){n.push.apply(n,Nm(r.props.children,i));return}Ve(r.type===ei,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Ve(!r.props.index||!r.props.children,"An index route cannot have child routes.");let a={id:r.props.id||i.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(a.children=Nm(r.props.children,i)),n.push(a)}),n}var Uc="get",zc="application/x-www-form-urlencoded";function Sf(t){return t!=null&&typeof t.tagName=="string"}function XO(t){return Sf(t)&&t.tagName.toLowerCase()==="button"}function YO(t){return Sf(t)&&t.tagName.toLowerCase()==="form"}function eN(t){return Sf(t)&&t.tagName.toLowerCase()==="input"}function tN(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function nN(t,e){return t.button===0&&(!e||e==="_self")&&!tN(t)}function Im(t=""){return new URLSearchParams(typeof t=="string"||Array.isArray(t)||t instanceof URLSearchParams?t:Object.keys(t).reduce((e,n)=>{let r=t[n];return e.concat(Array.isArray(r)?r.map(s=>[n,s]):[[n,r]])},[]))}function rN(t,e){let n=Im(t);return e&&e.forEach((r,s)=>{n.has(s)||e.getAll(s).forEach(i=>{n.append(s,i)})}),n}var nc=null;function sN(){if(nc===null)try{new FormData(document.createElement("form"),0),nc=!1}catch{nc=!0}return nc}var iN=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Dh(t){return t!=null&&!iN.has(t)?(Nn(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${zc}"`),null):t}function aN(t,e){let n,r,s,i,a;if(YO(t)){let o=t.getAttribute("action");r=o?Is(o,e):null,n=t.getAttribute("method")||Uc,s=Dh(t.getAttribute("enctype"))||zc,i=new FormData(t)}else if(XO(t)||eN(t)&&(t.type==="submit"||t.type==="image")){let o=t.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let u=t.getAttribute("formaction")||o.getAttribute("action");if(r=u?Is(u,e):null,n=t.getAttribute("formmethod")||o.getAttribute("method")||Uc,s=Dh(t.getAttribute("formenctype"))||Dh(o.getAttribute("enctype"))||zc,i=new FormData(o,t),!sN()){let{name:l,type:c,value:d}=t;if(c==="image"){let f=l?`${l}.`:"";i.append(`${f}x`,"0"),i.append(`${f}y`,"0")}else l&&i.append(l,d)}}else{if(Sf(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=Uc,r=null,s=zc,a=t}return i&&s==="text/plain"&&(a=i,i=void 0),{action:r,method:n.toLowerCase(),encType:s,formData:i,body:a}}function D0(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function oN(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function uN(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function lN(t,e,n){let r=await Promise.all(t.map(async s=>{let i=e.routes[s.route.id];if(i){let a=await oN(i,n);return a.links?a.links():[]}return[]}));return hN(r.flat(1).filter(uN).filter(s=>s.rel==="stylesheet"||s.rel==="preload").map(s=>s.rel==="stylesheet"?{...s,rel:"prefetch",as:"style"}:{...s,rel:"prefetch"}))}function Pw(t,e,n,r,s,i){let a=(u,l)=>n[l]?u.route.id!==n[l].route.id:!0,o=(u,l)=>n[l].pathname!==u.pathname||n[l].route.path?.endsWith("*")&&n[l].params["*"]!==u.params["*"];return i==="assets"?e.filter((u,l)=>a(u,l)||o(u,l)):i==="data"?e.filter((u,l)=>{let c=r.routes[u.route.id];if(!c||!c.hasLoader)return!1;if(a(u,l)||o(u,l))return!0;if(u.route.shouldRevalidate){let d=u.route.shouldRevalidate({currentUrl:new URL(s.pathname+s.search+s.hash,window.origin),currentParams:n[0]?.params||{},nextUrl:new URL(t,window.origin),nextParams:u.params,defaultShouldRevalidate:!0});if(typeof d=="boolean")return d}return!0}):[]}function cN(t,e){return dN(t.map(n=>{let r=e.routes[n.route.id];if(!r)return[];let s=[r.module];return r.imports&&(s=s.concat(r.imports)),s}).flat(1))}function dN(t){return[...new Set(t)]}function fN(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function hN(t,e){let n=new Set;return new Set(e),t.reduce((r,s)=>{let i=JSON.stringify(fN(s));return n.has(i)||(n.add(i),r.push({key:i,link:s})),r},[])}function pN(t){let e=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return e.pathname==="/"?e.pathname="_root.data":e.pathname=`${e.pathname.replace(/\/$/,"")}.data`,e}function mN(){let t=v.useContext(so);return D0(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function gN(){let t=v.useContext(xf);return D0(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var F0=v.createContext(void 0);F0.displayName="FrameworkContext";function U2(){let t=v.useContext(F0);return D0(t,"You must render this element inside a <HydratedRouter> element"),t}function yN(t,e){let n=v.useContext(F0),[r,s]=v.useState(!1),[i,a]=v.useState(!1),{onFocus:o,onBlur:u,onMouseEnter:l,onMouseLeave:c,onTouchStart:d}=e,f=v.useRef(null);v.useEffect(()=>{if(t==="render"&&a(!0),t==="viewport"){let y=p=>{p.forEach(b=>{a(b.isIntersecting)})},w=new IntersectionObserver(y,{threshold:.5});return f.current&&w.observe(f.current),()=>{w.disconnect()}}},[t]),v.useEffect(()=>{if(r){let y=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(y)}}},[r]);let h=()=>{s(!0)},m=()=>{s(!1),a(!1)};return n?t!=="intent"?[i,f,{}]:[i,f,{onFocus:Ro(o,h),onBlur:Ro(u,m),onMouseEnter:Ro(l,h),onMouseLeave:Ro(c,m),onTouchStart:Ro(d,h)}]:[!1,f,{}]}function Ro(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function bN({page:t,...e}){let{router:n}=mN(),r=v.useMemo(()=>N2(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?v.createElement(_N,{page:t,matches:r,...e}):null}function wN(t){let{manifest:e,routeModules:n}=U2(),[r,s]=v.useState([]);return v.useEffect(()=>{let i=!1;return lN(t,e,n).then(a=>{i||s(a)}),()=>{i=!0}},[t,e,n]),r}function _N({page:t,matches:e,...n}){let r=ns(),{manifest:s,routeModules:i}=U2(),{loaderData:a,matches:o}=gN(),u=v.useMemo(()=>Pw(t,e,o,s,r,"data"),[t,e,o,s,r]),l=v.useMemo(()=>Pw(t,e,o,s,r,"assets"),[t,e,o,s,r]),c=v.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let h=new Set,m=!1;if(e.forEach(w=>{let p=s.routes[w.route.id];!p||!p.hasLoader||(!u.some(b=>b.route.id===w.route.id)&&w.route.id in a&&i[w.route.id]?.shouldRevalidate||p.hasClientLoader?m=!0:h.add(w.route.id))}),h.size===0)return[];let y=pN(t);return m&&h.size>0&&y.searchParams.set("_routes",e.filter(w=>h.has(w.route.id)).map(w=>w.route.id).join(",")),[y.pathname+y.search]},[a,r,s,u,e,t,i]),d=v.useMemo(()=>cN(l,s),[l,s]),f=wN(l);return v.createElement(v.Fragment,null,c.map(h=>v.createElement("link",{key:h,rel:"prefetch",as:"fetch",href:h,...n})),d.map(h=>v.createElement("link",{key:h,rel:"modulepreload",href:h,...n})),f.map(({key:h,link:m})=>v.createElement("link",{key:h,...m})))}function vN(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var z2=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{z2&&(window.__reactRouterVersion="7.1.3")}catch{}function xN({basename:t,children:e,window:n}){let r=v.useRef();r.current==null&&(r.current=uO({window:n,v5Compat:!0}));let s=r.current,[i,a]=v.useState({action:s.action,location:s.location}),o=v.useCallback(u=>{v.startTransition(()=>a(u))},[a]);return v.useLayoutEffect(()=>s.listen(o),[s,o]),v.createElement(KO,{basename:t,children:e,location:i.location,navigationType:i.action,navigator:s})}var q2=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,kf=v.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:s,reloadDocument:i,replace:a,state:o,target:u,to:l,preventScrollReset:c,viewTransition:d,...f},h){let{basename:m}=v.useContext(nr),y=typeof l=="string"&&q2.test(l),w,p=!1;if(typeof l=="string"&&y&&(w=l,z2))try{let $=new URL(window.location.href),j=l.startsWith("//")?new URL($.protocol+l):new URL(l),H=Is(j.pathname,m);j.origin===$.origin&&H!=null?l=H+j.search+j.hash:p=!0}catch{Nn(!1,`<Link to="${l}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let b=jO(l,{relative:s}),[_,x,S]=yN(r,f),E=AN(l,{replace:a,state:o,target:u,preventScrollReset:c,relative:s,viewTransition:d});function k($){e&&e($),$.defaultPrevented||E($)}let T=v.createElement("a",{...f,...S,href:w||b,onClick:p||i?e:k,ref:vN(h,x),target:u,"data-discover":!y&&n==="render"?"true":void 0});return _&&!y?v.createElement(v.Fragment,null,T,v.createElement(bN,{page:b})):T});kf.displayName="Link";var SN=v.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:s=!1,style:i,to:a,viewTransition:o,children:u,...l},c){let d=ml(a,{relative:l.relative}),f=ns(),h=v.useContext(xf),{navigator:m,basename:y}=v.useContext(nr),w=h!=null&&NN(d)&&o===!0,p=m.encodeLocation?m.encodeLocation(d).pathname:d.pathname,b=f.pathname,_=h&&h.navigation&&h.navigation.location?h.navigation.location.pathname:null;n||(b=b.toLowerCase(),_=_?_.toLowerCase():null,p=p.toLowerCase()),_&&y&&(_=Is(_,y)||_);const x=p!=="/"&&p.endsWith("/")?p.length-1:p.length;let S=b===p||!s&&b.startsWith(p)&&b.charAt(x)==="/",E=_!=null&&(_===p||!s&&_.startsWith(p)&&_.charAt(p.length)==="/"),k={isActive:S,isPending:E,isTransitioning:w},T=S?e:void 0,$;typeof r=="function"?$=r(k):$=[r,S?"active":null,E?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let j=typeof i=="function"?i(k):i;return v.createElement(kf,{...l,"aria-current":T,className:$,ref:c,style:j,to:a,viewTransition:o},typeof u=="function"?u(k):u)});SN.displayName="NavLink";var kN=v.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:s,state:i,method:a=Uc,action:o,onSubmit:u,relative:l,preventScrollReset:c,viewTransition:d,...f},h)=>{let m=PN(),y=ON(o,{relative:l}),w=a.toLowerCase()==="get"?"get":"post",p=typeof o=="string"&&q2.test(o),b=_=>{if(u&&u(_),_.defaultPrevented)return;_.preventDefault();let x=_.nativeEvent.submitter,S=x?.getAttribute("formmethod")||a;m(x||_.currentTarget,{fetcherKey:e,method:S,navigate:n,replace:s,state:i,relative:l,preventScrollReset:c,viewTransition:d})};return v.createElement("form",{ref:h,method:w,action:y,onSubmit:r?u:b,...f,"data-discover":!p&&t==="render"?"true":void 0})});kN.displayName="Form";function EN(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function H2(t){let e=v.useContext(so);return Ve(e,EN(t)),e}function AN(t,{target:e,replace:n,state:r,preventScrollReset:s,relative:i,viewTransition:a}={}){let o=Ii(),u=ns(),l=ml(t,{relative:i});return v.useCallback(c=>{if(nN(c,e)){c.preventDefault();let d=n!==void 0?n:Lu(u)===Lu(l);o(t,{replace:d,state:r,preventScrollReset:s,relative:i,viewTransition:a})}},[u,o,l,n,r,e,t,s,i,a])}function V2(t){Nn(typeof URLSearchParams<"u","You cannot use the `useSearchParams` hook in a browser that does not support the URLSearchParams API. If you need to support Internet Explorer 11, we recommend you load a polyfill such as https://github.com/ungap/url-search-params.");let e=v.useRef(Im(t)),n=v.useRef(!1),r=ns(),s=v.useMemo(()=>rN(r.search,n.current?null:e.current),[r.search]),i=Ii(),a=v.useCallback((o,u)=>{const l=Im(typeof o=="function"?o(s):o);n.current=!0,i("?"+l,u)},[i,s]);return[s,a]}var TN=0,CN=()=>`__${String(++TN)}__`;function PN(){let{router:t}=H2("useSubmit"),{basename:e}=v.useContext(nr),n=WO();return v.useCallback(async(r,s={})=>{let{action:i,method:a,encType:o,formData:u,body:l}=aN(r,e);if(s.navigate===!1){let c=s.fetcherKey||CN();await t.fetch(c,n,s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:l,formMethod:s.method||a,formEncType:s.encType||o,flushSync:s.flushSync})}else await t.navigate(s.action||i,{preventScrollReset:s.preventScrollReset,formData:u,body:l,formMethod:s.method||a,formEncType:s.encType||o,replace:s.replace,state:s.state,fromRouteId:n,flushSync:s.flushSync,viewTransition:s.viewTransition})},[t,e,n])}function ON(t,{relative:e}={}){let{basename:n}=v.useContext(nr),r=v.useContext(rr);Ve(r,"useFormAction must be used inside a RouteContext");let[s]=r.matches.slice(-1),i={...ml(t||".",{relative:e})},a=ns();if(t==null){i.search=a.search;let o=new URLSearchParams(i.search),u=o.getAll("index");if(u.some(c=>c==="")){o.delete("index"),u.filter(d=>d).forEach(d=>o.append("index",d));let c=o.toString();i.search=c?`?${c}`:""}}return(!t||t===".")&&s.route.index&&(i.search=i.search?i.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(i.pathname=i.pathname==="/"?n:Wr([n,i.pathname])),Lu(i)}function NN(t,e={}){let n=v.useContext($2);Ve(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=H2("useViewTransitionState"),s=ml(t,{relative:e.relative});if(!n.isTransitioning)return!1;let i=Is(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=Is(n.nextLocation.pathname,r)||n.nextLocation.pathname;return Td(s.pathname,a)!=null||Td(s.pathname,i)!=null}new TextEncoder;const IN="modulepreload",RN=function(t){return"/"+t},Ow={},Da=function(e,n,r){let s=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=a?.nonce||a?.getAttribute("nonce");s=Promise.allSettled(n.map(u=>{if(u=RN(u),u in Ow)return;Ow[u]=!0;const l=u.endsWith(".css"),c=l?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${u}"]${c}`))return;const d=document.createElement("link");if(d.rel=l?"stylesheet":IN,l||(d.as="script"),d.crossOrigin="",d.href=u,o&&d.setAttribute("nonce",o),document.head.appendChild(d),l)return new Promise((f,h)=>{d.addEventListener("load",f),d.addEventListener("error",()=>h(new Error(`Unable to preload CSS for ${u}`)))})}))}function i(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return s.then(a=>{for(const o of a||[])o.status==="rejected"&&i(o.reason);return e().catch(i)})},jN=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>ao);return{default:r}},[]).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)};class B0 extends Error{constructor(e,n="FunctionsError",r){super(e),this.name=n,this.context=r}}class $N extends B0{constructor(e){super("Failed to send a request to the Edge Function","FunctionsFetchError",e)}}class LN extends B0{constructor(e){super("Relay Error invoking the Edge Function","FunctionsRelayError",e)}}class MN extends B0{constructor(e){super("Edge Function returned a non-2xx status code","FunctionsHttpError",e)}}var Rm;(function(t){t.Any="any",t.ApNortheast1="ap-northeast-1",t.ApNortheast2="ap-northeast-2",t.ApSouth1="ap-south-1",t.ApSoutheast1="ap-southeast-1",t.ApSoutheast2="ap-southeast-2",t.CaCentral1="ca-central-1",t.EuCentral1="eu-central-1",t.EuWest1="eu-west-1",t.EuWest2="eu-west-2",t.EuWest3="eu-west-3",t.SaEast1="sa-east-1",t.UsEast1="us-east-1",t.UsWest1="us-west-1",t.UsWest2="us-west-2"})(Rm||(Rm={}));var DN=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};class FN{constructor(e,{headers:n={},customFetch:r,region:s=Rm.Any}={}){this.url=e,this.headers=n,this.region=s,this.fetch=jN(r)}setAuth(e){this.headers.Authorization=`Bearer ${e}`}invoke(e,n={}){var r;return DN(this,void 0,void 0,function*(){try{const{headers:s,method:i,body:a}=n;let o={},{region:u}=n;u||(u=this.region),u&&u!=="any"&&(o["x-region"]=u);let l;a&&(s&&!Object.prototype.hasOwnProperty.call(s,"Content-Type")||!s)&&(typeof Blob<"u"&&a instanceof Blob||a instanceof ArrayBuffer?(o["Content-Type"]="application/octet-stream",l=a):typeof a=="string"?(o["Content-Type"]="text/plain",l=a):typeof FormData<"u"&&a instanceof FormData?l=a:(o["Content-Type"]="application/json",l=JSON.stringify(a)));const c=yield this.fetch(`${this.url}/${e}`,{method:i||"POST",headers:Object.assign(Object.assign(Object.assign({},o),this.headers),s),body:l}).catch(m=>{throw new $N(m)}),d=c.headers.get("x-relay-error");if(d&&d==="true")throw new LN(c);if(!c.ok)throw new MN(c);let f=((r=c.headers.get("Content-Type"))!==null&&r!==void 0?r:"text/plain").split(";")[0].trim(),h;return f==="application/json"?h=yield c.json():f==="application/octet-stream"?h=yield c.blob():f==="text/event-stream"?h=c:f==="multipart/form-data"?h=yield c.formData():h=yield c.text(),{data:h,error:null}}catch(s){return{data:null,error:s}}})}}var Zt={},U0={},Ef={},gl={},Af={},Tf={},BN=function(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("unable to locate global object")},Fa=BN();const UN=Fa.fetch,W2=Fa.fetch.bind(Fa),G2=Fa.Headers,zN=Fa.Request,qN=Fa.Response,ao=Object.freeze(Object.defineProperty({__proto__:null,Headers:G2,Request:zN,Response:qN,default:W2,fetch:UN},Symbol.toStringTag,{value:"Module"})),HN=AT(ao);var Cf={};Object.defineProperty(Cf,"__esModule",{value:!0});let VN=class extends Error{constructor(e){super(e.message),this.name="PostgrestError",this.details=e.details,this.hint=e.hint,this.code=e.code}};Cf.default=VN;var Z2=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Tf,"__esModule",{value:!0});const WN=Z2(HN),GN=Z2(Cf);let ZN=class{constructor(e){this.shouldThrowOnError=!1,this.method=e.method,this.url=e.url,this.headers=e.headers,this.schema=e.schema,this.body=e.body,this.shouldThrowOnError=e.shouldThrowOnError,this.signal=e.signal,this.isMaybeSingle=e.isMaybeSingle,e.fetch?this.fetch=e.fetch:typeof fetch>"u"?this.fetch=WN.default:this.fetch=fetch}throwOnError(){return this.shouldThrowOnError=!0,this}setHeader(e,n){return this.headers=Object.assign({},this.headers),this.headers[e]=n,this}then(e,n){this.schema===void 0||(["GET","HEAD"].includes(this.method)?this.headers["Accept-Profile"]=this.schema:this.headers["Content-Profile"]=this.schema),this.method!=="GET"&&this.method!=="HEAD"&&(this.headers["Content-Type"]="application/json");const r=this.fetch;let s=r(this.url.toString(),{method:this.method,headers:this.headers,body:JSON.stringify(this.body),signal:this.signal}).then(async i=>{var a,o,u;let l=null,c=null,d=null,f=i.status,h=i.statusText;if(i.ok){if(this.method!=="HEAD"){const p=await i.text();p===""||(this.headers.Accept==="text/csv"||this.headers.Accept&&this.headers.Accept.includes("application/vnd.pgrst.plan+text")?c=p:c=JSON.parse(p))}const y=(a=this.headers.Prefer)===null||a===void 0?void 0:a.match(/count=(exact|planned|estimated)/),w=(o=i.headers.get("content-range"))===null||o===void 0?void 0:o.split("/");y&&w&&w.length>1&&(d=parseInt(w[1])),this.isMaybeSingle&&this.method==="GET"&&Array.isArray(c)&&(c.length>1?(l={code:"PGRST116",details:`Results contain ${c.length} rows, application/vnd.pgrst.object+json requires 1 row`,hint:null,message:"JSON object requested, multiple (or no) rows returned"},c=null,d=null,f=406,h="Not Acceptable"):c.length===1?c=c[0]:c=null)}else{const y=await i.text();try{l=JSON.parse(y),Array.isArray(l)&&i.status===404&&(c=[],l=null,f=200,h="OK")}catch{i.status===404&&y===""?(f=204,h="No Content"):l={message:y}}if(l&&this.isMaybeSingle&&(!((u=l?.details)===null||u===void 0)&&u.includes("0 rows"))&&(l=null,f=200,h="OK"),l&&this.shouldThrowOnError)throw new GN.default(l)}return{error:l,data:c,count:d,status:f,statusText:h}});return this.shouldThrowOnError||(s=s.catch(i=>{var a,o,u;return{error:{message:`${(a=i?.name)!==null&&a!==void 0?a:"FetchError"}: ${i?.message}`,details:`${(o=i?.stack)!==null&&o!==void 0?o:""}`,hint:"",code:`${(u=i?.code)!==null&&u!==void 0?u:""}`},data:null,count:null,status:0,statusText:""}})),s.then(e,n)}};Tf.default=ZN;var JN=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Af,"__esModule",{value:!0});const KN=JN(Tf);let QN=class extends KN.default{select(e){let n=!1;const r=(e??"*").split("").map(s=>/\s/.test(s)&&!n?"":(s==='"'&&(n=!n),s)).join("");return this.url.searchParams.set("select",r),this.headers.Prefer&&(this.headers.Prefer+=","),this.headers.Prefer+="return=representation",this}order(e,{ascending:n=!0,nullsFirst:r,foreignTable:s,referencedTable:i=s}={}){const a=i?`${i}.order`:"order",o=this.url.searchParams.get(a);return this.url.searchParams.set(a,`${o?`${o},`:""}${e}.${n?"asc":"desc"}${r===void 0?"":r?".nullsfirst":".nullslast"}`),this}limit(e,{foreignTable:n,referencedTable:r=n}={}){const s=typeof r>"u"?"limit":`${r}.limit`;return this.url.searchParams.set(s,`${e}`),this}range(e,n,{foreignTable:r,referencedTable:s=r}={}){const i=typeof s>"u"?"offset":`${s}.offset`,a=typeof s>"u"?"limit":`${s}.limit`;return this.url.searchParams.set(i,`${e}`),this.url.searchParams.set(a,`${n-e+1}`),this}abortSignal(e){return this.signal=e,this}single(){return this.headers.Accept="application/vnd.pgrst.object+json",this}maybeSingle(){return this.method==="GET"?this.headers.Accept="application/json":this.headers.Accept="application/vnd.pgrst.object+json",this.isMaybeSingle=!0,this}csv(){return this.headers.Accept="text/csv",this}geojson(){return this.headers.Accept="application/geo+json",this}explain({analyze:e=!1,verbose:n=!1,settings:r=!1,buffers:s=!1,wal:i=!1,format:a="text"}={}){var o;const u=[e?"analyze":null,n?"verbose":null,r?"settings":null,s?"buffers":null,i?"wal":null].filter(Boolean).join("|"),l=(o=this.headers.Accept)!==null&&o!==void 0?o:"application/json";return this.headers.Accept=`application/vnd.pgrst.plan+${a}; for="${l}"; options=${u};`,a==="json"?this:this}rollback(){var e;return((e=this.headers.Prefer)!==null&&e!==void 0?e:"").trim().length>0?this.headers.Prefer+=",tx=rollback":this.headers.Prefer="tx=rollback",this}returns(){return this}};Af.default=QN;var XN=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(gl,"__esModule",{value:!0});const YN=XN(Af);let eI=class extends YN.default{eq(e,n){return this.url.searchParams.append(e,`eq.${n}`),this}neq(e,n){return this.url.searchParams.append(e,`neq.${n}`),this}gt(e,n){return this.url.searchParams.append(e,`gt.${n}`),this}gte(e,n){return this.url.searchParams.append(e,`gte.${n}`),this}lt(e,n){return this.url.searchParams.append(e,`lt.${n}`),this}lte(e,n){return this.url.searchParams.append(e,`lte.${n}`),this}like(e,n){return this.url.searchParams.append(e,`like.${n}`),this}likeAllOf(e,n){return this.url.searchParams.append(e,`like(all).{${n.join(",")}}`),this}likeAnyOf(e,n){return this.url.searchParams.append(e,`like(any).{${n.join(",")}}`),this}ilike(e,n){return this.url.searchParams.append(e,`ilike.${n}`),this}ilikeAllOf(e,n){return this.url.searchParams.append(e,`ilike(all).{${n.join(",")}}`),this}ilikeAnyOf(e,n){return this.url.searchParams.append(e,`ilike(any).{${n.join(",")}}`),this}is(e,n){return this.url.searchParams.append(e,`is.${n}`),this}in(e,n){const r=Array.from(new Set(n)).map(s=>typeof s=="string"&&new RegExp("[,()]").test(s)?`"${s}"`:`${s}`).join(",");return this.url.searchParams.append(e,`in.(${r})`),this}contains(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cs.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cs.{${n.join(",")}}`):this.url.searchParams.append(e,`cs.${JSON.stringify(n)}`),this}containedBy(e,n){return typeof n=="string"?this.url.searchParams.append(e,`cd.${n}`):Array.isArray(n)?this.url.searchParams.append(e,`cd.{${n.join(",")}}`):this.url.searchParams.append(e,`cd.${JSON.stringify(n)}`),this}rangeGt(e,n){return this.url.searchParams.append(e,`sr.${n}`),this}rangeGte(e,n){return this.url.searchParams.append(e,`nxl.${n}`),this}rangeLt(e,n){return this.url.searchParams.append(e,`sl.${n}`),this}rangeLte(e,n){return this.url.searchParams.append(e,`nxr.${n}`),this}rangeAdjacent(e,n){return this.url.searchParams.append(e,`adj.${n}`),this}overlaps(e,n){return typeof n=="string"?this.url.searchParams.append(e,`ov.${n}`):this.url.searchParams.append(e,`ov.{${n.join(",")}}`),this}textSearch(e,n,{config:r,type:s}={}){let i="";s==="plain"?i="pl":s==="phrase"?i="ph":s==="websearch"&&(i="w");const a=r===void 0?"":`(${r})`;return this.url.searchParams.append(e,`${i}fts${a}.${n}`),this}match(e){return Object.entries(e).forEach(([n,r])=>{this.url.searchParams.append(n,`eq.${r}`)}),this}not(e,n,r){return this.url.searchParams.append(e,`not.${n}.${r}`),this}or(e,{foreignTable:n,referencedTable:r=n}={}){const s=r?`${r}.or`:"or";return this.url.searchParams.append(s,`(${e})`),this}filter(e,n,r){return this.url.searchParams.append(e,`${n}.${r}`),this}};gl.default=eI;var tI=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Ef,"__esModule",{value:!0});const jo=tI(gl);let nI=class{constructor(e,{headers:n={},schema:r,fetch:s}){this.url=e,this.headers=n,this.schema=r,this.fetch=s}select(e,{head:n=!1,count:r}={}){const s=n?"HEAD":"GET";let i=!1;const a=(e??"*").split("").map(o=>/\s/.test(o)&&!i?"":(o==='"'&&(i=!i),o)).join("");return this.url.searchParams.set("select",a),r&&(this.headers.Prefer=`count=${r}`),new jo.default({method:s,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}insert(e,{count:n,defaultToNull:r=!0}={}){const s="POST",i=[];if(this.headers.Prefer&&i.push(this.headers.Prefer),n&&i.push(`count=${n}`),r||i.push("missing=default"),this.headers.Prefer=i.join(","),Array.isArray(e)){const a=e.reduce((o,u)=>o.concat(Object.keys(u)),[]);if(a.length>0){const o=[...new Set(a)].map(u=>`"${u}"`);this.url.searchParams.set("columns",o.join(","))}}return new jo.default({method:s,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}upsert(e,{onConflict:n,ignoreDuplicates:r=!1,count:s,defaultToNull:i=!0}={}){const a="POST",o=[`resolution=${r?"ignore":"merge"}-duplicates`];if(n!==void 0&&this.url.searchParams.set("on_conflict",n),this.headers.Prefer&&o.push(this.headers.Prefer),s&&o.push(`count=${s}`),i||o.push("missing=default"),this.headers.Prefer=o.join(","),Array.isArray(e)){const u=e.reduce((l,c)=>l.concat(Object.keys(c)),[]);if(u.length>0){const l=[...new Set(u)].map(c=>`"${c}"`);this.url.searchParams.set("columns",l.join(","))}}return new jo.default({method:a,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}update(e,{count:n}={}){const r="PATCH",s=[];return this.headers.Prefer&&s.push(this.headers.Prefer),n&&s.push(`count=${n}`),this.headers.Prefer=s.join(","),new jo.default({method:r,url:this.url,headers:this.headers,schema:this.schema,body:e,fetch:this.fetch,allowEmpty:!1})}delete({count:e}={}){const n="DELETE",r=[];return e&&r.push(`count=${e}`),this.headers.Prefer&&r.unshift(this.headers.Prefer),this.headers.Prefer=r.join(","),new jo.default({method:n,url:this.url,headers:this.headers,schema:this.schema,fetch:this.fetch,allowEmpty:!1})}};Ef.default=nI;var Pf={},Of={};Object.defineProperty(Of,"__esModule",{value:!0});Of.version=void 0;Of.version="0.0.0-automated";Object.defineProperty(Pf,"__esModule",{value:!0});Pf.DEFAULT_HEADERS=void 0;const rI=Of;Pf.DEFAULT_HEADERS={"X-Client-Info":`postgrest-js/${rI.version}`};var J2=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(U0,"__esModule",{value:!0});const sI=J2(Ef),iI=J2(gl),aI=Pf;let oI=class K2{constructor(e,{headers:n={},schema:r,fetch:s}={}){this.url=e,this.headers=Object.assign(Object.assign({},aI.DEFAULT_HEADERS),n),this.schemaName=r,this.fetch=s}from(e){const n=new URL(`${this.url}/${e}`);return new sI.default(n,{headers:Object.assign({},this.headers),schema:this.schemaName,fetch:this.fetch})}schema(e){return new K2(this.url,{headers:this.headers,schema:e,fetch:this.fetch})}rpc(e,n={},{head:r=!1,get:s=!1,count:i}={}){let a;const o=new URL(`${this.url}/rpc/${e}`);let u;r||s?(a=r?"HEAD":"GET",Object.entries(n).filter(([c,d])=>d!==void 0).map(([c,d])=>[c,Array.isArray(d)?`{${d.join(",")}}`:`${d}`]).forEach(([c,d])=>{o.searchParams.append(c,d)})):(a="POST",u=n);const l=Object.assign({},this.headers);return i&&(l.Prefer=`count=${i}`),new iI.default({method:a,url:o,headers:l,schema:this.schemaName,body:u,fetch:this.fetch,allowEmpty:!1})}};U0.default=oI;var oo=Pn&&Pn.__importDefault||function(t){return t&&t.__esModule?t:{default:t}};Object.defineProperty(Zt,"__esModule",{value:!0});Zt.PostgrestError=Zt.PostgrestBuilder=Zt.PostgrestTransformBuilder=Zt.PostgrestFilterBuilder=Zt.PostgrestQueryBuilder=Zt.PostgrestClient=void 0;const Q2=oo(U0);Zt.PostgrestClient=Q2.default;const X2=oo(Ef);Zt.PostgrestQueryBuilder=X2.default;const Y2=oo(gl);Zt.PostgrestFilterBuilder=Y2.default;const eS=oo(Af);Zt.PostgrestTransformBuilder=eS.default;const tS=oo(Tf);Zt.PostgrestBuilder=tS.default;const nS=oo(Cf);Zt.PostgrestError=nS.default;var uI=Zt.default={PostgrestClient:Q2.default,PostgrestQueryBuilder:X2.default,PostgrestFilterBuilder:Y2.default,PostgrestTransformBuilder:eS.default,PostgrestBuilder:tS.default,PostgrestError:nS.default};const{PostgrestClient:lI,PostgrestQueryBuilder:wW,PostgrestFilterBuilder:_W,PostgrestTransformBuilder:vW,PostgrestBuilder:xW,PostgrestError:SW}=uI,cI="2.11.2",dI={"X-Client-Info":`realtime-js/${cI}`},fI="1.0.0",rS=1e4,hI=1e3;var xa;(function(t){t[t.connecting=0]="connecting",t[t.open=1]="open",t[t.closing=2]="closing",t[t.closed=3]="closed"})(xa||(xa={}));var an;(function(t){t.closed="closed",t.errored="errored",t.joined="joined",t.joining="joining",t.leaving="leaving"})(an||(an={}));var zn;(function(t){t.close="phx_close",t.error="phx_error",t.join="phx_join",t.reply="phx_reply",t.leave="phx_leave",t.access_token="access_token"})(zn||(zn={}));var jm;(function(t){t.websocket="websocket"})(jm||(jm={}));var ri;(function(t){t.Connecting="connecting",t.Open="open",t.Closing="closing",t.Closed="closed"})(ri||(ri={}));class pI{constructor(){this.HEADER_LENGTH=1}decode(e,n){return e.constructor===ArrayBuffer?n(this._binaryDecode(e)):n(typeof e=="string"?JSON.parse(e):{})}_binaryDecode(e){const n=new DataView(e),r=new TextDecoder;return this._decodeBroadcast(e,n,r)}_decodeBroadcast(e,n,r){const s=n.getUint8(1),i=n.getUint8(2);let a=this.HEADER_LENGTH+2;const o=r.decode(e.slice(a,a+s));a=a+s;const u=r.decode(e.slice(a,a+i));a=a+i;const l=JSON.parse(r.decode(e.slice(a,e.byteLength)));return{ref:null,topic:o,event:u,payload:l}}}class sS{constructor(e,n){this.callback=e,this.timerCalc=n,this.timer=void 0,this.tries=0,this.callback=e,this.timerCalc=n}reset(){this.tries=0,clearTimeout(this.timer)}scheduleTimeout(){clearTimeout(this.timer),this.timer=setTimeout(()=>{this.tries=this.tries+1,this.callback()},this.timerCalc(this.tries+1))}}var Le;(function(t){t.abstime="abstime",t.bool="bool",t.date="date",t.daterange="daterange",t.float4="float4",t.float8="float8",t.int2="int2",t.int4="int4",t.int4range="int4range",t.int8="int8",t.int8range="int8range",t.json="json",t.jsonb="jsonb",t.money="money",t.numeric="numeric",t.oid="oid",t.reltime="reltime",t.text="text",t.time="time",t.timestamp="timestamp",t.timestamptz="timestamptz",t.timetz="timetz",t.tsrange="tsrange",t.tstzrange="tstzrange"})(Le||(Le={}));const Nw=(t,e,n={})=>{var r;const s=(r=n.skipTypes)!==null&&r!==void 0?r:[];return Object.keys(e).reduce((i,a)=>(i[a]=mI(a,t,e,s),i),{})},mI=(t,e,n,r)=>{const s=e.find(o=>o.name===t),i=s?.type,a=n[t];return i&&!r.includes(i)?iS(i,a):$m(a)},iS=(t,e)=>{if(t.charAt(0)==="_"){const n=t.slice(1,t.length);return wI(e,n)}switch(t){case Le.bool:return gI(e);case Le.float4:case Le.float8:case Le.int2:case Le.int4:case Le.int8:case Le.numeric:case Le.oid:return yI(e);case Le.json:case Le.jsonb:return bI(e);case Le.timestamp:return _I(e);case Le.abstime:case Le.date:case Le.daterange:case Le.int4range:case Le.int8range:case Le.money:case Le.reltime:case Le.text:case Le.time:case Le.timestamptz:case Le.timetz:case Le.tsrange:case Le.tstzrange:return $m(e);default:return $m(e)}},$m=t=>t,gI=t=>{switch(t){case"t":return!0;case"f":return!1;default:return t}},yI=t=>{if(typeof t=="string"){const e=parseFloat(t);if(!Number.isNaN(e))return e}return t},bI=t=>{if(typeof t=="string")try{return JSON.parse(t)}catch(e){return console.log(`JSON parse error: ${e}`),t}return t},wI=(t,e)=>{if(typeof t!="string")return t;const n=t.length-1,r=t[n];if(t[0]==="{"&&r==="}"){let i;const a=t.slice(1,n);try{i=JSON.parse("["+a+"]")}catch{i=a?a.split(","):[]}return i.map(o=>iS(e,o))}return t},_I=t=>typeof t=="string"?t.replace(" ","T"):t,aS=t=>{let e=t;return e=e.replace(/^ws/i,"http"),e=e.replace(/(\/socket\/websocket|\/socket|\/websocket)\/?$/i,""),e.replace(/\/+$/,"")};class Fh{constructor(e,n,r={},s=rS){this.channel=e,this.event=n,this.payload=r,this.timeout=s,this.sent=!1,this.timeoutTimer=void 0,this.ref="",this.receivedResp=null,this.recHooks=[],this.refEvent=null}resend(e){this.timeout=e,this._cancelRefEvent(),this.ref="",this.refEvent=null,this.receivedResp=null,this.sent=!1,this.send()}send(){this._hasReceived("timeout")||(this.startTimeout(),this.sent=!0,this.channel.socket.push({topic:this.channel.topic,event:this.event,payload:this.payload,ref:this.ref,join_ref:this.channel._joinRef()}))}updatePayload(e){this.payload=Object.assign(Object.assign({},this.payload),e)}receive(e,n){var r;return this._hasReceived(e)&&n((r=this.receivedResp)===null||r===void 0?void 0:r.response),this.recHooks.push({status:e,callback:n}),this}startTimeout(){if(this.timeoutTimer)return;this.ref=this.channel.socket._makeRef(),this.refEvent=this.channel._replyEventName(this.ref);const e=n=>{this._cancelRefEvent(),this._cancelTimeout(),this.receivedResp=n,this._matchReceive(n)};this.channel._on(this.refEvent,{},e),this.timeoutTimer=setTimeout(()=>{this.trigger("timeout",{})},this.timeout)}trigger(e,n){this.refEvent&&this.channel._trigger(this.refEvent,{status:e,response:n})}destroy(){this._cancelRefEvent(),this._cancelTimeout()}_cancelRefEvent(){this.refEvent&&this.channel._off(this.refEvent,{})}_cancelTimeout(){clearTimeout(this.timeoutTimer),this.timeoutTimer=void 0}_matchReceive({status:e,response:n}){this.recHooks.filter(r=>r.status===e).forEach(r=>r.callback(n))}_hasReceived(e){return this.receivedResp&&this.receivedResp.status===e}}var Iw;(function(t){t.SYNC="sync",t.JOIN="join",t.LEAVE="leave"})(Iw||(Iw={}));class lu{constructor(e,n){this.channel=e,this.state={},this.pendingDiffs=[],this.joinRef=null,this.caller={onJoin:()=>{},onLeave:()=>{},onSync:()=>{}};const r=n?.events||{state:"presence_state",diff:"presence_diff"};this.channel._on(r.state,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.joinRef=this.channel._joinRef(),this.state=lu.syncState(this.state,s,i,a),this.pendingDiffs.forEach(u=>{this.state=lu.syncDiff(this.state,u,i,a)}),this.pendingDiffs=[],o()}),this.channel._on(r.diff,{},s=>{const{onJoin:i,onLeave:a,onSync:o}=this.caller;this.inPendingSyncState()?this.pendingDiffs.push(s):(this.state=lu.syncDiff(this.state,s,i,a),o())}),this.onJoin((s,i,a)=>{this.channel._trigger("presence",{event:"join",key:s,currentPresences:i,newPresences:a})}),this.onLeave((s,i,a)=>{this.channel._trigger("presence",{event:"leave",key:s,currentPresences:i,leftPresences:a})}),this.onSync(()=>{this.channel._trigger("presence",{event:"sync"})})}static syncState(e,n,r,s){const i=this.cloneDeep(e),a=this.transformState(n),o={},u={};return this.map(i,(l,c)=>{a[l]||(u[l]=c)}),this.map(a,(l,c)=>{const d=i[l];if(d){const f=c.map(w=>w.presence_ref),h=d.map(w=>w.presence_ref),m=c.filter(w=>h.indexOf(w.presence_ref)<0),y=d.filter(w=>f.indexOf(w.presence_ref)<0);m.length>0&&(o[l]=m),y.length>0&&(u[l]=y)}else o[l]=c}),this.syncDiff(i,{joins:o,leaves:u},r,s)}static syncDiff(e,n,r,s){const{joins:i,leaves:a}={joins:this.transformState(n.joins),leaves:this.transformState(n.leaves)};return r||(r=()=>{}),s||(s=()=>{}),this.map(i,(o,u)=>{var l;const c=(l=e[o])!==null&&l!==void 0?l:[];if(e[o]=this.cloneDeep(u),c.length>0){const d=e[o].map(h=>h.presence_ref),f=c.filter(h=>d.indexOf(h.presence_ref)<0);e[o].unshift(...f)}r(o,c,u)}),this.map(a,(o,u)=>{let l=e[o];if(!l)return;const c=u.map(d=>d.presence_ref);l=l.filter(d=>c.indexOf(d.presence_ref)<0),e[o]=l,s(o,l,u),l.length===0&&delete e[o]}),e}static map(e,n){return Object.getOwnPropertyNames(e).map(r=>n(r,e[r]))}static transformState(e){return e=this.cloneDeep(e),Object.getOwnPropertyNames(e).reduce((n,r)=>{const s=e[r];return"metas"in s?n[r]=s.metas.map(i=>(i.presence_ref=i.phx_ref,delete i.phx_ref,delete i.phx_ref_prev,i)):n[r]=s,n},{})}static cloneDeep(e){return JSON.parse(JSON.stringify(e))}onJoin(e){this.caller.onJoin=e}onLeave(e){this.caller.onLeave=e}onSync(e){this.caller.onSync=e}inPendingSyncState(){return!this.joinRef||this.joinRef!==this.channel._joinRef()}}var Rw;(function(t){t.ALL="*",t.INSERT="INSERT",t.UPDATE="UPDATE",t.DELETE="DELETE"})(Rw||(Rw={}));var jw;(function(t){t.BROADCAST="broadcast",t.PRESENCE="presence",t.POSTGRES_CHANGES="postgres_changes",t.SYSTEM="system"})(jw||(jw={}));var Dr;(function(t){t.SUBSCRIBED="SUBSCRIBED",t.TIMED_OUT="TIMED_OUT",t.CLOSED="CLOSED",t.CHANNEL_ERROR="CHANNEL_ERROR"})(Dr||(Dr={}));class z0{constructor(e,n={config:{}},r){this.topic=e,this.params=n,this.socket=r,this.bindings={},this.state=an.closed,this.joinedOnce=!1,this.pushBuffer=[],this.subTopic=e.replace(/^realtime:/i,""),this.params.config=Object.assign({broadcast:{ack:!1,self:!1},presence:{key:""},private:!1},n.config),this.timeout=this.socket.timeout,this.joinPush=new Fh(this,zn.join,this.params,this.timeout),this.rejoinTimer=new sS(()=>this._rejoinUntilConnected(),this.socket.reconnectAfterMs),this.joinPush.receive("ok",()=>{this.state=an.joined,this.rejoinTimer.reset(),this.pushBuffer.forEach(s=>s.send()),this.pushBuffer=[]}),this._onClose(()=>{this.rejoinTimer.reset(),this.socket.log("channel",`close ${this.topic} ${this._joinRef()}`),this.state=an.closed,this.socket._remove(this)}),this._onError(s=>{this._isLeaving()||this._isClosed()||(this.socket.log("channel",`error ${this.topic}`,s),this.state=an.errored,this.rejoinTimer.scheduleTimeout())}),this.joinPush.receive("timeout",()=>{this._isJoining()&&(this.socket.log("channel",`timeout ${this.topic}`,this.joinPush.timeout),this.state=an.errored,this.rejoinTimer.scheduleTimeout())}),this._on(zn.reply,{},(s,i)=>{this._trigger(this._replyEventName(i),s)}),this.presence=new lu(this),this.broadcastEndpointURL=aS(this.socket.endPoint)+"/api/broadcast",this.private=this.params.config.private||!1}subscribe(e,n=this.timeout){var r,s;if(this.socket.isConnected()||this.socket.connect(),this.joinedOnce)throw"tried to subscribe multiple times. 'subscribe' can only be called a single time per channel instance";{const{config:{broadcast:i,presence:a,private:o}}=this.params;this._onError(c=>e?.(Dr.CHANNEL_ERROR,c)),this._onClose(()=>e?.(Dr.CLOSED));const u={},l={broadcast:i,presence:a,postgres_changes:(s=(r=this.bindings.postgres_changes)===null||r===void 0?void 0:r.map(c=>c.filter))!==null&&s!==void 0?s:[],private:o};this.socket.accessTokenValue&&(u.access_token=this.socket.accessTokenValue),this.updateJoinPayload(Object.assign({config:l},u)),this.joinedOnce=!0,this._rejoin(n),this.joinPush.receive("ok",async({postgres_changes:c})=>{var d;if(this.socket.setAuth(),c===void 0){e?.(Dr.SUBSCRIBED);return}else{const f=this.bindings.postgres_changes,h=(d=f?.length)!==null&&d!==void 0?d:0,m=[];for(let y=0;y<h;y++){const w=f[y],{filter:{event:p,schema:b,table:_,filter:x}}=w,S=c&&c[y];if(S&&S.event===p&&S.schema===b&&S.table===_&&S.filter===x)m.push(Object.assign(Object.assign({},w),{id:S.id}));else{this.unsubscribe(),e?.(Dr.CHANNEL_ERROR,new Error("mismatch between server and client bindings for postgres changes"));return}}this.bindings.postgres_changes=m,e&&e(Dr.SUBSCRIBED);return}}).receive("error",c=>{e?.(Dr.CHANNEL_ERROR,new Error(JSON.stringify(Object.values(c).join(", ")||"error")))}).receive("timeout",()=>{e?.(Dr.TIMED_OUT)})}return this}presenceState(){return this.presence.state}async track(e,n={}){return await this.send({type:"presence",event:"track",payload:e},n.timeout||this.timeout)}async untrack(e={}){return await this.send({type:"presence",event:"untrack"},e)}on(e,n,r){return this._on(e,n,r)}async send(e,n={}){var r,s;if(!this._canPush()&&e.type==="broadcast"){const{event:i,payload:a}=e,u={method:"POST",headers:{Authorization:this.socket.accessTokenValue?`Bearer ${this.socket.accessTokenValue}`:"",apikey:this.socket.apiKey?this.socket.apiKey:"","Content-Type":"application/json"},body:JSON.stringify({messages:[{topic:this.subTopic,event:i,payload:a,private:this.private}]})};try{const l=await this._fetchWithTimeout(this.broadcastEndpointURL,u,(r=n.timeout)!==null&&r!==void 0?r:this.timeout);return await((s=l.body)===null||s===void 0?void 0:s.cancel()),l.ok?"ok":"error"}catch(l){return l.name==="AbortError"?"timed out":"error"}}else return new Promise(i=>{var a,o,u;const l=this._push(e.type,e,n.timeout||this.timeout);e.type==="broadcast"&&!(!((u=(o=(a=this.params)===null||a===void 0?void 0:a.config)===null||o===void 0?void 0:o.broadcast)===null||u===void 0)&&u.ack)&&i("ok"),l.receive("ok",()=>i("ok")),l.receive("error",()=>i("error")),l.receive("timeout",()=>i("timed out"))})}updateJoinPayload(e){this.joinPush.updatePayload(e)}unsubscribe(e=this.timeout){this.state=an.leaving;const n=()=>{this.socket.log("channel",`leave ${this.topic}`),this._trigger(zn.close,"leave",this._joinRef())};return this.rejoinTimer.reset(),this.joinPush.destroy(),new Promise(r=>{const s=new Fh(this,zn.leave,{},e);s.receive("ok",()=>{n(),r("ok")}).receive("timeout",()=>{n(),r("timed out")}).receive("error",()=>{r("error")}),s.send(),this._canPush()||s.trigger("ok",{})})}async _fetchWithTimeout(e,n,r){const s=new AbortController,i=setTimeout(()=>s.abort(),r),a=await this.socket.fetch(e,Object.assign(Object.assign({},n),{signal:s.signal}));return clearTimeout(i),a}_push(e,n,r=this.timeout){if(!this.joinedOnce)throw`tried to push '${e}' to '${this.topic}' before joining. Use channel.subscribe() before pushing events`;let s=new Fh(this,e,n,r);return this._canPush()?s.send():(s.startTimeout(),this.pushBuffer.push(s)),s}_onMessage(e,n,r){return n}_isMember(e){return this.topic===e}_joinRef(){return this.joinPush.ref}_trigger(e,n,r){var s,i;const a=e.toLocaleLowerCase(),{close:o,error:u,leave:l,join:c}=zn;if(r&&[o,u,l,c].indexOf(a)>=0&&r!==this._joinRef())return;let f=this._onMessage(a,n,r);if(n&&!f)throw"channel onMessage callbacks must return the payload, modified or unmodified";["insert","update","delete"].includes(a)?(s=this.bindings.postgres_changes)===null||s===void 0||s.filter(h=>{var m,y,w;return((m=h.filter)===null||m===void 0?void 0:m.event)==="*"||((w=(y=h.filter)===null||y===void 0?void 0:y.event)===null||w===void 0?void 0:w.toLocaleLowerCase())===a}).map(h=>h.callback(f,r)):(i=this.bindings[a])===null||i===void 0||i.filter(h=>{var m,y,w,p,b,_;if(["broadcast","presence","postgres_changes"].includes(a))if("id"in h){const x=h.id,S=(m=h.filter)===null||m===void 0?void 0:m.event;return x&&((y=n.ids)===null||y===void 0?void 0:y.includes(x))&&(S==="*"||S?.toLocaleLowerCase()===((w=n.data)===null||w===void 0?void 0:w.type.toLocaleLowerCase()))}else{const x=(b=(p=h?.filter)===null||p===void 0?void 0:p.event)===null||b===void 0?void 0:b.toLocaleLowerCase();return x==="*"||x===((_=n?.event)===null||_===void 0?void 0:_.toLocaleLowerCase())}else return h.type.toLocaleLowerCase()===a}).map(h=>{if(typeof f=="object"&&"ids"in f){const m=f.data,{schema:y,table:w,commit_timestamp:p,type:b,errors:_}=m;f=Object.assign(Object.assign({},{schema:y,table:w,commit_timestamp:p,eventType:b,new:{},old:{},errors:_}),this._getPayloadRecords(m))}h.callback(f,r)})}_isClosed(){return this.state===an.closed}_isJoined(){return this.state===an.joined}_isJoining(){return this.state===an.joining}_isLeaving(){return this.state===an.leaving}_replyEventName(e){return`chan_reply_${e}`}_on(e,n,r){const s=e.toLocaleLowerCase(),i={type:s,filter:n,callback:r};return this.bindings[s]?this.bindings[s].push(i):this.bindings[s]=[i],this}_off(e,n){const r=e.toLocaleLowerCase();return this.bindings[r]=this.bindings[r].filter(s=>{var i;return!(((i=s.type)===null||i===void 0?void 0:i.toLocaleLowerCase())===r&&z0.isEqual(s.filter,n))}),this}static isEqual(e,n){if(Object.keys(e).length!==Object.keys(n).length)return!1;for(const r in e)if(e[r]!==n[r])return!1;return!0}_rejoinUntilConnected(){this.rejoinTimer.scheduleTimeout(),this.socket.isConnected()&&this._rejoin()}_onClose(e){this._on(zn.close,{},e)}_onError(e){this._on(zn.error,{},n=>e(n))}_canPush(){return this.socket.isConnected()&&this._isJoined()}_rejoin(e=this.timeout){this._isLeaving()||(this.socket._leaveOpenTopic(this.topic),this.state=an.joining,this.joinPush.resend(e))}_getPayloadRecords(e){const n={new:{},old:{}};return(e.type==="INSERT"||e.type==="UPDATE")&&(n.new=Nw(e.columns,e.record)),(e.type==="UPDATE"||e.type==="DELETE")&&(n.old=Nw(e.columns,e.old_record)),n}}const vI=()=>{},xI=typeof WebSocket<"u",SI=`
  addEventListener("message", (e) => {
    if (e.data.event === "start") {
      setInterval(() => postMessage({ event: "keepAlive" }), e.data.interval);
    }
  });`;class kI{constructor(e,n){var r;this.accessTokenValue=null,this.apiKey=null,this.channels=[],this.endPoint="",this.httpEndpoint="",this.headers=dI,this.params={},this.timeout=rS,this.heartbeatIntervalMs=3e4,this.heartbeatTimer=void 0,this.pendingHeartbeatRef=null,this.ref=0,this.logger=vI,this.conn=null,this.sendBuffer=[],this.serializer=new pI,this.stateChangeCallbacks={open:[],close:[],error:[],message:[]},this.accessToken=null,this._resolveFetch=i=>{let a;return i?a=i:typeof fetch>"u"?a=(...o)=>Da(async()=>{const{default:u}=await Promise.resolve().then(()=>ao);return{default:u}},void 0).then(({default:u})=>u(...o)):a=fetch,(...o)=>a(...o)},this.endPoint=`${e}/${jm.websocket}`,this.httpEndpoint=aS(e),n?.transport?this.transport=n.transport:this.transport=null,n?.params&&(this.params=n.params),n?.headers&&(this.headers=Object.assign(Object.assign({},this.headers),n.headers)),n?.timeout&&(this.timeout=n.timeout),n?.logger&&(this.logger=n.logger),n?.heartbeatIntervalMs&&(this.heartbeatIntervalMs=n.heartbeatIntervalMs);const s=(r=n?.params)===null||r===void 0?void 0:r.apikey;if(s&&(this.accessTokenValue=s,this.apiKey=s),this.reconnectAfterMs=n?.reconnectAfterMs?n.reconnectAfterMs:i=>[1e3,2e3,5e3,1e4][i-1]||1e4,this.encode=n?.encode?n.encode:(i,a)=>a(JSON.stringify(i)),this.decode=n?.decode?n.decode:this.serializer.decode.bind(this.serializer),this.reconnectTimer=new sS(async()=>{this.disconnect(),this.connect()},this.reconnectAfterMs),this.fetch=this._resolveFetch(n?.fetch),n?.worker){if(typeof window<"u"&&!window.Worker)throw new Error("Web Worker is not supported");this.worker=n?.worker||!1,this.workerUrl=n?.workerUrl}this.accessToken=n?.accessToken||null}connect(){if(!this.conn){if(this.transport){this.conn=new this.transport(this.endpointURL(),void 0,{headers:this.headers});return}if(xI){this.conn=new WebSocket(this.endpointURL()),this.setupConnection();return}this.conn=new EI(this.endpointURL(),void 0,{close:()=>{this.conn=null}}),Da(async()=>{const{default:e}=await import("./browser-CKtmAn4K.js").then(n=>n.b);return{default:e}},[]).then(({default:e})=>{this.conn=new e(this.endpointURL(),void 0,{headers:this.headers}),this.setupConnection()})}}endpointURL(){return this._appendParams(this.endPoint,Object.assign({},this.params,{vsn:fI}))}disconnect(e,n){this.conn&&(this.conn.onclose=function(){},e?this.conn.close(e,n??""):this.conn.close(),this.conn=null,this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.reset())}getChannels(){return this.channels}async removeChannel(e){const n=await e.unsubscribe();return this.channels.length===0&&this.disconnect(),n}async removeAllChannels(){const e=await Promise.all(this.channels.map(n=>n.unsubscribe()));return this.disconnect(),e}log(e,n,r){this.logger(e,n,r)}connectionState(){switch(this.conn&&this.conn.readyState){case xa.connecting:return ri.Connecting;case xa.open:return ri.Open;case xa.closing:return ri.Closing;default:return ri.Closed}}isConnected(){return this.connectionState()===ri.Open}channel(e,n={config:{}}){const r=new z0(`realtime:${e}`,n,this);return this.channels.push(r),r}push(e){const{topic:n,event:r,payload:s,ref:i}=e,a=()=>{this.encode(e,o=>{var u;(u=this.conn)===null||u===void 0||u.send(o)})};this.log("push",`${n} ${r} (${i})`,s),this.isConnected()?a():this.sendBuffer.push(a)}async setAuth(e=null){let n=e||this.accessToken&&await this.accessToken()||this.accessTokenValue;if(n){let r=null;try{r=JSON.parse(atob(n.split(".")[1]))}catch{}if(r&&r.exp&&!(Math.floor(Date.now()/1e3)-r.exp<0))return this.log("auth",`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`),Promise.reject(`InvalidJWTToken: Invalid value for JWT claim "exp" with value ${r.exp}`);this.accessTokenValue=n,this.channels.forEach(s=>{n&&s.updateJoinPayload({access_token:n}),s.joinedOnce&&s._isJoined()&&s._push(zn.access_token,{access_token:n})})}}async sendHeartbeat(){var e;if(this.isConnected()){if(this.pendingHeartbeatRef){this.pendingHeartbeatRef=null,this.log("transport","heartbeat timeout. Attempting to re-establish connection"),(e=this.conn)===null||e===void 0||e.close(hI,"hearbeat timeout");return}this.pendingHeartbeatRef=this._makeRef(),this.push({topic:"phoenix",event:"heartbeat",payload:{},ref:this.pendingHeartbeatRef}),this.setAuth()}}flushSendBuffer(){this.isConnected()&&this.sendBuffer.length>0&&(this.sendBuffer.forEach(e=>e()),this.sendBuffer=[])}_makeRef(){let e=this.ref+1;return e===this.ref?this.ref=0:this.ref=e,this.ref.toString()}_leaveOpenTopic(e){let n=this.channels.find(r=>r.topic===e&&(r._isJoined()||r._isJoining()));n&&(this.log("transport",`leaving duplicate topic "${e}"`),n.unsubscribe())}_remove(e){this.channels=this.channels.filter(n=>n._joinRef()!==e._joinRef())}setupConnection(){this.conn&&(this.conn.binaryType="arraybuffer",this.conn.onopen=()=>this._onConnOpen(),this.conn.onerror=e=>this._onConnError(e),this.conn.onmessage=e=>this._onConnMessage(e),this.conn.onclose=e=>this._onConnClose(e))}_onConnMessage(e){this.decode(e.data,n=>{let{topic:r,event:s,payload:i,ref:a}=n;a&&a===this.pendingHeartbeatRef&&(this.pendingHeartbeatRef=null),this.log("receive",`${i.status||""} ${r} ${s} ${a&&"("+a+")"||""}`,i),this.channels.filter(o=>o._isMember(r)).forEach(o=>o._trigger(s,i,a)),this.stateChangeCallbacks.message.forEach(o=>o(n))})}async _onConnOpen(){if(this.log("transport",`connected to ${this.endpointURL()}`),this.flushSendBuffer(),this.reconnectTimer.reset(),!this.worker)this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.heartbeatTimer=setInterval(()=>this.sendHeartbeat(),this.heartbeatIntervalMs);else{this.workerUrl?this.log("worker",`starting worker for from ${this.workerUrl}`):this.log("worker","starting default worker");const e=this._workerObjectUrl(this.workerUrl);this.workerRef=new Worker(e),this.workerRef.onerror=n=>{this.log("worker","worker error",n.message),this.workerRef.terminate()},this.workerRef.onmessage=n=>{n.data.event==="keepAlive"&&this.sendHeartbeat()},this.workerRef.postMessage({event:"start",interval:this.heartbeatIntervalMs})}this.stateChangeCallbacks.open.forEach(e=>e())}_onConnClose(e){this.log("transport","close",e),this._triggerChanError(),this.heartbeatTimer&&clearInterval(this.heartbeatTimer),this.reconnectTimer.scheduleTimeout(),this.stateChangeCallbacks.close.forEach(n=>n(e))}_onConnError(e){this.log("transport",e.message),this._triggerChanError(),this.stateChangeCallbacks.error.forEach(n=>n(e))}_triggerChanError(){this.channels.forEach(e=>e._trigger(zn.error))}_appendParams(e,n){if(Object.keys(n).length===0)return e;const r=e.match(/\?/)?"&":"?",s=new URLSearchParams(n);return`${e}${r}${s}`}_workerObjectUrl(e){let n;if(e)n=e;else{const r=new Blob([SI],{type:"application/javascript"});n=URL.createObjectURL(r)}return n}}class EI{constructor(e,n,r){this.binaryType="arraybuffer",this.onclose=()=>{},this.onerror=()=>{},this.onmessage=()=>{},this.onopen=()=>{},this.readyState=xa.connecting,this.send=()=>{},this.url=null,this.url=e,this.close=r.close}}class q0 extends Error{constructor(e){super(e),this.__isStorageError=!0,this.name="StorageError"}}function pt(t){return typeof t=="object"&&t!==null&&"__isStorageError"in t}class AI extends q0{constructor(e,n){super(e),this.name="StorageApiError",this.status=n}toJSON(){return{name:this.name,message:this.message,status:this.status}}}class Lm extends q0{constructor(e,n){super(e),this.name="StorageUnknownError",this.originalError=n}}var TI=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};const oS=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>ao);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},CI=()=>TI(void 0,void 0,void 0,function*(){return typeof Response>"u"?(yield Da(()=>Promise.resolve().then(()=>ao),void 0)).Response:Response}),Mm=t=>{if(Array.isArray(t))return t.map(n=>Mm(n));if(typeof t=="function"||t!==Object(t))return t;const e={};return Object.entries(t).forEach(([n,r])=>{const s=n.replace(/([-_][a-z])/gi,i=>i.toUpperCase().replace(/[-_]/g,""));e[s]=Mm(r)}),e};var Ri=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};const Bh=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),PI=(t,e,n)=>Ri(void 0,void 0,void 0,function*(){const r=yield CI();t instanceof r&&!n?.noResolveJson?t.json().then(s=>{e(new AI(Bh(s),t.status||500))}).catch(s=>{e(new Lm(Bh(s),s))}):e(new Lm(Bh(t),t))}),OI=(t,e,n,r)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json"},e?.headers),r&&(s.body=JSON.stringify(r)),Object.assign(Object.assign({},s),n))};function yl(t,e,n,r,s,i){return Ri(this,void 0,void 0,function*(){return new Promise((a,o)=>{t(n,OI(e,r,s,i)).then(u=>{if(!u.ok)throw u;return r?.noResolveJson?u:u.json()}).then(u=>a(u)).catch(u=>PI(u,o,r))})})}function Cd(t,e,n,r){return Ri(this,void 0,void 0,function*(){return yl(t,"GET",e,n,r)})}function ps(t,e,n,r,s){return Ri(this,void 0,void 0,function*(){return yl(t,"POST",e,r,s,n)})}function NI(t,e,n,r,s){return Ri(this,void 0,void 0,function*(){return yl(t,"PUT",e,r,s,n)})}function II(t,e,n,r){return Ri(this,void 0,void 0,function*(){return yl(t,"HEAD",e,Object.assign(Object.assign({},n),{noResolveJson:!0}),r)})}function uS(t,e,n,r,s){return Ri(this,void 0,void 0,function*(){return yl(t,"DELETE",e,r,s,n)})}var qt=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};const RI={limit:100,offset:0,sortBy:{column:"name",order:"asc"}},$w={cacheControl:"3600",contentType:"text/plain;charset=UTF-8",upsert:!1};class jI{constructor(e,n={},r,s){this.url=e,this.headers=n,this.bucketId=r,this.fetch=oS(s)}uploadOrUpdate(e,n,r,s){return qt(this,void 0,void 0,function*(){try{let i;const a=Object.assign(Object.assign({},$w),s);let o=Object.assign(Object.assign({},this.headers),e==="POST"&&{"x-upsert":String(a.upsert)});const u=a.metadata;typeof Blob<"u"&&r instanceof Blob?(i=new FormData,i.append("cacheControl",a.cacheControl),u&&i.append("metadata",this.encodeMetadata(u)),i.append("",r)):typeof FormData<"u"&&r instanceof FormData?(i=r,i.append("cacheControl",a.cacheControl),u&&i.append("metadata",this.encodeMetadata(u))):(i=r,o["cache-control"]=`max-age=${a.cacheControl}`,o["content-type"]=a.contentType,u&&(o["x-metadata"]=this.toBase64(this.encodeMetadata(u)))),s?.headers&&(o=Object.assign(Object.assign({},o),s.headers));const l=this._removeEmptyFolders(n),c=this._getFinalPath(l),d=yield this.fetch(`${this.url}/object/${c}`,Object.assign({method:e,body:i,headers:o},a?.duplex?{duplex:a.duplex}:{})),f=yield d.json();return d.ok?{data:{path:l,id:f.Id,fullPath:f.Key},error:null}:{data:null,error:f}}catch(i){if(pt(i))return{data:null,error:i};throw i}})}upload(e,n,r){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("POST",e,n,r)})}uploadToSignedUrl(e,n,r,s){return qt(this,void 0,void 0,function*(){const i=this._removeEmptyFolders(e),a=this._getFinalPath(i),o=new URL(this.url+`/object/upload/sign/${a}`);o.searchParams.set("token",n);try{let u;const l=Object.assign({upsert:$w.upsert},s),c=Object.assign(Object.assign({},this.headers),{"x-upsert":String(l.upsert)});typeof Blob<"u"&&r instanceof Blob?(u=new FormData,u.append("cacheControl",l.cacheControl),u.append("",r)):typeof FormData<"u"&&r instanceof FormData?(u=r,u.append("cacheControl",l.cacheControl)):(u=r,c["cache-control"]=`max-age=${l.cacheControl}`,c["content-type"]=l.contentType);const d=yield this.fetch(o.toString(),{method:"PUT",body:u,headers:c}),f=yield d.json();return d.ok?{data:{path:i,fullPath:f.Key},error:null}:{data:null,error:f}}catch(u){if(pt(u))return{data:null,error:u};throw u}})}createSignedUploadUrl(e,n){return qt(this,void 0,void 0,function*(){try{let r=this._getFinalPath(e);const s=Object.assign({},this.headers);n?.upsert&&(s["x-upsert"]="true");const i=yield ps(this.fetch,`${this.url}/object/upload/sign/${r}`,{},{headers:s}),a=new URL(this.url+i.url),o=a.searchParams.get("token");if(!o)throw new q0("No token returned by API");return{data:{signedUrl:a.toString(),path:e,token:o},error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}update(e,n,r){return qt(this,void 0,void 0,function*(){return this.uploadOrUpdate("PUT",e,n,r)})}move(e,n,r){return qt(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/object/move`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:this.headers}),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}copy(e,n,r){return qt(this,void 0,void 0,function*(){try{return{data:{path:(yield ps(this.fetch,`${this.url}/object/copy`,{bucketId:this.bucketId,sourceKey:e,destinationKey:n,destinationBucket:r?.destinationBucket},{headers:this.headers})).Key},error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}createSignedUrl(e,n,r){return qt(this,void 0,void 0,function*(){try{let s=this._getFinalPath(e),i=yield ps(this.fetch,`${this.url}/object/sign/${s}`,Object.assign({expiresIn:n},r?.transform?{transform:r.transform}:{}),{headers:this.headers});const a=r?.download?`&download=${r.download===!0?"":r.download}`:"";return i={signedUrl:encodeURI(`${this.url}${i.signedURL}${a}`)},{data:i,error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}createSignedUrls(e,n,r){return qt(this,void 0,void 0,function*(){try{const s=yield ps(this.fetch,`${this.url}/object/sign/${this.bucketId}`,{expiresIn:n,paths:e},{headers:this.headers}),i=r?.download?`&download=${r.download===!0?"":r.download}`:"";return{data:s.map(a=>Object.assign(Object.assign({},a),{signedUrl:a.signedURL?encodeURI(`${this.url}${a.signedURL}${i}`):null})),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}download(e,n){return qt(this,void 0,void 0,function*(){const s=typeof n?.transform<"u"?"render/image/authenticated":"object",i=this.transformOptsToQueryString(n?.transform||{}),a=i?`?${i}`:"";try{const o=this._getFinalPath(e);return{data:yield(yield Cd(this.fetch,`${this.url}/${s}/${o}${a}`,{headers:this.headers,noResolveJson:!0})).blob(),error:null}}catch(o){if(pt(o))return{data:null,error:o};throw o}})}info(e){return qt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{const r=yield Cd(this.fetch,`${this.url}/object/info/${n}`,{headers:this.headers});return{data:Mm(r),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}exists(e){return qt(this,void 0,void 0,function*(){const n=this._getFinalPath(e);try{return yield II(this.fetch,`${this.url}/object/${n}`,{headers:this.headers}),{data:!0,error:null}}catch(r){if(pt(r)&&r instanceof Lm){const s=r.originalError;if([400,404].includes(s?.status))return{data:!1,error:r}}throw r}})}getPublicUrl(e,n){const r=this._getFinalPath(e),s=[],i=n?.download?`download=${n.download===!0?"":n.download}`:"";i!==""&&s.push(i);const o=typeof n?.transform<"u"?"render/image":"object",u=this.transformOptsToQueryString(n?.transform||{});u!==""&&s.push(u);let l=s.join("&");return l!==""&&(l=`?${l}`),{data:{publicUrl:encodeURI(`${this.url}/${o}/public/${r}${l}`)}}}remove(e){return qt(this,void 0,void 0,function*(){try{return{data:yield uS(this.fetch,`${this.url}/object/${this.bucketId}`,{prefixes:e},{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}list(e,n,r){return qt(this,void 0,void 0,function*(){try{const s=Object.assign(Object.assign(Object.assign({},RI),n),{prefix:e||""});return{data:yield ps(this.fetch,`${this.url}/object/list/${this.bucketId}`,s,{headers:this.headers},r),error:null}}catch(s){if(pt(s))return{data:null,error:s};throw s}})}encodeMetadata(e){return JSON.stringify(e)}toBase64(e){return typeof Buffer<"u"?Buffer.from(e).toString("base64"):btoa(e)}_getFinalPath(e){return`${this.bucketId}/${e}`}_removeEmptyFolders(e){return e.replace(/^\/|\/$/g,"").replace(/\/+/g,"/")}transformOptsToQueryString(e){const n=[];return e.width&&n.push(`width=${e.width}`),e.height&&n.push(`height=${e.height}`),e.resize&&n.push(`resize=${e.resize}`),e.format&&n.push(`format=${e.format}`),e.quality&&n.push(`quality=${e.quality}`),n.join("&")}}const $I="2.7.1",LI={"X-Client-Info":`storage-js/${$I}`};var Di=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};class MI{constructor(e,n={},r){this.url=e,this.headers=Object.assign(Object.assign({},LI),n),this.fetch=oS(r)}listBuckets(){return Di(this,void 0,void 0,function*(){try{return{data:yield Cd(this.fetch,`${this.url}/bucket`,{headers:this.headers}),error:null}}catch(e){if(pt(e))return{data:null,error:e};throw e}})}getBucket(e){return Di(this,void 0,void 0,function*(){try{return{data:yield Cd(this.fetch,`${this.url}/bucket/${e}`,{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}createBucket(e,n={public:!1}){return Di(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}updateBucket(e,n){return Di(this,void 0,void 0,function*(){try{return{data:yield NI(this.fetch,`${this.url}/bucket/${e}`,{id:e,name:e,public:n.public,file_size_limit:n.fileSizeLimit,allowed_mime_types:n.allowedMimeTypes},{headers:this.headers}),error:null}}catch(r){if(pt(r))return{data:null,error:r};throw r}})}emptyBucket(e){return Di(this,void 0,void 0,function*(){try{return{data:yield ps(this.fetch,`${this.url}/bucket/${e}/empty`,{},{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}deleteBucket(e){return Di(this,void 0,void 0,function*(){try{return{data:yield uS(this.fetch,`${this.url}/bucket/${e}`,{},{headers:this.headers}),error:null}}catch(n){if(pt(n))return{data:null,error:n};throw n}})}}class DI extends MI{constructor(e,n={},r){super(e,n,r)}from(e){return new jI(this.url,this.headers,e,this.fetch)}}const FI="2.48.0";let Ho="";typeof Deno<"u"?Ho="deno":typeof document<"u"?Ho="web":typeof navigator<"u"&&navigator.product==="ReactNative"?Ho="react-native":Ho="node";const BI={"X-Client-Info":`supabase-js-${Ho}/${FI}`},UI={headers:BI},zI={schema:"public"},qI={autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,flowType:"implicit"},HI={};var VI=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};const WI=t=>{let e;return t?e=t:typeof fetch>"u"?e=W2:e=fetch,(...n)=>e(...n)},GI=()=>typeof Headers>"u"?G2:Headers,ZI=(t,e,n)=>{const r=WI(n),s=GI();return(i,a)=>VI(void 0,void 0,void 0,function*(){var o;const u=(o=yield e())!==null&&o!==void 0?o:t;let l=new s(a?.headers);return l.has("apikey")||l.set("apikey",t),l.has("Authorization")||l.set("Authorization",`Bearer ${u}`),r(i,Object.assign(Object.assign({},a),{headers:l}))})};var JI=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};function KI(t){return t.replace(/\/$/,"")}function QI(t,e){const{db:n,auth:r,realtime:s,global:i}=t,{db:a,auth:o,realtime:u,global:l}=e,c={db:Object.assign(Object.assign({},a),n),auth:Object.assign(Object.assign({},o),r),realtime:Object.assign(Object.assign({},u),s),global:Object.assign(Object.assign({},l),i),accessToken:()=>JI(this,void 0,void 0,function*(){return""})};return t.accessToken?c.accessToken=t.accessToken:delete c.accessToken,c}const lS="2.67.3",XI="http://localhost:9999",YI="supabase.auth.token",e4={"X-Client-Info":`gotrue-js/${lS}`},Lw=10,Dm="X-Supabase-Api-Version",cS={"2024-01-01":{timestamp:Date.parse("2024-01-01T00:00:00.0Z"),name:"2024-01-01"}};function t4(t){return Math.round(Date.now()/1e3)+t}function n4(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){const e=Math.random()*16|0;return(t=="x"?e:e&3|8).toString(16)})}const ur=()=>typeof window<"u"&&typeof document<"u",Ks={tested:!1,writable:!1},cu=()=>{if(!ur())return!1;try{if(typeof globalThis.localStorage!="object")return!1}catch{return!1}if(Ks.tested)return Ks.writable;const t=`lswt-${Math.random()}${Math.random()}`;try{globalThis.localStorage.setItem(t,t),globalThis.localStorage.removeItem(t),Ks.tested=!0,Ks.writable=!0}catch{Ks.tested=!0,Ks.writable=!1}return Ks.writable};function r4(t){const e={},n=new URL(t);if(n.hash&&n.hash[0]==="#")try{new URLSearchParams(n.hash.substring(1)).forEach((s,i)=>{e[i]=s})}catch{}return n.searchParams.forEach((r,s)=>{e[s]=r}),e}const dS=t=>{let e;return t?e=t:typeof fetch>"u"?e=(...n)=>Da(async()=>{const{default:r}=await Promise.resolve().then(()=>ao);return{default:r}},void 0).then(({default:r})=>r(...n)):e=fetch,(...n)=>e(...n)},s4=t=>typeof t=="object"&&t!==null&&"status"in t&&"ok"in t&&"json"in t&&typeof t.json=="function",fS=async(t,e,n)=>{await t.setItem(e,JSON.stringify(n))},rc=async(t,e)=>{const n=await t.getItem(e);if(!n)return null;try{return JSON.parse(n)}catch{return n}},sc=async(t,e)=>{await t.removeItem(e)};function i4(t){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";let n="",r,s,i,a,o,u,l,c=0;for(t=t.replace("-","+").replace("_","/");c<t.length;)a=e.indexOf(t.charAt(c++)),o=e.indexOf(t.charAt(c++)),u=e.indexOf(t.charAt(c++)),l=e.indexOf(t.charAt(c++)),r=a<<2|o>>4,s=(o&15)<<4|u>>2,i=(u&3)<<6|l,n=n+String.fromCharCode(r),u!=64&&s!=0&&(n=n+String.fromCharCode(s)),l!=64&&i!=0&&(n=n+String.fromCharCode(i));return n}class Nf{constructor(){this.promise=new Nf.promiseConstructor((e,n)=>{this.resolve=e,this.reject=n})}}Nf.promiseConstructor=Promise;function Mw(t){const e=/^([a-z0-9_-]{4})*($|[a-z0-9_-]{3}=?$|[a-z0-9_-]{2}(==)?$)$/i,n=t.split(".");if(n.length!==3)throw new Error("JWT is not valid: not a JWT structure");if(!e.test(n[1]))throw new Error("JWT is not valid: payload is not in base64url format");const r=n[1];return JSON.parse(i4(r))}async function a4(t){return await new Promise(e=>{setTimeout(()=>e(null),t)})}function o4(t,e){return new Promise((r,s)=>{(async()=>{for(let i=0;i<1/0;i++)try{const a=await t(i);if(!e(i,null,a)){r(a);return}}catch(a){if(!e(i,a)){s(a);return}}})()})}function u4(t){return("0"+t.toString(16)).substr(-2)}function l4(){const e=new Uint32Array(56);if(typeof crypto>"u"){const n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789-._~",r=n.length;let s="";for(let i=0;i<56;i++)s+=n.charAt(Math.floor(Math.random()*r));return s}return crypto.getRandomValues(e),Array.from(e,u4).join("")}async function c4(t){const n=new TextEncoder().encode(t),r=await crypto.subtle.digest("SHA-256",n),s=new Uint8Array(r);return Array.from(s).map(i=>String.fromCharCode(i)).join("")}function d4(t){return btoa(t).replace(/\+/g,"-").replace(/\//g,"_").replace(/=+$/,"")}async function f4(t){if(!(typeof crypto<"u"&&typeof crypto.subtle<"u"&&typeof TextEncoder<"u"))return console.warn("WebCrypto API is not supported. Code challenge method will default to use plain instead of sha256."),t;const n=await c4(t);return d4(n)}async function Fi(t,e,n=!1){const r=l4();let s=r;n&&(s+="/PASSWORD_RECOVERY"),await fS(t,`${e}-code-verifier`,s);const i=await f4(r);return[i,r===i?"plain":"s256"]}const h4=/^2[0-9]{3}-(0[1-9]|1[0-2])-(0[1-9]|1[0-9]|2[0-9]|3[0-1])$/i;function p4(t){const e=t.headers.get(Dm);if(!e||!e.match(h4))return null;try{return new Date(`${e}T00:00:00.0Z`)}catch{return null}}class H0 extends Error{constructor(e,n,r){super(e),this.__isAuthError=!0,this.name="AuthError",this.status=n,this.code=r}}function ce(t){return typeof t=="object"&&t!==null&&"__isAuthError"in t}class m4 extends H0{constructor(e,n,r){super(e,n,r),this.name="AuthApiError",this.status=n,this.code=r}}function g4(t){return ce(t)&&t.name==="AuthApiError"}class hS extends H0{constructor(e,n){super(e),this.name="AuthUnknownError",this.originalError=n}}class ji extends H0{constructor(e,n,r,s){super(e,r,s),this.name=n,this.status=r}}class ls extends ji{constructor(){super("Auth session missing!","AuthSessionMissingError",400,void 0)}}function y4(t){return ce(t)&&t.name==="AuthSessionMissingError"}class Uh extends ji{constructor(){super("Auth session or user missing","AuthInvalidTokenResponseError",500,void 0)}}class ic extends ji{constructor(e){super(e,"AuthInvalidCredentialsError",400,void 0)}}class ac extends ji{constructor(e,n=null){super(e,"AuthImplicitGrantRedirectError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}function b4(t){return ce(t)&&t.name==="AuthImplicitGrantRedirectError"}class Dw extends ji{constructor(e,n=null){super(e,"AuthPKCEGrantCodeExchangeError",500,void 0),this.details=null,this.details=n}toJSON(){return{name:this.name,message:this.message,status:this.status,details:this.details}}}class Fm extends ji{constructor(e,n){super(e,"AuthRetryableFetchError",n,void 0)}}function zh(t){return ce(t)&&t.name==="AuthRetryableFetchError"}class Fw extends ji{constructor(e,n,r){super(e,"AuthWeakPasswordError",n,"weak_password"),this.reasons=r}}var w4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};const ti=t=>t.msg||t.message||t.error_description||t.error||JSON.stringify(t),_4=[502,503,504];async function Bw(t){var e;if(!s4(t))throw new Fm(ti(t),0);if(_4.includes(t.status))throw new Fm(ti(t),t.status);let n;try{n=await t.json()}catch(i){throw new hS(ti(i),i)}let r;const s=p4(t);if(s&&s.getTime()>=cS["2024-01-01"].timestamp&&typeof n=="object"&&n&&typeof n.code=="string"?r=n.code:typeof n=="object"&&n&&typeof n.error_code=="string"&&(r=n.error_code),r){if(r==="weak_password")throw new Fw(ti(n),t.status,((e=n.weak_password)===null||e===void 0?void 0:e.reasons)||[]);if(r==="session_not_found")throw new ls}else if(typeof n=="object"&&n&&typeof n.weak_password=="object"&&n.weak_password&&Array.isArray(n.weak_password.reasons)&&n.weak_password.reasons.length&&n.weak_password.reasons.reduce((i,a)=>i&&typeof a=="string",!0))throw new Fw(ti(n),t.status,n.weak_password.reasons);throw new m4(ti(n),t.status||500,r)}const v4=(t,e,n,r)=>{const s={method:t,headers:e?.headers||{}};return t==="GET"?s:(s.headers=Object.assign({"Content-Type":"application/json;charset=UTF-8"},e?.headers),s.body=JSON.stringify(r),Object.assign(Object.assign({},s),n))};async function be(t,e,n,r){var s;const i=Object.assign({},r?.headers);i[Dm]||(i[Dm]=cS["2024-01-01"].name),r?.jwt&&(i.Authorization=`Bearer ${r.jwt}`);const a=(s=r?.query)!==null&&s!==void 0?s:{};r?.redirectTo&&(a.redirect_to=r.redirectTo);const o=Object.keys(a).length?"?"+new URLSearchParams(a).toString():"",u=await x4(t,e,n+o,{headers:i,noResolveJson:r?.noResolveJson},{},r?.body);return r?.xform?r?.xform(u):{data:Object.assign({},u),error:null}}async function x4(t,e,n,r,s,i){const a=v4(e,r,s,i);let o;try{o=await t(n,Object.assign({},a))}catch(u){throw console.error(u),new Fm(ti(u),0)}if(o.ok||await Bw(o),r?.noResolveJson)return o;try{return await o.json()}catch(u){await Bw(u)}}function cs(t){var e;let n=null;A4(t)&&(n=Object.assign({},t),t.expires_at||(n.expires_at=t4(t.expires_in)));const r=(e=t.user)!==null&&e!==void 0?e:t;return{data:{session:n,user:r},error:null}}function Uw(t){const e=cs(t);return!e.error&&t.weak_password&&typeof t.weak_password=="object"&&Array.isArray(t.weak_password.reasons)&&t.weak_password.reasons.length&&t.weak_password.message&&typeof t.weak_password.message=="string"&&t.weak_password.reasons.reduce((n,r)=>n&&typeof r=="string",!0)&&(e.data.weak_password=t.weak_password),e}function ws(t){var e;return{data:{user:(e=t.user)!==null&&e!==void 0?e:t},error:null}}function S4(t){return{data:t,error:null}}function k4(t){const{action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i}=t,a=w4(t,["action_link","email_otp","hashed_token","redirect_to","verification_type"]),o={action_link:e,email_otp:n,hashed_token:r,redirect_to:s,verification_type:i},u=Object.assign({},a);return{data:{properties:o,user:u},error:null}}function E4(t){return t}function A4(t){return t.access_token&&t.refresh_token&&t.expires_in}var T4=function(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n};class C4{constructor({url:e="",headers:n={},fetch:r}){this.url=e,this.headers=n,this.fetch=dS(r),this.mfa={listFactors:this._listFactors.bind(this),deleteFactor:this._deleteFactor.bind(this)}}async signOut(e,n="global"){try{return await be(this.fetch,"POST",`${this.url}/logout?scope=${n}`,{headers:this.headers,jwt:e,noResolveJson:!0}),{data:null,error:null}}catch(r){if(ce(r))return{data:null,error:r};throw r}}async inviteUserByEmail(e,n={}){try{return await be(this.fetch,"POST",`${this.url}/invite`,{body:{email:e,data:n.data},headers:this.headers,redirectTo:n.redirectTo,xform:ws})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async generateLink(e){try{const{options:n}=e,r=T4(e,["options"]),s=Object.assign(Object.assign({},r),n);return"newEmail"in r&&(s.new_email=r?.newEmail,delete s.newEmail),await be(this.fetch,"POST",`${this.url}/admin/generate_link`,{body:s,headers:this.headers,xform:k4,redirectTo:n?.redirectTo})}catch(n){if(ce(n))return{data:{properties:null,user:null},error:n};throw n}}async createUser(e){try{return await be(this.fetch,"POST",`${this.url}/admin/users`,{body:e,headers:this.headers,xform:ws})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async listUsers(e){var n,r,s,i,a,o,u;try{const l={nextPage:null,lastPage:0,total:0},c=await be(this.fetch,"GET",`${this.url}/admin/users`,{headers:this.headers,noResolveJson:!0,query:{page:(r=(n=e?.page)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:"",per_page:(i=(s=e?.perPage)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""},xform:E4});if(c.error)throw c.error;const d=await c.json(),f=(a=c.headers.get("x-total-count"))!==null&&a!==void 0?a:0,h=(u=(o=c.headers.get("link"))===null||o===void 0?void 0:o.split(","))!==null&&u!==void 0?u:[];return h.length>0&&(h.forEach(m=>{const y=parseInt(m.split(";")[0].split("=")[1].substring(0,1)),w=JSON.parse(m.split(";")[1].split("=")[1]);l[`${w}Page`]=y}),l.total=parseInt(f)),{data:Object.assign(Object.assign({},d),l),error:null}}catch(l){if(ce(l))return{data:{users:[]},error:l};throw l}}async getUserById(e){try{return await be(this.fetch,"GET",`${this.url}/admin/users/${e}`,{headers:this.headers,xform:ws})}catch(n){if(ce(n))return{data:{user:null},error:n};throw n}}async updateUserById(e,n){try{return await be(this.fetch,"PUT",`${this.url}/admin/users/${e}`,{body:n,headers:this.headers,xform:ws})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async deleteUser(e,n=!1){try{return await be(this.fetch,"DELETE",`${this.url}/admin/users/${e}`,{headers:this.headers,body:{should_soft_delete:n},xform:ws})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}async _listFactors(e){try{const{data:n,error:r}=await be(this.fetch,"GET",`${this.url}/admin/users/${e.userId}/factors`,{headers:this.headers,xform:s=>({data:{factors:s},error:null})});return{data:n,error:r}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _deleteFactor(e){try{return{data:await be(this.fetch,"DELETE",`${this.url}/admin/users/${e.userId}/factors/${e.id}`,{headers:this.headers}),error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}}const P4={getItem:t=>cu()?globalThis.localStorage.getItem(t):null,setItem:(t,e)=>{cu()&&globalThis.localStorage.setItem(t,e)},removeItem:t=>{cu()&&globalThis.localStorage.removeItem(t)}};function zw(t={}){return{getItem:e=>t[e]||null,setItem:(e,n)=>{t[e]=n},removeItem:e=>{delete t[e]}}}function O4(){if(typeof globalThis!="object")try{Object.defineProperty(Object.prototype,"__magic__",{get:function(){return this},configurable:!0}),__magic__.globalThis=__magic__,delete Object.prototype.__magic__}catch{typeof self<"u"&&(self.globalThis=self)}}const Bi={debug:!!(globalThis&&cu()&&globalThis.localStorage&&globalThis.localStorage.getItem("supabase.gotrue-js.locks.debug")==="true")};class pS extends Error{constructor(e){super(e),this.isAcquireTimeout=!0}}class N4 extends pS{}async function I4(t,e,n){Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquire lock",t,e);const r=new globalThis.AbortController;return e>0&&setTimeout(()=>{r.abort(),Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock acquire timed out",t)},e),await Promise.resolve().then(()=>globalThis.navigator.locks.request(t,e===0?{mode:"exclusive",ifAvailable:!0}:{mode:"exclusive",signal:r.signal},async s=>{if(s){Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: acquired",t,s.name);try{return await n()}finally{Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: released",t,s.name)}}else{if(e===0)throw Bi.debug&&console.log("@supabase/gotrue-js: navigatorLock: not immediately available",t),new N4(`Acquiring an exclusive Navigator LockManager lock "${t}" immediately failed`);if(Bi.debug)try{const i=await globalThis.navigator.locks.query();console.log("@supabase/gotrue-js: Navigator LockManager state",JSON.stringify(i,null,"  "))}catch(i){console.warn("@supabase/gotrue-js: Error when querying Navigator LockManager state",i)}return console.warn("@supabase/gotrue-js: Navigator LockManager returned a null lock when using #request without ifAvailable set to true, it appears this browser is not following the LockManager spec https://developer.mozilla.org/en-US/docs/Web/API/LockManager/request"),await n()}}))}O4();const R4={url:XI,storageKey:YI,autoRefreshToken:!0,persistSession:!0,detectSessionInUrl:!0,headers:e4,flowType:"implicit",debug:!1,hasCustomAuthorizationHeader:!1},$o=30*1e3,qw=3;async function Hw(t,e,n){return await n()}class Mu{constructor(e){var n,r;this.memoryStorage=null,this.stateChangeEmitters=new Map,this.autoRefreshTicker=null,this.visibilityChangedCallback=null,this.refreshingDeferred=null,this.initializePromise=null,this.detectSessionInUrl=!0,this.hasCustomAuthorizationHeader=!1,this.suppressGetSessionWarning=!1,this.lockAcquired=!1,this.pendingInLock=[],this.broadcastChannel=null,this.logger=console.log,this.instanceID=Mu.nextInstanceID,Mu.nextInstanceID+=1,this.instanceID>0&&ur()&&console.warn("Multiple GoTrueClient instances detected in the same browser context. It is not an error, but this should be avoided as it may produce undefined behavior when used concurrently under the same storage key.");const s=Object.assign(Object.assign({},R4),e);if(this.logDebugMessages=!!s.debug,typeof s.debug=="function"&&(this.logger=s.debug),this.persistSession=s.persistSession,this.storageKey=s.storageKey,this.autoRefreshToken=s.autoRefreshToken,this.admin=new C4({url:s.url,headers:s.headers,fetch:s.fetch}),this.url=s.url,this.headers=s.headers,this.fetch=dS(s.fetch),this.lock=s.lock||Hw,this.detectSessionInUrl=s.detectSessionInUrl,this.flowType=s.flowType,this.hasCustomAuthorizationHeader=s.hasCustomAuthorizationHeader,s.lock?this.lock=s.lock:ur()&&(!((n=globalThis?.navigator)===null||n===void 0)&&n.locks)?this.lock=I4:this.lock=Hw,this.mfa={verify:this._verify.bind(this),enroll:this._enroll.bind(this),unenroll:this._unenroll.bind(this),challenge:this._challenge.bind(this),listFactors:this._listFactors.bind(this),challengeAndVerify:this._challengeAndVerify.bind(this),getAuthenticatorAssuranceLevel:this._getAuthenticatorAssuranceLevel.bind(this)},this.persistSession?s.storage?this.storage=s.storage:cu()?this.storage=P4:(this.memoryStorage={},this.storage=zw(this.memoryStorage)):(this.memoryStorage={},this.storage=zw(this.memoryStorage)),ur()&&globalThis.BroadcastChannel&&this.persistSession&&this.storageKey){try{this.broadcastChannel=new globalThis.BroadcastChannel(this.storageKey)}catch(i){console.error("Failed to create a new BroadcastChannel, multi-tab state changes will not be available",i)}(r=this.broadcastChannel)===null||r===void 0||r.addEventListener("message",async i=>{this._debug("received broadcast notification from other tab or client",i),await this._notifyAllSubscribers(i.data.event,i.data.session,!1)})}this.initialize()}_debug(...e){return this.logDebugMessages&&this.logger(`GoTrueClient@${this.instanceID} (${lS}) ${new Date().toISOString()}`,...e),this}async initialize(){return this.initializePromise?await this.initializePromise:(this.initializePromise=(async()=>await this._acquireLock(-1,async()=>await this._initialize()))(),await this.initializePromise)}async _initialize(){var e;try{const n=r4(window.location.href);let r="none";if(this._isImplicitGrantCallback(n)?r="implicit":await this._isPKCECallback(n)&&(r="pkce"),ur()&&this.detectSessionInUrl&&r!=="none"){const{data:s,error:i}=await this._getSessionFromURL(n,r);if(i){if(this._debug("#_initialize()","error detecting session from URL",i),b4(i)){const u=(e=i.details)===null||e===void 0?void 0:e.code;if(u==="identity_already_exists"||u==="identity_not_found"||u==="single_identity_not_deletable")return{error:i}}return await this._removeSession(),{error:i}}const{session:a,redirectType:o}=s;return this._debug("#_initialize()","detected session in URL",a,"redirect type",o),await this._saveSession(a),setTimeout(async()=>{o==="recovery"?await this._notifyAllSubscribers("PASSWORD_RECOVERY",a):await this._notifyAllSubscribers("SIGNED_IN",a)},0),{error:null}}return await this._recoverAndRefresh(),{error:null}}catch(n){return ce(n)?{error:n}:{error:new hS("Unexpected error during initialization",n)}}finally{await this._handleVisibilityChange(),this._debug("#_initialize()","end")}}async signInAnonymously(e){var n,r,s;try{const i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{data:(r=(n=e?.options)===null||n===void 0?void 0:n.data)!==null&&r!==void 0?r:{},gotrue_meta_security:{captcha_token:(s=e?.options)===null||s===void 0?void 0:s.captchaToken}},xform:cs}),{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const u=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(ce(i))return{data:{user:null,session:null},error:i};throw i}}async signUp(e){var n,r,s;try{let i;if("email"in e){const{email:c,password:d,options:f}=e;let h=null,m=null;this.flowType==="pkce"&&([h,m]=await Fi(this.storage,this.storageKey)),i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,redirectTo:f?.emailRedirectTo,body:{email:c,password:d,data:(n=f?.data)!==null&&n!==void 0?n:{},gotrue_meta_security:{captcha_token:f?.captchaToken},code_challenge:h,code_challenge_method:m},xform:cs})}else if("phone"in e){const{phone:c,password:d,options:f}=e;i=await be(this.fetch,"POST",`${this.url}/signup`,{headers:this.headers,body:{phone:c,password:d,data:(r=f?.data)!==null&&r!==void 0?r:{},channel:(s=f?.channel)!==null&&s!==void 0?s:"sms",gotrue_meta_security:{captcha_token:f?.captchaToken}},xform:cs})}else throw new ic("You must provide either an email or phone number and a password");const{data:a,error:o}=i;if(o||!a)return{data:{user:null,session:null},error:o};const u=a.session,l=a.user;return a.session&&(await this._saveSession(a.session),await this._notifyAllSubscribers("SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(i){if(ce(i))return{data:{user:null,session:null},error:i};throw i}}async signInWithPassword(e){try{let n;if("email"in e){const{email:i,password:a,options:o}=e;n=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{email:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Uw})}else if("phone"in e){const{phone:i,password:a,options:o}=e;n=await be(this.fetch,"POST",`${this.url}/token?grant_type=password`,{headers:this.headers,body:{phone:i,password:a,gotrue_meta_security:{captcha_token:o?.captchaToken}},xform:Uw})}else throw new ic("You must provide either an email or phone number and a password");const{data:r,error:s}=n;return s?{data:{user:null,session:null},error:s}:!r||!r.session||!r.user?{data:{user:null,session:null},error:new Uh}:(r.session&&(await this._saveSession(r.session),await this._notifyAllSubscribers("SIGNED_IN",r.session)),{data:Object.assign({user:r.user,session:r.session},r.weak_password?{weakPassword:r.weak_password}:null),error:s})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOAuth(e){var n,r,s,i;return await this._handleProviderSignIn(e.provider,{redirectTo:(n=e.options)===null||n===void 0?void 0:n.redirectTo,scopes:(r=e.options)===null||r===void 0?void 0:r.scopes,queryParams:(s=e.options)===null||s===void 0?void 0:s.queryParams,skipBrowserRedirect:(i=e.options)===null||i===void 0?void 0:i.skipBrowserRedirect})}async exchangeCodeForSession(e){return await this.initializePromise,this._acquireLock(-1,async()=>this._exchangeCodeForSession(e))}async _exchangeCodeForSession(e){const n=await rc(this.storage,`${this.storageKey}-code-verifier`),[r,s]=(n??"").split("/");try{const{data:i,error:a}=await be(this.fetch,"POST",`${this.url}/token?grant_type=pkce`,{headers:this.headers,body:{auth_code:e,code_verifier:r},xform:cs});if(await sc(this.storage,`${this.storageKey}-code-verifier`),a)throw a;return!i||!i.session||!i.user?{data:{user:null,session:null,redirectType:null},error:new Uh}:(i.session&&(await this._saveSession(i.session),await this._notifyAllSubscribers("SIGNED_IN",i.session)),{data:Object.assign(Object.assign({},i),{redirectType:s??null}),error:a})}catch(i){if(ce(i))return{data:{user:null,session:null,redirectType:null},error:i};throw i}}async signInWithIdToken(e){try{const{options:n,provider:r,token:s,access_token:i,nonce:a}=e,o=await be(this.fetch,"POST",`${this.url}/token?grant_type=id_token`,{headers:this.headers,body:{provider:r,id_token:s,access_token:i,nonce:a,gotrue_meta_security:{captcha_token:n?.captchaToken}},xform:cs}),{data:u,error:l}=o;return l?{data:{user:null,session:null},error:l}:!u||!u.session||!u.user?{data:{user:null,session:null},error:new Uh}:(u.session&&(await this._saveSession(u.session),await this._notifyAllSubscribers("SIGNED_IN",u.session)),{data:u,error:l})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async signInWithOtp(e){var n,r,s,i,a;try{if("email"in e){const{email:o,options:u}=e;let l=null,c=null;this.flowType==="pkce"&&([l,c]=await Fi(this.storage,this.storageKey));const{error:d}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{email:o,data:(n=u?.data)!==null&&n!==void 0?n:{},create_user:(r=u?.shouldCreateUser)!==null&&r!==void 0?r:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},code_challenge:l,code_challenge_method:c},redirectTo:u?.emailRedirectTo});return{data:{user:null,session:null},error:d}}if("phone"in e){const{phone:o,options:u}=e,{data:l,error:c}=await be(this.fetch,"POST",`${this.url}/otp`,{headers:this.headers,body:{phone:o,data:(s=u?.data)!==null&&s!==void 0?s:{},create_user:(i=u?.shouldCreateUser)!==null&&i!==void 0?i:!0,gotrue_meta_security:{captcha_token:u?.captchaToken},channel:(a=u?.channel)!==null&&a!==void 0?a:"sms"}});return{data:{user:null,session:null,messageId:l?.message_id},error:c}}throw new ic("You must provide either an email or phone number.")}catch(o){if(ce(o))return{data:{user:null,session:null},error:o};throw o}}async verifyOtp(e){var n,r;try{let s,i;"options"in e&&(s=(n=e.options)===null||n===void 0?void 0:n.redirectTo,i=(r=e.options)===null||r===void 0?void 0:r.captchaToken);const{data:a,error:o}=await be(this.fetch,"POST",`${this.url}/verify`,{headers:this.headers,body:Object.assign(Object.assign({},e),{gotrue_meta_security:{captcha_token:i}}),redirectTo:s,xform:cs});if(o)throw o;if(!a)throw new Error("An error occurred on token verification.");const u=a.session,l=a.user;return u?.access_token&&(await this._saveSession(u),await this._notifyAllSubscribers(e.type=="recovery"?"PASSWORD_RECOVERY":"SIGNED_IN",u)),{data:{user:l,session:u},error:null}}catch(s){if(ce(s))return{data:{user:null,session:null},error:s};throw s}}async signInWithSSO(e){var n,r,s;try{let i=null,a=null;return this.flowType==="pkce"&&([i,a]=await Fi(this.storage,this.storageKey)),await be(this.fetch,"POST",`${this.url}/sso`,{body:Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},"providerId"in e?{provider_id:e.providerId}:null),"domain"in e?{domain:e.domain}:null),{redirect_to:(r=(n=e.options)===null||n===void 0?void 0:n.redirectTo)!==null&&r!==void 0?r:void 0}),!((s=e?.options)===null||s===void 0)&&s.captchaToken?{gotrue_meta_security:{captcha_token:e.options.captchaToken}}:null),{skip_http_redirect:!0,code_challenge:i,code_challenge_method:a}),headers:this.headers,xform:S4})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async reauthenticate(){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._reauthenticate())}async _reauthenticate(){try{return await this._useSession(async e=>{const{data:{session:n},error:r}=e;if(r)throw r;if(!n)throw new ls;const{error:s}=await be(this.fetch,"GET",`${this.url}/reauthenticate`,{headers:this.headers,jwt:n.access_token});return{data:{user:null,session:null},error:s}})}catch(e){if(ce(e))return{data:{user:null,session:null},error:e};throw e}}async resend(e){try{const n=`${this.url}/resend`;if("email"in e){const{email:r,type:s,options:i}=e,{error:a}=await be(this.fetch,"POST",n,{headers:this.headers,body:{email:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}},redirectTo:i?.emailRedirectTo});return{data:{user:null,session:null},error:a}}else if("phone"in e){const{phone:r,type:s,options:i}=e,{data:a,error:o}=await be(this.fetch,"POST",n,{headers:this.headers,body:{phone:r,type:s,gotrue_meta_security:{captcha_token:i?.captchaToken}}});return{data:{user:null,session:null,messageId:a?.message_id},error:o}}throw new ic("You must provide either an email or phone number and a type")}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async getSession(){return await this.initializePromise,await this._acquireLock(-1,async()=>this._useSession(async n=>n))}async _acquireLock(e,n){this._debug("#_acquireLock","begin",e);try{if(this.lockAcquired){const r=this.pendingInLock.length?this.pendingInLock[this.pendingInLock.length-1]:Promise.resolve(),s=(async()=>(await r,await n()))();return this.pendingInLock.push((async()=>{try{await s}catch{}})()),s}return await this.lock(`lock:${this.storageKey}`,e,async()=>{this._debug("#_acquireLock","lock acquired for storage key",this.storageKey);try{this.lockAcquired=!0;const r=n();for(this.pendingInLock.push((async()=>{try{await r}catch{}})()),await r;this.pendingInLock.length;){const s=[...this.pendingInLock];await Promise.all(s),this.pendingInLock.splice(0,s.length)}return await r}finally{this._debug("#_acquireLock","lock released for storage key",this.storageKey),this.lockAcquired=!1}})}finally{this._debug("#_acquireLock","end")}}async _useSession(e){this._debug("#_useSession","begin");try{const n=await this.__loadSession();return await e(n)}finally{this._debug("#_useSession","end")}}async __loadSession(){this._debug("#__loadSession()","begin"),this.lockAcquired||this._debug("#__loadSession()","used outside of an acquired lock!",new Error().stack);try{let e=null;const n=await rc(this.storage,this.storageKey);if(this._debug("#getSession()","session from storage",n),n!==null&&(this._isValidSession(n)?e=n:(this._debug("#getSession()","session from storage is not valid"),await this._removeSession())),!e)return{data:{session:null},error:null};const r=e.expires_at?e.expires_at<=Date.now()/1e3:!1;if(this._debug("#__loadSession()",`session has${r?"":" not"} expired`,"expires_at",e.expires_at),!r){if(this.storage.isServer){let a=this.suppressGetSessionWarning;e=new Proxy(e,{get:(u,l,c)=>(!a&&l==="user"&&(console.warn("Using the user object as returned from supabase.auth.getSession() or from some supabase.auth.onAuthStateChange() events could be insecure! This value comes directly from the storage medium (usually cookies on the server) and may not be authentic. Use supabase.auth.getUser() instead which authenticates the data by contacting the Supabase Auth server."),a=!0,this.suppressGetSessionWarning=!0),Reflect.get(u,l,c))})}return{data:{session:e},error:null}}const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{session:null},error:i}:{data:{session:s},error:null}}finally{this._debug("#__loadSession()","end")}}async getUser(e){return e?await this._getUser(e):(await this.initializePromise,await this._acquireLock(-1,async()=>await this._getUser()))}async _getUser(e){try{return e?await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:e,xform:ws}):await this._useSession(async n=>{var r,s,i;const{data:a,error:o}=n;if(o)throw o;return!(!((r=a.session)===null||r===void 0)&&r.access_token)&&!this.hasCustomAuthorizationHeader?{data:{user:null},error:new ls}:await be(this.fetch,"GET",`${this.url}/user`,{headers:this.headers,jwt:(i=(s=a.session)===null||s===void 0?void 0:s.access_token)!==null&&i!==void 0?i:void 0,xform:ws})})}catch(n){if(ce(n))return y4(n)&&(await this._removeSession(),await sc(this.storage,`${this.storageKey}-code-verifier`)),{data:{user:null},error:n};throw n}}async updateUser(e,n={}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._updateUser(e,n))}async _updateUser(e,n={}){try{return await this._useSession(async r=>{const{data:s,error:i}=r;if(i)throw i;if(!s.session)throw new ls;const a=s.session;let o=null,u=null;this.flowType==="pkce"&&e.email!=null&&([o,u]=await Fi(this.storage,this.storageKey));const{data:l,error:c}=await be(this.fetch,"PUT",`${this.url}/user`,{headers:this.headers,redirectTo:n?.emailRedirectTo,body:Object.assign(Object.assign({},e),{code_challenge:o,code_challenge_method:u}),jwt:a.access_token,xform:ws});if(c)throw c;return a.user=l.user,await this._saveSession(a),await this._notifyAllSubscribers("USER_UPDATED",a),{data:{user:a.user},error:null}})}catch(r){if(ce(r))return{data:{user:null},error:r};throw r}}_decodeJWT(e){return Mw(e)}async setSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._setSession(e))}async _setSession(e){try{if(!e.access_token||!e.refresh_token)throw new ls;const n=Date.now()/1e3;let r=n,s=!0,i=null;const a=Mw(e.access_token);if(a.exp&&(r=a.exp,s=r<=n),s){const{session:o,error:u}=await this._callRefreshToken(e.refresh_token);if(u)return{data:{user:null,session:null},error:u};if(!o)return{data:{user:null,session:null},error:null};i=o}else{const{data:o,error:u}=await this._getUser(e.access_token);if(u)throw u;i={access_token:e.access_token,refresh_token:e.refresh_token,user:o.user,token_type:"bearer",expires_in:r-n,expires_at:r},await this._saveSession(i),await this._notifyAllSubscribers("SIGNED_IN",i)}return{data:{user:i.user,session:i},error:null}}catch(n){if(ce(n))return{data:{session:null,user:null},error:n};throw n}}async refreshSession(e){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._refreshSession(e))}async _refreshSession(e){try{return await this._useSession(async n=>{var r;if(!e){const{data:a,error:o}=n;if(o)throw o;e=(r=a.session)!==null&&r!==void 0?r:void 0}if(!e?.refresh_token)throw new ls;const{session:s,error:i}=await this._callRefreshToken(e.refresh_token);return i?{data:{user:null,session:null},error:i}:s?{data:{user:s.user,session:s},error:null}:{data:{user:null,session:null},error:null}})}catch(n){if(ce(n))return{data:{user:null,session:null},error:n};throw n}}async _getSessionFromURL(e,n){try{if(!ur())throw new ac("No browser detected.");if(e.error||e.error_description||e.error_code)throw new ac(e.error_description||"Error in URL with unspecified error_description",{error:e.error||"unspecified_error",code:e.error_code||"unspecified_code"});switch(n){case"implicit":if(this.flowType==="pkce")throw new Dw("Not a valid PKCE flow url.");break;case"pkce":if(this.flowType==="implicit")throw new ac("Not a valid implicit grant flow url.");break;default:}if(n==="pkce"){if(this._debug("#_initialize()","begin","is PKCE flow",!0),!e.code)throw new Dw("No code detected.");const{data:b,error:_}=await this._exchangeCodeForSession(e.code);if(_)throw _;const x=new URL(window.location.href);return x.searchParams.delete("code"),window.history.replaceState(window.history.state,"",x.toString()),{data:{session:b.session,redirectType:null},error:null}}const{provider_token:r,provider_refresh_token:s,access_token:i,refresh_token:a,expires_in:o,expires_at:u,token_type:l}=e;if(!i||!o||!a||!l)throw new ac("No session defined in URL");const c=Math.round(Date.now()/1e3),d=parseInt(o);let f=c+d;u&&(f=parseInt(u));const h=f-c;h*1e3<=$o&&console.warn(`@supabase/gotrue-js: Session as retrieved from URL expires in ${h}s, should have been closer to ${d}s`);const m=f-d;c-m>=120?console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued over 120s ago, URL could be stale",m,f,c):c-m<0&&console.warn("@supabase/gotrue-js: Session as retrieved from URL was issued in the future? Check the device clock for skew",m,f,c);const{data:y,error:w}=await this._getUser(i);if(w)throw w;const p={provider_token:r,provider_refresh_token:s,access_token:i,expires_in:d,expires_at:f,refresh_token:a,token_type:l,user:y.user};return window.location.hash="",this._debug("#_getSessionFromURL()","clearing window.location.hash"),{data:{session:p,redirectType:e.type},error:null}}catch(r){if(ce(r))return{data:{session:null,redirectType:null},error:r};throw r}}_isImplicitGrantCallback(e){return!!(e.access_token||e.error_description)}async _isPKCECallback(e){const n=await rc(this.storage,`${this.storageKey}-code-verifier`);return!!(e.code&&n)}async signOut(e={scope:"global"}){return await this.initializePromise,await this._acquireLock(-1,async()=>await this._signOut(e))}async _signOut({scope:e}={scope:"global"}){return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{error:i};const a=(r=s.session)===null||r===void 0?void 0:r.access_token;if(a){const{error:o}=await this.admin.signOut(a,e);if(o&&!(g4(o)&&(o.status===404||o.status===401||o.status===403)))return{error:o}}return e!=="others"&&(await this._removeSession(),await sc(this.storage,`${this.storageKey}-code-verifier`)),{error:null}})}onAuthStateChange(e){const n=n4(),r={id:n,callback:e,unsubscribe:()=>{this._debug("#unsubscribe()","state change callback with id removed",n),this.stateChangeEmitters.delete(n)}};return this._debug("#onAuthStateChange()","registered callback with id",n),this.stateChangeEmitters.set(n,r),(async()=>(await this.initializePromise,await this._acquireLock(-1,async()=>{this._emitInitialSession(n)})))(),{data:{subscription:r}}}async _emitInitialSession(e){return await this._useSession(async n=>{var r,s;try{const{data:{session:i},error:a}=n;if(a)throw a;await((r=this.stateChangeEmitters.get(e))===null||r===void 0?void 0:r.callback("INITIAL_SESSION",i)),this._debug("INITIAL_SESSION","callback id",e,"session",i)}catch(i){await((s=this.stateChangeEmitters.get(e))===null||s===void 0?void 0:s.callback("INITIAL_SESSION",null)),this._debug("INITIAL_SESSION","callback id",e,"error",i),console.error(i)}})}async resetPasswordForEmail(e,n={}){let r=null,s=null;this.flowType==="pkce"&&([r,s]=await Fi(this.storage,this.storageKey,!0));try{return await be(this.fetch,"POST",`${this.url}/recover`,{body:{email:e,code_challenge:r,code_challenge_method:s,gotrue_meta_security:{captcha_token:n.captchaToken}},headers:this.headers,redirectTo:n.redirectTo})}catch(i){if(ce(i))return{data:null,error:i};throw i}}async getUserIdentities(){var e;try{const{data:n,error:r}=await this.getUser();if(r)throw r;return{data:{identities:(e=n.user.identities)!==null&&e!==void 0?e:[]},error:null}}catch(n){if(ce(n))return{data:null,error:n};throw n}}async linkIdentity(e){var n;try{const{data:r,error:s}=await this._useSession(async i=>{var a,o,u,l,c;const{data:d,error:f}=i;if(f)throw f;const h=await this._getUrlForProvider(`${this.url}/user/identities/authorize`,e.provider,{redirectTo:(a=e.options)===null||a===void 0?void 0:a.redirectTo,scopes:(o=e.options)===null||o===void 0?void 0:o.scopes,queryParams:(u=e.options)===null||u===void 0?void 0:u.queryParams,skipBrowserRedirect:!0});return await be(this.fetch,"GET",h,{headers:this.headers,jwt:(c=(l=d.session)===null||l===void 0?void 0:l.access_token)!==null&&c!==void 0?c:void 0})});if(s)throw s;return ur()&&!(!((n=e.options)===null||n===void 0)&&n.skipBrowserRedirect)&&window.location.assign(r?.url),{data:{provider:e.provider,url:r?.url},error:null}}catch(r){if(ce(r))return{data:{provider:e.provider,url:null},error:r};throw r}}async unlinkIdentity(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:a}=n;if(a)throw a;return await be(this.fetch,"DELETE",`${this.url}/user/identities/${e.identity_id}`,{headers:this.headers,jwt:(s=(r=i.session)===null||r===void 0?void 0:r.access_token)!==null&&s!==void 0?s:void 0})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _refreshAccessToken(e){const n=`#_refreshAccessToken(${e.substring(0,5)}...)`;this._debug(n,"begin");try{const r=Date.now();return await o4(async s=>(s>0&&await a4(200*Math.pow(2,s-1)),this._debug(n,"refreshing attempt",s),await be(this.fetch,"POST",`${this.url}/token?grant_type=refresh_token`,{body:{refresh_token:e},headers:this.headers,xform:cs})),(s,i)=>{const a=200*Math.pow(2,s);return i&&zh(i)&&Date.now()+a-r<$o})}catch(r){if(this._debug(n,"error",r),ce(r))return{data:{session:null,user:null},error:r};throw r}finally{this._debug(n,"end")}}_isValidSession(e){return typeof e=="object"&&e!==null&&"access_token"in e&&"refresh_token"in e&&"expires_at"in e}async _handleProviderSignIn(e,n){const r=await this._getUrlForProvider(`${this.url}/authorize`,e,{redirectTo:n.redirectTo,scopes:n.scopes,queryParams:n.queryParams});return this._debug("#_handleProviderSignIn()","provider",e,"options",n,"url",r),ur()&&!n.skipBrowserRedirect&&window.location.assign(r),{data:{provider:e,url:r},error:null}}async _recoverAndRefresh(){var e;const n="#_recoverAndRefresh()";this._debug(n,"begin");try{const r=await rc(this.storage,this.storageKey);if(this._debug(n,"session from storage",r),!this._isValidSession(r)){this._debug(n,"session is not valid"),r!==null&&await this._removeSession();return}const s=Math.round(Date.now()/1e3),i=((e=r.expires_at)!==null&&e!==void 0?e:1/0)<s+Lw;if(this._debug(n,`session has${i?"":" not"} expired with margin of ${Lw}s`),i){if(this.autoRefreshToken&&r.refresh_token){const{error:a}=await this._callRefreshToken(r.refresh_token);a&&(console.error(a),zh(a)||(this._debug(n,"refresh failed with a non-retryable error, removing the session",a),await this._removeSession()))}}else await this._notifyAllSubscribers("SIGNED_IN",r)}catch(r){this._debug(n,"error",r),console.error(r);return}finally{this._debug(n,"end")}}async _callRefreshToken(e){var n,r;if(!e)throw new ls;if(this.refreshingDeferred)return this.refreshingDeferred.promise;const s=`#_callRefreshToken(${e.substring(0,5)}...)`;this._debug(s,"begin");try{this.refreshingDeferred=new Nf;const{data:i,error:a}=await this._refreshAccessToken(e);if(a)throw a;if(!i.session)throw new ls;await this._saveSession(i.session),await this._notifyAllSubscribers("TOKEN_REFRESHED",i.session);const o={session:i.session,error:null};return this.refreshingDeferred.resolve(o),o}catch(i){if(this._debug(s,"error",i),ce(i)){const a={session:null,error:i};return zh(i)||await this._removeSession(),(n=this.refreshingDeferred)===null||n===void 0||n.resolve(a),a}throw(r=this.refreshingDeferred)===null||r===void 0||r.reject(i),i}finally{this.refreshingDeferred=null,this._debug(s,"end")}}async _notifyAllSubscribers(e,n,r=!0){const s=`#_notifyAllSubscribers(${e})`;this._debug(s,"begin",n,`broadcast = ${r}`);try{this.broadcastChannel&&r&&this.broadcastChannel.postMessage({event:e,session:n});const i=[],a=Array.from(this.stateChangeEmitters.values()).map(async o=>{try{await o.callback(e,n)}catch(u){i.push(u)}});if(await Promise.all(a),i.length>0){for(let o=0;o<i.length;o+=1)console.error(i[o]);throw i[0]}}finally{this._debug(s,"end")}}async _saveSession(e){this._debug("#_saveSession()",e),this.suppressGetSessionWarning=!0,await fS(this.storage,this.storageKey,e)}async _removeSession(){this._debug("#_removeSession()"),await sc(this.storage,this.storageKey),await this._notifyAllSubscribers("SIGNED_OUT",null)}_removeVisibilityChangedCallback(){this._debug("#_removeVisibilityChangedCallback()");const e=this.visibilityChangedCallback;this.visibilityChangedCallback=null;try{e&&ur()&&window?.removeEventListener&&window.removeEventListener("visibilitychange",e)}catch(n){console.error("removing visibilitychange callback failed",n)}}async _startAutoRefresh(){await this._stopAutoRefresh(),this._debug("#_startAutoRefresh()");const e=setInterval(()=>this._autoRefreshTokenTick(),$o);this.autoRefreshTicker=e,e&&typeof e=="object"&&typeof e.unref=="function"?e.unref():typeof Deno<"u"&&typeof Deno.unrefTimer=="function"&&Deno.unrefTimer(e),setTimeout(async()=>{await this.initializePromise,await this._autoRefreshTokenTick()},0)}async _stopAutoRefresh(){this._debug("#_stopAutoRefresh()");const e=this.autoRefreshTicker;this.autoRefreshTicker=null,e&&clearInterval(e)}async startAutoRefresh(){this._removeVisibilityChangedCallback(),await this._startAutoRefresh()}async stopAutoRefresh(){this._removeVisibilityChangedCallback(),await this._stopAutoRefresh()}async _autoRefreshTokenTick(){this._debug("#_autoRefreshTokenTick()","begin");try{await this._acquireLock(0,async()=>{try{const e=Date.now();try{return await this._useSession(async n=>{const{data:{session:r}}=n;if(!r||!r.refresh_token||!r.expires_at){this._debug("#_autoRefreshTokenTick()","no session");return}const s=Math.floor((r.expires_at*1e3-e)/$o);this._debug("#_autoRefreshTokenTick()",`access token expires in ${s} ticks, a tick lasts ${$o}ms, refresh threshold is ${qw} ticks`),s<=qw&&await this._callRefreshToken(r.refresh_token)})}catch(n){console.error("Auto refresh tick failed with error. This is likely a transient error.",n)}}finally{this._debug("#_autoRefreshTokenTick()","end")}})}catch(e){if(e.isAcquireTimeout||e instanceof pS)this._debug("auto refresh token tick lock not available");else throw e}}async _handleVisibilityChange(){if(this._debug("#_handleVisibilityChange()"),!ur()||!window?.addEventListener)return this.autoRefreshToken&&this.startAutoRefresh(),!1;try{this.visibilityChangedCallback=async()=>await this._onVisibilityChanged(!1),window?.addEventListener("visibilitychange",this.visibilityChangedCallback),await this._onVisibilityChanged(!0)}catch(e){console.error("_handleVisibilityChange",e)}}async _onVisibilityChanged(e){const n=`#_onVisibilityChanged(${e})`;this._debug(n,"visibilityState",document.visibilityState),document.visibilityState==="visible"?(this.autoRefreshToken&&this._startAutoRefresh(),e||(await this.initializePromise,await this._acquireLock(-1,async()=>{if(document.visibilityState!=="visible"){this._debug(n,"acquired the lock to recover the session, but the browser visibilityState is no longer visible, aborting");return}await this._recoverAndRefresh()}))):document.visibilityState==="hidden"&&this.autoRefreshToken&&this._stopAutoRefresh()}async _getUrlForProvider(e,n,r){const s=[`provider=${encodeURIComponent(n)}`];if(r?.redirectTo&&s.push(`redirect_to=${encodeURIComponent(r.redirectTo)}`),r?.scopes&&s.push(`scopes=${encodeURIComponent(r.scopes)}`),this.flowType==="pkce"){const[i,a]=await Fi(this.storage,this.storageKey),o=new URLSearchParams({code_challenge:`${encodeURIComponent(i)}`,code_challenge_method:`${encodeURIComponent(a)}`});s.push(o.toString())}if(r?.queryParams){const i=new URLSearchParams(r.queryParams);s.push(i.toString())}return r?.skipBrowserRedirect&&s.push(`skip_http_redirect=${r.skipBrowserRedirect}`),`${e}?${s.join("&")}`}async _unenroll(e){try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await be(this.fetch,"DELETE",`${this.url}/factors/${e.factorId}`,{headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _enroll(e){try{return await this._useSession(async n=>{var r,s;const{data:i,error:a}=n;if(a)return{data:null,error:a};const o=Object.assign({friendly_name:e.friendlyName,factor_type:e.factorType},e.factorType==="phone"?{phone:e.phone}:{issuer:e.issuer}),{data:u,error:l}=await be(this.fetch,"POST",`${this.url}/factors`,{body:o,headers:this.headers,jwt:(r=i?.session)===null||r===void 0?void 0:r.access_token});return l?{data:null,error:l}:(e.factorType==="totp"&&(!((s=u?.totp)===null||s===void 0)&&s.qr_code)&&(u.totp.qr_code=`data:image/svg+xml;utf-8,${u.totp.qr_code}`),{data:u,error:null})})}catch(n){if(ce(n))return{data:null,error:n};throw n}}async _verify(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;if(i)return{data:null,error:i};const{data:a,error:o}=await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/verify`,{body:{code:e.code,challenge_id:e.challengeId},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token});return o?{data:null,error:o}:(await this._saveSession(Object.assign({expires_at:Math.round(Date.now()/1e3)+a.expires_in},a)),await this._notifyAllSubscribers("MFA_CHALLENGE_VERIFIED",a),{data:a,error:o})})}catch(n){if(ce(n))return{data:null,error:n};throw n}})}async _challenge(e){return this._acquireLock(-1,async()=>{try{return await this._useSession(async n=>{var r;const{data:s,error:i}=n;return i?{data:null,error:i}:await be(this.fetch,"POST",`${this.url}/factors/${e.factorId}/challenge`,{body:{channel:e.channel},headers:this.headers,jwt:(r=s?.session)===null||r===void 0?void 0:r.access_token})})}catch(n){if(ce(n))return{data:null,error:n};throw n}})}async _challengeAndVerify(e){const{data:n,error:r}=await this._challenge({factorId:e.factorId});return r?{data:null,error:r}:await this._verify({factorId:e.factorId,challengeId:n.id,code:e.code})}async _listFactors(){const{data:{user:e},error:n}=await this.getUser();if(n)return{data:null,error:n};const r=e?.factors||[],s=r.filter(a=>a.factor_type==="totp"&&a.status==="verified"),i=r.filter(a=>a.factor_type==="phone"&&a.status==="verified");return{data:{all:r,totp:s,phone:i},error:null}}async _getAuthenticatorAssuranceLevel(){return this._acquireLock(-1,async()=>await this._useSession(async e=>{var n,r;const{data:{session:s},error:i}=e;if(i)return{data:null,error:i};if(!s)return{data:{currentLevel:null,nextLevel:null,currentAuthenticationMethods:[]},error:null};const a=this._decodeJWT(s.access_token);let o=null;a.aal&&(o=a.aal);let u=o;((r=(n=s.user.factors)===null||n===void 0?void 0:n.filter(d=>d.status==="verified"))!==null&&r!==void 0?r:[]).length>0&&(u="aal2");const c=a.amr||[];return{data:{currentLevel:o,nextLevel:u,currentAuthenticationMethods:c},error:null}}))}}Mu.nextInstanceID=0;const j4=Mu;class $4 extends j4{constructor(e){super(e)}}var L4=function(t,e,n,r){function s(i){return i instanceof n?i:new n(function(a){a(i)})}return new(n||(n=Promise))(function(i,a){function o(c){try{l(r.next(c))}catch(d){a(d)}}function u(c){try{l(r.throw(c))}catch(d){a(d)}}function l(c){c.done?i(c.value):s(c.value).then(o,u)}l((r=r.apply(t,e||[])).next())})};class M4{constructor(e,n,r){var s,i,a;if(this.supabaseUrl=e,this.supabaseKey=n,!e)throw new Error("supabaseUrl is required.");if(!n)throw new Error("supabaseKey is required.");const o=KI(e);this.realtimeUrl=`${o}/realtime/v1`.replace(/^http/i,"ws"),this.authUrl=`${o}/auth/v1`,this.storageUrl=`${o}/storage/v1`,this.functionsUrl=`${o}/functions/v1`;const u=`sb-${new URL(this.authUrl).hostname.split(".")[0]}-auth-token`,l={db:zI,realtime:HI,auth:Object.assign(Object.assign({},qI),{storageKey:u}),global:UI},c=QI(r??{},l);this.storageKey=(s=c.auth.storageKey)!==null&&s!==void 0?s:"",this.headers=(i=c.global.headers)!==null&&i!==void 0?i:{},c.accessToken?(this.accessToken=c.accessToken,this.auth=new Proxy({},{get:(d,f)=>{throw new Error(`@supabase/supabase-js: Supabase Client is configured with the accessToken option, accessing supabase.auth.${String(f)} is not possible`)}})):this.auth=this._initSupabaseAuthClient((a=c.auth)!==null&&a!==void 0?a:{},this.headers,c.global.fetch),this.fetch=ZI(n,this._getAccessToken.bind(this),c.global.fetch),this.realtime=this._initRealtimeClient(Object.assign({headers:this.headers,accessToken:this._getAccessToken.bind(this)},c.realtime)),this.rest=new lI(`${o}/rest/v1`,{headers:this.headers,schema:c.db.schema,fetch:this.fetch}),c.accessToken||this._listenForAuthEvents()}get functions(){return new FN(this.functionsUrl,{headers:this.headers,customFetch:this.fetch})}get storage(){return new DI(this.storageUrl,this.headers,this.fetch)}from(e){return this.rest.from(e)}schema(e){return this.rest.schema(e)}rpc(e,n={},r={}){return this.rest.rpc(e,n,r)}channel(e,n={config:{}}){return this.realtime.channel(e,n)}getChannels(){return this.realtime.getChannels()}removeChannel(e){return this.realtime.removeChannel(e)}removeAllChannels(){return this.realtime.removeAllChannels()}_getAccessToken(){var e,n;return L4(this,void 0,void 0,function*(){if(this.accessToken)return yield this.accessToken();const{data:r}=yield this.auth.getSession();return(n=(e=r.session)===null||e===void 0?void 0:e.access_token)!==null&&n!==void 0?n:null})}_initSupabaseAuthClient({autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,storageKey:i,flowType:a,lock:o,debug:u},l,c){const d={Authorization:`Bearer ${this.supabaseKey}`,apikey:`${this.supabaseKey}`};return new $4({url:this.authUrl,headers:Object.assign(Object.assign({},d),l),storageKey:i,autoRefreshToken:e,persistSession:n,detectSessionInUrl:r,storage:s,flowType:a,lock:o,debug:u,fetch:c,hasCustomAuthorizationHeader:"Authorization"in this.headers})}_initRealtimeClient(e){return new kI(this.realtimeUrl,Object.assign(Object.assign({},e),{params:Object.assign({apikey:this.supabaseKey},e?.params)}))}_listenForAuthEvents(){return this.auth.onAuthStateChange((n,r)=>{this._handleTokenChanged(n,"CLIENT",r?.access_token)})}_handleTokenChanged(e,n,r){(e==="TOKEN_REFRESHED"||e==="SIGNED_IN")&&this.changedAccessToken!==r?this.changedAccessToken=r:e==="SIGNED_OUT"&&(this.realtime.setAuth(),n=="STORAGE"&&this.auth.signOut(),this.changedAccessToken=void 0)}}const D4=(t,e,n)=>new M4(t,e,n),_e=D4("https://obuohudtjurfoqikktmw.supabase.co","eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6Im9idW9odWR0anVyZm9xaWtrdG13Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3MzczOTI1NzgsImV4cCI6MjA1Mjk2ODU3OH0.yHMJxvpvI3ui1pxHSkQqmCKIHRsYbGgNICq1qJA0XeQ"),mS=v.createContext(void 0),F4=({children:t})=>{const[e,n]=v.useState(null),[r,s]=v.useState(!0),[i,a]=v.useState([]),[o,u]=v.useState(!0);v.useEffect(()=>{(async()=>{try{const{data:y,error:w}=await _e.from("organizations").select("id, name");if(w)throw w;a(y||[])}catch(y){console.error("Error loading organizations:",y)}finally{u(!1)}})(),_e.auth.getSession().then(({data:{session:y}})=>{n(y?.user??null),s(!1)});const{data:{subscription:m}}=_e.auth.onAuthStateChange((y,w)=>{n(w?.user??null)});return()=>m.unsubscribe()},[]);const f={user:e,loading:r,signIn:async(h,m)=>{const{error:y}=await _e.auth.signInWithPassword({email:h,password:m});if(y)throw y;const w=await _e.from("users").select("*").eq("email",h).single();if(!w.data)throw new Error("User not found");return w.data.organization_id==="9066e91f-faa2-4a68-8749-af0582dd435c"},signUp:async(h,m,y)=>{const{data:w,error:p}=await _e.auth.signUp({email:h,password:m});if(p)throw p;const b=await fetch("/users",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:h,organization_id:y,user_id:w.user.id})});if(!b.ok){const _=await b.json();throw new Error(_.message||"Failed to create user")}return y==="9066e91f-faa2-4a68-8749-af0582dd435c"},signOut:async()=>{const{error:h}=await _e.auth.signOut();if(h)throw h},organizations:i,loadingOrgs:o};return g.jsx(mS.Provider,{value:f,children:t})},gS=()=>{const t=v.useContext(mS);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t};function yS(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var s=t.length;for(e=0;e<s;e++)t[e]&&(n=yS(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function bS(){for(var t,e,n=0,r="",s=arguments.length;n<s;n++)(t=arguments[n])&&(e=yS(t))&&(r&&(r+=" "),r+=e);return r}const V0="-",B4=t=>{const e=z4(t),{conflictingClassGroups:n,conflictingClassGroupModifiers:r}=t;return{getClassGroupId:a=>{const o=a.split(V0);return o[0]===""&&o.length!==1&&o.shift(),wS(o,e)||U4(a)},getConflictingClassGroupIds:(a,o)=>{const u=n[a]||[];return o&&r[a]?[...u,...r[a]]:u}}},wS=(t,e)=>{if(t.length===0)return e.classGroupId;const n=t[0],r=e.nextPart.get(n),s=r?wS(t.slice(1),r):void 0;if(s)return s;if(e.validators.length===0)return;const i=t.join(V0);return e.validators.find(({validator:a})=>a(i))?.classGroupId},Vw=/^\[(.+)\]$/,U4=t=>{if(Vw.test(t)){const e=Vw.exec(t)[1],n=e?.substring(0,e.indexOf(":"));if(n)return"arbitrary.."+n}},z4=t=>{const{theme:e,prefix:n}=t,r={nextPart:new Map,validators:[]};return H4(Object.entries(t.classGroups),n).forEach(([i,a])=>{Bm(a,r,i,e)}),r},Bm=(t,e,n,r)=>{t.forEach(s=>{if(typeof s=="string"){const i=s===""?e:Ww(e,s);i.classGroupId=n;return}if(typeof s=="function"){if(q4(s)){Bm(s(r),e,n,r);return}e.validators.push({validator:s,classGroupId:n});return}Object.entries(s).forEach(([i,a])=>{Bm(a,Ww(e,i),n,r)})})},Ww=(t,e)=>{let n=t;return e.split(V0).forEach(r=>{n.nextPart.has(r)||n.nextPart.set(r,{nextPart:new Map,validators:[]}),n=n.nextPart.get(r)}),n},q4=t=>t.isThemeGetter,H4=(t,e)=>e?t.map(([n,r])=>{const s=r.map(i=>typeof i=="string"?e+i:typeof i=="object"?Object.fromEntries(Object.entries(i).map(([a,o])=>[e+a,o])):i);return[n,s]}):t,V4=t=>{if(t<1)return{get:()=>{},set:()=>{}};let e=0,n=new Map,r=new Map;const s=(i,a)=>{n.set(i,a),e++,e>t&&(e=0,r=n,n=new Map)};return{get(i){let a=n.get(i);if(a!==void 0)return a;if((a=r.get(i))!==void 0)return s(i,a),a},set(i,a){n.has(i)?n.set(i,a):s(i,a)}}},_S="!",W4=t=>{const{separator:e,experimentalParseClassName:n}=t,r=e.length===1,s=e[0],i=e.length,a=o=>{const u=[];let l=0,c=0,d;for(let w=0;w<o.length;w++){let p=o[w];if(l===0){if(p===s&&(r||o.slice(w,w+i)===e)){u.push(o.slice(c,w)),c=w+i;continue}if(p==="/"){d=w;continue}}p==="["?l++:p==="]"&&l--}const f=u.length===0?o:o.substring(c),h=f.startsWith(_S),m=h?f.substring(1):f,y=d&&d>c?d-c:void 0;return{modifiers:u,hasImportantModifier:h,baseClassName:m,maybePostfixModifierPosition:y}};return n?o=>n({className:o,parseClassName:a}):a},G4=t=>{if(t.length<=1)return t;const e=[];let n=[];return t.forEach(r=>{r[0]==="["?(e.push(...n.sort(),r),n=[]):n.push(r)}),e.push(...n.sort()),e},Z4=t=>({cache:V4(t.cacheSize),parseClassName:W4(t),...B4(t)}),J4=/\s+/,K4=(t,e)=>{const{parseClassName:n,getClassGroupId:r,getConflictingClassGroupIds:s}=e,i=[],a=t.trim().split(J4);let o="";for(let u=a.length-1;u>=0;u-=1){const l=a[u],{modifiers:c,hasImportantModifier:d,baseClassName:f,maybePostfixModifierPosition:h}=n(l);let m=!!h,y=r(m?f.substring(0,h):f);if(!y){if(!m){o=l+(o.length>0?" "+o:o);continue}if(y=r(f),!y){o=l+(o.length>0?" "+o:o);continue}m=!1}const w=G4(c).join(":"),p=d?w+_S:w,b=p+y;if(i.includes(b))continue;i.push(b);const _=s(y,m);for(let x=0;x<_.length;++x){const S=_[x];i.push(p+S)}o=l+(o.length>0?" "+o:o)}return o};function Q4(){let t=0,e,n,r="";for(;t<arguments.length;)(e=arguments[t++])&&(n=vS(e))&&(r&&(r+=" "),r+=n);return r}const vS=t=>{if(typeof t=="string")return t;let e,n="";for(let r=0;r<t.length;r++)t[r]&&(e=vS(t[r]))&&(n&&(n+=" "),n+=e);return n};function X4(t,...e){let n,r,s,i=a;function a(u){const l=e.reduce((c,d)=>d(c),t());return n=Z4(l),r=n.cache.get,s=n.cache.set,i=o,o(u)}function o(u){const l=r(u);if(l)return l;const c=K4(u,n);return s(u,c),c}return function(){return i(Q4.apply(null,arguments))}}const Fe=t=>{const e=n=>n[t]||[];return e.isThemeGetter=!0,e},xS=/^\[(?:([a-z-]+):)?(.+)\]$/i,Y4=/^\d+\/\d+$/,eR=new Set(["px","full","screen"]),tR=/^(\d+(\.\d+)?)?(xs|sm|md|lg|xl)$/,nR=/\d+(%|px|r?em|[sdl]?v([hwib]|min|max)|pt|pc|in|cm|mm|cap|ch|ex|r?lh|cq(w|h|i|b|min|max))|\b(calc|min|max|clamp)\(.+\)|^0$/,rR=/^(rgba?|hsla?|hwb|(ok)?(lab|lch))\(.+\)$/,sR=/^(inset_)?-?((\d+)?\.?(\d+)[a-z]+|0)_-?((\d+)?\.?(\d+)[a-z]+|0)/,iR=/^(url|image|image-set|cross-fade|element|(repeating-)?(linear|radial|conic)-gradient)\(.+\)$/,Or=t=>Sa(t)||eR.has(t)||Y4.test(t),ss=t=>uo(t,"length",hR),Sa=t=>!!t&&!Number.isNaN(Number(t)),qh=t=>uo(t,"number",Sa),Lo=t=>!!t&&Number.isInteger(Number(t)),aR=t=>t.endsWith("%")&&Sa(t.slice(0,-1)),oe=t=>xS.test(t),is=t=>tR.test(t),oR=new Set(["length","size","percentage"]),uR=t=>uo(t,oR,SS),lR=t=>uo(t,"position",SS),cR=new Set(["image","url"]),dR=t=>uo(t,cR,mR),fR=t=>uo(t,"",pR),Mo=()=>!0,uo=(t,e,n)=>{const r=xS.exec(t);return r?r[1]?typeof e=="string"?r[1]===e:e.has(r[1]):n(r[2]):!1},hR=t=>nR.test(t)&&!rR.test(t),SS=()=>!1,pR=t=>sR.test(t),mR=t=>iR.test(t),gR=()=>{const t=Fe("colors"),e=Fe("spacing"),n=Fe("blur"),r=Fe("brightness"),s=Fe("borderColor"),i=Fe("borderRadius"),a=Fe("borderSpacing"),o=Fe("borderWidth"),u=Fe("contrast"),l=Fe("grayscale"),c=Fe("hueRotate"),d=Fe("invert"),f=Fe("gap"),h=Fe("gradientColorStops"),m=Fe("gradientColorStopPositions"),y=Fe("inset"),w=Fe("margin"),p=Fe("opacity"),b=Fe("padding"),_=Fe("saturate"),x=Fe("scale"),S=Fe("sepia"),E=Fe("skew"),k=Fe("space"),T=Fe("translate"),$=()=>["auto","contain","none"],j=()=>["auto","hidden","clip","visible","scroll"],H=()=>["auto",oe,e],q=()=>[oe,e],X=()=>["",Or,ss],O=()=>["auto",Sa,oe],I=()=>["bottom","center","left","left-bottom","left-top","right","right-bottom","right-top","top"],L=()=>["solid","dashed","dotted","double","none"],F=()=>["normal","multiply","screen","overlay","darken","lighten","color-dodge","color-burn","hard-light","soft-light","difference","exclusion","hue","saturation","color","luminosity"],A=()=>["start","end","center","between","around","evenly","stretch"],C=()=>["","0",oe],M=()=>["auto","avoid","all","avoid-page","page","left","right","column"],W=()=>[Sa,oe];return{cacheSize:500,separator:":",theme:{colors:[Mo],spacing:[Or,ss],blur:["none","",is,oe],brightness:W(),borderColor:[t],borderRadius:["none","","full",is,oe],borderSpacing:q(),borderWidth:X(),contrast:W(),grayscale:C(),hueRotate:W(),invert:C(),gap:q(),gradientColorStops:[t],gradientColorStopPositions:[aR,ss],inset:H(),margin:H(),opacity:W(),padding:q(),saturate:W(),scale:W(),sepia:C(),skew:W(),space:q(),translate:q()},classGroups:{aspect:[{aspect:["auto","square","video",oe]}],container:["container"],columns:[{columns:[is]}],"break-after":[{"break-after":M()}],"break-before":[{"break-before":M()}],"break-inside":[{"break-inside":["auto","avoid","avoid-page","avoid-column"]}],"box-decoration":[{"box-decoration":["slice","clone"]}],box:[{box:["border","content"]}],display:["block","inline-block","inline","flex","inline-flex","table","inline-table","table-caption","table-cell","table-column","table-column-group","table-footer-group","table-header-group","table-row-group","table-row","flow-root","grid","inline-grid","contents","list-item","hidden"],float:[{float:["right","left","none","start","end"]}],clear:[{clear:["left","right","both","none","start","end"]}],isolation:["isolate","isolation-auto"],"object-fit":[{object:["contain","cover","fill","none","scale-down"]}],"object-position":[{object:[...I(),oe]}],overflow:[{overflow:j()}],"overflow-x":[{"overflow-x":j()}],"overflow-y":[{"overflow-y":j()}],overscroll:[{overscroll:$()}],"overscroll-x":[{"overscroll-x":$()}],"overscroll-y":[{"overscroll-y":$()}],position:["static","fixed","absolute","relative","sticky"],inset:[{inset:[y]}],"inset-x":[{"inset-x":[y]}],"inset-y":[{"inset-y":[y]}],start:[{start:[y]}],end:[{end:[y]}],top:[{top:[y]}],right:[{right:[y]}],bottom:[{bottom:[y]}],left:[{left:[y]}],visibility:["visible","invisible","collapse"],z:[{z:["auto",Lo,oe]}],basis:[{basis:H()}],"flex-direction":[{flex:["row","row-reverse","col","col-reverse"]}],"flex-wrap":[{flex:["wrap","wrap-reverse","nowrap"]}],flex:[{flex:["1","auto","initial","none",oe]}],grow:[{grow:C()}],shrink:[{shrink:C()}],order:[{order:["first","last","none",Lo,oe]}],"grid-cols":[{"grid-cols":[Mo]}],"col-start-end":[{col:["auto",{span:["full",Lo,oe]},oe]}],"col-start":[{"col-start":O()}],"col-end":[{"col-end":O()}],"grid-rows":[{"grid-rows":[Mo]}],"row-start-end":[{row:["auto",{span:[Lo,oe]},oe]}],"row-start":[{"row-start":O()}],"row-end":[{"row-end":O()}],"grid-flow":[{"grid-flow":["row","col","dense","row-dense","col-dense"]}],"auto-cols":[{"auto-cols":["auto","min","max","fr",oe]}],"auto-rows":[{"auto-rows":["auto","min","max","fr",oe]}],gap:[{gap:[f]}],"gap-x":[{"gap-x":[f]}],"gap-y":[{"gap-y":[f]}],"justify-content":[{justify:["normal",...A()]}],"justify-items":[{"justify-items":["start","end","center","stretch"]}],"justify-self":[{"justify-self":["auto","start","end","center","stretch"]}],"align-content":[{content:["normal",...A(),"baseline"]}],"align-items":[{items:["start","end","center","baseline","stretch"]}],"align-self":[{self:["auto","start","end","center","stretch","baseline"]}],"place-content":[{"place-content":[...A(),"baseline"]}],"place-items":[{"place-items":["start","end","center","baseline","stretch"]}],"place-self":[{"place-self":["auto","start","end","center","stretch"]}],p:[{p:[b]}],px:[{px:[b]}],py:[{py:[b]}],ps:[{ps:[b]}],pe:[{pe:[b]}],pt:[{pt:[b]}],pr:[{pr:[b]}],pb:[{pb:[b]}],pl:[{pl:[b]}],m:[{m:[w]}],mx:[{mx:[w]}],my:[{my:[w]}],ms:[{ms:[w]}],me:[{me:[w]}],mt:[{mt:[w]}],mr:[{mr:[w]}],mb:[{mb:[w]}],ml:[{ml:[w]}],"space-x":[{"space-x":[k]}],"space-x-reverse":["space-x-reverse"],"space-y":[{"space-y":[k]}],"space-y-reverse":["space-y-reverse"],w:[{w:["auto","min","max","fit","svw","lvw","dvw",oe,e]}],"min-w":[{"min-w":[oe,e,"min","max","fit"]}],"max-w":[{"max-w":[oe,e,"none","full","min","max","fit","prose",{screen:[is]},is]}],h:[{h:[oe,e,"auto","min","max","fit","svh","lvh","dvh"]}],"min-h":[{"min-h":[oe,e,"min","max","fit","svh","lvh","dvh"]}],"max-h":[{"max-h":[oe,e,"min","max","fit","svh","lvh","dvh"]}],size:[{size:[oe,e,"auto","min","max","fit"]}],"font-size":[{text:["base",is,ss]}],"font-smoothing":["antialiased","subpixel-antialiased"],"font-style":["italic","not-italic"],"font-weight":[{font:["thin","extralight","light","normal","medium","semibold","bold","extrabold","black",qh]}],"font-family":[{font:[Mo]}],"fvn-normal":["normal-nums"],"fvn-ordinal":["ordinal"],"fvn-slashed-zero":["slashed-zero"],"fvn-figure":["lining-nums","oldstyle-nums"],"fvn-spacing":["proportional-nums","tabular-nums"],"fvn-fraction":["diagonal-fractions","stacked-fractions"],tracking:[{tracking:["tighter","tight","normal","wide","wider","widest",oe]}],"line-clamp":[{"line-clamp":["none",Sa,qh]}],leading:[{leading:["none","tight","snug","normal","relaxed","loose",Or,oe]}],"list-image":[{"list-image":["none",oe]}],"list-style-type":[{list:["none","disc","decimal",oe]}],"list-style-position":[{list:["inside","outside"]}],"placeholder-color":[{placeholder:[t]}],"placeholder-opacity":[{"placeholder-opacity":[p]}],"text-alignment":[{text:["left","center","right","justify","start","end"]}],"text-color":[{text:[t]}],"text-opacity":[{"text-opacity":[p]}],"text-decoration":["underline","overline","line-through","no-underline"],"text-decoration-style":[{decoration:[...L(),"wavy"]}],"text-decoration-thickness":[{decoration:["auto","from-font",Or,ss]}],"underline-offset":[{"underline-offset":["auto",Or,oe]}],"text-decoration-color":[{decoration:[t]}],"text-transform":["uppercase","lowercase","capitalize","normal-case"],"text-overflow":["truncate","text-ellipsis","text-clip"],"text-wrap":[{text:["wrap","nowrap","balance","pretty"]}],indent:[{indent:q()}],"vertical-align":[{align:["baseline","top","middle","bottom","text-top","text-bottom","sub","super",oe]}],whitespace:[{whitespace:["normal","nowrap","pre","pre-line","pre-wrap","break-spaces"]}],break:[{break:["normal","words","all","keep"]}],hyphens:[{hyphens:["none","manual","auto"]}],content:[{content:["none",oe]}],"bg-attachment":[{bg:["fixed","local","scroll"]}],"bg-clip":[{"bg-clip":["border","padding","content","text"]}],"bg-opacity":[{"bg-opacity":[p]}],"bg-origin":[{"bg-origin":["border","padding","content"]}],"bg-position":[{bg:[...I(),lR]}],"bg-repeat":[{bg:["no-repeat",{repeat:["","x","y","round","space"]}]}],"bg-size":[{bg:["auto","cover","contain",uR]}],"bg-image":[{bg:["none",{"gradient-to":["t","tr","r","br","b","bl","l","tl"]},dR]}],"bg-color":[{bg:[t]}],"gradient-from-pos":[{from:[m]}],"gradient-via-pos":[{via:[m]}],"gradient-to-pos":[{to:[m]}],"gradient-from":[{from:[h]}],"gradient-via":[{via:[h]}],"gradient-to":[{to:[h]}],rounded:[{rounded:[i]}],"rounded-s":[{"rounded-s":[i]}],"rounded-e":[{"rounded-e":[i]}],"rounded-t":[{"rounded-t":[i]}],"rounded-r":[{"rounded-r":[i]}],"rounded-b":[{"rounded-b":[i]}],"rounded-l":[{"rounded-l":[i]}],"rounded-ss":[{"rounded-ss":[i]}],"rounded-se":[{"rounded-se":[i]}],"rounded-ee":[{"rounded-ee":[i]}],"rounded-es":[{"rounded-es":[i]}],"rounded-tl":[{"rounded-tl":[i]}],"rounded-tr":[{"rounded-tr":[i]}],"rounded-br":[{"rounded-br":[i]}],"rounded-bl":[{"rounded-bl":[i]}],"border-w":[{border:[o]}],"border-w-x":[{"border-x":[o]}],"border-w-y":[{"border-y":[o]}],"border-w-s":[{"border-s":[o]}],"border-w-e":[{"border-e":[o]}],"border-w-t":[{"border-t":[o]}],"border-w-r":[{"border-r":[o]}],"border-w-b":[{"border-b":[o]}],"border-w-l":[{"border-l":[o]}],"border-opacity":[{"border-opacity":[p]}],"border-style":[{border:[...L(),"hidden"]}],"divide-x":[{"divide-x":[o]}],"divide-x-reverse":["divide-x-reverse"],"divide-y":[{"divide-y":[o]}],"divide-y-reverse":["divide-y-reverse"],"divide-opacity":[{"divide-opacity":[p]}],"divide-style":[{divide:L()}],"border-color":[{border:[s]}],"border-color-x":[{"border-x":[s]}],"border-color-y":[{"border-y":[s]}],"border-color-s":[{"border-s":[s]}],"border-color-e":[{"border-e":[s]}],"border-color-t":[{"border-t":[s]}],"border-color-r":[{"border-r":[s]}],"border-color-b":[{"border-b":[s]}],"border-color-l":[{"border-l":[s]}],"divide-color":[{divide:[s]}],"outline-style":[{outline:["",...L()]}],"outline-offset":[{"outline-offset":[Or,oe]}],"outline-w":[{outline:[Or,ss]}],"outline-color":[{outline:[t]}],"ring-w":[{ring:X()}],"ring-w-inset":["ring-inset"],"ring-color":[{ring:[t]}],"ring-opacity":[{"ring-opacity":[p]}],"ring-offset-w":[{"ring-offset":[Or,ss]}],"ring-offset-color":[{"ring-offset":[t]}],shadow:[{shadow:["","inner","none",is,fR]}],"shadow-color":[{shadow:[Mo]}],opacity:[{opacity:[p]}],"mix-blend":[{"mix-blend":[...F(),"plus-lighter","plus-darker"]}],"bg-blend":[{"bg-blend":F()}],filter:[{filter:["","none"]}],blur:[{blur:[n]}],brightness:[{brightness:[r]}],contrast:[{contrast:[u]}],"drop-shadow":[{"drop-shadow":["","none",is,oe]}],grayscale:[{grayscale:[l]}],"hue-rotate":[{"hue-rotate":[c]}],invert:[{invert:[d]}],saturate:[{saturate:[_]}],sepia:[{sepia:[S]}],"backdrop-filter":[{"backdrop-filter":["","none"]}],"backdrop-blur":[{"backdrop-blur":[n]}],"backdrop-brightness":[{"backdrop-brightness":[r]}],"backdrop-contrast":[{"backdrop-contrast":[u]}],"backdrop-grayscale":[{"backdrop-grayscale":[l]}],"backdrop-hue-rotate":[{"backdrop-hue-rotate":[c]}],"backdrop-invert":[{"backdrop-invert":[d]}],"backdrop-opacity":[{"backdrop-opacity":[p]}],"backdrop-saturate":[{"backdrop-saturate":[_]}],"backdrop-sepia":[{"backdrop-sepia":[S]}],"border-collapse":[{border:["collapse","separate"]}],"border-spacing":[{"border-spacing":[a]}],"border-spacing-x":[{"border-spacing-x":[a]}],"border-spacing-y":[{"border-spacing-y":[a]}],"table-layout":[{table:["auto","fixed"]}],caption:[{caption:["top","bottom"]}],transition:[{transition:["none","all","","colors","opacity","shadow","transform",oe]}],duration:[{duration:W()}],ease:[{ease:["linear","in","out","in-out",oe]}],delay:[{delay:W()}],animate:[{animate:["none","spin","ping","pulse","bounce",oe]}],transform:[{transform:["","gpu","none"]}],scale:[{scale:[x]}],"scale-x":[{"scale-x":[x]}],"scale-y":[{"scale-y":[x]}],rotate:[{rotate:[Lo,oe]}],"translate-x":[{"translate-x":[T]}],"translate-y":[{"translate-y":[T]}],"skew-x":[{"skew-x":[E]}],"skew-y":[{"skew-y":[E]}],"transform-origin":[{origin:["center","top","top-right","right","bottom-right","bottom","bottom-left","left","top-left",oe]}],accent:[{accent:["auto",t]}],appearance:[{appearance:["none","auto"]}],cursor:[{cursor:["auto","default","pointer","wait","text","move","help","not-allowed","none","context-menu","progress","cell","crosshair","vertical-text","alias","copy","no-drop","grab","grabbing","all-scroll","col-resize","row-resize","n-resize","e-resize","s-resize","w-resize","ne-resize","nw-resize","se-resize","sw-resize","ew-resize","ns-resize","nesw-resize","nwse-resize","zoom-in","zoom-out",oe]}],"caret-color":[{caret:[t]}],"pointer-events":[{"pointer-events":["none","auto"]}],resize:[{resize:["none","y","x",""]}],"scroll-behavior":[{scroll:["auto","smooth"]}],"scroll-m":[{"scroll-m":q()}],"scroll-mx":[{"scroll-mx":q()}],"scroll-my":[{"scroll-my":q()}],"scroll-ms":[{"scroll-ms":q()}],"scroll-me":[{"scroll-me":q()}],"scroll-mt":[{"scroll-mt":q()}],"scroll-mr":[{"scroll-mr":q()}],"scroll-mb":[{"scroll-mb":q()}],"scroll-ml":[{"scroll-ml":q()}],"scroll-p":[{"scroll-p":q()}],"scroll-px":[{"scroll-px":q()}],"scroll-py":[{"scroll-py":q()}],"scroll-ps":[{"scroll-ps":q()}],"scroll-pe":[{"scroll-pe":q()}],"scroll-pt":[{"scroll-pt":q()}],"scroll-pr":[{"scroll-pr":q()}],"scroll-pb":[{"scroll-pb":q()}],"scroll-pl":[{"scroll-pl":q()}],"snap-align":[{snap:["start","end","center","align-none"]}],"snap-stop":[{snap:["normal","always"]}],"snap-type":[{snap:["none","x","y","both"]}],"snap-strictness":[{snap:["mandatory","proximity"]}],touch:[{touch:["auto","none","manipulation"]}],"touch-x":[{"touch-pan":["x","left","right"]}],"touch-y":[{"touch-pan":["y","up","down"]}],"touch-pz":["touch-pinch-zoom"],select:[{select:["none","text","all","auto"]}],"will-change":[{"will-change":["auto","scroll","contents","transform",oe]}],fill:[{fill:[t,"none"]}],"stroke-w":[{stroke:[Or,ss,qh]}],stroke:[{stroke:[t,"none"]}],sr:["sr-only","not-sr-only"],"forced-color-adjust":[{"forced-color-adjust":["auto","none"]}]},conflictingClassGroups:{overflow:["overflow-x","overflow-y"],overscroll:["overscroll-x","overscroll-y"],inset:["inset-x","inset-y","start","end","top","right","bottom","left"],"inset-x":["right","left"],"inset-y":["top","bottom"],flex:["basis","grow","shrink"],gap:["gap-x","gap-y"],p:["px","py","ps","pe","pt","pr","pb","pl"],px:["pr","pl"],py:["pt","pb"],m:["mx","my","ms","me","mt","mr","mb","ml"],mx:["mr","ml"],my:["mt","mb"],size:["w","h"],"font-size":["leading"],"fvn-normal":["fvn-ordinal","fvn-slashed-zero","fvn-figure","fvn-spacing","fvn-fraction"],"fvn-ordinal":["fvn-normal"],"fvn-slashed-zero":["fvn-normal"],"fvn-figure":["fvn-normal"],"fvn-spacing":["fvn-normal"],"fvn-fraction":["fvn-normal"],"line-clamp":["display","overflow"],rounded:["rounded-s","rounded-e","rounded-t","rounded-r","rounded-b","rounded-l","rounded-ss","rounded-se","rounded-ee","rounded-es","rounded-tl","rounded-tr","rounded-br","rounded-bl"],"rounded-s":["rounded-ss","rounded-es"],"rounded-e":["rounded-se","rounded-ee"],"rounded-t":["rounded-tl","rounded-tr"],"rounded-r":["rounded-tr","rounded-br"],"rounded-b":["rounded-br","rounded-bl"],"rounded-l":["rounded-tl","rounded-bl"],"border-spacing":["border-spacing-x","border-spacing-y"],"border-w":["border-w-s","border-w-e","border-w-t","border-w-r","border-w-b","border-w-l"],"border-w-x":["border-w-r","border-w-l"],"border-w-y":["border-w-t","border-w-b"],"border-color":["border-color-s","border-color-e","border-color-t","border-color-r","border-color-b","border-color-l"],"border-color-x":["border-color-r","border-color-l"],"border-color-y":["border-color-t","border-color-b"],"scroll-m":["scroll-mx","scroll-my","scroll-ms","scroll-me","scroll-mt","scroll-mr","scroll-mb","scroll-ml"],"scroll-mx":["scroll-mr","scroll-ml"],"scroll-my":["scroll-mt","scroll-mb"],"scroll-p":["scroll-px","scroll-py","scroll-ps","scroll-pe","scroll-pt","scroll-pr","scroll-pb","scroll-pl"],"scroll-px":["scroll-pr","scroll-pl"],"scroll-py":["scroll-pt","scroll-pb"],touch:["touch-x","touch-y","touch-pz"],"touch-x":["touch"],"touch-y":["touch"],"touch-pz":["touch"]},conflictingClassGroupModifiers:{"font-size":["leading"]}}},yR=X4(gR);function at(...t){return yR(bS(t))}function jt(t,e="Unknown"){return t?t.profile&&typeof t.profile=="object"&&"name"in t.profile?t.profile.name:t.email.split("@")[0]||e:e}const kS=v.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:at("rounded-lg border bg-card text-card-foreground shadow-sm",t),...e}));kS.displayName="Card";const ES=v.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:at("flex flex-col space-y-1.5 p-6",t),...e}));ES.displayName="CardHeader";const AS=v.forwardRef(({className:t,...e},n)=>g.jsx("h3",{ref:n,className:at("text-2xl font-semibold leading-none tracking-tight",t),...e}));AS.displayName="CardTitle";const TS=v.forwardRef(({className:t,...e},n)=>g.jsx("p",{ref:n,className:at("text-sm text-muted-foreground",t),...e}));TS.displayName="CardDescription";const CS=v.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:at("p-6 pt-0",t),...e}));CS.displayName="CardContent";const PS=v.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:at("flex items-center p-6 pt-0",t),...e}));PS.displayName="CardFooter";function Gw(t,e){if(typeof t=="function")return t(e);t!=null&&(t.current=e)}function OS(...t){return e=>{let n=!1;const r=t.map(s=>{const i=Gw(s,e);return!n&&typeof i=="function"&&(n=!0),i});if(n)return()=>{for(let s=0;s<r.length;s++){const i=r[s];typeof i=="function"?i():Gw(t[s],null)}}}}function xt(...t){return v.useCallback(OS(...t),t)}var Ba=v.forwardRef((t,e)=>{const{children:n,...r}=t,s=v.Children.toArray(n),i=s.find(wR);if(i){const a=i.props.children,o=s.map(u=>u===i?v.Children.count(a)>1?v.Children.only(null):v.isValidElement(a)?a.props.children:null:u);return g.jsx(Um,{...r,ref:e,children:v.isValidElement(a)?v.cloneElement(a,void 0,o):null})}return g.jsx(Um,{...r,ref:e,children:n})});Ba.displayName="Slot";var Um=v.forwardRef((t,e)=>{const{children:n,...r}=t;if(v.isValidElement(n)){const s=vR(n);return v.cloneElement(n,{..._R(r,n.props),ref:e?OS(e,s):s})}return v.Children.count(n)>1?v.Children.only(null):null});Um.displayName="SlotClone";var bR=({children:t})=>g.jsx(g.Fragment,{children:t});function wR(t){return v.isValidElement(t)&&t.type===bR}function _R(t,e){const n={...e};for(const r in e){const s=t[r],i=e[r];/^on[A-Z]/.test(r)?s&&i?n[r]=(...o)=>{i(...o),s(...o)}:s&&(n[r]=s):r==="style"?n[r]={...s,...i}:r==="className"&&(n[r]=[s,i].filter(Boolean).join(" "))}return{...t,...n}}function vR(t){let e=Object.getOwnPropertyDescriptor(t.props,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning;return n?t.ref:(e=Object.getOwnPropertyDescriptor(t,"ref")?.get,n=e&&"isReactWarning"in e&&e.isReactWarning,n?t.props.ref:t.props.ref||t.ref)}const Zw=t=>typeof t=="boolean"?`${t}`:t===0?"0":t,Jw=bS,W0=(t,e)=>n=>{var r;if(e?.variants==null)return Jw(t,n?.class,n?.className);const{variants:s,defaultVariants:i}=e,a=Object.keys(s).map(l=>{const c=n?.[l],d=i?.[l];if(c===null)return null;const f=Zw(c)||Zw(d);return s[l][f]}),o=n&&Object.entries(n).reduce((l,c)=>{let[d,f]=c;return f===void 0||(l[d]=f),l},{}),u=e==null||(r=e.compoundVariants)===null||r===void 0?void 0:r.reduce((l,c)=>{let{class:d,className:f,...h}=c;return Object.entries(h).every(m=>{let[y,w]=m;return Array.isArray(w)?w.includes({...i,...o}[y]):{...i,...o}[y]===w})?[...l,d,f]:l},[]);return Jw(t,a,u,n?.class,n?.className)},xR=W0("inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0",{variants:{variant:{default:"bg-primary text-primary-foreground hover:bg-primary/90",destructive:"bg-destructive text-destructive-foreground hover:bg-destructive/90",outline:"border border-input bg-background hover:bg-accent hover:text-accent-foreground",secondary:"bg-secondary text-secondary-foreground hover:bg-secondary/80",custom:"border border-input bg-secondary text-secondary-foreground hover:bg-secondary/80",ghost:"hover:bg-accent hover:text-accent-foreground",link:"text-primary underline-offset-4 hover:underline"},size:{default:"h-10 px-4 py-2",sm:"h-9 rounded-md px-3",lg:"h-11 rounded-md px-8",icon:"h-10 w-10"}},defaultVariants:{variant:"default",size:"default"}}),zm=v.forwardRef(({className:t,variant:e,size:n,asChild:r=!1,...s},i)=>{const a=r?Ba:"button";return g.jsx(a,{className:at(xR({variant:e,size:n,className:t})),ref:i,...s})});zm.displayName="Button";const qm=v.forwardRef(({className:t,type:e,...n},r)=>g.jsx("input",{type:e,className:at("flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50",t),ref:r,...n}));qm.displayName="Input";var SR=["a","button","div","form","h2","h3","img","input","label","li","nav","ol","p","span","svg","ul"],Xe=SR.reduce((t,e)=>{const n=v.forwardRef((r,s)=>{const{asChild:i,...a}=r,o=i?Ba:e;return typeof window<"u"&&(window[Symbol.for("radix-ui")]=!0),g.jsx(o,{...a,ref:s})});return n.displayName=`Primitive.${e}`,{...t,[e]:n}},{});function kR(t,e){t&&no.flushSync(()=>t.dispatchEvent(e))}var ER="Label",NS=v.forwardRef((t,e)=>g.jsx(Xe.label,{...t,ref:e,onMouseDown:n=>{n.target.closest("button, input, select, textarea")||(t.onMouseDown?.(n),!n.defaultPrevented&&n.detail>1&&n.preventDefault())}}));NS.displayName=ER;var IS=NS;const AR=W0("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),qc=v.forwardRef(({className:t,...e},n)=>g.jsx(IS,{ref:n,className:at(AR(),t),...e}));qc.displayName=IS.displayName;const TR=W0("relative w-full rounded-lg border p-4 [&>svg~*]:pl-7 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),RS=v.forwardRef(({className:t,variant:e,...n},r)=>g.jsx("div",{ref:r,role:"alert",className:at(TR({variant:e}),t),...n}));RS.displayName="Alert";const CR=v.forwardRef(({className:t,...e},n)=>g.jsx("h5",{ref:n,className:at("mb-1 font-medium leading-none tracking-tight",t),...e}));CR.displayName="AlertTitle";const jS=v.forwardRef(({className:t,...e},n)=>g.jsx("div",{ref:n,className:at("text-sm [&_p]:leading-relaxed",t),...e}));jS.displayName="AlertDescription";/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PR=t=>t.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),$S=(...t)=>t.filter((e,n,r)=>!!e&&e.trim()!==""&&r.indexOf(e)===n).join(" ").trim();/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var OR={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NR=v.forwardRef(({color:t="currentColor",size:e=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:s="",children:i,iconNode:a,...o},u)=>v.createElement("svg",{ref:u,...OR,width:e,height:e,stroke:t,strokeWidth:r?Number(n)*24/Number(e):n,className:$S("lucide",s),...o},[...a.map(([l,c])=>v.createElement(l,c)),...Array.isArray(i)?i:[i]]));/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Re=(t,e)=>{const n=v.forwardRef(({className:r,...s},i)=>v.createElement(NR,{ref:i,iconNode:e,className:$S(`lucide-${PR(t)}`,r),...s}));return n.displayName=`${t}`,n};/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IR=[["path",{d:"M10.268 21a2 2 0 0 0 3.464 0",key:"vwvbt9"}],["path",{d:"M3.262 15.326A1 1 0 0 0 4 17h16a1 1 0 0 0 .74-1.673C19.41 13.956 18 12.499 18 8A6 6 0 0 0 6 8c0 4.499-1.411 5.956-2.738 7.326",key:"11g9vi"}]],LS=Re("Bell",IR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RR=[["path",{d:"M3 3v16a2 2 0 0 0 2 2h16",key:"c24i48"}],["path",{d:"M18 17V9",key:"2bz60n"}],["path",{d:"M13 17V5",key:"1frdt8"}],["path",{d:"M8 17v-3",key:"17ska0"}]],jR=Re("ChartColumn",RR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const $R=[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]],LR=Re("Check",$R);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MR=[["path",{d:"m6 9 6 6 6-6",key:"qrunsl"}]],bl=Re("ChevronDown",MR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DR=[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]],FR=Re("ChevronLeft",DR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BR=[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]],UR=Re("ChevronRight",BR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const zR=[["path",{d:"m18 15-6-6-6 6",key:"153udz"}]],MS=Re("ChevronUp",zR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const qR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M9.09 9a3 3 0 0 1 5.83 1c0 2-3 3-3 3",key:"1u773s"}],["path",{d:"M12 17h.01",key:"p32p05"}]],DS=Re("CircleHelp",qR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const HR=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}]],G0=Re("Circle",HR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const VR=[["path",{d:"M18 2h-3a5 5 0 0 0-5 5v3H7v4h3v8h4v-8h3l1-4h-4V7a1 1 0 0 1 1-1h3z",key:"1jg4f8"}]],WR=Re("Facebook",VR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const GR=[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M3 9h18",key:"1pudct"}],["path",{d:"M3 15h18",key:"5xshup"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]],FS=Re("Grid3x3",GR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ZR=[["path",{d:"M15 21v-8a1 1 0 0 0-1-1h-4a1 1 0 0 0-1 1v8",key:"5wwlr5"}],["path",{d:"M3 10a2 2 0 0 1 .709-1.528l7-5.999a2 2 0 0 1 2.582 0l7 5.999A2 2 0 0 1 21 10v9a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2z",key:"1d0kgt"}]],JR=Re("House",ZR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const KR=[["path",{d:"M9 17H7A5 5 0 0 1 7 7h2",key:"8i5ue5"}],["path",{d:"M15 7h2a5 5 0 1 1 0 10h-2",key:"1b9ql8"}],["line",{x1:"8",x2:"16",y1:"12",y2:"12",key:"1jonct"}]],QR=Re("Link2",KR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const XR=[["path",{d:"M16 8a6 6 0 0 1 6 6v7h-4v-7a2 2 0 0 0-2-2 2 2 0 0 0-2 2v7h-4v-7a6 6 0 0 1 6-6z",key:"c2jq9f"}],["rect",{width:"4",height:"12",x:"2",y:"9",key:"mk3on5"}],["circle",{cx:"4",cy:"4",r:"2",key:"bt5ra8"}]],YR=Re("Linkedin",XR);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const e6=[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]],t6=Re("LoaderCircle",e6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const n6=[["path",{d:"M9 21H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h4",key:"1uf3rs"}],["polyline",{points:"16 17 21 12 16 7",key:"1gabdz"}],["line",{x1:"21",x2:"9",y1:"12",y2:"12",key:"1uyos4"}]],BS=Re("LogOut",n6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const r6=[["polyline",{points:"15 3 21 3 21 9",key:"mznyad"}],["polyline",{points:"9 21 3 21 3 15",key:"1avn1i"}],["line",{x1:"21",x2:"14",y1:"3",y2:"10",key:"ota7mn"}],["line",{x1:"3",x2:"10",y1:"21",y2:"14",key:"1atl0r"}]],s6=Re("Maximize2",r6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const i6=[["path",{d:"M7.9 20A9 9 0 1 0 4 16.1L2 22Z",key:"vv11sd"}]],Z0=Re("MessageCircle",i6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const a6=[["path",{d:"M5 12h14",key:"1ays0h"}]],o6=Re("Minus",a6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const u6=[["path",{d:"M13.234 20.252 21 12.3",key:"1cbrk9"}],["path",{d:"m16 6-8.414 8.586a2 2 0 0 0 0 2.828 2 2 0 0 0 2.828 0l8.414-8.586a4 4 0 0 0 0-5.656 4 4 0 0 0-5.656 0l-8.415 8.585a6 6 0 1 0 8.486 8.486",key:"1pkts6"}]],l6=Re("Paperclip",u6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const c6=[["path",{d:"M22 16.92v3a2 2 0 0 1-2.18 2 19.79 19.79 0 0 1-8.63-3.07 19.5 19.5 0 0 1-6-6 19.79 19.79 0 0 1-3.07-8.67A2 2 0 0 1 4.11 2h3a2 2 0 0 1 2 1.72 12.84 12.84 0 0 0 .7 2.81 2 2 0 0 1-.45 2.11L8.09 9.91a16 16 0 0 0 6 6l1.27-1.27a2 2 0 0 1 2.11-.45 12.84 12.84 0 0 0 2.81.7A2 2 0 0 1 22 16.92z",key:"foiqr5"}]],US=Re("Phone",c6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const d6=[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"M12 5v14",key:"s699le"}]],If=Re("Plus",d6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const f6=[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]],zS=Re("Search",f6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const h6=[["path",{d:"M12.22 2h-.44a2 2 0 0 0-2 2v.18a2 2 0 0 1-1 1.73l-.43.25a2 2 0 0 1-2 0l-.15-.08a2 2 0 0 0-2.73.73l-.22.38a2 2 0 0 0 .73 2.73l.15.1a2 2 0 0 1 1 1.72v.51a2 2 0 0 1-1 1.74l-.15.09a2 2 0 0 0-.73 2.73l.22.38a2 2 0 0 0 2.73.73l.15-.08a2 2 0 0 1 2 0l.43.25a2 2 0 0 1 1 1.73V20a2 2 0 0 0 2 2h.44a2 2 0 0 0 2-2v-.18a2 2 0 0 1 1-1.73l.43-.25a2 2 0 0 1 2 0l.15.08a2 2 0 0 0 2.73-.73l.22-.39a2 2 0 0 0-.73-2.73l-.15-.08a2 2 0 0 1-1-1.74v-.5a2 2 0 0 1 1-1.74l.15-.09a2 2 0 0 0 .73-2.73l-.22-.38a2 2 0 0 0-2.73-.73l-.15.08a2 2 0 0 1-2 0l-.43-.25a2 2 0 0 1-1-1.73V4a2 2 0 0 0-2-2z",key:"1qme2f"}],["circle",{cx:"12",cy:"12",r:"3",key:"1v7zrd"}]],p6=Re("Settings",h6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const m6=[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 14s1.5 2 4 2 4-2 4-2",key:"1y1vjs"}],["line",{x1:"9",x2:"9.01",y1:"9",y2:"9",key:"yxxnd0"}],["line",{x1:"15",x2:"15.01",y1:"9",y2:"9",key:"1p4y9e"}]],g6=Re("Smile",m6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y6=[["path",{d:"M22 4s-.7 2.1-2 3.4c1.6 10-9.4 17.3-18 11.6 2.2.1 4.4-.6 6-2C3 15.5.5 9.6 3 5c2.2 2.6 5.6 4.1 9 4-.9-4.2 4-6.6 7-3.8 1.1 0 3-1.2 3-1.2z",key:"pff0z6"}]],b6=Re("Twitter",y6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const w6=[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]],_6=Re("Users",w6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const v6=[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]],Rf=Re("X",v6);/**
 * @license lucide-react v0.474.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x6=[["path",{d:"M2.5 17a24.12 24.12 0 0 1 0-10 2 2 0 0 1 1.4-1.4 49.56 49.56 0 0 1 16.2 0A2 2 0 0 1 21.5 7a24.12 24.12 0 0 1 0 10 2 2 0 0 1-1.4 1.4 49.55 49.55 0 0 1-16.2 0A2 2 0 0 1 2.5 17",key:"1q2vi4"}],["path",{d:"m10 15 5-3-5-3z",key:"1jp15x"}]],S6=Re("Youtube",x6);function Kw(t,[e,n]){return Math.min(n,Math.max(e,t))}function nt(t,e,{checkForDefaultPrevented:n=!0}={}){return function(s){if(t?.(s),n===!1||!s.defaultPrevented)return e?.(s)}}function J0(t,e=[]){let n=[];function r(i,a){const o=v.createContext(a),u=n.length;n=[...n,a];const l=d=>{const{scope:f,children:h,...m}=d,y=f?.[t]?.[u]||o,w=v.useMemo(()=>m,Object.values(m));return g.jsx(y.Provider,{value:w,children:h})};l.displayName=i+"Provider";function c(d,f){const h=f?.[t]?.[u]||o,m=v.useContext(h);if(m)return m;if(a!==void 0)return a;throw new Error(`\`${d}\` must be used within \`${i}\``)}return[l,c]}const s=()=>{const i=n.map(a=>v.createContext(a));return function(o){const u=o?.[t]||i;return v.useMemo(()=>({[`__scope${t}`]:{...o,[t]:u}}),[o,u])}};return s.scopeName=t,[r,k6(s,...e)]}function k6(...t){const e=t[0];if(t.length===1)return e;const n=()=>{const r=t.map(s=>({useScope:s(),scopeName:s.scopeName}));return function(i){const a=r.reduce((o,{useScope:u,scopeName:l})=>{const d=u(i)[`__scope${l}`];return{...o,...d}},{});return v.useMemo(()=>({[`__scope${e.scopeName}`]:a}),[a])}};return n.scopeName=e.scopeName,n}function E6(t){const e=t+"CollectionProvider",[n,r]=J0(e),[s,i]=n(e,{collectionRef:{current:null},itemMap:new Map}),a=h=>{const{scope:m,children:y}=h,w=Lr.useRef(null),p=Lr.useRef(new Map).current;return g.jsx(s,{scope:m,itemMap:p,collectionRef:w,children:y})};a.displayName=e;const o=t+"CollectionSlot",u=Lr.forwardRef((h,m)=>{const{scope:y,children:w}=h,p=i(o,y),b=xt(m,p.collectionRef);return g.jsx(Ba,{ref:b,children:w})});u.displayName=o;const l=t+"CollectionItemSlot",c="data-radix-collection-item",d=Lr.forwardRef((h,m)=>{const{scope:y,children:w,...p}=h,b=Lr.useRef(null),_=xt(m,b),x=i(l,y);return Lr.useEffect(()=>(x.itemMap.set(b,{ref:b,...p}),()=>void x.itemMap.delete(b))),g.jsx(Ba,{[c]:"",ref:_,children:w})});d.displayName=l;function f(h){const m=i(t+"CollectionConsumer",h);return Lr.useCallback(()=>{const w=m.collectionRef.current;if(!w)return[];const p=Array.from(w.querySelectorAll(`[${c}]`));return Array.from(m.itemMap.values()).sort((x,S)=>p.indexOf(x.ref.current)-p.indexOf(S.ref.current))},[m.collectionRef,m.itemMap])}return[{Provider:a,Slot:u,ItemSlot:d},f,r]}var A6=v.createContext(void 0);function T6(t){const e=v.useContext(A6);return t||e||"ltr"}function Qr(t){const e=v.useRef(t);return v.useEffect(()=>{e.current=t}),v.useMemo(()=>(...n)=>e.current?.(...n),[])}function C6(t,e=globalThis?.document){const n=Qr(t);v.useEffect(()=>{const r=s=>{s.key==="Escape"&&n(s)};return e.addEventListener("keydown",r,{capture:!0}),()=>e.removeEventListener("keydown",r,{capture:!0})},[n,e])}var P6="DismissableLayer",Hm="dismissableLayer.update",O6="dismissableLayer.pointerDownOutside",N6="dismissableLayer.focusOutside",Qw,qS=v.createContext({layers:new Set,layersWithOutsidePointerEventsDisabled:new Set,branches:new Set}),HS=v.forwardRef((t,e)=>{const{disableOutsidePointerEvents:n=!1,onEscapeKeyDown:r,onPointerDownOutside:s,onFocusOutside:i,onInteractOutside:a,onDismiss:o,...u}=t,l=v.useContext(qS),[c,d]=v.useState(null),f=c?.ownerDocument??globalThis?.document,[,h]=v.useState({}),m=xt(e,k=>d(k)),y=Array.from(l.layers),[w]=[...l.layersWithOutsidePointerEventsDisabled].slice(-1),p=y.indexOf(w),b=c?y.indexOf(c):-1,_=l.layersWithOutsidePointerEventsDisabled.size>0,x=b>=p,S=j6(k=>{const T=k.target,$=[...l.branches].some(j=>j.contains(T));!x||$||(s?.(k),a?.(k),k.defaultPrevented||o?.())},f),E=$6(k=>{const T=k.target;[...l.branches].some(j=>j.contains(T))||(i?.(k),a?.(k),k.defaultPrevented||o?.())},f);return C6(k=>{b===l.layers.size-1&&(r?.(k),!k.defaultPrevented&&o&&(k.preventDefault(),o()))},f),v.useEffect(()=>{if(c)return n&&(l.layersWithOutsidePointerEventsDisabled.size===0&&(Qw=f.body.style.pointerEvents,f.body.style.pointerEvents="none"),l.layersWithOutsidePointerEventsDisabled.add(c)),l.layers.add(c),Xw(),()=>{n&&l.layersWithOutsidePointerEventsDisabled.size===1&&(f.body.style.pointerEvents=Qw)}},[c,f,n,l]),v.useEffect(()=>()=>{c&&(l.layers.delete(c),l.layersWithOutsidePointerEventsDisabled.delete(c),Xw())},[c,l]),v.useEffect(()=>{const k=()=>h({});return document.addEventListener(Hm,k),()=>document.removeEventListener(Hm,k)},[]),g.jsx(Xe.div,{...u,ref:m,style:{pointerEvents:_?x?"auto":"none":void 0,...t.style},onFocusCapture:nt(t.onFocusCapture,E.onFocusCapture),onBlurCapture:nt(t.onBlurCapture,E.onBlurCapture),onPointerDownCapture:nt(t.onPointerDownCapture,S.onPointerDownCapture)})});HS.displayName=P6;var I6="DismissableLayerBranch",R6=v.forwardRef((t,e)=>{const n=v.useContext(qS),r=v.useRef(null),s=xt(e,r);return v.useEffect(()=>{const i=r.current;if(i)return n.branches.add(i),()=>{n.branches.delete(i)}},[n.branches]),g.jsx(Xe.div,{...t,ref:s})});R6.displayName=I6;function j6(t,e=globalThis?.document){const n=Qr(t),r=v.useRef(!1),s=v.useRef(()=>{});return v.useEffect(()=>{const i=o=>{if(o.target&&!r.current){let u=function(){VS(O6,n,l,{discrete:!0})};const l={originalEvent:o};o.pointerType==="touch"?(e.removeEventListener("click",s.current),s.current=u,e.addEventListener("click",s.current,{once:!0})):u()}else e.removeEventListener("click",s.current);r.current=!1},a=window.setTimeout(()=>{e.addEventListener("pointerdown",i)},0);return()=>{window.clearTimeout(a),e.removeEventListener("pointerdown",i),e.removeEventListener("click",s.current)}},[e,n]),{onPointerDownCapture:()=>r.current=!0}}function $6(t,e=globalThis?.document){const n=Qr(t),r=v.useRef(!1);return v.useEffect(()=>{const s=i=>{i.target&&!r.current&&VS(N6,n,{originalEvent:i},{discrete:!1})};return e.addEventListener("focusin",s),()=>e.removeEventListener("focusin",s)},[e,n]),{onFocusCapture:()=>r.current=!0,onBlurCapture:()=>r.current=!1}}function Xw(){const t=new CustomEvent(Hm);document.dispatchEvent(t)}function VS(t,e,n,{discrete:r}){const s=n.originalEvent.target,i=new CustomEvent(t,{bubbles:!1,cancelable:!0,detail:n});e&&s.addEventListener(t,e,{once:!0}),r?kR(s,i):s.dispatchEvent(i)}var Hh=0;function L6(){v.useEffect(()=>{const t=document.querySelectorAll("[data-radix-focus-guard]");return document.body.insertAdjacentElement("afterbegin",t[0]??Yw()),document.body.insertAdjacentElement("beforeend",t[1]??Yw()),Hh++,()=>{Hh===1&&document.querySelectorAll("[data-radix-focus-guard]").forEach(e=>e.remove()),Hh--}},[])}function Yw(){const t=document.createElement("span");return t.setAttribute("data-radix-focus-guard",""),t.tabIndex=0,t.style.outline="none",t.style.opacity="0",t.style.position="fixed",t.style.pointerEvents="none",t}var Vh="focusScope.autoFocusOnMount",Wh="focusScope.autoFocusOnUnmount",e_={bubbles:!1,cancelable:!0},M6="FocusScope",WS=v.forwardRef((t,e)=>{const{loop:n=!1,trapped:r=!1,onMountAutoFocus:s,onUnmountAutoFocus:i,...a}=t,[o,u]=v.useState(null),l=Qr(s),c=Qr(i),d=v.useRef(null),f=xt(e,y=>u(y)),h=v.useRef({paused:!1,pause(){this.paused=!0},resume(){this.paused=!1}}).current;v.useEffect(()=>{if(r){let y=function(_){if(h.paused||!o)return;const x=_.target;o.contains(x)?d.current=x:ds(d.current,{select:!0})},w=function(_){if(h.paused||!o)return;const x=_.relatedTarget;x!==null&&(o.contains(x)||ds(d.current,{select:!0}))},p=function(_){if(document.activeElement===document.body)for(const S of _)S.removedNodes.length>0&&ds(o)};document.addEventListener("focusin",y),document.addEventListener("focusout",w);const b=new MutationObserver(p);return o&&b.observe(o,{childList:!0,subtree:!0}),()=>{document.removeEventListener("focusin",y),document.removeEventListener("focusout",w),b.disconnect()}}},[r,o,h.paused]),v.useEffect(()=>{if(o){n_.add(h);const y=document.activeElement;if(!o.contains(y)){const p=new CustomEvent(Vh,e_);o.addEventListener(Vh,l),o.dispatchEvent(p),p.defaultPrevented||(D6(q6(GS(o)),{select:!0}),document.activeElement===y&&ds(o))}return()=>{o.removeEventListener(Vh,l),setTimeout(()=>{const p=new CustomEvent(Wh,e_);o.addEventListener(Wh,c),o.dispatchEvent(p),p.defaultPrevented||ds(y??document.body,{select:!0}),o.removeEventListener(Wh,c),n_.remove(h)},0)}}},[o,l,c,h]);const m=v.useCallback(y=>{if(!n&&!r||h.paused)return;const w=y.key==="Tab"&&!y.altKey&&!y.ctrlKey&&!y.metaKey,p=document.activeElement;if(w&&p){const b=y.currentTarget,[_,x]=F6(b);_&&x?!y.shiftKey&&p===x?(y.preventDefault(),n&&ds(_,{select:!0})):y.shiftKey&&p===_&&(y.preventDefault(),n&&ds(x,{select:!0})):p===b&&y.preventDefault()}},[n,r,h.paused]);return g.jsx(Xe.div,{tabIndex:-1,...a,ref:f,onKeyDown:m})});WS.displayName=M6;function D6(t,{select:e=!1}={}){const n=document.activeElement;for(const r of t)if(ds(r,{select:e}),document.activeElement!==n)return}function F6(t){const e=GS(t),n=t_(e,t),r=t_(e.reverse(),t);return[n,r]}function GS(t){const e=[],n=document.createTreeWalker(t,NodeFilter.SHOW_ELEMENT,{acceptNode:r=>{const s=r.tagName==="INPUT"&&r.type==="hidden";return r.disabled||r.hidden||s?NodeFilter.FILTER_SKIP:r.tabIndex>=0?NodeFilter.FILTER_ACCEPT:NodeFilter.FILTER_SKIP}});for(;n.nextNode();)e.push(n.currentNode);return e}function t_(t,e){for(const n of t)if(!B6(n,{upTo:e}))return n}function B6(t,{upTo:e}){if(getComputedStyle(t).visibility==="hidden")return!0;for(;t;){if(e!==void 0&&t===e)return!1;if(getComputedStyle(t).display==="none")return!0;t=t.parentElement}return!1}function U6(t){return t instanceof HTMLInputElement&&"select"in t}function ds(t,{select:e=!1}={}){if(t&&t.focus){const n=document.activeElement;t.focus({preventScroll:!0}),t!==n&&U6(t)&&e&&t.select()}}var n_=z6();function z6(){let t=[];return{add(e){const n=t[0];e!==n&&n?.pause(),t=r_(t,e),t.unshift(e)},remove(e){t=r_(t,e),t[0]?.resume()}}}function r_(t,e){const n=[...t],r=n.indexOf(e);return r!==-1&&n.splice(r,1),n}function q6(t){return t.filter(e=>e.tagName!=="A")}var gn=globalThis?.document?v.useLayoutEffect:()=>{},H6=zT.useId||(()=>{}),V6=0;function K0(t){const[e,n]=v.useState(H6());return gn(()=>{n(r=>r??String(V6++))},[t]),e?`radix-${e}`:""}const W6=["top","right","bottom","left"],Rs=Math.min,cn=Math.max,Pd=Math.round,oc=Math.floor,Sr=t=>({x:t,y:t}),G6={left:"right",right:"left",bottom:"top",top:"bottom"},Z6={start:"end",end:"start"};function Vm(t,e,n){return cn(t,Rs(e,n))}function Xr(t,e){return typeof t=="function"?t(e):t}function Yr(t){return t.split("-")[0]}function lo(t){return t.split("-")[1]}function Q0(t){return t==="x"?"y":"x"}function X0(t){return t==="y"?"height":"width"}function js(t){return["top","bottom"].includes(Yr(t))?"y":"x"}function Y0(t){return Q0(js(t))}function J6(t,e,n){n===void 0&&(n=!1);const r=lo(t),s=Y0(t),i=X0(s);let a=s==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return e.reference[i]>e.floating[i]&&(a=Od(a)),[a,Od(a)]}function K6(t){const e=Od(t);return[Wm(t),e,Wm(e)]}function Wm(t){return t.replace(/start|end/g,e=>Z6[e])}function Q6(t,e,n){const r=["left","right"],s=["right","left"],i=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?s:r:e?r:s;case"left":case"right":return e?i:a;default:return[]}}function X6(t,e,n,r){const s=lo(t);let i=Q6(Yr(t),n==="start",r);return s&&(i=i.map(a=>a+"-"+s),e&&(i=i.concat(i.map(Wm)))),i}function Od(t){return t.replace(/left|right|bottom|top/g,e=>G6[e])}function Y6(t){return{top:0,right:0,bottom:0,left:0,...t}}function ZS(t){return typeof t!="number"?Y6(t):{top:t,right:t,bottom:t,left:t}}function Nd(t){const{x:e,y:n,width:r,height:s}=t;return{width:r,height:s,top:n,left:e,right:e+r,bottom:n+s,x:e,y:n}}function s_(t,e,n){let{reference:r,floating:s}=t;const i=js(e),a=Y0(e),o=X0(a),u=Yr(e),l=i==="y",c=r.x+r.width/2-s.width/2,d=r.y+r.height/2-s.height/2,f=r[o]/2-s[o]/2;let h;switch(u){case"top":h={x:c,y:r.y-s.height};break;case"bottom":h={x:c,y:r.y+r.height};break;case"right":h={x:r.x+r.width,y:d};break;case"left":h={x:r.x-s.width,y:d};break;default:h={x:r.x,y:r.y}}switch(lo(e)){case"start":h[a]-=f*(n&&l?-1:1);break;case"end":h[a]+=f*(n&&l?-1:1);break}return h}const ej=async(t,e,n)=>{const{placement:r="bottom",strategy:s="absolute",middleware:i=[],platform:a}=n,o=i.filter(Boolean),u=await(a.isRTL==null?void 0:a.isRTL(e));let l=await a.getElementRects({reference:t,floating:e,strategy:s}),{x:c,y:d}=s_(l,r,u),f=r,h={},m=0;for(let y=0;y<o.length;y++){const{name:w,fn:p}=o[y],{x:b,y:_,data:x,reset:S}=await p({x:c,y:d,initialPlacement:r,placement:f,strategy:s,middlewareData:h,rects:l,platform:a,elements:{reference:t,floating:e}});c=b??c,d=_??d,h={...h,[w]:{...h[w],...x}},S&&m<=50&&(m++,typeof S=="object"&&(S.placement&&(f=S.placement),S.rects&&(l=S.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:s}):S.rects),{x:c,y:d}=s_(l,f,u)),y=-1)}return{x:c,y:d,placement:f,strategy:s,middlewareData:h}};async function Du(t,e){var n;e===void 0&&(e={});const{x:r,y:s,platform:i,rects:a,elements:o,strategy:u}=t,{boundary:l="clippingAncestors",rootBoundary:c="viewport",elementContext:d="floating",altBoundary:f=!1,padding:h=0}=Xr(e,t),m=ZS(h),w=o[f?d==="floating"?"reference":"floating":d],p=Nd(await i.getClippingRect({element:(n=await(i.isElement==null?void 0:i.isElement(w)))==null||n?w:w.contextElement||await(i.getDocumentElement==null?void 0:i.getDocumentElement(o.floating)),boundary:l,rootBoundary:c,strategy:u})),b=d==="floating"?{x:r,y:s,width:a.floating.width,height:a.floating.height}:a.reference,_=await(i.getOffsetParent==null?void 0:i.getOffsetParent(o.floating)),x=await(i.isElement==null?void 0:i.isElement(_))?await(i.getScale==null?void 0:i.getScale(_))||{x:1,y:1}:{x:1,y:1},S=Nd(i.convertOffsetParentRelativeRectToViewportRelativeRect?await i.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:b,offsetParent:_,strategy:u}):b);return{top:(p.top-S.top+m.top)/x.y,bottom:(S.bottom-p.bottom+m.bottom)/x.y,left:(p.left-S.left+m.left)/x.x,right:(S.right-p.right+m.right)/x.x}}const tj=t=>({name:"arrow",options:t,async fn(e){const{x:n,y:r,placement:s,rects:i,platform:a,elements:o,middlewareData:u}=e,{element:l,padding:c=0}=Xr(t,e)||{};if(l==null)return{};const d=ZS(c),f={x:n,y:r},h=Y0(s),m=X0(h),y=await a.getDimensions(l),w=h==="y",p=w?"top":"left",b=w?"bottom":"right",_=w?"clientHeight":"clientWidth",x=i.reference[m]+i.reference[h]-f[h]-i.floating[m],S=f[h]-i.reference[h],E=await(a.getOffsetParent==null?void 0:a.getOffsetParent(l));let k=E?E[_]:0;(!k||!await(a.isElement==null?void 0:a.isElement(E)))&&(k=o.floating[_]||i.floating[m]);const T=x/2-S/2,$=k/2-y[m]/2-1,j=Rs(d[p],$),H=Rs(d[b],$),q=j,X=k-y[m]-H,O=k/2-y[m]/2+T,I=Vm(q,O,X),L=!u.arrow&&lo(s)!=null&&O!==I&&i.reference[m]/2-(O<q?j:H)-y[m]/2<0,F=L?O<q?O-q:O-X:0;return{[h]:f[h]+F,data:{[h]:I,centerOffset:O-I-F,...L&&{alignmentOffset:F}},reset:L}}}),nj=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,r;const{placement:s,middlewareData:i,rects:a,initialPlacement:o,platform:u,elements:l}=e,{mainAxis:c=!0,crossAxis:d=!0,fallbackPlacements:f,fallbackStrategy:h="bestFit",fallbackAxisSideDirection:m="none",flipAlignment:y=!0,...w}=Xr(t,e);if((n=i.arrow)!=null&&n.alignmentOffset)return{};const p=Yr(s),b=js(o),_=Yr(o)===o,x=await(u.isRTL==null?void 0:u.isRTL(l.floating)),S=f||(_||!y?[Od(o)]:K6(o)),E=m!=="none";!f&&E&&S.push(...X6(o,y,m,x));const k=[o,...S],T=await Du(e,w),$=[];let j=((r=i.flip)==null?void 0:r.overflows)||[];if(c&&$.push(T[p]),d){const O=J6(s,a,x);$.push(T[O[0]],T[O[1]])}if(j=[...j,{placement:s,overflows:$}],!$.every(O=>O<=0)){var H,q;const O=(((H=i.flip)==null?void 0:H.index)||0)+1,I=k[O];if(I)return{data:{index:O,overflows:j},reset:{placement:I}};let L=(q=j.filter(F=>F.overflows[0]<=0).sort((F,A)=>F.overflows[1]-A.overflows[1])[0])==null?void 0:q.placement;if(!L)switch(h){case"bestFit":{var X;const F=(X=j.filter(A=>{if(E){const C=js(A.placement);return C===b||C==="y"}return!0}).map(A=>[A.placement,A.overflows.filter(C=>C>0).reduce((C,M)=>C+M,0)]).sort((A,C)=>A[1]-C[1])[0])==null?void 0:X[0];F&&(L=F);break}case"initialPlacement":L=o;break}if(s!==L)return{reset:{placement:L}}}return{}}}};function i_(t,e){return{top:t.top-e.height,right:t.right-e.width,bottom:t.bottom-e.height,left:t.left-e.width}}function a_(t){return W6.some(e=>t[e]>=0)}const rj=function(t){return t===void 0&&(t={}),{name:"hide",options:t,async fn(e){const{rects:n}=e,{strategy:r="referenceHidden",...s}=Xr(t,e);switch(r){case"referenceHidden":{const i=await Du(e,{...s,elementContext:"reference"}),a=i_(i,n.reference);return{data:{referenceHiddenOffsets:a,referenceHidden:a_(a)}}}case"escaped":{const i=await Du(e,{...s,altBoundary:!0}),a=i_(i,n.floating);return{data:{escapedOffsets:a,escaped:a_(a)}}}default:return{}}}}};async function sj(t,e){const{placement:n,platform:r,elements:s}=t,i=await(r.isRTL==null?void 0:r.isRTL(s.floating)),a=Yr(n),o=lo(n),u=js(n)==="y",l=["left","top"].includes(a)?-1:1,c=i&&u?-1:1,d=Xr(e,t);let{mainAxis:f,crossAxis:h,alignmentAxis:m}=typeof d=="number"?{mainAxis:d,crossAxis:0,alignmentAxis:null}:{mainAxis:d.mainAxis||0,crossAxis:d.crossAxis||0,alignmentAxis:d.alignmentAxis};return o&&typeof m=="number"&&(h=o==="end"?m*-1:m),u?{x:h*c,y:f*l}:{x:f*l,y:h*c}}const ij=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,r;const{x:s,y:i,placement:a,middlewareData:o}=e,u=await sj(e,t);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:s+u.x,y:i+u.y,data:{...u,placement:a}}}}},aj=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:r,placement:s}=e,{mainAxis:i=!0,crossAxis:a=!1,limiter:o={fn:w=>{let{x:p,y:b}=w;return{x:p,y:b}}},...u}=Xr(t,e),l={x:n,y:r},c=await Du(e,u),d=js(Yr(s)),f=Q0(d);let h=l[f],m=l[d];if(i){const w=f==="y"?"top":"left",p=f==="y"?"bottom":"right",b=h+c[w],_=h-c[p];h=Vm(b,h,_)}if(a){const w=d==="y"?"top":"left",p=d==="y"?"bottom":"right",b=m+c[w],_=m-c[p];m=Vm(b,m,_)}const y=o.fn({...e,[f]:h,[d]:m});return{...y,data:{x:y.x-n,y:y.y-r,enabled:{[f]:i,[d]:a}}}}}},oj=function(t){return t===void 0&&(t={}),{options:t,fn(e){const{x:n,y:r,placement:s,rects:i,middlewareData:a}=e,{offset:o=0,mainAxis:u=!0,crossAxis:l=!0}=Xr(t,e),c={x:n,y:r},d=js(s),f=Q0(d);let h=c[f],m=c[d];const y=Xr(o,e),w=typeof y=="number"?{mainAxis:y,crossAxis:0}:{mainAxis:0,crossAxis:0,...y};if(u){const _=f==="y"?"height":"width",x=i.reference[f]-i.floating[_]+w.mainAxis,S=i.reference[f]+i.reference[_]-w.mainAxis;h<x?h=x:h>S&&(h=S)}if(l){var p,b;const _=f==="y"?"width":"height",x=["top","left"].includes(Yr(s)),S=i.reference[d]-i.floating[_]+(x&&((p=a.offset)==null?void 0:p[d])||0)+(x?0:w.crossAxis),E=i.reference[d]+i.reference[_]+(x?0:((b=a.offset)==null?void 0:b[d])||0)-(x?w.crossAxis:0);m<S?m=S:m>E&&(m=E)}return{[f]:h,[d]:m}}}},uj=function(t){return t===void 0&&(t={}),{name:"size",options:t,async fn(e){var n,r;const{placement:s,rects:i,platform:a,elements:o}=e,{apply:u=()=>{},...l}=Xr(t,e),c=await Du(e,l),d=Yr(s),f=lo(s),h=js(s)==="y",{width:m,height:y}=i.floating;let w,p;d==="top"||d==="bottom"?(w=d,p=f===(await(a.isRTL==null?void 0:a.isRTL(o.floating))?"start":"end")?"left":"right"):(p=d,w=f==="end"?"top":"bottom");const b=y-c.top-c.bottom,_=m-c.left-c.right,x=Rs(y-c[w],b),S=Rs(m-c[p],_),E=!e.middlewareData.shift;let k=x,T=S;if((n=e.middlewareData.shift)!=null&&n.enabled.x&&(T=_),(r=e.middlewareData.shift)!=null&&r.enabled.y&&(k=b),E&&!f){const j=cn(c.left,0),H=cn(c.right,0),q=cn(c.top,0),X=cn(c.bottom,0);h?T=m-2*(j!==0||H!==0?j+H:cn(c.left,c.right)):k=y-2*(q!==0||X!==0?q+X:cn(c.top,c.bottom))}await u({...e,availableWidth:T,availableHeight:k});const $=await a.getDimensions(o.floating);return m!==$.width||y!==$.height?{reset:{rects:!0}}:{}}}};function jf(){return typeof window<"u"}function co(t){return JS(t)?(t.nodeName||"").toLowerCase():"#document"}function hn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function Pr(t){var e;return(e=(JS(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function JS(t){return jf()?t instanceof Node||t instanceof hn(t).Node:!1}function Xn(t){return jf()?t instanceof Element||t instanceof hn(t).Element:!1}function Er(t){return jf()?t instanceof HTMLElement||t instanceof hn(t).HTMLElement:!1}function o_(t){return!jf()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof hn(t).ShadowRoot}function wl(t){const{overflow:e,overflowX:n,overflowY:r,display:s}=Yn(t);return/auto|scroll|overlay|hidden|clip/.test(e+r+n)&&!["inline","contents"].includes(s)}function lj(t){return["table","td","th"].includes(co(t))}function $f(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function ey(t){const e=ty(),n=Xn(t)?Yn(t):t;return["transform","translate","scale","rotate","perspective"].some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","translate","scale","rotate","perspective","filter"].some(r=>(n.willChange||"").includes(r))||["paint","layout","strict","content"].some(r=>(n.contain||"").includes(r))}function cj(t){let e=$s(t);for(;Er(e)&&!Ua(e);){if(ey(e))return e;if($f(e))return null;e=$s(e)}return null}function ty(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function Ua(t){return["html","body","#document"].includes(co(t))}function Yn(t){return hn(t).getComputedStyle(t)}function Lf(t){return Xn(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function $s(t){if(co(t)==="html")return t;const e=t.assignedSlot||t.parentNode||o_(t)&&t.host||Pr(t);return o_(e)?e.host:e}function KS(t){const e=$s(t);return Ua(e)?t.ownerDocument?t.ownerDocument.body:t.body:Er(e)&&wl(e)?e:KS(e)}function Fu(t,e,n){var r;e===void 0&&(e=[]),n===void 0&&(n=!0);const s=KS(t),i=s===((r=t.ownerDocument)==null?void 0:r.body),a=hn(s);if(i){const o=Gm(a);return e.concat(a,a.visualViewport||[],wl(s)?s:[],o&&n?Fu(o):[])}return e.concat(s,Fu(s,[],n))}function Gm(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function QS(t){const e=Yn(t);let n=parseFloat(e.width)||0,r=parseFloat(e.height)||0;const s=Er(t),i=s?t.offsetWidth:n,a=s?t.offsetHeight:r,o=Pd(n)!==i||Pd(r)!==a;return o&&(n=i,r=a),{width:n,height:r,$:o}}function ny(t){return Xn(t)?t:t.contextElement}function ka(t){const e=ny(t);if(!Er(e))return Sr(1);const n=e.getBoundingClientRect(),{width:r,height:s,$:i}=QS(e);let a=(i?Pd(n.width):n.width)/r,o=(i?Pd(n.height):n.height)/s;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const dj=Sr(0);function XS(t){const e=hn(t);return!ty()||!e.visualViewport?dj:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function fj(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==hn(t)?!1:e}function ki(t,e,n,r){e===void 0&&(e=!1),n===void 0&&(n=!1);const s=t.getBoundingClientRect(),i=ny(t);let a=Sr(1);e&&(r?Xn(r)&&(a=ka(r)):a=ka(t));const o=fj(i,n,r)?XS(i):Sr(0);let u=(s.left+o.x)/a.x,l=(s.top+o.y)/a.y,c=s.width/a.x,d=s.height/a.y;if(i){const f=hn(i),h=r&&Xn(r)?hn(r):r;let m=f,y=Gm(m);for(;y&&r&&h!==m;){const w=ka(y),p=y.getBoundingClientRect(),b=Yn(y),_=p.left+(y.clientLeft+parseFloat(b.paddingLeft))*w.x,x=p.top+(y.clientTop+parseFloat(b.paddingTop))*w.y;u*=w.x,l*=w.y,c*=w.x,d*=w.y,u+=_,l+=x,m=hn(y),y=Gm(m)}}return Nd({width:c,height:d,x:u,y:l})}function ry(t,e){const n=Lf(t).scrollLeft;return e?e.left+n:ki(Pr(t)).left+n}function YS(t,e,n){n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=r.left+e.scrollLeft-(n?0:ry(t,r)),i=r.top+e.scrollTop;return{x:s,y:i}}function hj(t){let{elements:e,rect:n,offsetParent:r,strategy:s}=t;const i=s==="fixed",a=Pr(r),o=e?$f(e.floating):!1;if(r===a||o&&i)return n;let u={scrollLeft:0,scrollTop:0},l=Sr(1);const c=Sr(0),d=Er(r);if((d||!d&&!i)&&((co(r)!=="body"||wl(a))&&(u=Lf(r)),Er(r))){const h=ki(r);l=ka(r),c.x=h.x+r.clientLeft,c.y=h.y+r.clientTop}const f=a&&!d&&!i?YS(a,u,!0):Sr(0);return{width:n.width*l.x,height:n.height*l.y,x:n.x*l.x-u.scrollLeft*l.x+c.x+f.x,y:n.y*l.y-u.scrollTop*l.y+c.y+f.y}}function pj(t){return Array.from(t.getClientRects())}function mj(t){const e=Pr(t),n=Lf(t),r=t.ownerDocument.body,s=cn(e.scrollWidth,e.clientWidth,r.scrollWidth,r.clientWidth),i=cn(e.scrollHeight,e.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+ry(t);const o=-n.scrollTop;return Yn(r).direction==="rtl"&&(a+=cn(e.clientWidth,r.clientWidth)-s),{width:s,height:i,x:a,y:o}}function gj(t,e){const n=hn(t),r=Pr(t),s=n.visualViewport;let i=r.clientWidth,a=r.clientHeight,o=0,u=0;if(s){i=s.width,a=s.height;const l=ty();(!l||l&&e==="fixed")&&(o=s.offsetLeft,u=s.offsetTop)}return{width:i,height:a,x:o,y:u}}function yj(t,e){const n=ki(t,!0,e==="fixed"),r=n.top+t.clientTop,s=n.left+t.clientLeft,i=Er(t)?ka(t):Sr(1),a=t.clientWidth*i.x,o=t.clientHeight*i.y,u=s*i.x,l=r*i.y;return{width:a,height:o,x:u,y:l}}function u_(t,e,n){let r;if(e==="viewport")r=gj(t,n);else if(e==="document")r=mj(Pr(t));else if(Xn(e))r=yj(e,n);else{const s=XS(t);r={x:e.x-s.x,y:e.y-s.y,width:e.width,height:e.height}}return Nd(r)}function ek(t,e){const n=$s(t);return n===e||!Xn(n)||Ua(n)?!1:Yn(n).position==="fixed"||ek(n,e)}function bj(t,e){const n=e.get(t);if(n)return n;let r=Fu(t,[],!1).filter(o=>Xn(o)&&co(o)!=="body"),s=null;const i=Yn(t).position==="fixed";let a=i?$s(t):t;for(;Xn(a)&&!Ua(a);){const o=Yn(a),u=ey(a);!u&&o.position==="fixed"&&(s=null),(i?!u&&!s:!u&&o.position==="static"&&!!s&&["absolute","fixed"].includes(s.position)||wl(a)&&!u&&ek(t,a))?r=r.filter(c=>c!==a):s=o,a=$s(a)}return e.set(t,r),r}function wj(t){let{element:e,boundary:n,rootBoundary:r,strategy:s}=t;const a=[...n==="clippingAncestors"?$f(e)?[]:bj(e,this._c):[].concat(n),r],o=a[0],u=a.reduce((l,c)=>{const d=u_(e,c,s);return l.top=cn(d.top,l.top),l.right=Rs(d.right,l.right),l.bottom=Rs(d.bottom,l.bottom),l.left=cn(d.left,l.left),l},u_(e,o,s));return{width:u.right-u.left,height:u.bottom-u.top,x:u.left,y:u.top}}function _j(t){const{width:e,height:n}=QS(t);return{width:e,height:n}}function vj(t,e,n){const r=Er(e),s=Pr(e),i=n==="fixed",a=ki(t,!0,i,e);let o={scrollLeft:0,scrollTop:0};const u=Sr(0);if(r||!r&&!i)if((co(e)!=="body"||wl(s))&&(o=Lf(e)),r){const f=ki(e,!0,i,e);u.x=f.x+e.clientLeft,u.y=f.y+e.clientTop}else s&&(u.x=ry(s));const l=s&&!r&&!i?YS(s,o):Sr(0),c=a.left+o.scrollLeft-u.x-l.x,d=a.top+o.scrollTop-u.y-l.y;return{x:c,y:d,width:a.width,height:a.height}}function Gh(t){return Yn(t).position==="static"}function l_(t,e){if(!Er(t)||Yn(t).position==="fixed")return null;if(e)return e(t);let n=t.offsetParent;return Pr(t)===n&&(n=n.ownerDocument.body),n}function tk(t,e){const n=hn(t);if($f(t))return n;if(!Er(t)){let s=$s(t);for(;s&&!Ua(s);){if(Xn(s)&&!Gh(s))return s;s=$s(s)}return n}let r=l_(t,e);for(;r&&lj(r)&&Gh(r);)r=l_(r,e);return r&&Ua(r)&&Gh(r)&&!ey(r)?n:r||cj(t)||n}const xj=async function(t){const e=this.getOffsetParent||tk,n=this.getDimensions,r=await n(t.floating);return{reference:vj(t.reference,await e(t.floating),t.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Sj(t){return Yn(t).direction==="rtl"}const kj={convertOffsetParentRelativeRectToViewportRelativeRect:hj,getDocumentElement:Pr,getClippingRect:wj,getOffsetParent:tk,getElementRects:xj,getClientRects:pj,getDimensions:_j,getScale:ka,isElement:Xn,isRTL:Sj};function nk(t,e){return t.x===e.x&&t.y===e.y&&t.width===e.width&&t.height===e.height}function Ej(t,e){let n=null,r;const s=Pr(t);function i(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,u){o===void 0&&(o=!1),u===void 0&&(u=1),i();const l=t.getBoundingClientRect(),{left:c,top:d,width:f,height:h}=l;if(o||e(),!f||!h)return;const m=oc(d),y=oc(s.clientWidth-(c+f)),w=oc(s.clientHeight-(d+h)),p=oc(c),_={rootMargin:-m+"px "+-y+"px "+-w+"px "+-p+"px",threshold:cn(0,Rs(1,u))||1};let x=!0;function S(E){const k=E[0].intersectionRatio;if(k!==u){if(!x)return a();k?a(!1,k):r=setTimeout(()=>{a(!1,1e-7)},1e3)}k===1&&!nk(l,t.getBoundingClientRect())&&a(),x=!1}try{n=new IntersectionObserver(S,{..._,root:s.ownerDocument})}catch{n=new IntersectionObserver(S,_)}n.observe(t)}return a(!0),i}function Aj(t,e,n,r){r===void 0&&(r={});const{ancestorScroll:s=!0,ancestorResize:i=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:u=!1}=r,l=ny(t),c=s||i?[...l?Fu(l):[],...Fu(e)]:[];c.forEach(p=>{s&&p.addEventListener("scroll",n,{passive:!0}),i&&p.addEventListener("resize",n)});const d=l&&o?Ej(l,n):null;let f=-1,h=null;a&&(h=new ResizeObserver(p=>{let[b]=p;b&&b.target===l&&h&&(h.unobserve(e),cancelAnimationFrame(f),f=requestAnimationFrame(()=>{var _;(_=h)==null||_.observe(e)})),n()}),l&&!u&&h.observe(l),h.observe(e));let m,y=u?ki(t):null;u&&w();function w(){const p=ki(t);y&&!nk(y,p)&&n(),y=p,m=requestAnimationFrame(w)}return n(),()=>{var p;c.forEach(b=>{s&&b.removeEventListener("scroll",n),i&&b.removeEventListener("resize",n)}),d?.(),(p=h)==null||p.disconnect(),h=null,u&&cancelAnimationFrame(m)}}const Tj=ij,Cj=aj,Pj=nj,Oj=uj,Nj=rj,c_=tj,Ij=oj,Rj=(t,e,n)=>{const r=new Map,s={platform:kj,...n},i={...s.platform,_c:r};return ej(t,e,{...s,platform:i})};var Hc=typeof document<"u"?v.useLayoutEffect:v.useEffect;function Id(t,e){if(t===e)return!0;if(typeof t!=typeof e)return!1;if(typeof t=="function"&&t.toString()===e.toString())return!0;let n,r,s;if(t&&e&&typeof t=="object"){if(Array.isArray(t)){if(n=t.length,n!==e.length)return!1;for(r=n;r--!==0;)if(!Id(t[r],e[r]))return!1;return!0}if(s=Object.keys(t),n=s.length,n!==Object.keys(e).length)return!1;for(r=n;r--!==0;)if(!{}.hasOwnProperty.call(e,s[r]))return!1;for(r=n;r--!==0;){const i=s[r];if(!(i==="_owner"&&t.$$typeof)&&!Id(t[i],e[i]))return!1}return!0}return t!==t&&e!==e}function rk(t){return typeof window>"u"?1:(t.ownerDocument.defaultView||window).devicePixelRatio||1}function d_(t,e){const n=rk(t);return Math.round(e*n)/n}function Zh(t){const e=v.useRef(t);return Hc(()=>{e.current=t}),e}function jj(t){t===void 0&&(t={});const{placement:e="bottom",strategy:n="absolute",middleware:r=[],platform:s,elements:{reference:i,floating:a}={},transform:o=!0,whileElementsMounted:u,open:l}=t,[c,d]=v.useState({x:0,y:0,strategy:n,placement:e,middlewareData:{},isPositioned:!1}),[f,h]=v.useState(r);Id(f,r)||h(r);const[m,y]=v.useState(null),[w,p]=v.useState(null),b=v.useCallback(A=>{A!==E.current&&(E.current=A,y(A))},[]),_=v.useCallback(A=>{A!==k.current&&(k.current=A,p(A))},[]),x=i||m,S=a||w,E=v.useRef(null),k=v.useRef(null),T=v.useRef(c),$=u!=null,j=Zh(u),H=Zh(s),q=Zh(l),X=v.useCallback(()=>{if(!E.current||!k.current)return;const A={placement:e,strategy:n,middleware:f};H.current&&(A.platform=H.current),Rj(E.current,k.current,A).then(C=>{const M={...C,isPositioned:q.current!==!1};O.current&&!Id(T.current,M)&&(T.current=M,no.flushSync(()=>{d(M)}))})},[f,e,n,H,q]);Hc(()=>{l===!1&&T.current.isPositioned&&(T.current.isPositioned=!1,d(A=>({...A,isPositioned:!1})))},[l]);const O=v.useRef(!1);Hc(()=>(O.current=!0,()=>{O.current=!1}),[]),Hc(()=>{if(x&&(E.current=x),S&&(k.current=S),x&&S){if(j.current)return j.current(x,S,X);X()}},[x,S,X,j,$]);const I=v.useMemo(()=>({reference:E,floating:k,setReference:b,setFloating:_}),[b,_]),L=v.useMemo(()=>({reference:x,floating:S}),[x,S]),F=v.useMemo(()=>{const A={position:n,left:0,top:0};if(!L.floating)return A;const C=d_(L.floating,c.x),M=d_(L.floating,c.y);return o?{...A,transform:"translate("+C+"px, "+M+"px)",...rk(L.floating)>=1.5&&{willChange:"transform"}}:{position:n,left:C,top:M}},[n,o,L.floating,c.x,c.y]);return v.useMemo(()=>({...c,update:X,refs:I,elements:L,floatingStyles:F}),[c,X,I,L,F])}const $j=t=>{function e(n){return{}.hasOwnProperty.call(n,"current")}return{name:"arrow",options:t,fn(n){const{element:r,padding:s}=typeof t=="function"?t(n):t;return r&&e(r)?r.current!=null?c_({element:r.current,padding:s}).fn(n):{}:r?c_({element:r,padding:s}).fn(n):{}}}},Lj=(t,e)=>({...Tj(t),options:[t,e]}),Mj=(t,e)=>({...Cj(t),options:[t,e]}),Dj=(t,e)=>({...Ij(t),options:[t,e]}),Fj=(t,e)=>({...Pj(t),options:[t,e]}),Bj=(t,e)=>({...Oj(t),options:[t,e]}),Uj=(t,e)=>({...Nj(t),options:[t,e]}),zj=(t,e)=>({...$j(t),options:[t,e]});var qj="Arrow",sk=v.forwardRef((t,e)=>{const{children:n,width:r=10,height:s=5,...i}=t;return g.jsx(Xe.svg,{...i,ref:e,width:r,height:s,viewBox:"0 0 30 10",preserveAspectRatio:"none",children:t.asChild?n:g.jsx("polygon",{points:"0,0 30,0 15,10"})})});sk.displayName=qj;var Hj=sk;function Vj(t){const[e,n]=v.useState(void 0);return gn(()=>{if(t){n({width:t.offsetWidth,height:t.offsetHeight});const r=new ResizeObserver(s=>{if(!Array.isArray(s)||!s.length)return;const i=s[0];let a,o;if("borderBoxSize"in i){const u=i.borderBoxSize,l=Array.isArray(u)?u[0]:u;a=l.inlineSize,o=l.blockSize}else a=t.offsetWidth,o=t.offsetHeight;n({width:a,height:o})});return r.observe(t,{box:"border-box"}),()=>r.unobserve(t)}else n(void 0)},[t]),e}var sy="Popper",[ik,ak]=J0(sy),[Wj,ok]=ik(sy),uk=t=>{const{__scopePopper:e,children:n}=t,[r,s]=v.useState(null);return g.jsx(Wj,{scope:e,anchor:r,onAnchorChange:s,children:n})};uk.displayName=sy;var lk="PopperAnchor",ck=v.forwardRef((t,e)=>{const{__scopePopper:n,virtualRef:r,...s}=t,i=ok(lk,n),a=v.useRef(null),o=xt(e,a);return v.useEffect(()=>{i.onAnchorChange(r?.current||a.current)}),r?null:g.jsx(Xe.div,{...s,ref:o})});ck.displayName=lk;var iy="PopperContent",[Gj,Zj]=ik(iy),dk=v.forwardRef((t,e)=>{const{__scopePopper:n,side:r="bottom",sideOffset:s=0,align:i="center",alignOffset:a=0,arrowPadding:o=0,avoidCollisions:u=!0,collisionBoundary:l=[],collisionPadding:c=0,sticky:d="partial",hideWhenDetached:f=!1,updatePositionStrategy:h="optimized",onPlaced:m,...y}=t,w=ok(iy,n),[p,b]=v.useState(null),_=xt(e,ee=>b(ee)),[x,S]=v.useState(null),E=Vj(x),k=E?.width??0,T=E?.height??0,$=r+(i!=="center"?"-"+i:""),j=typeof c=="number"?c:{top:0,right:0,bottom:0,left:0,...c},H=Array.isArray(l)?l:[l],q=H.length>0,X={padding:j,boundary:H.filter(Kj),altBoundary:q},{refs:O,floatingStyles:I,placement:L,isPositioned:F,middlewareData:A}=jj({strategy:"fixed",placement:$,whileElementsMounted:(...ee)=>Aj(...ee,{animationFrame:h==="always"}),elements:{reference:w.anchor},middleware:[Lj({mainAxis:s+T,alignmentAxis:a}),u&&Mj({mainAxis:!0,crossAxis:!1,limiter:d==="partial"?Dj():void 0,...X}),u&&Fj({...X}),Bj({...X,apply:({elements:ee,rects:Ee,availableWidth:Ye,availableHeight:Ce})=>{const{width:D,height:K}=Ee.reference,R=ee.floating.style;R.setProperty("--radix-popper-available-width",`${Ye}px`),R.setProperty("--radix-popper-available-height",`${Ce}px`),R.setProperty("--radix-popper-anchor-width",`${D}px`),R.setProperty("--radix-popper-anchor-height",`${K}px`)}}),x&&zj({element:x,padding:o}),Qj({arrowWidth:k,arrowHeight:T}),f&&Uj({strategy:"referenceHidden",...X})]}),[C,M]=pk(L),W=Qr(m);gn(()=>{F&&W?.()},[F,W]);const J=A.arrow?.x,fe=A.arrow?.y,pe=A.arrow?.centerOffset!==0,[me,De]=v.useState();return gn(()=>{p&&De(window.getComputedStyle(p).zIndex)},[p]),g.jsx("div",{ref:O.setFloating,"data-radix-popper-content-wrapper":"",style:{...I,transform:F?I.transform:"translate(0, -200%)",minWidth:"max-content",zIndex:me,"--radix-popper-transform-origin":[A.transformOrigin?.x,A.transformOrigin?.y].join(" "),...A.hide?.referenceHidden&&{visibility:"hidden",pointerEvents:"none"}},dir:t.dir,children:g.jsx(Gj,{scope:n,placedSide:C,onArrowChange:S,arrowX:J,arrowY:fe,shouldHideArrow:pe,children:g.jsx(Xe.div,{"data-side":C,"data-align":M,...y,ref:_,style:{...y.style,animation:F?void 0:"none"}})})})});dk.displayName=iy;var fk="PopperArrow",Jj={top:"bottom",right:"left",bottom:"top",left:"right"},hk=v.forwardRef(function(e,n){const{__scopePopper:r,...s}=e,i=Zj(fk,r),a=Jj[i.placedSide];return g.jsx("span",{ref:i.onArrowChange,style:{position:"absolute",left:i.arrowX,top:i.arrowY,[a]:0,transformOrigin:{top:"",right:"0 0",bottom:"center 0",left:"100% 0"}[i.placedSide],transform:{top:"translateY(100%)",right:"translateY(50%) rotate(90deg) translateX(-50%)",bottom:"rotate(180deg)",left:"translateY(50%) rotate(-90deg) translateX(50%)"}[i.placedSide],visibility:i.shouldHideArrow?"hidden":void 0},children:g.jsx(Hj,{...s,ref:n,style:{...s.style,display:"block"}})})});hk.displayName=fk;function Kj(t){return t!==null}var Qj=t=>({name:"transformOrigin",options:t,fn(e){const{placement:n,rects:r,middlewareData:s}=e,a=s.arrow?.centerOffset!==0,o=a?0:t.arrowWidth,u=a?0:t.arrowHeight,[l,c]=pk(n),d={start:"0%",center:"50%",end:"100%"}[c],f=(s.arrow?.x??0)+o/2,h=(s.arrow?.y??0)+u/2;let m="",y="";return l==="bottom"?(m=a?d:`${f}px`,y=`${-u}px`):l==="top"?(m=a?d:`${f}px`,y=`${r.floating.height+u}px`):l==="right"?(m=`${-u}px`,y=a?d:`${h}px`):l==="left"&&(m=`${r.floating.width+u}px`,y=a?d:`${h}px`),{data:{x:m,y}}}});function pk(t){const[e,n="center"]=t.split("-");return[e,n]}var Xj=uk,Yj=ck,e$=dk,t$=hk,n$="Portal",mk=v.forwardRef((t,e)=>{const{container:n,...r}=t,[s,i]=v.useState(!1);gn(()=>i(!0),[]);const a=n||s&&globalThis?.document?.body;return a?QP.createPortal(g.jsx(Xe.div,{...r,ref:e}),a):null});mk.displayName=n$;function f_({prop:t,defaultProp:e,onChange:n=()=>{}}){const[r,s]=r$({defaultProp:e,onChange:n}),i=t!==void 0,a=i?t:r,o=Qr(n),u=v.useCallback(l=>{if(i){const d=typeof l=="function"?l(t):l;d!==t&&o(d)}else s(l)},[i,t,s,o]);return[a,u]}function r$({defaultProp:t,onChange:e}){const n=v.useState(t),[r]=n,s=v.useRef(r),i=Qr(e);return v.useEffect(()=>{s.current!==r&&(i(r),s.current=r)},[r,s,i]),n}function s$(t){const e=v.useRef({value:t,previous:t});return v.useMemo(()=>(e.current.value!==t&&(e.current.previous=e.current.value,e.current.value=t),e.current.previous),[t])}var i$="VisuallyHidden",gk=v.forwardRef((t,e)=>g.jsx(Xe.span,{...t,ref:e,style:{position:"absolute",border:0,width:1,height:1,padding:0,margin:-1,overflow:"hidden",clip:"rect(0, 0, 0, 0)",whiteSpace:"nowrap",wordWrap:"normal",...t.style}}));gk.displayName=i$;var a$=function(t){if(typeof document>"u")return null;var e=Array.isArray(t)?t[0]:t;return e.ownerDocument.body},Ui=new WeakMap,uc=new WeakMap,lc={},Jh=0,yk=function(t){return t&&(t.host||yk(t.parentNode))},o$=function(t,e){return e.map(function(n){if(t.contains(n))return n;var r=yk(n);return r&&t.contains(r)?r:(console.error("aria-hidden",n,"in not contained inside",t,". Doing nothing"),null)}).filter(function(n){return!!n})},u$=function(t,e,n,r){var s=o$(e,Array.isArray(t)?t:[t]);lc[n]||(lc[n]=new WeakMap);var i=lc[n],a=[],o=new Set,u=new Set(s),l=function(d){!d||o.has(d)||(o.add(d),l(d.parentNode))};s.forEach(l);var c=function(d){!d||u.has(d)||Array.prototype.forEach.call(d.children,function(f){if(o.has(f))c(f);else try{var h=f.getAttribute(r),m=h!==null&&h!=="false",y=(Ui.get(f)||0)+1,w=(i.get(f)||0)+1;Ui.set(f,y),i.set(f,w),a.push(f),y===1&&m&&uc.set(f,!0),w===1&&f.setAttribute(n,"true"),m||f.setAttribute(r,"true")}catch(p){console.error("aria-hidden: cannot operate on ",f,p)}})};return c(e),o.clear(),Jh++,function(){a.forEach(function(d){var f=Ui.get(d)-1,h=i.get(d)-1;Ui.set(d,f),i.set(d,h),f||(uc.has(d)||d.removeAttribute(r),uc.delete(d)),h||d.removeAttribute(n)}),Jh--,Jh||(Ui=new WeakMap,Ui=new WeakMap,uc=new WeakMap,lc={})}},l$=function(t,e,n){n===void 0&&(n="data-aria-hidden");var r=Array.from(Array.isArray(t)?t:[t]),s=a$(t);return s?(r.push.apply(r,Array.from(s.querySelectorAll("[aria-live]"))),u$(r,s,n,"aria-hidden")):function(){return null}},pr=function(){return pr=Object.assign||function(e){for(var n,r=1,s=arguments.length;r<s;r++){n=arguments[r];for(var i in n)Object.prototype.hasOwnProperty.call(n,i)&&(e[i]=n[i])}return e},pr.apply(this,arguments)};function bk(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var s=0,r=Object.getOwnPropertySymbols(t);s<r.length;s++)e.indexOf(r[s])<0&&Object.prototype.propertyIsEnumerable.call(t,r[s])&&(n[r[s]]=t[r[s]]);return n}function c$(t,e,n){if(n||arguments.length===2)for(var r=0,s=e.length,i;r<s;r++)(i||!(r in e))&&(i||(i=Array.prototype.slice.call(e,0,r)),i[r]=e[r]);return t.concat(i||Array.prototype.slice.call(e))}var Vc="right-scroll-bar-position",Wc="width-before-scroll-bar",d$="with-scroll-bars-hidden",f$="--removed-body-scroll-bar-size";function Kh(t,e){return typeof t=="function"?t(e):t&&(t.current=e),t}function h$(t,e){var n=v.useState(function(){return{value:t,callback:e,facade:{get current(){return n.value},set current(r){var s=n.value;s!==r&&(n.value=r,n.callback(r,s))}}}})[0];return n.callback=e,n.facade}var p$=typeof window<"u"?v.useLayoutEffect:v.useEffect,h_=new WeakMap;function m$(t,e){var n=h$(null,function(r){return t.forEach(function(s){return Kh(s,r)})});return p$(function(){var r=h_.get(n);if(r){var s=new Set(r),i=new Set(t),a=n.current;s.forEach(function(o){i.has(o)||Kh(o,null)}),i.forEach(function(o){s.has(o)||Kh(o,a)})}h_.set(n,t)},[t]),n}function g$(t){return t}function y$(t,e){e===void 0&&(e=g$);var n=[],r=!1,s={read:function(){if(r)throw new Error("Sidecar: could not `read` from an `assigned` medium. `read` could be used only with `useMedium`.");return n.length?n[n.length-1]:t},useMedium:function(i){var a=e(i,r);return n.push(a),function(){n=n.filter(function(o){return o!==a})}},assignSyncMedium:function(i){for(r=!0;n.length;){var a=n;n=[],a.forEach(i)}n={push:function(o){return i(o)},filter:function(){return n}}},assignMedium:function(i){r=!0;var a=[];if(n.length){var o=n;n=[],o.forEach(i),a=n}var u=function(){var c=a;a=[],c.forEach(i)},l=function(){return Promise.resolve().then(u)};l(),n={push:function(c){a.push(c),l()},filter:function(c){return a=a.filter(c),n}}}};return s}function b$(t){t===void 0&&(t={});var e=y$(null);return e.options=pr({async:!0,ssr:!1},t),e}var wk=function(t){var e=t.sideCar,n=bk(t,["sideCar"]);if(!e)throw new Error("Sidecar: please provide `sideCar` property to import the right car");var r=e.read();if(!r)throw new Error("Sidecar medium not found");return v.createElement(r,pr({},n))};wk.isSideCarExport=!0;function w$(t,e){return t.useMedium(e),wk}var _k=b$(),Qh=function(){},Mf=v.forwardRef(function(t,e){var n=v.useRef(null),r=v.useState({onScrollCapture:Qh,onWheelCapture:Qh,onTouchMoveCapture:Qh}),s=r[0],i=r[1],a=t.forwardProps,o=t.children,u=t.className,l=t.removeScrollBar,c=t.enabled,d=t.shards,f=t.sideCar,h=t.noIsolation,m=t.inert,y=t.allowPinchZoom,w=t.as,p=w===void 0?"div":w,b=t.gapMode,_=bk(t,["forwardProps","children","className","removeScrollBar","enabled","shards","sideCar","noIsolation","inert","allowPinchZoom","as","gapMode"]),x=f,S=m$([n,e]),E=pr(pr({},_),s);return v.createElement(v.Fragment,null,c&&v.createElement(x,{sideCar:_k,removeScrollBar:l,shards:d,noIsolation:h,inert:m,setCallbacks:i,allowPinchZoom:!!y,lockRef:n,gapMode:b}),a?v.cloneElement(v.Children.only(o),pr(pr({},E),{ref:S})):v.createElement(p,pr({},E,{className:u,ref:S}),o))});Mf.defaultProps={enabled:!0,removeScrollBar:!0,inert:!1};Mf.classNames={fullWidth:Wc,zeroRight:Vc};var _$=function(){if(typeof __webpack_nonce__<"u")return __webpack_nonce__};function v$(){if(!document)return null;var t=document.createElement("style");t.type="text/css";var e=_$();return e&&t.setAttribute("nonce",e),t}function x$(t,e){t.styleSheet?t.styleSheet.cssText=e:t.appendChild(document.createTextNode(e))}function S$(t){var e=document.head||document.getElementsByTagName("head")[0];e.appendChild(t)}var k$=function(){var t=0,e=null;return{add:function(n){t==0&&(e=v$())&&(x$(e,n),S$(e)),t++},remove:function(){t--,!t&&e&&(e.parentNode&&e.parentNode.removeChild(e),e=null)}}},E$=function(){var t=k$();return function(e,n){v.useEffect(function(){return t.add(e),function(){t.remove()}},[e&&n])}},vk=function(){var t=E$(),e=function(n){var r=n.styles,s=n.dynamic;return t(r,s),null};return e},A$={left:0,top:0,right:0,gap:0},Xh=function(t){return parseInt(t||"",10)||0},T$=function(t){var e=window.getComputedStyle(document.body),n=e[t==="padding"?"paddingLeft":"marginLeft"],r=e[t==="padding"?"paddingTop":"marginTop"],s=e[t==="padding"?"paddingRight":"marginRight"];return[Xh(n),Xh(r),Xh(s)]},C$=function(t){if(t===void 0&&(t="margin"),typeof window>"u")return A$;var e=T$(t),n=document.documentElement.clientWidth,r=window.innerWidth;return{left:e[0],top:e[1],right:e[2],gap:Math.max(0,r-n+e[2]-e[0])}},P$=vk(),Ea="data-scroll-locked",O$=function(t,e,n,r){var s=t.left,i=t.top,a=t.right,o=t.gap;return n===void 0&&(n="margin"),`
  .`.concat(d$,` {
   overflow: hidden `).concat(r,`;
   padding-right: `).concat(o,"px ").concat(r,`;
  }
  body[`).concat(Ea,`] {
    overflow: hidden `).concat(r,`;
    overscroll-behavior: contain;
    `).concat([e&&"position: relative ".concat(r,";"),n==="margin"&&`
    padding-left: `.concat(s,`px;
    padding-top: `).concat(i,`px;
    padding-right: `).concat(a,`px;
    margin-left:0;
    margin-top:0;
    margin-right: `).concat(o,"px ").concat(r,`;
    `),n==="padding"&&"padding-right: ".concat(o,"px ").concat(r,";")].filter(Boolean).join(""),`
  }
  
  .`).concat(Vc,` {
    right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Wc,` {
    margin-right: `).concat(o,"px ").concat(r,`;
  }
  
  .`).concat(Vc," .").concat(Vc,` {
    right: 0 `).concat(r,`;
  }
  
  .`).concat(Wc," .").concat(Wc,` {
    margin-right: 0 `).concat(r,`;
  }
  
  body[`).concat(Ea,`] {
    `).concat(f$,": ").concat(o,`px;
  }
`)},p_=function(){var t=parseInt(document.body.getAttribute(Ea)||"0",10);return isFinite(t)?t:0},N$=function(){v.useEffect(function(){return document.body.setAttribute(Ea,(p_()+1).toString()),function(){var t=p_()-1;t<=0?document.body.removeAttribute(Ea):document.body.setAttribute(Ea,t.toString())}},[])},I$=function(t){var e=t.noRelative,n=t.noImportant,r=t.gapMode,s=r===void 0?"margin":r;N$();var i=v.useMemo(function(){return C$(s)},[s]);return v.createElement(P$,{styles:O$(i,!e,s,n?"":"!important")})},Zm=!1;if(typeof window<"u")try{var cc=Object.defineProperty({},"passive",{get:function(){return Zm=!0,!0}});window.addEventListener("test",cc,cc),window.removeEventListener("test",cc,cc)}catch{Zm=!1}var zi=Zm?{passive:!1}:!1,R$=function(t){return t.tagName==="TEXTAREA"},xk=function(t,e){if(!(t instanceof Element))return!1;var n=window.getComputedStyle(t);return n[e]!=="hidden"&&!(n.overflowY===n.overflowX&&!R$(t)&&n[e]==="visible")},j$=function(t){return xk(t,"overflowY")},$$=function(t){return xk(t,"overflowX")},m_=function(t,e){var n=e.ownerDocument,r=e;do{typeof ShadowRoot<"u"&&r instanceof ShadowRoot&&(r=r.host);var s=Sk(t,r);if(s){var i=kk(t,r),a=i[1],o=i[2];if(a>o)return!0}r=r.parentNode}while(r&&r!==n.body);return!1},L$=function(t){var e=t.scrollTop,n=t.scrollHeight,r=t.clientHeight;return[e,n,r]},M$=function(t){var e=t.scrollLeft,n=t.scrollWidth,r=t.clientWidth;return[e,n,r]},Sk=function(t,e){return t==="v"?j$(e):$$(e)},kk=function(t,e){return t==="v"?L$(e):M$(e)},D$=function(t,e){return t==="h"&&e==="rtl"?-1:1},F$=function(t,e,n,r,s){var i=D$(t,window.getComputedStyle(e).direction),a=i*r,o=n.target,u=e.contains(o),l=!1,c=a>0,d=0,f=0;do{var h=kk(t,o),m=h[0],y=h[1],w=h[2],p=y-w-i*m;(m||p)&&Sk(t,o)&&(d+=p,f+=m),o instanceof ShadowRoot?o=o.host:o=o.parentNode}while(!u&&o!==document.body||u&&(e.contains(o)||e===o));return(c&&Math.abs(d)<1||!c&&Math.abs(f)<1)&&(l=!0),l},dc=function(t){return"changedTouches"in t?[t.changedTouches[0].clientX,t.changedTouches[0].clientY]:[0,0]},g_=function(t){return[t.deltaX,t.deltaY]},y_=function(t){return t&&"current"in t?t.current:t},B$=function(t,e){return t[0]===e[0]&&t[1]===e[1]},U$=function(t){return`
  .block-interactivity-`.concat(t,` {pointer-events: none;}
  .allow-interactivity-`).concat(t,` {pointer-events: all;}
`)},z$=0,qi=[];function q$(t){var e=v.useRef([]),n=v.useRef([0,0]),r=v.useRef(),s=v.useState(z$++)[0],i=v.useState(vk)[0],a=v.useRef(t);v.useEffect(function(){a.current=t},[t]),v.useEffect(function(){if(t.inert){document.body.classList.add("block-interactivity-".concat(s));var y=c$([t.lockRef.current],(t.shards||[]).map(y_),!0).filter(Boolean);return y.forEach(function(w){return w.classList.add("allow-interactivity-".concat(s))}),function(){document.body.classList.remove("block-interactivity-".concat(s)),y.forEach(function(w){return w.classList.remove("allow-interactivity-".concat(s))})}}},[t.inert,t.lockRef.current,t.shards]);var o=v.useCallback(function(y,w){if("touches"in y&&y.touches.length===2||y.type==="wheel"&&y.ctrlKey)return!a.current.allowPinchZoom;var p=dc(y),b=n.current,_="deltaX"in y?y.deltaX:b[0]-p[0],x="deltaY"in y?y.deltaY:b[1]-p[1],S,E=y.target,k=Math.abs(_)>Math.abs(x)?"h":"v";if("touches"in y&&k==="h"&&E.type==="range")return!1;var T=m_(k,E);if(!T)return!0;if(T?S=k:(S=k==="v"?"h":"v",T=m_(k,E)),!T)return!1;if(!r.current&&"changedTouches"in y&&(_||x)&&(r.current=S),!S)return!0;var $=r.current||S;return F$($,w,y,$==="h"?_:x)},[]),u=v.useCallback(function(y){var w=y;if(!(!qi.length||qi[qi.length-1]!==i)){var p="deltaY"in w?g_(w):dc(w),b=e.current.filter(function(S){return S.name===w.type&&(S.target===w.target||w.target===S.shadowParent)&&B$(S.delta,p)})[0];if(b&&b.should){w.cancelable&&w.preventDefault();return}if(!b){var _=(a.current.shards||[]).map(y_).filter(Boolean).filter(function(S){return S.contains(w.target)}),x=_.length>0?o(w,_[0]):!a.current.noIsolation;x&&w.cancelable&&w.preventDefault()}}},[]),l=v.useCallback(function(y,w,p,b){var _={name:y,delta:w,target:p,should:b,shadowParent:H$(p)};e.current.push(_),setTimeout(function(){e.current=e.current.filter(function(x){return x!==_})},1)},[]),c=v.useCallback(function(y){n.current=dc(y),r.current=void 0},[]),d=v.useCallback(function(y){l(y.type,g_(y),y.target,o(y,t.lockRef.current))},[]),f=v.useCallback(function(y){l(y.type,dc(y),y.target,o(y,t.lockRef.current))},[]);v.useEffect(function(){return qi.push(i),t.setCallbacks({onScrollCapture:d,onWheelCapture:d,onTouchMoveCapture:f}),document.addEventListener("wheel",u,zi),document.addEventListener("touchmove",u,zi),document.addEventListener("touchstart",c,zi),function(){qi=qi.filter(function(y){return y!==i}),document.removeEventListener("wheel",u,zi),document.removeEventListener("touchmove",u,zi),document.removeEventListener("touchstart",c,zi)}},[]);var h=t.removeScrollBar,m=t.inert;return v.createElement(v.Fragment,null,m?v.createElement(i,{styles:U$(s)}):null,h?v.createElement(I$,{gapMode:t.gapMode}):null)}function H$(t){for(var e=null;t!==null;)t instanceof ShadowRoot&&(e=t.host,t=t.host),t=t.parentNode;return e}const V$=w$(_k,q$);var Ek=v.forwardRef(function(t,e){return v.createElement(Mf,pr({},t,{ref:e,sideCar:V$}))});Ek.classNames=Mf.classNames;var W$=[" ","Enter","ArrowUp","ArrowDown"],G$=[" ","Enter"],_l="Select",[Df,Ff,Z$]=E6(_l),[fo,kW]=J0(_l,[Z$,ak]),Bf=ak(),[J$,Ws]=fo(_l),[K$,Q$]=fo(_l),Ak=t=>{const{__scopeSelect:e,children:n,open:r,defaultOpen:s,onOpenChange:i,value:a,defaultValue:o,onValueChange:u,dir:l,name:c,autoComplete:d,disabled:f,required:h,form:m}=t,y=Bf(e),[w,p]=v.useState(null),[b,_]=v.useState(null),[x,S]=v.useState(!1),E=T6(l),[k=!1,T]=f_({prop:r,defaultProp:s,onChange:i}),[$,j]=f_({prop:a,defaultProp:o,onChange:u}),H=v.useRef(null),q=w?m||!!w.closest("form"):!0,[X,O]=v.useState(new Set),I=Array.from(X).map(L=>L.props.value).join(";");return g.jsx(Xj,{...y,children:g.jsxs(J$,{required:h,scope:e,trigger:w,onTriggerChange:p,valueNode:b,onValueNodeChange:_,valueNodeHasChildren:x,onValueNodeHasChildrenChange:S,contentId:K0(),value:$,onValueChange:j,open:k,onOpenChange:T,dir:E,triggerPointerDownPosRef:H,disabled:f,children:[g.jsx(Df.Provider,{scope:e,children:g.jsx(K$,{scope:t.__scopeSelect,onNativeOptionAdd:v.useCallback(L=>{O(F=>new Set(F).add(L))},[]),onNativeOptionRemove:v.useCallback(L=>{O(F=>{const A=new Set(F);return A.delete(L),A})},[]),children:n})}),q?g.jsxs(Qk,{"aria-hidden":!0,required:h,tabIndex:-1,name:c,autoComplete:d,value:$,onChange:L=>j(L.target.value),disabled:f,form:m,children:[$===void 0?g.jsx("option",{value:""}):null,Array.from(X)]},I):null]})})};Ak.displayName=_l;var Tk="SelectTrigger",Ck=v.forwardRef((t,e)=>{const{__scopeSelect:n,disabled:r=!1,...s}=t,i=Bf(n),a=Ws(Tk,n),o=a.disabled||r,u=xt(e,a.onTriggerChange),l=Ff(n),c=v.useRef("touch"),[d,f,h]=Xk(y=>{const w=l().filter(_=>!_.disabled),p=w.find(_=>_.value===a.value),b=Yk(w,y,p);b!==void 0&&a.onValueChange(b.value)}),m=y=>{o||(a.onOpenChange(!0),h()),y&&(a.triggerPointerDownPosRef.current={x:Math.round(y.pageX),y:Math.round(y.pageY)})};return g.jsx(Yj,{asChild:!0,...i,children:g.jsx(Xe.button,{type:"button",role:"combobox","aria-controls":a.contentId,"aria-expanded":a.open,"aria-required":a.required,"aria-autocomplete":"none",dir:a.dir,"data-state":a.open?"open":"closed",disabled:o,"data-disabled":o?"":void 0,"data-placeholder":Kk(a.value)?"":void 0,...s,ref:u,onClick:nt(s.onClick,y=>{y.currentTarget.focus(),c.current!=="mouse"&&m(y)}),onPointerDown:nt(s.onPointerDown,y=>{c.current=y.pointerType;const w=y.target;w.hasPointerCapture(y.pointerId)&&w.releasePointerCapture(y.pointerId),y.button===0&&y.ctrlKey===!1&&y.pointerType==="mouse"&&(m(y),y.preventDefault())}),onKeyDown:nt(s.onKeyDown,y=>{const w=d.current!=="";!(y.ctrlKey||y.altKey||y.metaKey)&&y.key.length===1&&f(y.key),!(w&&y.key===" ")&&W$.includes(y.key)&&(m(),y.preventDefault())})})})});Ck.displayName=Tk;var Pk="SelectValue",Ok=v.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,children:i,placeholder:a="",...o}=t,u=Ws(Pk,n),{onValueNodeHasChildrenChange:l}=u,c=i!==void 0,d=xt(e,u.onValueNodeChange);return gn(()=>{l(c)},[l,c]),g.jsx(Xe.span,{...o,ref:d,style:{pointerEvents:"none"},children:Kk(u.value)?g.jsx(g.Fragment,{children:a}):i})});Ok.displayName=Pk;var X$="SelectIcon",Nk=v.forwardRef((t,e)=>{const{__scopeSelect:n,children:r,...s}=t;return g.jsx(Xe.span,{"aria-hidden":!0,...s,ref:e,children:r||""})});Nk.displayName=X$;var Y$="SelectPortal",Ik=t=>g.jsx(mk,{asChild:!0,...t});Ik.displayName=Y$;var Ei="SelectContent",Rk=v.forwardRef((t,e)=>{const n=Ws(Ei,t.__scopeSelect),[r,s]=v.useState();if(gn(()=>{s(new DocumentFragment)},[]),!n.open){const i=r;return i?no.createPortal(g.jsx(jk,{scope:t.__scopeSelect,children:g.jsx(Df.Slot,{scope:t.__scopeSelect,children:g.jsx("div",{children:t.children})})}),i):null}return g.jsx($k,{...t,ref:e})});Rk.displayName=Ei;var Dn=10,[jk,Gs]=fo(Ei),eL="SelectContentImpl",$k=v.forwardRef((t,e)=>{const{__scopeSelect:n,position:r="item-aligned",onCloseAutoFocus:s,onEscapeKeyDown:i,onPointerDownOutside:a,side:o,sideOffset:u,align:l,alignOffset:c,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:m,hideWhenDetached:y,avoidCollisions:w,...p}=t,b=Ws(Ei,n),[_,x]=v.useState(null),[S,E]=v.useState(null),k=xt(e,ee=>x(ee)),[T,$]=v.useState(null),[j,H]=v.useState(null),q=Ff(n),[X,O]=v.useState(!1),I=v.useRef(!1);v.useEffect(()=>{if(_)return l$(_)},[_]),L6();const L=v.useCallback(ee=>{const[Ee,...Ye]=q().map(K=>K.ref.current),[Ce]=Ye.slice(-1),D=document.activeElement;for(const K of ee)if(K===D||(K?.scrollIntoView({block:"nearest"}),K===Ee&&S&&(S.scrollTop=0),K===Ce&&S&&(S.scrollTop=S.scrollHeight),K?.focus(),document.activeElement!==D))return},[q,S]),F=v.useCallback(()=>L([T,_]),[L,T,_]);v.useEffect(()=>{X&&F()},[X,F]);const{onOpenChange:A,triggerPointerDownPosRef:C}=b;v.useEffect(()=>{if(_){let ee={x:0,y:0};const Ee=Ce=>{ee={x:Math.abs(Math.round(Ce.pageX)-(C.current?.x??0)),y:Math.abs(Math.round(Ce.pageY)-(C.current?.y??0))}},Ye=Ce=>{ee.x<=10&&ee.y<=10?Ce.preventDefault():_.contains(Ce.target)||A(!1),document.removeEventListener("pointermove",Ee),C.current=null};return C.current!==null&&(document.addEventListener("pointermove",Ee),document.addEventListener("pointerup",Ye,{capture:!0,once:!0})),()=>{document.removeEventListener("pointermove",Ee),document.removeEventListener("pointerup",Ye,{capture:!0})}}},[_,A,C]),v.useEffect(()=>{const ee=()=>A(!1);return window.addEventListener("blur",ee),window.addEventListener("resize",ee),()=>{window.removeEventListener("blur",ee),window.removeEventListener("resize",ee)}},[A]);const[M,W]=Xk(ee=>{const Ee=q().filter(D=>!D.disabled),Ye=Ee.find(D=>D.ref.current===document.activeElement),Ce=Yk(Ee,ee,Ye);Ce&&setTimeout(()=>Ce.ref.current.focus())}),J=v.useCallback((ee,Ee,Ye)=>{const Ce=!I.current&&!Ye;(b.value!==void 0&&b.value===Ee||Ce)&&($(ee),Ce&&(I.current=!0))},[b.value]),fe=v.useCallback(()=>_?.focus(),[_]),pe=v.useCallback((ee,Ee,Ye)=>{const Ce=!I.current&&!Ye;(b.value!==void 0&&b.value===Ee||Ce)&&H(ee)},[b.value]),me=r==="popper"?Jm:Lk,De=me===Jm?{side:o,sideOffset:u,align:l,alignOffset:c,arrowPadding:d,collisionBoundary:f,collisionPadding:h,sticky:m,hideWhenDetached:y,avoidCollisions:w}:{};return g.jsx(jk,{scope:n,content:_,viewport:S,onViewportChange:E,itemRefCallback:J,selectedItem:T,onItemLeave:fe,itemTextRefCallback:pe,focusSelectedItem:F,selectedItemText:j,position:r,isPositioned:X,searchRef:M,children:g.jsx(Ek,{as:Ba,allowPinchZoom:!0,children:g.jsx(WS,{asChild:!0,trapped:b.open,onMountAutoFocus:ee=>{ee.preventDefault()},onUnmountAutoFocus:nt(s,ee=>{b.trigger?.focus({preventScroll:!0}),ee.preventDefault()}),children:g.jsx(HS,{asChild:!0,disableOutsidePointerEvents:!0,onEscapeKeyDown:i,onPointerDownOutside:a,onFocusOutside:ee=>ee.preventDefault(),onDismiss:()=>b.onOpenChange(!1),children:g.jsx(me,{role:"listbox",id:b.contentId,"data-state":b.open?"open":"closed",dir:b.dir,onContextMenu:ee=>ee.preventDefault(),...p,...De,onPlaced:()=>O(!0),ref:k,style:{display:"flex",flexDirection:"column",outline:"none",...p.style},onKeyDown:nt(p.onKeyDown,ee=>{const Ee=ee.ctrlKey||ee.altKey||ee.metaKey;if(ee.key==="Tab"&&ee.preventDefault(),!Ee&&ee.key.length===1&&W(ee.key),["ArrowUp","ArrowDown","Home","End"].includes(ee.key)){let Ce=q().filter(D=>!D.disabled).map(D=>D.ref.current);if(["ArrowUp","End"].includes(ee.key)&&(Ce=Ce.slice().reverse()),["ArrowUp","ArrowDown"].includes(ee.key)){const D=ee.target,K=Ce.indexOf(D);Ce=Ce.slice(K+1)}setTimeout(()=>L(Ce)),ee.preventDefault()}})})})})})})});$k.displayName=eL;var tL="SelectItemAlignedPosition",Lk=v.forwardRef((t,e)=>{const{__scopeSelect:n,onPlaced:r,...s}=t,i=Ws(Ei,n),a=Gs(Ei,n),[o,u]=v.useState(null),[l,c]=v.useState(null),d=xt(e,k=>c(k)),f=Ff(n),h=v.useRef(!1),m=v.useRef(!0),{viewport:y,selectedItem:w,selectedItemText:p,focusSelectedItem:b}=a,_=v.useCallback(()=>{if(i.trigger&&i.valueNode&&o&&l&&y&&w&&p){const k=i.trigger.getBoundingClientRect(),T=l.getBoundingClientRect(),$=i.valueNode.getBoundingClientRect(),j=p.getBoundingClientRect();if(i.dir!=="rtl"){const D=j.left-T.left,K=$.left-D,R=k.left-K,te=k.width+R,z=Math.max(te,T.width),Y=window.innerWidth-Dn,et=Kw(K,[Dn,Math.max(Dn,Y-z)]);o.style.minWidth=te+"px",o.style.left=et+"px"}else{const D=T.right-j.right,K=window.innerWidth-$.right-D,R=window.innerWidth-k.right-K,te=k.width+R,z=Math.max(te,T.width),Y=window.innerWidth-Dn,et=Kw(K,[Dn,Math.max(Dn,Y-z)]);o.style.minWidth=te+"px",o.style.right=et+"px"}const H=f(),q=window.innerHeight-Dn*2,X=y.scrollHeight,O=window.getComputedStyle(l),I=parseInt(O.borderTopWidth,10),L=parseInt(O.paddingTop,10),F=parseInt(O.borderBottomWidth,10),A=parseInt(O.paddingBottom,10),C=I+L+X+A+F,M=Math.min(w.offsetHeight*5,C),W=window.getComputedStyle(y),J=parseInt(W.paddingTop,10),fe=parseInt(W.paddingBottom,10),pe=k.top+k.height/2-Dn,me=q-pe,De=w.offsetHeight/2,ee=w.offsetTop+De,Ee=I+L+ee,Ye=C-Ee;if(Ee<=pe){const D=H.length>0&&w===H[H.length-1].ref.current;o.style.bottom="0px";const K=l.clientHeight-y.offsetTop-y.offsetHeight,R=Math.max(me,De+(D?fe:0)+K+F),te=Ee+R;o.style.height=te+"px"}else{const D=H.length>0&&w===H[0].ref.current;o.style.top="0px";const R=Math.max(pe,I+y.offsetTop+(D?J:0)+De)+Ye;o.style.height=R+"px",y.scrollTop=Ee-pe+y.offsetTop}o.style.margin=`${Dn}px 0`,o.style.minHeight=M+"px",o.style.maxHeight=q+"px",r?.(),requestAnimationFrame(()=>h.current=!0)}},[f,i.trigger,i.valueNode,o,l,y,w,p,i.dir,r]);gn(()=>_(),[_]);const[x,S]=v.useState();gn(()=>{l&&S(window.getComputedStyle(l).zIndex)},[l]);const E=v.useCallback(k=>{k&&m.current===!0&&(_(),b?.(),m.current=!1)},[_,b]);return g.jsx(rL,{scope:n,contentWrapper:o,shouldExpandOnScrollRef:h,onScrollButtonChange:E,children:g.jsx("div",{ref:u,style:{display:"flex",flexDirection:"column",position:"fixed",zIndex:x},children:g.jsx(Xe.div,{...s,ref:d,style:{boxSizing:"border-box",maxHeight:"100%",...s.style}})})})});Lk.displayName=tL;var nL="SelectPopperPosition",Jm=v.forwardRef((t,e)=>{const{__scopeSelect:n,align:r="start",collisionPadding:s=Dn,...i}=t,a=Bf(n);return g.jsx(e$,{...a,...i,ref:e,align:r,collisionPadding:s,style:{boxSizing:"border-box",...i.style,"--radix-select-content-transform-origin":"var(--radix-popper-transform-origin)","--radix-select-content-available-width":"var(--radix-popper-available-width)","--radix-select-content-available-height":"var(--radix-popper-available-height)","--radix-select-trigger-width":"var(--radix-popper-anchor-width)","--radix-select-trigger-height":"var(--radix-popper-anchor-height)"}})});Jm.displayName=nL;var[rL,ay]=fo(Ei,{}),Km="SelectViewport",Mk=v.forwardRef((t,e)=>{const{__scopeSelect:n,nonce:r,...s}=t,i=Gs(Km,n),a=ay(Km,n),o=xt(e,i.onViewportChange),u=v.useRef(0);return g.jsxs(g.Fragment,{children:[g.jsx("style",{dangerouslySetInnerHTML:{__html:"[data-radix-select-viewport]{scrollbar-width:none;-ms-overflow-style:none;-webkit-overflow-scrolling:touch;}[data-radix-select-viewport]::-webkit-scrollbar{display:none}"},nonce:r}),g.jsx(Df.Slot,{scope:n,children:g.jsx(Xe.div,{"data-radix-select-viewport":"",role:"presentation",...s,ref:o,style:{position:"relative",flex:1,overflow:"hidden auto",...s.style},onScroll:nt(s.onScroll,l=>{const c=l.currentTarget,{contentWrapper:d,shouldExpandOnScrollRef:f}=a;if(f?.current&&d){const h=Math.abs(u.current-c.scrollTop);if(h>0){const m=window.innerHeight-Dn*2,y=parseFloat(d.style.minHeight),w=parseFloat(d.style.height),p=Math.max(y,w);if(p<m){const b=p+h,_=Math.min(m,b),x=b-_;d.style.height=_+"px",d.style.bottom==="0px"&&(c.scrollTop=x>0?x:0,d.style.justifyContent="flex-end")}}}u.current=c.scrollTop})})})]})});Mk.displayName=Km;var Dk="SelectGroup",[sL,iL]=fo(Dk),aL=v.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=K0();return g.jsx(sL,{scope:n,id:s,children:g.jsx(Xe.div,{role:"group","aria-labelledby":s,...r,ref:e})})});aL.displayName=Dk;var Fk="SelectLabel",Bk=v.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=iL(Fk,n);return g.jsx(Xe.div,{id:s.id,...r,ref:e})});Bk.displayName=Fk;var Rd="SelectItem",[oL,Uk]=fo(Rd),zk=v.forwardRef((t,e)=>{const{__scopeSelect:n,value:r,disabled:s=!1,textValue:i,...a}=t,o=Ws(Rd,n),u=Gs(Rd,n),l=o.value===r,[c,d]=v.useState(i??""),[f,h]=v.useState(!1),m=xt(e,b=>u.itemRefCallback?.(b,r,s)),y=K0(),w=v.useRef("touch"),p=()=>{s||(o.onValueChange(r),o.onOpenChange(!1))};if(r==="")throw new Error("A <Select.Item /> must have a value prop that is not an empty string. This is because the Select value can be set to an empty string to clear the selection and show the placeholder.");return g.jsx(oL,{scope:n,value:r,disabled:s,textId:y,isSelected:l,onItemTextChange:v.useCallback(b=>{d(_=>_||(b?.textContent??"").trim())},[]),children:g.jsx(Df.ItemSlot,{scope:n,value:r,disabled:s,textValue:c,children:g.jsx(Xe.div,{role:"option","aria-labelledby":y,"data-highlighted":f?"":void 0,"aria-selected":l&&f,"data-state":l?"checked":"unchecked","aria-disabled":s||void 0,"data-disabled":s?"":void 0,tabIndex:s?void 0:-1,...a,ref:m,onFocus:nt(a.onFocus,()=>h(!0)),onBlur:nt(a.onBlur,()=>h(!1)),onClick:nt(a.onClick,()=>{w.current!=="mouse"&&p()}),onPointerUp:nt(a.onPointerUp,()=>{w.current==="mouse"&&p()}),onPointerDown:nt(a.onPointerDown,b=>{w.current=b.pointerType}),onPointerMove:nt(a.onPointerMove,b=>{w.current=b.pointerType,s?u.onItemLeave?.():w.current==="mouse"&&b.currentTarget.focus({preventScroll:!0})}),onPointerLeave:nt(a.onPointerLeave,b=>{b.currentTarget===document.activeElement&&u.onItemLeave?.()}),onKeyDown:nt(a.onKeyDown,b=>{u.searchRef?.current!==""&&b.key===" "||(G$.includes(b.key)&&p(),b.key===" "&&b.preventDefault())})})})})});zk.displayName=Rd;var Vo="SelectItemText",qk=v.forwardRef((t,e)=>{const{__scopeSelect:n,className:r,style:s,...i}=t,a=Ws(Vo,n),o=Gs(Vo,n),u=Uk(Vo,n),l=Q$(Vo,n),[c,d]=v.useState(null),f=xt(e,p=>d(p),u.onItemTextChange,p=>o.itemTextRefCallback?.(p,u.value,u.disabled)),h=c?.textContent,m=v.useMemo(()=>g.jsx("option",{value:u.value,disabled:u.disabled,children:h},u.value),[u.disabled,u.value,h]),{onNativeOptionAdd:y,onNativeOptionRemove:w}=l;return gn(()=>(y(m),()=>w(m)),[y,w,m]),g.jsxs(g.Fragment,{children:[g.jsx(Xe.span,{id:u.textId,...i,ref:f}),u.isSelected&&a.valueNode&&!a.valueNodeHasChildren?no.createPortal(i.children,a.valueNode):null]})});qk.displayName=Vo;var Hk="SelectItemIndicator",Vk=v.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return Uk(Hk,n).isSelected?g.jsx(Xe.span,{"aria-hidden":!0,...r,ref:e}):null});Vk.displayName=Hk;var Qm="SelectScrollUpButton",Wk=v.forwardRef((t,e)=>{const n=Gs(Qm,t.__scopeSelect),r=ay(Qm,t.__scopeSelect),[s,i]=v.useState(!1),a=xt(e,r.onScrollButtonChange);return gn(()=>{if(n.viewport&&n.isPositioned){let o=function(){const l=u.scrollTop>0;i(l)};const u=n.viewport;return o(),u.addEventListener("scroll",o),()=>u.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?g.jsx(Zk,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:u}=n;o&&u&&(o.scrollTop=o.scrollTop-u.offsetHeight)}}):null});Wk.displayName=Qm;var Xm="SelectScrollDownButton",Gk=v.forwardRef((t,e)=>{const n=Gs(Xm,t.__scopeSelect),r=ay(Xm,t.__scopeSelect),[s,i]=v.useState(!1),a=xt(e,r.onScrollButtonChange);return gn(()=>{if(n.viewport&&n.isPositioned){let o=function(){const l=u.scrollHeight-u.clientHeight,c=Math.ceil(u.scrollTop)<l;i(c)};const u=n.viewport;return o(),u.addEventListener("scroll",o),()=>u.removeEventListener("scroll",o)}},[n.viewport,n.isPositioned]),s?g.jsx(Zk,{...t,ref:a,onAutoScroll:()=>{const{viewport:o,selectedItem:u}=n;o&&u&&(o.scrollTop=o.scrollTop+u.offsetHeight)}}):null});Gk.displayName=Xm;var Zk=v.forwardRef((t,e)=>{const{__scopeSelect:n,onAutoScroll:r,...s}=t,i=Gs("SelectScrollButton",n),a=v.useRef(null),o=Ff(n),u=v.useCallback(()=>{a.current!==null&&(window.clearInterval(a.current),a.current=null)},[]);return v.useEffect(()=>()=>u(),[u]),gn(()=>{o().find(c=>c.ref.current===document.activeElement)?.ref.current?.scrollIntoView({block:"nearest"})},[o]),g.jsx(Xe.div,{"aria-hidden":!0,...s,ref:e,style:{flexShrink:0,...s.style},onPointerDown:nt(s.onPointerDown,()=>{a.current===null&&(a.current=window.setInterval(r,50))}),onPointerMove:nt(s.onPointerMove,()=>{i.onItemLeave?.(),a.current===null&&(a.current=window.setInterval(r,50))}),onPointerLeave:nt(s.onPointerLeave,()=>{u()})})}),uL="SelectSeparator",Jk=v.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t;return g.jsx(Xe.div,{"aria-hidden":!0,...r,ref:e})});Jk.displayName=uL;var Ym="SelectArrow",lL=v.forwardRef((t,e)=>{const{__scopeSelect:n,...r}=t,s=Bf(n),i=Ws(Ym,n),a=Gs(Ym,n);return i.open&&a.position==="popper"?g.jsx(t$,{...s,...r,ref:e}):null});lL.displayName=Ym;function Kk(t){return t===""||t===void 0}var Qk=v.forwardRef((t,e)=>{const{value:n,...r}=t,s=v.useRef(null),i=xt(e,s),a=s$(n);return v.useEffect(()=>{const o=s.current,u=window.HTMLSelectElement.prototype,c=Object.getOwnPropertyDescriptor(u,"value").set;if(a!==n&&c){const d=new Event("change",{bubbles:!0});c.call(o,n),o.dispatchEvent(d)}},[a,n]),g.jsx(gk,{asChild:!0,children:g.jsx("select",{...r,ref:i,defaultValue:n})})});Qk.displayName="BubbleSelect";function Xk(t){const e=Qr(t),n=v.useRef(""),r=v.useRef(0),s=v.useCallback(a=>{const o=n.current+a;e(o),function u(l){n.current=l,window.clearTimeout(r.current),l!==""&&(r.current=window.setTimeout(()=>u(""),1e3))}(o)},[e]),i=v.useCallback(()=>{n.current="",window.clearTimeout(r.current)},[]);return v.useEffect(()=>()=>window.clearTimeout(r.current),[]),[n,s,i]}function Yk(t,e,n){const s=e.length>1&&Array.from(e).every(l=>l===e[0])?e[0]:e,i=n?t.indexOf(n):-1;let a=cL(t,Math.max(i,0));s.length===1&&(a=a.filter(l=>l!==n));const u=a.find(l=>l.textValue.toLowerCase().startsWith(s.toLowerCase()));return u!==n?u:void 0}function cL(t,e){return t.map((n,r)=>t[(e+r)%t.length])}var dL=Ak,eE=Ck,fL=Ok,hL=Nk,pL=Ik,tE=Rk,mL=Mk,nE=Bk,rE=zk,gL=qk,yL=Vk,sE=Wk,iE=Gk,aE=Jk;const bL=dL,wL=fL,oE=v.forwardRef(({className:t,children:e,...n},r)=>g.jsxs(eE,{ref:r,className:at("flex h-10 w-full items-center justify-between rounded-md border border-input bg-background px-3 py-2 text-sm ring-offset-background placeholder:text-muted-foreground focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 [&>span]:line-clamp-1",t),...n,children:[e,g.jsx(hL,{asChild:!0,children:g.jsx(bl,{className:"h-4 w-4 opacity-50"})})]}));oE.displayName=eE.displayName;const uE=v.forwardRef(({className:t,...e},n)=>g.jsx(sE,{ref:n,className:at("flex cursor-default items-center justify-center py-1",t),...e,children:g.jsx(MS,{className:"h-4 w-4"})}));uE.displayName=sE.displayName;const lE=v.forwardRef(({className:t,...e},n)=>g.jsx(iE,{ref:n,className:at("flex cursor-default items-center justify-center py-1",t),...e,children:g.jsx(bl,{className:"h-4 w-4"})}));lE.displayName=iE.displayName;const cE=v.forwardRef(({className:t,children:e,position:n="popper",...r},s)=>g.jsx(pL,{children:g.jsxs(tE,{ref:s,className:at("relative z-50 max-h-96 min-w-[8rem] overflow-hidden rounded-md border bg-popover text-popover-foreground shadow-md data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[side=bottom]:slide-in-from-top-2 data-[side=left]:slide-in-from-right-2 data-[side=right]:slide-in-from-left-2 data-[side=top]:slide-in-from-bottom-2",n==="popper"&&"data-[side=bottom]:translate-y-1 data-[side=left]:-translate-x-1 data-[side=right]:translate-x-1 data-[side=top]:-translate-y-1",t),position:n,...r,children:[g.jsx(uE,{}),g.jsx(mL,{className:at("p-1",n==="popper"&&"h-[var(--radix-select-trigger-height)] w-full min-w-[var(--radix-select-trigger-width)]"),children:e}),g.jsx(lE,{})]})}));cE.displayName=tE.displayName;const _L=v.forwardRef(({className:t,...e},n)=>g.jsx(nE,{ref:n,className:at("py-1.5 pl-8 pr-2 text-sm font-semibold",t),...e}));_L.displayName=nE.displayName;const dE=v.forwardRef(({className:t,children:e,...n},r)=>g.jsxs(rE,{ref:r,className:at("relative flex w-full cursor-default select-none items-center rounded-sm py-1.5 pl-8 pr-2 text-sm outline-none focus:bg-accent focus:text-accent-foreground data-[disabled]:pointer-events-none data-[disabled]:opacity-50",t),...n,children:[g.jsx("span",{className:"absolute left-2 flex h-3.5 w-3.5 items-center justify-center",children:g.jsx(yL,{children:g.jsx(LR,{className:"h-4 w-4"})})}),g.jsx(gL,{children:e})]}));dE.displayName=rE.displayName;const vL=v.forwardRef(({className:t,...e},n)=>g.jsx(aE,{ref:n,className:at("-mx-1 my-1 h-px bg-muted",t),...e}));vL.displayName=aE.displayName;const xL=()=>{const{signIn:t,signUp:e,organizations:n,loadingOrgs:r}=gS(),s=Ii(),[i,a]=v.useState(!1),[o,u]=v.useState({email:"",password:""}),[l,c]=v.useState(""),[d,f]=v.useState(!1),h=async p=>{p.preventDefault();try{if(c(""),f(!0),i){if(!o.organization_id)throw new Error("Please select an organization");const b=await e(o.email,o.password,o.organization_id);c("Registration successful! Please check your email to verify your account.")}else{const b=await t(o.email,o.password);s(b?"/employee":"/")}}catch(b){c(i?"Failed to register.":"Failed to sign in. Please check your credentials."),console.error(i?"Registration error:":"Login error:",b)}finally{f(!1)}},m=p=>{const{name:b,value:_}=p.target;u(x=>({...x,[b]:_}))},y=p=>{u(b=>({...b,organization_id:p}))},w=()=>{a(!i),c(""),u({email:"",password:"",organization_id:void 0})};return g.jsx("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-secondary/20 p-4",children:g.jsxs(kS,{className:"w-full max-w-md",children:[g.jsxs(ES,{className:"space-y-1",children:[g.jsx(AS,{className:"text-2xl text-center",children:i?"Create an Account":"AutoCRM"}),g.jsx(TS,{className:"text-center",children:i?"Enter your details to create your account":"Enter your credentials to access your account"})]}),g.jsxs(CS,{children:[l&&g.jsx(RS,{className:`mb-6 ${l.includes("successful")?"bg-primary/10 text-primary":"bg-destructive/10 text-destructive border-destructive/50"}`,children:g.jsx(jS,{children:l})}),g.jsxs("form",{onSubmit:h,className:"space-y-6",children:[g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{className:"space-y-2",children:[g.jsx(qc,{htmlFor:"email",children:"Email"}),g.jsx(qm,{id:"email",name:"email",type:"email",placeholder:"name@example.com",value:o.email,onChange:m,disabled:d,className:"transition-all duration-200"})]}),g.jsxs("div",{className:"space-y-2",children:[g.jsx(qc,{htmlFor:"password",children:"Password"}),g.jsx(qm,{id:"password",name:"password",type:"password",placeholder:"Enter your password",value:o.password,onChange:m,disabled:d,className:"transition-all duration-200"})]}),i&&g.jsxs("div",{className:"space-y-2",children:[g.jsx(qc,{htmlFor:"organization",children:"Organization"}),g.jsxs(bL,{disabled:d||r,value:o.organization_id,onValueChange:y,children:[g.jsx(oE,{children:g.jsx(wL,{placeholder:"Select an organization"})}),g.jsx(cE,{children:n.map(p=>g.jsx(dE,{value:p.id,children:p.name},p.id))})]})]})]}),g.jsx(zm,{type:"submit",className:"w-full",disabled:d,size:"lg",children:d?g.jsxs("span",{className:"flex items-center justify-center gap-2",children:[g.jsx(t6,{className:"h-4 w-4 animate-spin"}),i?"Creating account...":"Signing in..."]}):i?"Create account":"Sign in"})]})]}),g.jsx(PS,{children:g.jsx(zm,{type:"button",variant:"ghost",onClick:w,className:"w-full",disabled:d,children:i?"Already have an account? Sign in":"Need an account? Create one"})})]})})};var SL=["second","minute","hour","day","week","month","year"];function kL(t,e){if(e===0)return["just now","right now"];var n=SL[Math.floor(e/2)];return t>1&&(n+="s"),[t+" "+n+" ago","in "+t+" "+n]}var EL=["","","","","","",""];function AL(t,e){if(e===0)return["",""];var n=EL[~~(e/2)];return[t+" "+n+"",t+" "+n+""]}var eg={},fE=function(t,e){eg[t]=e},TL=function(t){return eg[t]||eg.en_US},Yh=[60,60,24,7,365/7/12,12];function CL(t){return t instanceof Date?t:!isNaN(t)||/^\d+$/.test(t)?new Date(parseInt(t)):(t=(t||"").trim().replace(/\.\d+/,"").replace(/-/,"/").replace(/-/,"/").replace(/(\d)T(\d)/,"$1 $2").replace(/Z/," UTC").replace(/([+-]\d\d):?(\d\d)/," $1$2"),new Date(t))}function PL(t,e){var n=t<0?1:0;t=Math.abs(t);for(var r=t,s=0;t>=Yh[s]&&s<Yh.length;s++)t/=Yh[s];return t=Math.floor(t),s*=2,t>(s===0?9:1)&&(s+=1),e(t,s,r)[n].replace("%s",t.toString())}function OL(t,e){var n=new Date;return(+n-+CL(t))/1e3}var NL=function(t,e,n){var r=OL(t);return PL(r,TL(e))};fE("en_US",kL);fE("zh_CN",AL);const oy={id:"9066e91f-faa2-4a68-8749-af0582dd435c",name:"AutoCRM"};function IL({userId:t,teams:e,initialValues:n}){const[r,s]=v.useState(!1),[i,a]=v.useState(null),[o,u]=v.useState(null),[l,c]=v.useState(!1),[d,f]=v.useState({team_id:"",subject:"",description:"",priority:"normal"});v.useEffect(()=>{if(n){c(!0);const p={team_id:e.find(b=>b.name===n.team_name)?.id||"",subject:n.subject,description:n.description};f(b=>({...b,...p}))}},[n]);const h=async p=>{p.preventDefault(),s(!0),u(null);try{const{data:{session:b}}=await _e.auth.getSession();if(!b)throw new Error("No session found");if(!(await fetch("/tickets",{method:"POST",headers:{Authorization:`Bearer ${b.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({...d,customer_id:t,channel:"chat"})})).ok)throw new Error("Failed to create ticket");f({team_id:"",subject:"",description:"",priority:"normal"})}catch(b){u(b instanceof Error?b.message:"Failed to create ticket")}finally{s(!1)}},m=p=>{const{name:b,value:_}=p.target;f(x=>({...x,[b]:_}))},y=p=>{a(p)},w=()=>{a(null)};return g.jsxs("div",{className:"pl-6 w-[450px]",children:[g.jsxs("div",{className:"flex items-center justify-between mb-4",children:[g.jsx("h2",{className:"text-lg font-medium text-left",children:"Create New Ticket"}),g.jsx("button",{onClick:()=>c(!l),className:"p-1 hover:bg-gray-100 rounded-full transition-colors",children:l?g.jsx(o6,{className:"w-5 h-5 text-gray-500"}):g.jsx(If,{className:"w-5 h-5 text-gray-500"})})]}),g.jsx("div",{className:`transition-all duration-300 ease-in-out overflow-hidden ${l?"max-h-[1000px] opacity-100":"max-h-0 opacity-0"}`,children:g.jsx("div",{className:"bg-white rounded-lg border p-4",children:g.jsxs("form",{onSubmit:h,className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{htmlFor:"team",className:"block text-sm font-medium text-gray-700 mb-1",children:"Team"}),g.jsxs("select",{id:"team",name:"team_id",value:d.team_id,onChange:m,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[g.jsx("option",{value:"",children:"Select a team"}),e.map(p=>p.organization_id===oy.id?g.jsx("option",{value:p.id,onMouseEnter:()=>y(p),onMouseLeave:w,className:`${i?.id===p.id?"bg-gray-100":""}`,"data-tip":p.description,children:p.name},p.id):null)]}),i&&g.jsx("div",{className:"absolute left-0 top-0 w-full h-full bg-gray-100 opacity-50 z-10",children:g.jsx("div",{className:"absolute left-1/2 top-1/2 transform -translate-x-1/2 -translate-y-1/2 w-1/2 h-1/2 bg-white rounded-lg p-4",children:g.jsx("p",{className:"text-sm text-gray-700",children:i.description})})})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"priority",className:"block text-sm font-medium text-gray-700 mb-1",children:"Priority"}),g.jsxs("select",{id:"priority",name:"priority",value:d.priority,onChange:m,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 sm:text-sm",children:[g.jsx("option",{value:"low",children:"Low"}),g.jsx("option",{value:"normal",children:"Normal"}),g.jsx("option",{value:"high",children:"High"}),g.jsx("option",{value:"urgent",children:"Urgent"})]})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"subject",className:"block text-sm font-medium text-gray-700 mb-1",children:"Subject"}),g.jsx("input",{type:"text",id:"subject",name:"subject",value:d.subject,onChange:m,required:!0,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Brief description of the issue"})]}),g.jsxs("div",{children:[g.jsx("label",{htmlFor:"description",className:"block text-sm font-medium text-gray-700 mb-1",children:"Description (Optional)"}),g.jsx("textarea",{id:"description",name:"description",value:d.description,onChange:m,rows:4,className:"w-full rounded-md border border-gray-300 px-3 py-2 text-gray-900 placeholder-gray-500 focus:border-blue-500 focus:ring-blue-500 sm:text-sm",placeholder:"Provide more details about your issue"})]}),o&&g.jsx("div",{className:"text-red-600 text-sm",children:o}),g.jsx("button",{type:"submit",disabled:r,className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:r?"Creating...":"Create Ticket"})]})})})]})}let da=class{constructor(e){Object.defineProperty(this,"pageContent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.pageContent=e.pageContent!==void 0?e.pageContent.toString():"",this.metadata=e.metadata??{},this.id=e.id}};var ve;(function(t){t.assertEqual=s=>s;function e(s){}t.assertIs=e;function n(s){throw new Error}t.assertNever=n,t.arrayToEnum=s=>{const i={};for(const a of s)i[a]=a;return i},t.getValidEnumValues=s=>{const i=t.objectKeys(s).filter(o=>typeof s[s[o]]!="number"),a={};for(const o of i)a[o]=s[o];return t.objectValues(a)},t.objectValues=s=>t.objectKeys(s).map(function(i){return s[i]}),t.objectKeys=typeof Object.keys=="function"?s=>Object.keys(s):s=>{const i=[];for(const a in s)Object.prototype.hasOwnProperty.call(s,a)&&i.push(a);return i},t.find=(s,i)=>{for(const a of s)if(i(a))return a},t.isInteger=typeof Number.isInteger=="function"?s=>Number.isInteger(s):s=>typeof s=="number"&&isFinite(s)&&Math.floor(s)===s;function r(s,i=" | "){return s.map(a=>typeof a=="string"?`'${a}'`:a).join(i)}t.joinValues=r,t.jsonStringifyReplacer=(s,i)=>typeof i=="bigint"?i.toString():i})(ve||(ve={}));var tg;(function(t){t.mergeShapes=(e,n)=>({...e,...n})})(tg||(tg={}));const Z=ve.arrayToEnum(["string","nan","number","integer","float","boolean","date","bigint","symbol","function","undefined","null","array","object","unknown","promise","void","never","map","set"]),Br=t=>{switch(typeof t){case"undefined":return Z.undefined;case"string":return Z.string;case"number":return isNaN(t)?Z.nan:Z.number;case"boolean":return Z.boolean;case"function":return Z.function;case"bigint":return Z.bigint;case"symbol":return Z.symbol;case"object":return Array.isArray(t)?Z.array:t===null?Z.null:t.then&&typeof t.then=="function"&&t.catch&&typeof t.catch=="function"?Z.promise:typeof Map<"u"&&t instanceof Map?Z.map:typeof Set<"u"&&t instanceof Set?Z.set:typeof Date<"u"&&t instanceof Date?Z.date:Z.object;default:return Z.unknown}},B=ve.arrayToEnum(["invalid_type","invalid_literal","custom","invalid_union","invalid_union_discriminator","invalid_enum_value","unrecognized_keys","invalid_arguments","invalid_return_type","invalid_date","invalid_string","too_small","too_big","invalid_intersection_types","not_multiple_of","not_finite"]),RL=t=>JSON.stringify(t,null,2).replace(/"([^"]+)":/g,"$1:");class pn extends Error{get errors(){return this.issues}constructor(e){super(),this.issues=[],this.addIssue=r=>{this.issues=[...this.issues,r]},this.addIssues=(r=[])=>{this.issues=[...this.issues,...r]};const n=new.target.prototype;Object.setPrototypeOf?Object.setPrototypeOf(this,n):this.__proto__=n,this.name="ZodError",this.issues=e}format(e){const n=e||function(i){return i.message},r={_errors:[]},s=i=>{for(const a of i.issues)if(a.code==="invalid_union")a.unionErrors.map(s);else if(a.code==="invalid_return_type")s(a.returnTypeError);else if(a.code==="invalid_arguments")s(a.argumentsError);else if(a.path.length===0)r._errors.push(n(a));else{let o=r,u=0;for(;u<a.path.length;){const l=a.path[u];u===a.path.length-1?(o[l]=o[l]||{_errors:[]},o[l]._errors.push(n(a))):o[l]=o[l]||{_errors:[]},o=o[l],u++}}};return s(this),r}static assert(e){if(!(e instanceof pn))throw new Error(`Not a ZodError: ${e}`)}toString(){return this.message}get message(){return JSON.stringify(this.issues,ve.jsonStringifyReplacer,2)}get isEmpty(){return this.issues.length===0}flatten(e=n=>n.message){const n={},r=[];for(const s of this.issues)s.path.length>0?(n[s.path[0]]=n[s.path[0]]||[],n[s.path[0]].push(e(s))):r.push(e(s));return{formErrors:r,fieldErrors:n}}get formErrors(){return this.flatten()}}pn.create=t=>new pn(t);const za=(t,e)=>{let n;switch(t.code){case B.invalid_type:t.received===Z.undefined?n="Required":n=`Expected ${t.expected}, received ${t.received}`;break;case B.invalid_literal:n=`Invalid literal value, expected ${JSON.stringify(t.expected,ve.jsonStringifyReplacer)}`;break;case B.unrecognized_keys:n=`Unrecognized key(s) in object: ${ve.joinValues(t.keys,", ")}`;break;case B.invalid_union:n="Invalid input";break;case B.invalid_union_discriminator:n=`Invalid discriminator value. Expected ${ve.joinValues(t.options)}`;break;case B.invalid_enum_value:n=`Invalid enum value. Expected ${ve.joinValues(t.options)}, received '${t.received}'`;break;case B.invalid_arguments:n="Invalid function arguments";break;case B.invalid_return_type:n="Invalid function return type";break;case B.invalid_date:n="Invalid date";break;case B.invalid_string:typeof t.validation=="object"?"includes"in t.validation?(n=`Invalid input: must include "${t.validation.includes}"`,typeof t.validation.position=="number"&&(n=`${n} at one or more positions greater than or equal to ${t.validation.position}`)):"startsWith"in t.validation?n=`Invalid input: must start with "${t.validation.startsWith}"`:"endsWith"in t.validation?n=`Invalid input: must end with "${t.validation.endsWith}"`:ve.assertNever(t.validation):t.validation!=="regex"?n=`Invalid ${t.validation}`:n="Invalid";break;case B.too_small:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at least":"more than"} ${t.minimum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at least":"over"} ${t.minimum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${t.minimum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly equal to ":t.inclusive?"greater than or equal to ":"greater than "}${new Date(Number(t.minimum))}`:n="Invalid input";break;case B.too_big:t.type==="array"?n=`Array must contain ${t.exact?"exactly":t.inclusive?"at most":"less than"} ${t.maximum} element(s)`:t.type==="string"?n=`String must contain ${t.exact?"exactly":t.inclusive?"at most":"under"} ${t.maximum} character(s)`:t.type==="number"?n=`Number must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="bigint"?n=`BigInt must be ${t.exact?"exactly":t.inclusive?"less than or equal to":"less than"} ${t.maximum}`:t.type==="date"?n=`Date must be ${t.exact?"exactly":t.inclusive?"smaller than or equal to":"smaller than"} ${new Date(Number(t.maximum))}`:n="Invalid input";break;case B.custom:n="Invalid input";break;case B.invalid_intersection_types:n="Intersection results could not be merged";break;case B.not_multiple_of:n=`Number must be a multiple of ${t.multipleOf}`;break;case B.not_finite:n="Number must be finite";break;default:n=e.defaultError,ve.assertNever(t)}return{message:n}};let hE=za;function jL(t){hE=t}function jd(){return hE}const $d=t=>{const{data:e,path:n,errorMaps:r,issueData:s}=t,i=[...n,...s.path||[]],a={...s,path:i};if(s.message!==void 0)return{...s,path:i,message:s.message};let o="";const u=r.filter(l=>!!l).slice().reverse();for(const l of u)o=l(a,{data:e,defaultError:o}).message;return{...s,path:i,message:o}},$L=[];function V(t,e){const n=jd(),r=$d({issueData:e,data:t.data,path:t.path,errorMaps:[t.common.contextualErrorMap,t.schemaErrorMap,n,n===za?void 0:za].filter(s=>!!s)});t.common.issues.push(r)}class Ot{constructor(){this.value="valid"}dirty(){this.value==="valid"&&(this.value="dirty")}abort(){this.value!=="aborted"&&(this.value="aborted")}static mergeArray(e,n){const r=[];for(const s of n){if(s.status==="aborted")return ie;s.status==="dirty"&&e.dirty(),r.push(s.value)}return{status:e.value,value:r}}static async mergeObjectAsync(e,n){const r=[];for(const s of n){const i=await s.key,a=await s.value;r.push({key:i,value:a})}return Ot.mergeObjectSync(e,r)}static mergeObjectSync(e,n){const r={};for(const s of n){const{key:i,value:a}=s;if(i.status==="aborted"||a.status==="aborted")return ie;i.status==="dirty"&&e.dirty(),a.status==="dirty"&&e.dirty(),i.value!=="__proto__"&&(typeof a.value<"u"||s.alwaysSet)&&(r[i.value]=a.value)}return{status:e.value,value:r}}}const ie=Object.freeze({status:"aborted"}),fa=t=>({status:"dirty",value:t}),Dt=t=>({status:"valid",value:t}),ng=t=>t.status==="aborted",rg=t=>t.status==="dirty",Ai=t=>t.status==="valid",Bu=t=>typeof Promise<"u"&&t instanceof Promise;function Ld(t,e,n,r){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return e.get(t)}function pE(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n}var ne;(function(t){t.errToObj=e=>typeof e=="string"?{message:e}:e||{},t.toString=e=>typeof e=="string"?e:e?.message})(ne||(ne={}));var Wo,Go;class Ar{constructor(e,n,r,s){this._cachedPath=[],this.parent=e,this.data=n,this._path=r,this._key=s}get path(){return this._cachedPath.length||(this._key instanceof Array?this._cachedPath.push(...this._path,...this._key):this._cachedPath.push(...this._path,this._key)),this._cachedPath}}const b_=(t,e)=>{if(Ai(e))return{success:!0,data:e.value};if(!t.common.issues.length)throw new Error("Validation failed but no issues detected.");return{success:!1,get error(){if(this._error)return this._error;const n=new pn(t.common.issues);return this._error=n,this._error}}};function ae(t){if(!t)return{};const{errorMap:e,invalid_type_error:n,required_error:r,description:s}=t;if(e&&(n||r))throw new Error(`Can't use "invalid_type_error" or "required_error" in conjunction with custom error map.`);return e?{errorMap:e,description:s}:{errorMap:(a,o)=>{var u,l;const{message:c}=t;return a.code==="invalid_enum_value"?{message:c??o.defaultError}:typeof o.data>"u"?{message:(u=c??r)!==null&&u!==void 0?u:o.defaultError}:a.code!=="invalid_type"?{message:o.defaultError}:{message:(l=c??n)!==null&&l!==void 0?l:o.defaultError}},description:s}}class de{get description(){return this._def.description}_getType(e){return Br(e.data)}_getOrReturnCtx(e,n){return n||{common:e.parent.common,data:e.data,parsedType:Br(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}_processInputParams(e){return{status:new Ot,ctx:{common:e.parent.common,data:e.data,parsedType:Br(e.data),schemaErrorMap:this._def.errorMap,path:e.path,parent:e.parent}}}_parseSync(e){const n=this._parse(e);if(Bu(n))throw new Error("Synchronous parse encountered promise.");return n}_parseAsync(e){const n=this._parse(e);return Promise.resolve(n)}parse(e,n){const r=this.safeParse(e,n);if(r.success)return r.data;throw r.error}safeParse(e,n){var r;const s={common:{issues:[],async:(r=n?.async)!==null&&r!==void 0?r:!1,contextualErrorMap:n?.errorMap},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Br(e)},i=this._parseSync({data:e,path:s.path,parent:s});return b_(s,i)}"~validate"(e){var n,r;const s={common:{issues:[],async:!!this["~standard"].async},path:[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Br(e)};if(!this["~standard"].async)try{const i=this._parseSync({data:e,path:[],parent:s});return Ai(i)?{value:i.value}:{issues:s.common.issues}}catch(i){!((r=(n=i?.message)===null||n===void 0?void 0:n.toLowerCase())===null||r===void 0)&&r.includes("encountered")&&(this["~standard"].async=!0),s.common={issues:[],async:!0}}return this._parseAsync({data:e,path:[],parent:s}).then(i=>Ai(i)?{value:i.value}:{issues:s.common.issues})}async parseAsync(e,n){const r=await this.safeParseAsync(e,n);if(r.success)return r.data;throw r.error}async safeParseAsync(e,n){const r={common:{issues:[],contextualErrorMap:n?.errorMap,async:!0},path:n?.path||[],schemaErrorMap:this._def.errorMap,parent:null,data:e,parsedType:Br(e)},s=this._parse({data:e,path:r.path,parent:r}),i=await(Bu(s)?s:Promise.resolve(s));return b_(r,i)}refine(e,n){const r=s=>typeof n=="string"||typeof n>"u"?{message:n}:typeof n=="function"?n(s):n;return this._refinement((s,i)=>{const a=e(s),o=()=>i.addIssue({code:B.custom,...r(s)});return typeof Promise<"u"&&a instanceof Promise?a.then(u=>u?!0:(o(),!1)):a?!0:(o(),!1)})}refinement(e,n){return this._refinement((r,s)=>e(r)?!0:(s.addIssue(typeof n=="function"?n(r,s):n),!1))}_refinement(e){return new er({schema:this,typeName:P.ZodEffects,effect:{type:"refinement",refinement:e}})}superRefine(e){return this._refinement(e)}constructor(e){this.spa=this.safeParseAsync,this._def=e,this.parse=this.parse.bind(this),this.safeParse=this.safeParse.bind(this),this.parseAsync=this.parseAsync.bind(this),this.safeParseAsync=this.safeParseAsync.bind(this),this.spa=this.spa.bind(this),this.refine=this.refine.bind(this),this.refinement=this.refinement.bind(this),this.superRefine=this.superRefine.bind(this),this.optional=this.optional.bind(this),this.nullable=this.nullable.bind(this),this.nullish=this.nullish.bind(this),this.array=this.array.bind(this),this.promise=this.promise.bind(this),this.or=this.or.bind(this),this.and=this.and.bind(this),this.transform=this.transform.bind(this),this.brand=this.brand.bind(this),this.default=this.default.bind(this),this.catch=this.catch.bind(this),this.describe=this.describe.bind(this),this.pipe=this.pipe.bind(this),this.readonly=this.readonly.bind(this),this.isNullable=this.isNullable.bind(this),this.isOptional=this.isOptional.bind(this),this["~standard"]={version:1,vendor:"zod",validate:n=>this["~validate"](n)}}optional(){return Jn.create(this,this._def)}nullable(){return Fs.create(this,this._def)}nullish(){return this.nullable().optional()}array(){return Zn.create(this)}promise(){return Ha.create(this,this._def)}or(e){return Hu.create([this,e],this._def)}and(e){return Vu.create(this,e,this._def)}transform(e){return new er({...ae(this._def),schema:this,typeName:P.ZodEffects,effect:{type:"transform",transform:e}})}default(e){const n=typeof e=="function"?e:()=>e;return new Ku({...ae(this._def),innerType:this,defaultValue:n,typeName:P.ZodDefault})}brand(){return new uy({typeName:P.ZodBranded,type:this,...ae(this._def)})}catch(e){const n=typeof e=="function"?e:()=>e;return new Qu({...ae(this._def),innerType:this,catchValue:n,typeName:P.ZodCatch})}describe(e){const n=this.constructor;return new n({...this._def,description:e})}pipe(e){return vl.create(this,e)}readonly(){return Xu.create(this)}isOptional(){return this.safeParse(void 0).success}isNullable(){return this.safeParse(null).success}}const LL=/^c[^\s-]{8,}$/i,ML=/^[0-9a-z]+$/,DL=/^[0-9A-HJKMNP-TV-Z]{26}$/i,FL=/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/i,BL=/^[a-z0-9_-]{21}$/i,UL=/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/,zL=/^[-+]?P(?!$)(?:(?:[-+]?\d+Y)|(?:[-+]?\d+[.,]\d+Y$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:(?:[-+]?\d+W)|(?:[-+]?\d+[.,]\d+W$))?(?:(?:[-+]?\d+D)|(?:[-+]?\d+[.,]\d+D$))?(?:T(?=[\d+-])(?:(?:[-+]?\d+H)|(?:[-+]?\d+[.,]\d+H$))?(?:(?:[-+]?\d+M)|(?:[-+]?\d+[.,]\d+M$))?(?:[-+]?\d+(?:[.,]\d+)?S)?)??$/,qL=/^(?!\.)(?!.*\.\.)([A-Z0-9_'+\-\.]*)[A-Z0-9_+-]@([A-Z0-9][A-Z0-9\-]*\.)+[A-Z]{2,}$/i,HL="^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$";let ep;const VL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,WL=/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,GL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/,ZL=/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,JL=/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,KL=/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,mE="((\\d\\d[2468][048]|\\d\\d[13579][26]|\\d\\d0[48]|[02468][048]00|[13579][26]00)-02-29|\\d{4}-((0[13578]|1[02])-(0[1-9]|[12]\\d|3[01])|(0[469]|11)-(0[1-9]|[12]\\d|30)|(02)-(0[1-9]|1\\d|2[0-8])))",QL=new RegExp(`^${mE}$`);function gE(t){let e="([01]\\d|2[0-3]):[0-5]\\d:[0-5]\\d";return t.precision?e=`${e}\\.\\d{${t.precision}}`:t.precision==null&&(e=`${e}(\\.\\d+)?`),e}function XL(t){return new RegExp(`^${gE(t)}$`)}function yE(t){let e=`${mE}T${gE(t)}`;const n=[];return n.push(t.local?"Z?":"Z"),t.offset&&n.push("([+-]\\d{2}:?\\d{2})"),e=`${e}(${n.join("|")})`,new RegExp(`^${e}$`)}function YL(t,e){return!!((e==="v4"||!e)&&VL.test(t)||(e==="v6"||!e)&&GL.test(t))}function e8(t,e){if(!UL.test(t))return!1;try{const[n]=t.split("."),r=n.replace(/-/g,"+").replace(/_/g,"/").padEnd(n.length+(4-n.length%4)%4,"="),s=JSON.parse(atob(r));return!(typeof s!="object"||s===null||!s.typ||!s.alg||e&&s.alg!==e)}catch{return!1}}function t8(t,e){return!!((e==="v4"||!e)&&WL.test(t)||(e==="v6"||!e)&&ZL.test(t))}class Hn extends de{_parse(e){if(this._def.coerce&&(e.data=String(e.data)),this._getType(e)!==Z.string){const i=this._getOrReturnCtx(e);return V(i,{code:B.invalid_type,expected:Z.string,received:i.parsedType}),ie}const r=new Ot;let s;for(const i of this._def.checks)if(i.kind==="min")e.data.length<i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:B.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="max")e.data.length>i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:B.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!1,message:i.message}),r.dirty());else if(i.kind==="length"){const a=e.data.length>i.value,o=e.data.length<i.value;(a||o)&&(s=this._getOrReturnCtx(e,s),a?V(s,{code:B.too_big,maximum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}):o&&V(s,{code:B.too_small,minimum:i.value,type:"string",inclusive:!0,exact:!0,message:i.message}),r.dirty())}else if(i.kind==="email")qL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"email",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="emoji")ep||(ep=new RegExp(HL,"u")),ep.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"emoji",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="uuid")FL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"uuid",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="nanoid")BL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"nanoid",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid")LL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="cuid2")ML.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cuid2",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="ulid")DL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ulid",code:B.invalid_string,message:i.message}),r.dirty());else if(i.kind==="url")try{new URL(e.data)}catch{s=this._getOrReturnCtx(e,s),V(s,{validation:"url",code:B.invalid_string,message:i.message}),r.dirty()}else i.kind==="regex"?(i.regex.lastIndex=0,i.regex.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"regex",code:B.invalid_string,message:i.message}),r.dirty())):i.kind==="trim"?e.data=e.data.trim():i.kind==="includes"?e.data.includes(i.value,i.position)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:{includes:i.value,position:i.position},message:i.message}),r.dirty()):i.kind==="toLowerCase"?e.data=e.data.toLowerCase():i.kind==="toUpperCase"?e.data=e.data.toUpperCase():i.kind==="startsWith"?e.data.startsWith(i.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:{startsWith:i.value},message:i.message}),r.dirty()):i.kind==="endsWith"?e.data.endsWith(i.value)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:{endsWith:i.value},message:i.message}),r.dirty()):i.kind==="datetime"?yE(i).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:"datetime",message:i.message}),r.dirty()):i.kind==="date"?QL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:"date",message:i.message}),r.dirty()):i.kind==="time"?XL(i).test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{code:B.invalid_string,validation:"time",message:i.message}),r.dirty()):i.kind==="duration"?zL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"duration",code:B.invalid_string,message:i.message}),r.dirty()):i.kind==="ip"?YL(e.data,i.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"ip",code:B.invalid_string,message:i.message}),r.dirty()):i.kind==="jwt"?e8(e.data,i.alg)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"jwt",code:B.invalid_string,message:i.message}),r.dirty()):i.kind==="cidr"?t8(e.data,i.version)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"cidr",code:B.invalid_string,message:i.message}),r.dirty()):i.kind==="base64"?JL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64",code:B.invalid_string,message:i.message}),r.dirty()):i.kind==="base64url"?KL.test(e.data)||(s=this._getOrReturnCtx(e,s),V(s,{validation:"base64url",code:B.invalid_string,message:i.message}),r.dirty()):ve.assertNever(i);return{status:r.value,value:e.data}}_regex(e,n,r){return this.refinement(s=>e.test(s),{validation:n,code:B.invalid_string,...ne.errToObj(r)})}_addCheck(e){return new Hn({...this._def,checks:[...this._def.checks,e]})}email(e){return this._addCheck({kind:"email",...ne.errToObj(e)})}url(e){return this._addCheck({kind:"url",...ne.errToObj(e)})}emoji(e){return this._addCheck({kind:"emoji",...ne.errToObj(e)})}uuid(e){return this._addCheck({kind:"uuid",...ne.errToObj(e)})}nanoid(e){return this._addCheck({kind:"nanoid",...ne.errToObj(e)})}cuid(e){return this._addCheck({kind:"cuid",...ne.errToObj(e)})}cuid2(e){return this._addCheck({kind:"cuid2",...ne.errToObj(e)})}ulid(e){return this._addCheck({kind:"ulid",...ne.errToObj(e)})}base64(e){return this._addCheck({kind:"base64",...ne.errToObj(e)})}base64url(e){return this._addCheck({kind:"base64url",...ne.errToObj(e)})}jwt(e){return this._addCheck({kind:"jwt",...ne.errToObj(e)})}ip(e){return this._addCheck({kind:"ip",...ne.errToObj(e)})}cidr(e){return this._addCheck({kind:"cidr",...ne.errToObj(e)})}datetime(e){var n,r;return typeof e=="string"?this._addCheck({kind:"datetime",precision:null,offset:!1,local:!1,message:e}):this._addCheck({kind:"datetime",precision:typeof e?.precision>"u"?null:e?.precision,offset:(n=e?.offset)!==null&&n!==void 0?n:!1,local:(r=e?.local)!==null&&r!==void 0?r:!1,...ne.errToObj(e?.message)})}date(e){return this._addCheck({kind:"date",message:e})}time(e){return typeof e=="string"?this._addCheck({kind:"time",precision:null,message:e}):this._addCheck({kind:"time",precision:typeof e?.precision>"u"?null:e?.precision,...ne.errToObj(e?.message)})}duration(e){return this._addCheck({kind:"duration",...ne.errToObj(e)})}regex(e,n){return this._addCheck({kind:"regex",regex:e,...ne.errToObj(n)})}includes(e,n){return this._addCheck({kind:"includes",value:e,position:n?.position,...ne.errToObj(n?.message)})}startsWith(e,n){return this._addCheck({kind:"startsWith",value:e,...ne.errToObj(n)})}endsWith(e,n){return this._addCheck({kind:"endsWith",value:e,...ne.errToObj(n)})}min(e,n){return this._addCheck({kind:"min",value:e,...ne.errToObj(n)})}max(e,n){return this._addCheck({kind:"max",value:e,...ne.errToObj(n)})}length(e,n){return this._addCheck({kind:"length",value:e,...ne.errToObj(n)})}nonempty(e){return this.min(1,ne.errToObj(e))}trim(){return new Hn({...this._def,checks:[...this._def.checks,{kind:"trim"}]})}toLowerCase(){return new Hn({...this._def,checks:[...this._def.checks,{kind:"toLowerCase"}]})}toUpperCase(){return new Hn({...this._def,checks:[...this._def.checks,{kind:"toUpperCase"}]})}get isDatetime(){return!!this._def.checks.find(e=>e.kind==="datetime")}get isDate(){return!!this._def.checks.find(e=>e.kind==="date")}get isTime(){return!!this._def.checks.find(e=>e.kind==="time")}get isDuration(){return!!this._def.checks.find(e=>e.kind==="duration")}get isEmail(){return!!this._def.checks.find(e=>e.kind==="email")}get isURL(){return!!this._def.checks.find(e=>e.kind==="url")}get isEmoji(){return!!this._def.checks.find(e=>e.kind==="emoji")}get isUUID(){return!!this._def.checks.find(e=>e.kind==="uuid")}get isNANOID(){return!!this._def.checks.find(e=>e.kind==="nanoid")}get isCUID(){return!!this._def.checks.find(e=>e.kind==="cuid")}get isCUID2(){return!!this._def.checks.find(e=>e.kind==="cuid2")}get isULID(){return!!this._def.checks.find(e=>e.kind==="ulid")}get isIP(){return!!this._def.checks.find(e=>e.kind==="ip")}get isCIDR(){return!!this._def.checks.find(e=>e.kind==="cidr")}get isBase64(){return!!this._def.checks.find(e=>e.kind==="base64")}get isBase64url(){return!!this._def.checks.find(e=>e.kind==="base64url")}get minLength(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxLength(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Hn.create=t=>{var e;return new Hn({checks:[],typeName:P.ZodString,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...ae(t)})};function n8(t,e){const n=(t.toString().split(".")[1]||"").length,r=(e.toString().split(".")[1]||"").length,s=n>r?n:r,i=parseInt(t.toFixed(s).replace(".","")),a=parseInt(e.toFixed(s).replace(".",""));return i%a/Math.pow(10,s)}class Ls extends de{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte,this.step=this.multipleOf}_parse(e){if(this._def.coerce&&(e.data=Number(e.data)),this._getType(e)!==Z.number){const i=this._getOrReturnCtx(e);return V(i,{code:B.invalid_type,expected:Z.number,received:i.parsedType}),ie}let r;const s=new Ot;for(const i of this._def.checks)i.kind==="int"?ve.isInteger(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:B.invalid_type,expected:"integer",received:"float",message:i.message}),s.dirty()):i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.too_small,minimum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.too_big,maximum:i.value,type:"number",inclusive:i.inclusive,exact:!1,message:i.message}),s.dirty()):i.kind==="multipleOf"?n8(e.data,i.value)!==0&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):i.kind==="finite"?Number.isFinite(e.data)||(r=this._getOrReturnCtx(e,r),V(r,{code:B.not_finite,message:i.message}),s.dirty()):ve.assertNever(i);return{status:s.value,value:e.data}}gte(e,n){return this.setLimit("min",e,!0,ne.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ne.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ne.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ne.toString(n))}setLimit(e,n,r,s){return new Ls({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ne.toString(s)}]})}_addCheck(e){return new Ls({...this._def,checks:[...this._def.checks,e]})}int(e){return this._addCheck({kind:"int",message:ne.toString(e)})}positive(e){return this._addCheck({kind:"min",value:0,inclusive:!1,message:ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:0,inclusive:!1,message:ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:0,inclusive:!0,message:ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:0,inclusive:!0,message:ne.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(n)})}finite(e){return this._addCheck({kind:"finite",message:ne.toString(e)})}safe(e){return this._addCheck({kind:"min",inclusive:!0,value:Number.MIN_SAFE_INTEGER,message:ne.toString(e)})._addCheck({kind:"max",inclusive:!0,value:Number.MAX_SAFE_INTEGER,message:ne.toString(e)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}get isInt(){return!!this._def.checks.find(e=>e.kind==="int"||e.kind==="multipleOf"&&ve.isInteger(e.value))}get isFinite(){let e=null,n=null;for(const r of this._def.checks){if(r.kind==="finite"||r.kind==="int"||r.kind==="multipleOf")return!0;r.kind==="min"?(n===null||r.value>n)&&(n=r.value):r.kind==="max"&&(e===null||r.value<e)&&(e=r.value)}return Number.isFinite(n)&&Number.isFinite(e)}}Ls.create=t=>new Ls({checks:[],typeName:P.ZodNumber,coerce:t?.coerce||!1,...ae(t)});class Ms extends de{constructor(){super(...arguments),this.min=this.gte,this.max=this.lte}_parse(e){if(this._def.coerce)try{e.data=BigInt(e.data)}catch{return this._getInvalidInput(e)}if(this._getType(e)!==Z.bigint)return this._getInvalidInput(e);let r;const s=new Ot;for(const i of this._def.checks)i.kind==="min"?(i.inclusive?e.data<i.value:e.data<=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.too_small,type:"bigint",minimum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="max"?(i.inclusive?e.data>i.value:e.data>=i.value)&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.too_big,type:"bigint",maximum:i.value,inclusive:i.inclusive,message:i.message}),s.dirty()):i.kind==="multipleOf"?e.data%i.value!==BigInt(0)&&(r=this._getOrReturnCtx(e,r),V(r,{code:B.not_multiple_of,multipleOf:i.value,message:i.message}),s.dirty()):ve.assertNever(i);return{status:s.value,value:e.data}}_getInvalidInput(e){const n=this._getOrReturnCtx(e);return V(n,{code:B.invalid_type,expected:Z.bigint,received:n.parsedType}),ie}gte(e,n){return this.setLimit("min",e,!0,ne.toString(n))}gt(e,n){return this.setLimit("min",e,!1,ne.toString(n))}lte(e,n){return this.setLimit("max",e,!0,ne.toString(n))}lt(e,n){return this.setLimit("max",e,!1,ne.toString(n))}setLimit(e,n,r,s){return new Ms({...this._def,checks:[...this._def.checks,{kind:e,value:n,inclusive:r,message:ne.toString(s)}]})}_addCheck(e){return new Ms({...this._def,checks:[...this._def.checks,e]})}positive(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}negative(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!1,message:ne.toString(e)})}nonpositive(e){return this._addCheck({kind:"max",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}nonnegative(e){return this._addCheck({kind:"min",value:BigInt(0),inclusive:!0,message:ne.toString(e)})}multipleOf(e,n){return this._addCheck({kind:"multipleOf",value:e,message:ne.toString(n)})}get minValue(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e}get maxValue(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e}}Ms.create=t=>{var e;return new Ms({checks:[],typeName:P.ZodBigInt,coerce:(e=t?.coerce)!==null&&e!==void 0?e:!1,...ae(t)})};class Uu extends de{_parse(e){if(this._def.coerce&&(e.data=!!e.data),this._getType(e)!==Z.boolean){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.boolean,received:r.parsedType}),ie}return Dt(e.data)}}Uu.create=t=>new Uu({typeName:P.ZodBoolean,coerce:t?.coerce||!1,...ae(t)});class Ti extends de{_parse(e){if(this._def.coerce&&(e.data=new Date(e.data)),this._getType(e)!==Z.date){const i=this._getOrReturnCtx(e);return V(i,{code:B.invalid_type,expected:Z.date,received:i.parsedType}),ie}if(isNaN(e.data.getTime())){const i=this._getOrReturnCtx(e);return V(i,{code:B.invalid_date}),ie}const r=new Ot;let s;for(const i of this._def.checks)i.kind==="min"?e.data.getTime()<i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:B.too_small,message:i.message,inclusive:!0,exact:!1,minimum:i.value,type:"date"}),r.dirty()):i.kind==="max"?e.data.getTime()>i.value&&(s=this._getOrReturnCtx(e,s),V(s,{code:B.too_big,message:i.message,inclusive:!0,exact:!1,maximum:i.value,type:"date"}),r.dirty()):ve.assertNever(i);return{status:r.value,value:new Date(e.data.getTime())}}_addCheck(e){return new Ti({...this._def,checks:[...this._def.checks,e]})}min(e,n){return this._addCheck({kind:"min",value:e.getTime(),message:ne.toString(n)})}max(e,n){return this._addCheck({kind:"max",value:e.getTime(),message:ne.toString(n)})}get minDate(){let e=null;for(const n of this._def.checks)n.kind==="min"&&(e===null||n.value>e)&&(e=n.value);return e!=null?new Date(e):null}get maxDate(){let e=null;for(const n of this._def.checks)n.kind==="max"&&(e===null||n.value<e)&&(e=n.value);return e!=null?new Date(e):null}}Ti.create=t=>new Ti({checks:[],coerce:t?.coerce||!1,typeName:P.ZodDate,...ae(t)});class Md extends de{_parse(e){if(this._getType(e)!==Z.symbol){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.symbol,received:r.parsedType}),ie}return Dt(e.data)}}Md.create=t=>new Md({typeName:P.ZodSymbol,...ae(t)});class zu extends de{_parse(e){if(this._getType(e)!==Z.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.undefined,received:r.parsedType}),ie}return Dt(e.data)}}zu.create=t=>new zu({typeName:P.ZodUndefined,...ae(t)});class qu extends de{_parse(e){if(this._getType(e)!==Z.null){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.null,received:r.parsedType}),ie}return Dt(e.data)}}qu.create=t=>new qu({typeName:P.ZodNull,...ae(t)});class qa extends de{constructor(){super(...arguments),this._any=!0}_parse(e){return Dt(e.data)}}qa.create=t=>new qa({typeName:P.ZodAny,...ae(t)});class yi extends de{constructor(){super(...arguments),this._unknown=!0}_parse(e){return Dt(e.data)}}yi.create=t=>new yi({typeName:P.ZodUnknown,...ae(t)});class es extends de{_parse(e){const n=this._getOrReturnCtx(e);return V(n,{code:B.invalid_type,expected:Z.never,received:n.parsedType}),ie}}es.create=t=>new es({typeName:P.ZodNever,...ae(t)});class Dd extends de{_parse(e){if(this._getType(e)!==Z.undefined){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.void,received:r.parsedType}),ie}return Dt(e.data)}}Dd.create=t=>new Dd({typeName:P.ZodVoid,...ae(t)});class Zn extends de{_parse(e){const{ctx:n,status:r}=this._processInputParams(e),s=this._def;if(n.parsedType!==Z.array)return V(n,{code:B.invalid_type,expected:Z.array,received:n.parsedType}),ie;if(s.exactLength!==null){const a=n.data.length>s.exactLength.value,o=n.data.length<s.exactLength.value;(a||o)&&(V(n,{code:a?B.too_big:B.too_small,minimum:o?s.exactLength.value:void 0,maximum:a?s.exactLength.value:void 0,type:"array",inclusive:!0,exact:!0,message:s.exactLength.message}),r.dirty())}if(s.minLength!==null&&n.data.length<s.minLength.value&&(V(n,{code:B.too_small,minimum:s.minLength.value,type:"array",inclusive:!0,exact:!1,message:s.minLength.message}),r.dirty()),s.maxLength!==null&&n.data.length>s.maxLength.value&&(V(n,{code:B.too_big,maximum:s.maxLength.value,type:"array",inclusive:!0,exact:!1,message:s.maxLength.message}),r.dirty()),n.common.async)return Promise.all([...n.data].map((a,o)=>s.type._parseAsync(new Ar(n,a,n.path,o)))).then(a=>Ot.mergeArray(r,a));const i=[...n.data].map((a,o)=>s.type._parseSync(new Ar(n,a,n.path,o)));return Ot.mergeArray(r,i)}get element(){return this._def.type}min(e,n){return new Zn({...this._def,minLength:{value:e,message:ne.toString(n)}})}max(e,n){return new Zn({...this._def,maxLength:{value:e,message:ne.toString(n)}})}length(e,n){return new Zn({...this._def,exactLength:{value:e,message:ne.toString(n)}})}nonempty(e){return this.min(1,e)}}Zn.create=(t,e)=>new Zn({type:t,minLength:null,maxLength:null,exactLength:null,typeName:P.ZodArray,...ae(e)});function Ki(t){if(t instanceof Ge){const e={};for(const n in t.shape){const r=t.shape[n];e[n]=Jn.create(Ki(r))}return new Ge({...t._def,shape:()=>e})}else return t instanceof Zn?new Zn({...t._def,type:Ki(t.element)}):t instanceof Jn?Jn.create(Ki(t.unwrap())):t instanceof Fs?Fs.create(Ki(t.unwrap())):t instanceof Tr?Tr.create(t.items.map(e=>Ki(e))):t}class Ge extends de{constructor(){super(...arguments),this._cached=null,this.nonstrict=this.passthrough,this.augment=this.extend}_getCached(){if(this._cached!==null)return this._cached;const e=this._def.shape(),n=ve.objectKeys(e);return this._cached={shape:e,keys:n}}_parse(e){if(this._getType(e)!==Z.object){const l=this._getOrReturnCtx(e);return V(l,{code:B.invalid_type,expected:Z.object,received:l.parsedType}),ie}const{status:r,ctx:s}=this._processInputParams(e),{shape:i,keys:a}=this._getCached(),o=[];if(!(this._def.catchall instanceof es&&this._def.unknownKeys==="strip"))for(const l in s.data)a.includes(l)||o.push(l);const u=[];for(const l of a){const c=i[l],d=s.data[l];u.push({key:{status:"valid",value:l},value:c._parse(new Ar(s,d,s.path,l)),alwaysSet:l in s.data})}if(this._def.catchall instanceof es){const l=this._def.unknownKeys;if(l==="passthrough")for(const c of o)u.push({key:{status:"valid",value:c},value:{status:"valid",value:s.data[c]}});else if(l==="strict")o.length>0&&(V(s,{code:B.unrecognized_keys,keys:o}),r.dirty());else if(l!=="strip")throw new Error("Internal ZodObject error: invalid unknownKeys value.")}else{const l=this._def.catchall;for(const c of o){const d=s.data[c];u.push({key:{status:"valid",value:c},value:l._parse(new Ar(s,d,s.path,c)),alwaysSet:c in s.data})}}return s.common.async?Promise.resolve().then(async()=>{const l=[];for(const c of u){const d=await c.key,f=await c.value;l.push({key:d,value:f,alwaysSet:c.alwaysSet})}return l}).then(l=>Ot.mergeObjectSync(r,l)):Ot.mergeObjectSync(r,u)}get shape(){return this._def.shape()}strict(e){return ne.errToObj,new Ge({...this._def,unknownKeys:"strict",...e!==void 0?{errorMap:(n,r)=>{var s,i,a,o;const u=(a=(i=(s=this._def).errorMap)===null||i===void 0?void 0:i.call(s,n,r).message)!==null&&a!==void 0?a:r.defaultError;return n.code==="unrecognized_keys"?{message:(o=ne.errToObj(e).message)!==null&&o!==void 0?o:u}:{message:u}}}:{}})}strip(){return new Ge({...this._def,unknownKeys:"strip"})}passthrough(){return new Ge({...this._def,unknownKeys:"passthrough"})}extend(e){return new Ge({...this._def,shape:()=>({...this._def.shape(),...e})})}merge(e){return new Ge({unknownKeys:e._def.unknownKeys,catchall:e._def.catchall,shape:()=>({...this._def.shape(),...e._def.shape()}),typeName:P.ZodObject})}setKey(e,n){return this.augment({[e]:n})}catchall(e){return new Ge({...this._def,catchall:e})}pick(e){const n={};return ve.objectKeys(e).forEach(r=>{e[r]&&this.shape[r]&&(n[r]=this.shape[r])}),new Ge({...this._def,shape:()=>n})}omit(e){const n={};return ve.objectKeys(this.shape).forEach(r=>{e[r]||(n[r]=this.shape[r])}),new Ge({...this._def,shape:()=>n})}deepPartial(){return Ki(this)}partial(e){const n={};return ve.objectKeys(this.shape).forEach(r=>{const s=this.shape[r];e&&!e[r]?n[r]=s:n[r]=s.optional()}),new Ge({...this._def,shape:()=>n})}required(e){const n={};return ve.objectKeys(this.shape).forEach(r=>{if(e&&!e[r])n[r]=this.shape[r];else{let i=this.shape[r];for(;i instanceof Jn;)i=i._def.innerType;n[r]=i}}),new Ge({...this._def,shape:()=>n})}keyof(){return bE(ve.objectKeys(this.shape))}}Ge.create=(t,e)=>new Ge({shape:()=>t,unknownKeys:"strip",catchall:es.create(),typeName:P.ZodObject,...ae(e)});Ge.strictCreate=(t,e)=>new Ge({shape:()=>t,unknownKeys:"strict",catchall:es.create(),typeName:P.ZodObject,...ae(e)});Ge.lazycreate=(t,e)=>new Ge({shape:t,unknownKeys:"strip",catchall:es.create(),typeName:P.ZodObject,...ae(e)});class Hu extends de{_parse(e){const{ctx:n}=this._processInputParams(e),r=this._def.options;function s(i){for(const o of i)if(o.result.status==="valid")return o.result;for(const o of i)if(o.result.status==="dirty")return n.common.issues.push(...o.ctx.common.issues),o.result;const a=i.map(o=>new pn(o.ctx.common.issues));return V(n,{code:B.invalid_union,unionErrors:a}),ie}if(n.common.async)return Promise.all(r.map(async i=>{const a={...n,common:{...n.common,issues:[]},parent:null};return{result:await i._parseAsync({data:n.data,path:n.path,parent:a}),ctx:a}})).then(s);{let i;const a=[];for(const u of r){const l={...n,common:{...n.common,issues:[]},parent:null},c=u._parseSync({data:n.data,path:n.path,parent:l});if(c.status==="valid")return c;c.status==="dirty"&&!i&&(i={result:c,ctx:l}),l.common.issues.length&&a.push(l.common.issues)}if(i)return n.common.issues.push(...i.ctx.common.issues),i.result;const o=a.map(u=>new pn(u));return V(n,{code:B.invalid_union,unionErrors:o}),ie}}get options(){return this._def.options}}Hu.create=(t,e)=>new Hu({options:t,typeName:P.ZodUnion,...ae(e)});const Rr=t=>t instanceof Gu?Rr(t.schema):t instanceof er?Rr(t.innerType()):t instanceof Zu?[t.value]:t instanceof Ds?t.options:t instanceof Ju?ve.objectValues(t.enum):t instanceof Ku?Rr(t._def.innerType):t instanceof zu?[void 0]:t instanceof qu?[null]:t instanceof Jn?[void 0,...Rr(t.unwrap())]:t instanceof Fs?[null,...Rr(t.unwrap())]:t instanceof uy||t instanceof Xu?Rr(t.unwrap()):t instanceof Qu?Rr(t._def.innerType):[];class Uf extends de{_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Z.object)return V(n,{code:B.invalid_type,expected:Z.object,received:n.parsedType}),ie;const r=this.discriminator,s=n.data[r],i=this.optionsMap.get(s);return i?n.common.async?i._parseAsync({data:n.data,path:n.path,parent:n}):i._parseSync({data:n.data,path:n.path,parent:n}):(V(n,{code:B.invalid_union_discriminator,options:Array.from(this.optionsMap.keys()),path:[r]}),ie)}get discriminator(){return this._def.discriminator}get options(){return this._def.options}get optionsMap(){return this._def.optionsMap}static create(e,n,r){const s=new Map;for(const i of n){const a=Rr(i.shape[e]);if(!a.length)throw new Error(`A discriminator value for key \`${e}\` could not be extracted from all schema options`);for(const o of a){if(s.has(o))throw new Error(`Discriminator property ${String(e)} has duplicate value ${String(o)}`);s.set(o,i)}}return new Uf({typeName:P.ZodDiscriminatedUnion,discriminator:e,options:n,optionsMap:s,...ae(r)})}}function sg(t,e){const n=Br(t),r=Br(e);if(t===e)return{valid:!0,data:t};if(n===Z.object&&r===Z.object){const s=ve.objectKeys(e),i=ve.objectKeys(t).filter(o=>s.indexOf(o)!==-1),a={...t,...e};for(const o of i){const u=sg(t[o],e[o]);if(!u.valid)return{valid:!1};a[o]=u.data}return{valid:!0,data:a}}else if(n===Z.array&&r===Z.array){if(t.length!==e.length)return{valid:!1};const s=[];for(let i=0;i<t.length;i++){const a=t[i],o=e[i],u=sg(a,o);if(!u.valid)return{valid:!1};s.push(u.data)}return{valid:!0,data:s}}else return n===Z.date&&r===Z.date&&+t==+e?{valid:!0,data:t}:{valid:!1}}class Vu extends de{_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=(i,a)=>{if(ng(i)||ng(a))return ie;const o=sg(i.value,a.value);return o.valid?((rg(i)||rg(a))&&n.dirty(),{status:n.value,value:o.data}):(V(r,{code:B.invalid_intersection_types}),ie)};return r.common.async?Promise.all([this._def.left._parseAsync({data:r.data,path:r.path,parent:r}),this._def.right._parseAsync({data:r.data,path:r.path,parent:r})]).then(([i,a])=>s(i,a)):s(this._def.left._parseSync({data:r.data,path:r.path,parent:r}),this._def.right._parseSync({data:r.data,path:r.path,parent:r}))}}Vu.create=(t,e,n)=>new Vu({left:t,right:e,typeName:P.ZodIntersection,...ae(n)});class Tr extends de{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Z.array)return V(r,{code:B.invalid_type,expected:Z.array,received:r.parsedType}),ie;if(r.data.length<this._def.items.length)return V(r,{code:B.too_small,minimum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),ie;!this._def.rest&&r.data.length>this._def.items.length&&(V(r,{code:B.too_big,maximum:this._def.items.length,inclusive:!0,exact:!1,type:"array"}),n.dirty());const i=[...r.data].map((a,o)=>{const u=this._def.items[o]||this._def.rest;return u?u._parse(new Ar(r,a,r.path,o)):null}).filter(a=>!!a);return r.common.async?Promise.all(i).then(a=>Ot.mergeArray(n,a)):Ot.mergeArray(n,i)}get items(){return this._def.items}rest(e){return new Tr({...this._def,rest:e})}}Tr.create=(t,e)=>{if(!Array.isArray(t))throw new Error("You must pass an array of schemas to z.tuple([ ... ])");return new Tr({items:t,typeName:P.ZodTuple,rest:null,...ae(e)})};class Wu extends de{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Z.object)return V(r,{code:B.invalid_type,expected:Z.object,received:r.parsedType}),ie;const s=[],i=this._def.keyType,a=this._def.valueType;for(const o in r.data)s.push({key:i._parse(new Ar(r,o,r.path,o)),value:a._parse(new Ar(r,r.data[o],r.path,o)),alwaysSet:o in r.data});return r.common.async?Ot.mergeObjectAsync(n,s):Ot.mergeObjectSync(n,s)}get element(){return this._def.valueType}static create(e,n,r){return n instanceof de?new Wu({keyType:e,valueType:n,typeName:P.ZodRecord,...ae(r)}):new Wu({keyType:Hn.create(),valueType:e,typeName:P.ZodRecord,...ae(n)})}}class Fd extends de{get keySchema(){return this._def.keyType}get valueSchema(){return this._def.valueType}_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Z.map)return V(r,{code:B.invalid_type,expected:Z.map,received:r.parsedType}),ie;const s=this._def.keyType,i=this._def.valueType,a=[...r.data.entries()].map(([o,u],l)=>({key:s._parse(new Ar(r,o,r.path,[l,"key"])),value:i._parse(new Ar(r,u,r.path,[l,"value"]))}));if(r.common.async){const o=new Map;return Promise.resolve().then(async()=>{for(const u of a){const l=await u.key,c=await u.value;if(l.status==="aborted"||c.status==="aborted")return ie;(l.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(l.value,c.value)}return{status:n.value,value:o}})}else{const o=new Map;for(const u of a){const l=u.key,c=u.value;if(l.status==="aborted"||c.status==="aborted")return ie;(l.status==="dirty"||c.status==="dirty")&&n.dirty(),o.set(l.value,c.value)}return{status:n.value,value:o}}}}Fd.create=(t,e,n)=>new Fd({valueType:e,keyType:t,typeName:P.ZodMap,...ae(n)});class Ci extends de{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.parsedType!==Z.set)return V(r,{code:B.invalid_type,expected:Z.set,received:r.parsedType}),ie;const s=this._def;s.minSize!==null&&r.data.size<s.minSize.value&&(V(r,{code:B.too_small,minimum:s.minSize.value,type:"set",inclusive:!0,exact:!1,message:s.minSize.message}),n.dirty()),s.maxSize!==null&&r.data.size>s.maxSize.value&&(V(r,{code:B.too_big,maximum:s.maxSize.value,type:"set",inclusive:!0,exact:!1,message:s.maxSize.message}),n.dirty());const i=this._def.valueType;function a(u){const l=new Set;for(const c of u){if(c.status==="aborted")return ie;c.status==="dirty"&&n.dirty(),l.add(c.value)}return{status:n.value,value:l}}const o=[...r.data.values()].map((u,l)=>i._parse(new Ar(r,u,r.path,l)));return r.common.async?Promise.all(o).then(u=>a(u)):a(o)}min(e,n){return new Ci({...this._def,minSize:{value:e,message:ne.toString(n)}})}max(e,n){return new Ci({...this._def,maxSize:{value:e,message:ne.toString(n)}})}size(e,n){return this.min(e,n).max(e,n)}nonempty(e){return this.min(1,e)}}Ci.create=(t,e)=>new Ci({valueType:t,minSize:null,maxSize:null,typeName:P.ZodSet,...ae(e)});class Aa extends de{constructor(){super(...arguments),this.validate=this.implement}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Z.function)return V(n,{code:B.invalid_type,expected:Z.function,received:n.parsedType}),ie;function r(o,u){return $d({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,jd(),za].filter(l=>!!l),issueData:{code:B.invalid_arguments,argumentsError:u}})}function s(o,u){return $d({data:o,path:n.path,errorMaps:[n.common.contextualErrorMap,n.schemaErrorMap,jd(),za].filter(l=>!!l),issueData:{code:B.invalid_return_type,returnTypeError:u}})}const i={errorMap:n.common.contextualErrorMap},a=n.data;if(this._def.returns instanceof Ha){const o=this;return Dt(async function(...u){const l=new pn([]),c=await o._def.args.parseAsync(u,i).catch(h=>{throw l.addIssue(r(u,h)),l}),d=await Reflect.apply(a,this,c);return await o._def.returns._def.type.parseAsync(d,i).catch(h=>{throw l.addIssue(s(d,h)),l})})}else{const o=this;return Dt(function(...u){const l=o._def.args.safeParse(u,i);if(!l.success)throw new pn([r(u,l.error)]);const c=Reflect.apply(a,this,l.data),d=o._def.returns.safeParse(c,i);if(!d.success)throw new pn([s(c,d.error)]);return d.data})}}parameters(){return this._def.args}returnType(){return this._def.returns}args(...e){return new Aa({...this._def,args:Tr.create(e).rest(yi.create())})}returns(e){return new Aa({...this._def,returns:e})}implement(e){return this.parse(e)}strictImplement(e){return this.parse(e)}static create(e,n,r){return new Aa({args:e||Tr.create([]).rest(yi.create()),returns:n||yi.create(),typeName:P.ZodFunction,...ae(r)})}}class Gu extends de{get schema(){return this._def.getter()}_parse(e){const{ctx:n}=this._processInputParams(e);return this._def.getter()._parse({data:n.data,path:n.path,parent:n})}}Gu.create=(t,e)=>new Gu({getter:t,typeName:P.ZodLazy,...ae(e)});class Zu extends de{_parse(e){if(e.data!==this._def.value){const n=this._getOrReturnCtx(e);return V(n,{received:n.data,code:B.invalid_literal,expected:this._def.value}),ie}return{status:"valid",value:e.data}}get value(){return this._def.value}}Zu.create=(t,e)=>new Zu({value:t,typeName:P.ZodLiteral,...ae(e)});function bE(t,e){return new Ds({values:t,typeName:P.ZodEnum,...ae(e)})}class Ds extends de{constructor(){super(...arguments),Wo.set(this,void 0)}_parse(e){if(typeof e.data!="string"){const n=this._getOrReturnCtx(e),r=this._def.values;return V(n,{expected:ve.joinValues(r),received:n.parsedType,code:B.invalid_type}),ie}if(Ld(this,Wo)||pE(this,Wo,new Set(this._def.values)),!Ld(this,Wo).has(e.data)){const n=this._getOrReturnCtx(e),r=this._def.values;return V(n,{received:n.data,code:B.invalid_enum_value,options:r}),ie}return Dt(e.data)}get options(){return this._def.values}get enum(){const e={};for(const n of this._def.values)e[n]=n;return e}get Values(){const e={};for(const n of this._def.values)e[n]=n;return e}get Enum(){const e={};for(const n of this._def.values)e[n]=n;return e}extract(e,n=this._def){return Ds.create(e,{...this._def,...n})}exclude(e,n=this._def){return Ds.create(this.options.filter(r=>!e.includes(r)),{...this._def,...n})}}Wo=new WeakMap;Ds.create=bE;class Ju extends de{constructor(){super(...arguments),Go.set(this,void 0)}_parse(e){const n=ve.getValidEnumValues(this._def.values),r=this._getOrReturnCtx(e);if(r.parsedType!==Z.string&&r.parsedType!==Z.number){const s=ve.objectValues(n);return V(r,{expected:ve.joinValues(s),received:r.parsedType,code:B.invalid_type}),ie}if(Ld(this,Go)||pE(this,Go,new Set(ve.getValidEnumValues(this._def.values))),!Ld(this,Go).has(e.data)){const s=ve.objectValues(n);return V(r,{received:r.data,code:B.invalid_enum_value,options:s}),ie}return Dt(e.data)}get enum(){return this._def.values}}Go=new WeakMap;Ju.create=(t,e)=>new Ju({values:t,typeName:P.ZodNativeEnum,...ae(e)});class Ha extends de{unwrap(){return this._def.type}_parse(e){const{ctx:n}=this._processInputParams(e);if(n.parsedType!==Z.promise&&n.common.async===!1)return V(n,{code:B.invalid_type,expected:Z.promise,received:n.parsedType}),ie;const r=n.parsedType===Z.promise?n.data:Promise.resolve(n.data);return Dt(r.then(s=>this._def.type.parseAsync(s,{path:n.path,errorMap:n.common.contextualErrorMap})))}}Ha.create=(t,e)=>new Ha({type:t,typeName:P.ZodPromise,...ae(e)});class er extends de{innerType(){return this._def.schema}sourceType(){return this._def.schema._def.typeName===P.ZodEffects?this._def.schema.sourceType():this._def.schema}_parse(e){const{status:n,ctx:r}=this._processInputParams(e),s=this._def.effect||null,i={addIssue:a=>{V(r,a),a.fatal?n.abort():n.dirty()},get path(){return r.path}};if(i.addIssue=i.addIssue.bind(i),s.type==="preprocess"){const a=s.transform(r.data,i);if(r.common.async)return Promise.resolve(a).then(async o=>{if(n.value==="aborted")return ie;const u=await this._def.schema._parseAsync({data:o,path:r.path,parent:r});return u.status==="aborted"?ie:u.status==="dirty"||n.value==="dirty"?fa(u.value):u});{if(n.value==="aborted")return ie;const o=this._def.schema._parseSync({data:a,path:r.path,parent:r});return o.status==="aborted"?ie:o.status==="dirty"||n.value==="dirty"?fa(o.value):o}}if(s.type==="refinement"){const a=o=>{const u=s.refinement(o,i);if(r.common.async)return Promise.resolve(u);if(u instanceof Promise)throw new Error("Async refinement encountered during synchronous parse operation. Use .parseAsync instead.");return o};if(r.common.async===!1){const o=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});return o.status==="aborted"?ie:(o.status==="dirty"&&n.dirty(),a(o.value),{status:n.value,value:o.value})}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(o=>o.status==="aborted"?ie:(o.status==="dirty"&&n.dirty(),a(o.value).then(()=>({status:n.value,value:o.value}))))}if(s.type==="transform")if(r.common.async===!1){const a=this._def.schema._parseSync({data:r.data,path:r.path,parent:r});if(!Ai(a))return a;const o=s.transform(a.value,i);if(o instanceof Promise)throw new Error("Asynchronous transform encountered during synchronous parse operation. Use .parseAsync instead.");return{status:n.value,value:o}}else return this._def.schema._parseAsync({data:r.data,path:r.path,parent:r}).then(a=>Ai(a)?Promise.resolve(s.transform(a.value,i)).then(o=>({status:n.value,value:o})):a);ve.assertNever(s)}}er.create=(t,e,n)=>new er({schema:t,typeName:P.ZodEffects,effect:e,...ae(n)});er.createWithPreprocess=(t,e,n)=>new er({schema:e,effect:{type:"preprocess",transform:t},typeName:P.ZodEffects,...ae(n)});class Jn extends de{_parse(e){return this._getType(e)===Z.undefined?Dt(void 0):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Jn.create=(t,e)=>new Jn({innerType:t,typeName:P.ZodOptional,...ae(e)});class Fs extends de{_parse(e){return this._getType(e)===Z.null?Dt(null):this._def.innerType._parse(e)}unwrap(){return this._def.innerType}}Fs.create=(t,e)=>new Fs({innerType:t,typeName:P.ZodNullable,...ae(e)});class Ku extends de{_parse(e){const{ctx:n}=this._processInputParams(e);let r=n.data;return n.parsedType===Z.undefined&&(r=this._def.defaultValue()),this._def.innerType._parse({data:r,path:n.path,parent:n})}removeDefault(){return this._def.innerType}}Ku.create=(t,e)=>new Ku({innerType:t,typeName:P.ZodDefault,defaultValue:typeof e.default=="function"?e.default:()=>e.default,...ae(e)});class Qu extends de{_parse(e){const{ctx:n}=this._processInputParams(e),r={...n,common:{...n.common,issues:[]}},s=this._def.innerType._parse({data:r.data,path:r.path,parent:{...r}});return Bu(s)?s.then(i=>({status:"valid",value:i.status==="valid"?i.value:this._def.catchValue({get error(){return new pn(r.common.issues)},input:r.data})})):{status:"valid",value:s.status==="valid"?s.value:this._def.catchValue({get error(){return new pn(r.common.issues)},input:r.data})}}removeCatch(){return this._def.innerType}}Qu.create=(t,e)=>new Qu({innerType:t,typeName:P.ZodCatch,catchValue:typeof e.catch=="function"?e.catch:()=>e.catch,...ae(e)});class Bd extends de{_parse(e){if(this._getType(e)!==Z.nan){const r=this._getOrReturnCtx(e);return V(r,{code:B.invalid_type,expected:Z.nan,received:r.parsedType}),ie}return{status:"valid",value:e.data}}}Bd.create=t=>new Bd({typeName:P.ZodNaN,...ae(t)});const r8=Symbol("zod_brand");class uy extends de{_parse(e){const{ctx:n}=this._processInputParams(e),r=n.data;return this._def.type._parse({data:r,path:n.path,parent:n})}unwrap(){return this._def.type}}class vl extends de{_parse(e){const{status:n,ctx:r}=this._processInputParams(e);if(r.common.async)return(async()=>{const i=await this._def.in._parseAsync({data:r.data,path:r.path,parent:r});return i.status==="aborted"?ie:i.status==="dirty"?(n.dirty(),fa(i.value)):this._def.out._parseAsync({data:i.value,path:r.path,parent:r})})();{const s=this._def.in._parseSync({data:r.data,path:r.path,parent:r});return s.status==="aborted"?ie:s.status==="dirty"?(n.dirty(),{status:"dirty",value:s.value}):this._def.out._parseSync({data:s.value,path:r.path,parent:r})}}static create(e,n){return new vl({in:e,out:n,typeName:P.ZodPipeline})}}class Xu extends de{_parse(e){const n=this._def.innerType._parse(e),r=s=>(Ai(s)&&(s.value=Object.freeze(s.value)),s);return Bu(n)?n.then(s=>r(s)):r(n)}unwrap(){return this._def.innerType}}Xu.create=(t,e)=>new Xu({innerType:t,typeName:P.ZodReadonly,...ae(e)});function wE(t,e={},n){return t?qa.create().superRefine((r,s)=>{var i,a;if(!t(r)){const o=typeof e=="function"?e(r):typeof e=="string"?{message:e}:e,u=(a=(i=o.fatal)!==null&&i!==void 0?i:n)!==null&&a!==void 0?a:!0,l=typeof o=="string"?{message:o}:o;s.addIssue({code:"custom",...l,fatal:u})}}):qa.create()}const s8={object:Ge.lazycreate};var P;(function(t){t.ZodString="ZodString",t.ZodNumber="ZodNumber",t.ZodNaN="ZodNaN",t.ZodBigInt="ZodBigInt",t.ZodBoolean="ZodBoolean",t.ZodDate="ZodDate",t.ZodSymbol="ZodSymbol",t.ZodUndefined="ZodUndefined",t.ZodNull="ZodNull",t.ZodAny="ZodAny",t.ZodUnknown="ZodUnknown",t.ZodNever="ZodNever",t.ZodVoid="ZodVoid",t.ZodArray="ZodArray",t.ZodObject="ZodObject",t.ZodUnion="ZodUnion",t.ZodDiscriminatedUnion="ZodDiscriminatedUnion",t.ZodIntersection="ZodIntersection",t.ZodTuple="ZodTuple",t.ZodRecord="ZodRecord",t.ZodMap="ZodMap",t.ZodSet="ZodSet",t.ZodFunction="ZodFunction",t.ZodLazy="ZodLazy",t.ZodLiteral="ZodLiteral",t.ZodEnum="ZodEnum",t.ZodEffects="ZodEffects",t.ZodNativeEnum="ZodNativeEnum",t.ZodOptional="ZodOptional",t.ZodNullable="ZodNullable",t.ZodDefault="ZodDefault",t.ZodCatch="ZodCatch",t.ZodPromise="ZodPromise",t.ZodBranded="ZodBranded",t.ZodPipeline="ZodPipeline",t.ZodReadonly="ZodReadonly"})(P||(P={}));const i8=(t,e={message:`Input not instance of ${t.name}`})=>wE(n=>n instanceof t,e),_E=Hn.create,vE=Ls.create,a8=Bd.create,o8=Ms.create,xE=Uu.create,u8=Ti.create,l8=Md.create,c8=zu.create,d8=qu.create,f8=qa.create,h8=yi.create,p8=es.create,m8=Dd.create,g8=Zn.create,y8=Ge.create,b8=Ge.strictCreate,w8=Hu.create,_8=Uf.create,v8=Vu.create,x8=Tr.create,S8=Wu.create,k8=Fd.create,E8=Ci.create,A8=Aa.create,T8=Gu.create,C8=Zu.create,P8=Ds.create,O8=Ju.create,N8=Ha.create,w_=er.create,I8=Jn.create,R8=Fs.create,j8=er.createWithPreprocess,$8=vl.create,L8=()=>_E().optional(),M8=()=>vE().optional(),D8=()=>xE().optional(),F8={string:t=>Hn.create({...t,coerce:!0}),number:t=>Ls.create({...t,coerce:!0}),boolean:t=>Uu.create({...t,coerce:!0}),bigint:t=>Ms.create({...t,coerce:!0}),date:t=>Ti.create({...t,coerce:!0})},B8=ie;var bi=Object.freeze({__proto__:null,defaultErrorMap:za,setErrorMap:jL,getErrorMap:jd,makeIssue:$d,EMPTY_PATH:$L,addIssueToContext:V,ParseStatus:Ot,INVALID:ie,DIRTY:fa,OK:Dt,isAborted:ng,isDirty:rg,isValid:Ai,isAsync:Bu,get util(){return ve},get objectUtil(){return tg},ZodParsedType:Z,getParsedType:Br,ZodType:de,datetimeRegex:yE,ZodString:Hn,ZodNumber:Ls,ZodBigInt:Ms,ZodBoolean:Uu,ZodDate:Ti,ZodSymbol:Md,ZodUndefined:zu,ZodNull:qu,ZodAny:qa,ZodUnknown:yi,ZodNever:es,ZodVoid:Dd,ZodArray:Zn,ZodObject:Ge,ZodUnion:Hu,ZodDiscriminatedUnion:Uf,ZodIntersection:Vu,ZodTuple:Tr,ZodRecord:Wu,ZodMap:Fd,ZodSet:Ci,ZodFunction:Aa,ZodLazy:Gu,ZodLiteral:Zu,ZodEnum:Ds,ZodNativeEnum:Ju,ZodPromise:Ha,ZodEffects:er,ZodTransformer:er,ZodOptional:Jn,ZodNullable:Fs,ZodDefault:Ku,ZodCatch:Qu,ZodNaN:Bd,BRAND:r8,ZodBranded:uy,ZodPipeline:vl,ZodReadonly:Xu,custom:wE,Schema:de,ZodSchema:de,late:s8,get ZodFirstPartyTypeKind(){return P},coerce:F8,any:f8,array:g8,bigint:o8,boolean:xE,date:u8,discriminatedUnion:_8,effect:w_,enum:P8,function:A8,instanceof:i8,intersection:v8,lazy:T8,literal:C8,map:k8,nan:a8,nativeEnum:O8,never:p8,null:d8,nullable:R8,number:vE,object:y8,oboolean:D8,onumber:M8,optional:I8,ostring:L8,pipeline:$8,preprocess:j8,promise:N8,record:S8,set:E8,strictObject:b8,string:_E,symbol:l8,transformer:w_,tuple:x8,undefined:c8,union:w8,unknown:h8,void:m8,NEVER:B8,ZodIssueCode:B,quotelessJson:RL,ZodError:pn}),zf={exports:{}},SE={};function In(t,e){typeof e=="boolean"&&(e={forever:e}),this._originalTimeouts=JSON.parse(JSON.stringify(t)),this._timeouts=t,this._options=e||{},this._maxRetryTime=e&&e.maxRetryTime||1/0,this._fn=null,this._errors=[],this._attempts=1,this._operationTimeout=null,this._operationTimeoutCb=null,this._timeout=null,this._operationStart=null,this._timer=null,this._options.forever&&(this._cachedTimeouts=this._timeouts.slice(0))}var U8=In;In.prototype.reset=function(){this._attempts=1,this._timeouts=this._originalTimeouts.slice(0)};In.prototype.stop=function(){this._timeout&&clearTimeout(this._timeout),this._timer&&clearTimeout(this._timer),this._timeouts=[],this._cachedTimeouts=null};In.prototype.retry=function(t){if(this._timeout&&clearTimeout(this._timeout),!t)return!1;var e=new Date().getTime();if(t&&e-this._operationStart>=this._maxRetryTime)return this._errors.push(t),this._errors.unshift(new Error("RetryOperation timeout occurred")),!1;this._errors.push(t);var n=this._timeouts.shift();if(n===void 0)if(this._cachedTimeouts)this._errors.splice(0,this._errors.length-1),n=this._cachedTimeouts.slice(-1);else return!1;var r=this;return this._timer=setTimeout(function(){r._attempts++,r._operationTimeoutCb&&(r._timeout=setTimeout(function(){r._operationTimeoutCb(r._attempts)},r._operationTimeout),r._options.unref&&r._timeout.unref()),r._fn(r._attempts)},n),this._options.unref&&this._timer.unref(),!0};In.prototype.attempt=function(t,e){this._fn=t,e&&(e.timeout&&(this._operationTimeout=e.timeout),e.cb&&(this._operationTimeoutCb=e.cb));var n=this;this._operationTimeoutCb&&(this._timeout=setTimeout(function(){n._operationTimeoutCb()},n._operationTimeout)),this._operationStart=new Date().getTime(),this._fn(this._attempts)};In.prototype.try=function(t){console.log("Using RetryOperation.try() is deprecated"),this.attempt(t)};In.prototype.start=function(t){console.log("Using RetryOperation.start() is deprecated"),this.attempt(t)};In.prototype.start=In.prototype.try;In.prototype.errors=function(){return this._errors};In.prototype.attempts=function(){return this._attempts};In.prototype.mainError=function(){if(this._errors.length===0)return null;for(var t={},e=null,n=0,r=0;r<this._errors.length;r++){var s=this._errors[r],i=s.message,a=(t[i]||0)+1;t[i]=a,a>=n&&(e=s,n=a)}return e};(function(t){var e=U8;t.operation=function(n){var r=t.timeouts(n);return new e(r,{forever:n&&(n.forever||n.retries===1/0),unref:n&&n.unref,maxRetryTime:n&&n.maxRetryTime})},t.timeouts=function(n){if(n instanceof Array)return[].concat(n);var r={retries:10,factor:2,minTimeout:1*1e3,maxTimeout:1/0,randomize:!1};for(var s in n)r[s]=n[s];if(r.minTimeout>r.maxTimeout)throw new Error("minTimeout is greater than maxTimeout");for(var i=[],a=0;a<r.retries;a++)i.push(this.createTimeout(a,r));return n&&n.forever&&!i.length&&i.push(this.createTimeout(a,r)),i.sort(function(o,u){return o-u}),i},t.createTimeout=function(n,r){var s=r.randomize?Math.random()+1:1,i=Math.round(s*Math.max(r.minTimeout,1)*Math.pow(r.factor,n));return i=Math.min(i,r.maxTimeout),i},t.wrap=function(n,r,s){if(r instanceof Array&&(s=r,r=null),!s){s=[];for(var i in n)typeof n[i]=="function"&&s.push(i)}for(var a=0;a<s.length;a++){var o=s[a],u=n[o];n[o]=function(c){var d=t.operation(r),f=Array.prototype.slice.call(arguments,1),h=f.pop();f.push(function(m){d.retry(m)||(m&&(arguments[0]=d.mainError()),h.apply(this,arguments))}),d.attempt(function(){c.apply(n,f)})}.bind(n,u),n[o].options=r}}})(SE);var z8=SE;const q8=z8,H8=["Failed to fetch","NetworkError when attempting to fetch resource.","The Internet connection appears to be offline.","Network request failed"];class kE extends Error{constructor(e){super(),e instanceof Error?(this.originalError=e,{message:e}=e):(this.originalError=new Error(e),this.originalError.stack=this.stack),this.name="AbortError",this.message=e}}const V8=(t,e,n)=>{const r=n.retries-(e-1);return t.attemptNumber=e,t.retriesLeft=r,t},W8=t=>H8.includes(t),EE=(t,e)=>new Promise((n,r)=>{e={onFailedAttempt:()=>{},retries:10,...e};const s=q8.operation(e);s.attempt(async i=>{try{n(await t(i))}catch(a){if(!(a instanceof Error)){r(new TypeError(`Non-error was thrown: "${a}". You should only throw errors.`));return}if(a instanceof kE)s.stop(),r(a.originalError);else if(a instanceof TypeError&&!W8(a.message))s.stop(),r(a);else{V8(a,i,e);try{await e.onFailedAttempt(a)}catch(o){r(o);return}s.retry(a)||r(s.mainError())}}})});zf.exports=EE;zf.exports.default=EE;zf.exports.AbortError=kE;var G8=zf.exports;const Ud=Xa(G8),Z8=/^(?:[0-9a-f]{8}-[0-9a-f]{4}-[1-8][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}|00000000-0000-0000-0000-000000000000|ffffffff-ffff-ffff-ffff-ffffffffffff)$/i;function du(t){return typeof t=="string"&&Z8.test(t)}var bt=[];for(var tp=0;tp<256;++tp)bt.push((tp+256).toString(16).slice(1));function J8(t,e=0){return(bt[t[e+0]]+bt[t[e+1]]+bt[t[e+2]]+bt[t[e+3]]+"-"+bt[t[e+4]]+bt[t[e+5]]+"-"+bt[t[e+6]]+bt[t[e+7]]+"-"+bt[t[e+8]]+bt[t[e+9]]+"-"+bt[t[e+10]]+bt[t[e+11]]+bt[t[e+12]]+bt[t[e+13]]+bt[t[e+14]]+bt[t[e+15]]).toLowerCase()}var fc,K8=new Uint8Array(16);function Q8(){if(!fc&&(fc=typeof crypto<"u"&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto),!fc))throw new Error("crypto.getRandomValues() not supported. See https://github.com/uuidjs/uuid#getrandomvalues-not-supported");return fc(K8)}var X8=typeof crypto<"u"&&crypto.randomUUID&&crypto.randomUUID.bind(crypto);const __={randomUUID:X8};function Jt(t,e,n){if(__.randomUUID&&!t)return __.randomUUID();t=t||{};var r=t.random||(t.rng||Q8)();return r[6]=r[6]&15|64,r[8]=r[8]&63|128,J8(r)}var AE={},TE={exports:{}};(function(t){var e=Object.prototype.hasOwnProperty,n="~";function r(){}Object.create&&(r.prototype=Object.create(null),new r().__proto__||(n=!1));function s(u,l,c){this.fn=u,this.context=l,this.once=c||!1}function i(u,l,c,d,f){if(typeof c!="function")throw new TypeError("The listener must be a function");var h=new s(c,d||u,f),m=n?n+l:l;return u._events[m]?u._events[m].fn?u._events[m]=[u._events[m],h]:u._events[m].push(h):(u._events[m]=h,u._eventsCount++),u}function a(u,l){--u._eventsCount===0?u._events=new r:delete u._events[l]}function o(){this._events=new r,this._eventsCount=0}o.prototype.eventNames=function(){var l=[],c,d;if(this._eventsCount===0)return l;for(d in c=this._events)e.call(c,d)&&l.push(n?d.slice(1):d);return Object.getOwnPropertySymbols?l.concat(Object.getOwnPropertySymbols(c)):l},o.prototype.listeners=function(l){var c=n?n+l:l,d=this._events[c];if(!d)return[];if(d.fn)return[d.fn];for(var f=0,h=d.length,m=new Array(h);f<h;f++)m[f]=d[f].fn;return m},o.prototype.listenerCount=function(l){var c=n?n+l:l,d=this._events[c];return d?d.fn?1:d.length:0},o.prototype.emit=function(l,c,d,f,h,m){var y=n?n+l:l;if(!this._events[y])return!1;var w=this._events[y],p=arguments.length,b,_;if(w.fn){switch(w.once&&this.removeListener(l,w.fn,void 0,!0),p){case 1:return w.fn.call(w.context),!0;case 2:return w.fn.call(w.context,c),!0;case 3:return w.fn.call(w.context,c,d),!0;case 4:return w.fn.call(w.context,c,d,f),!0;case 5:return w.fn.call(w.context,c,d,f,h),!0;case 6:return w.fn.call(w.context,c,d,f,h,m),!0}for(_=1,b=new Array(p-1);_<p;_++)b[_-1]=arguments[_];w.fn.apply(w.context,b)}else{var x=w.length,S;for(_=0;_<x;_++)switch(w[_].once&&this.removeListener(l,w[_].fn,void 0,!0),p){case 1:w[_].fn.call(w[_].context);break;case 2:w[_].fn.call(w[_].context,c);break;case 3:w[_].fn.call(w[_].context,c,d);break;case 4:w[_].fn.call(w[_].context,c,d,f);break;default:if(!b)for(S=1,b=new Array(p-1);S<p;S++)b[S-1]=arguments[S];w[_].fn.apply(w[_].context,b)}}return!0},o.prototype.on=function(l,c,d){return i(this,l,c,d,!1)},o.prototype.once=function(l,c,d){return i(this,l,c,d,!0)},o.prototype.removeListener=function(l,c,d,f){var h=n?n+l:l;if(!this._events[h])return this;if(!c)return a(this,h),this;var m=this._events[h];if(m.fn)m.fn===c&&(!f||m.once)&&(!d||m.context===d)&&a(this,h);else{for(var y=0,w=[],p=m.length;y<p;y++)(m[y].fn!==c||f&&!m[y].once||d&&m[y].context!==d)&&w.push(m[y]);w.length?this._events[h]=w.length===1?w[0]:w:a(this,h)}return this},o.prototype.removeAllListeners=function(l){var c;return l?(c=n?n+l:l,this._events[c]&&a(this,c)):(this._events=new r,this._eventsCount=0),this},o.prototype.off=o.prototype.removeListener,o.prototype.addListener=o.prototype.on,o.prefixed=n,o.EventEmitter=o,t.exports=o})(TE);var Y8=TE.exports,qf={exports:{}},e5=(t,e)=>(e=e||(()=>{}),t.then(n=>new Promise(r=>{r(e())}).then(()=>n),n=>new Promise(r=>{r(e())}).then(()=>{throw n})));const t5=e5;class CE extends Error{constructor(e){super(e),this.name="TimeoutError"}}const PE=(t,e,n)=>new Promise((r,s)=>{if(typeof e!="number"||e<0)throw new TypeError("Expected `milliseconds` to be a positive number");if(e===1/0){r(t);return}const i=setTimeout(()=>{if(typeof n=="function"){try{r(n())}catch(u){s(u)}return}const a=typeof n=="string"?n:`Promise timed out after ${e} milliseconds`,o=n instanceof Error?n:new CE(a);typeof t.cancel=="function"&&t.cancel(),s(o)},e);t5(t.then(r,s),()=>{clearTimeout(i)})});qf.exports=PE;qf.exports.default=PE;qf.exports.TimeoutError=CE;var n5=qf.exports,ly={},cy={};Object.defineProperty(cy,"__esModule",{value:!0});function r5(t,e,n){let r=0,s=t.length;for(;s>0;){const i=s/2|0;let a=r+i;n(t[a],e)<=0?(r=++a,s-=i+1):s=i}return r}cy.default=r5;Object.defineProperty(ly,"__esModule",{value:!0});const s5=cy;class i5{constructor(){this._queue=[]}enqueue(e,n){n=Object.assign({priority:0},n);const r={priority:n.priority,run:e};if(this.size&&this._queue[this.size-1].priority>=n.priority){this._queue.push(r);return}const s=s5.default(this._queue,r,(i,a)=>a.priority-i.priority);this._queue.splice(s,0,r)}dequeue(){const e=this._queue.shift();return e?.run}filter(e){return this._queue.filter(n=>n.priority===e.priority).map(n=>n.run)}get size(){return this._queue.length}}ly.default=i5;Object.defineProperty(AE,"__esModule",{value:!0});const a5=Y8,OE=n5,o5=ly,hc=()=>{},u5=new OE.TimeoutError;class l5 extends a5{constructor(e){var n,r,s,i;if(super(),this._intervalCount=0,this._intervalEnd=0,this._pendingCount=0,this._resolveEmpty=hc,this._resolveIdle=hc,e=Object.assign({carryoverConcurrencyCount:!1,intervalCap:1/0,interval:0,concurrency:1/0,autoStart:!0,queueClass:o5.default},e),!(typeof e.intervalCap=="number"&&e.intervalCap>=1))throw new TypeError(`Expected \`intervalCap\` to be a number from 1 and up, got \`${(r=(n=e.intervalCap)===null||n===void 0?void 0:n.toString())!==null&&r!==void 0?r:""}\` (${typeof e.intervalCap})`);if(e.interval===void 0||!(Number.isFinite(e.interval)&&e.interval>=0))throw new TypeError(`Expected \`interval\` to be a finite number >= 0, got \`${(i=(s=e.interval)===null||s===void 0?void 0:s.toString())!==null&&i!==void 0?i:""}\` (${typeof e.interval})`);this._carryoverConcurrencyCount=e.carryoverConcurrencyCount,this._isIntervalIgnored=e.intervalCap===1/0||e.interval===0,this._intervalCap=e.intervalCap,this._interval=e.interval,this._queue=new e.queueClass,this._queueClass=e.queueClass,this.concurrency=e.concurrency,this._timeout=e.timeout,this._throwOnTimeout=e.throwOnTimeout===!0,this._isPaused=e.autoStart===!1}get _doesIntervalAllowAnother(){return this._isIntervalIgnored||this._intervalCount<this._intervalCap}get _doesConcurrentAllowAnother(){return this._pendingCount<this._concurrency}_next(){this._pendingCount--,this._tryToStartAnother(),this.emit("next")}_resolvePromises(){this._resolveEmpty(),this._resolveEmpty=hc,this._pendingCount===0&&(this._resolveIdle(),this._resolveIdle=hc,this.emit("idle"))}_onResumeInterval(){this._onInterval(),this._initializeIntervalIfNeeded(),this._timeoutId=void 0}_isIntervalPaused(){const e=Date.now();if(this._intervalId===void 0){const n=this._intervalEnd-e;if(n<0)this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0;else return this._timeoutId===void 0&&(this._timeoutId=setTimeout(()=>{this._onResumeInterval()},n)),!0}return!1}_tryToStartAnother(){if(this._queue.size===0)return this._intervalId&&clearInterval(this._intervalId),this._intervalId=void 0,this._resolvePromises(),!1;if(!this._isPaused){const e=!this._isIntervalPaused();if(this._doesIntervalAllowAnother&&this._doesConcurrentAllowAnother){const n=this._queue.dequeue();return n?(this.emit("active"),n(),e&&this._initializeIntervalIfNeeded(),!0):!1}}return!1}_initializeIntervalIfNeeded(){this._isIntervalIgnored||this._intervalId!==void 0||(this._intervalId=setInterval(()=>{this._onInterval()},this._interval),this._intervalEnd=Date.now()+this._interval)}_onInterval(){this._intervalCount===0&&this._pendingCount===0&&this._intervalId&&(clearInterval(this._intervalId),this._intervalId=void 0),this._intervalCount=this._carryoverConcurrencyCount?this._pendingCount:0,this._processQueue()}_processQueue(){for(;this._tryToStartAnother(););}get concurrency(){return this._concurrency}set concurrency(e){if(!(typeof e=="number"&&e>=1))throw new TypeError(`Expected \`concurrency\` to be a number from 1 and up, got \`${e}\` (${typeof e})`);this._concurrency=e,this._processQueue()}async add(e,n={}){return new Promise((r,s)=>{const i=async()=>{this._pendingCount++,this._intervalCount++;try{const a=this._timeout===void 0&&n.timeout===void 0?e():OE.default(Promise.resolve(e()),n.timeout===void 0?this._timeout:n.timeout,()=>{(n.throwOnTimeout===void 0?this._throwOnTimeout:n.throwOnTimeout)&&s(u5)});r(await a)}catch(a){s(a)}this._next()};this._queue.enqueue(i,n),this._tryToStartAnother(),this.emit("add")})}async addAll(e,n){return Promise.all(e.map(async r=>this.add(r,n)))}start(){return this._isPaused?(this._isPaused=!1,this._processQueue(),this):this}pause(){this._isPaused=!0}clear(){this._queue=new this._queueClass}async onEmpty(){if(this._queue.size!==0)return new Promise(e=>{const n=this._resolveEmpty;this._resolveEmpty=()=>{n(),e()}})}async onIdle(){if(!(this._pendingCount===0&&this._queue.size===0))return new Promise(e=>{const n=this._resolveIdle;this._resolveIdle=()=>{n(),e()}})}get size(){return this._queue.size}sizeBy(e){return this._queue.filter(e).length}get pending(){return this._pendingCount}get isPaused(){return this._isPaused}get timeout(){return this._timeout}set timeout(e){this._timeout=e}}var Gr=AE.default=l5;const c5=(...t)=>fetch(...t),d5=Symbol.for("ls:fetch_implementation"),re=()=>globalThis[d5]??c5,f5=[400,401,403,404,405,406,407,408],h5=[409];let v_=class{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedResponseHook",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,"default"in Gr?this.queue=new Gr.default({concurrency:this.maxConcurrency}):this.queue=new Gr({concurrency:this.maxConcurrency}),this.onFailedResponseHook=e?.onFailedResponseHook}call(e,...n){const r=this.onFailedResponseHook;return this.queue.add(()=>Ud(()=>e(...n).catch(s=>{throw s instanceof Error?s:new Error(s)}),{async onFailedAttempt(s){if(s.message.startsWith("Cancel")||s.message.startsWith("TimeoutError")||s.message.startsWith("AbortError")||s?.code==="ECONNABORTED")throw s;const i=s?.response,a=i?.status;if(a){if(f5.includes(+a))throw s;if(h5.includes(+a))return;r&&await r(i)}},retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((s,i)=>{e.signal?.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>re()(...e).then(n=>n.ok?n:Promise.reject(n)))}};function x_(t){return typeof t?._getType=="function"}function S_(t){const e={type:t._getType(),data:{content:t.content}};return t?.additional_kwargs&&Object.keys(t.additional_kwargs).length>0&&(e.data.additional_kwargs={...t.additional_kwargs}),e}function he(t,e){if(!du(t)){const n=e!==void 0?`Invalid UUID for ${e}: ${t}`:`Invalid UUID: ${t}`;throw new Error(n)}return t}const k_={};function NE(t){k_[t]||(console.warn(t),k_[t]=!0)}var ig={exports:{}};const p5="2.0.0",IE=256,m5=Number.MAX_SAFE_INTEGER||9007199254740991,g5=16,y5=IE-6,b5=["major","premajor","minor","preminor","patch","prepatch","prerelease"];var Hf={MAX_LENGTH:IE,MAX_SAFE_COMPONENT_LENGTH:g5,MAX_SAFE_BUILD_LENGTH:y5,MAX_SAFE_INTEGER:m5,RELEASE_TYPES:b5,SEMVER_SPEC_VERSION:p5,FLAG_INCLUDE_PRERELEASE:1,FLAG_LOOSE:2},np={};const w5=typeof process=="object"&&np&&np.NODE_DEBUG&&/\bsemver\b/i.test(np.NODE_DEBUG)?(...t)=>console.error("SEMVER",...t):()=>{};var Vf=w5;(function(t,e){const{MAX_SAFE_COMPONENT_LENGTH:n,MAX_SAFE_BUILD_LENGTH:r,MAX_LENGTH:s}=Hf,i=Vf;e=t.exports={};const a=e.re=[],o=e.safeRe=[],u=e.src=[],l=e.t={};let c=0;const d="[a-zA-Z0-9-]",f=[["\\s",1],["\\d",s],[d,r]],h=y=>{for(const[w,p]of f)y=y.split(`${w}*`).join(`${w}{0,${p}}`).split(`${w}+`).join(`${w}{1,${p}}`);return y},m=(y,w,p)=>{const b=h(w),_=c++;i(y,_,w),l[y]=_,u[_]=w,a[_]=new RegExp(w,p?"g":void 0),o[_]=new RegExp(b,p?"g":void 0)};m("NUMERICIDENTIFIER","0|[1-9]\\d*"),m("NUMERICIDENTIFIERLOOSE","\\d+"),m("NONNUMERICIDENTIFIER",`\\d*[a-zA-Z-]${d}*`),m("MAINVERSION",`(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})\\.(${u[l.NUMERICIDENTIFIER]})`),m("MAINVERSIONLOOSE",`(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})\\.(${u[l.NUMERICIDENTIFIERLOOSE]})`),m("PRERELEASEIDENTIFIER",`(?:${u[l.NUMERICIDENTIFIER]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASEIDENTIFIERLOOSE",`(?:${u[l.NUMERICIDENTIFIERLOOSE]}|${u[l.NONNUMERICIDENTIFIER]})`),m("PRERELEASE",`(?:-(${u[l.PRERELEASEIDENTIFIER]}(?:\\.${u[l.PRERELEASEIDENTIFIER]})*))`),m("PRERELEASELOOSE",`(?:-?(${u[l.PRERELEASEIDENTIFIERLOOSE]}(?:\\.${u[l.PRERELEASEIDENTIFIERLOOSE]})*))`),m("BUILDIDENTIFIER",`${d}+`),m("BUILD",`(?:\\+(${u[l.BUILDIDENTIFIER]}(?:\\.${u[l.BUILDIDENTIFIER]})*))`),m("FULLPLAIN",`v?${u[l.MAINVERSION]}${u[l.PRERELEASE]}?${u[l.BUILD]}?`),m("FULL",`^${u[l.FULLPLAIN]}$`),m("LOOSEPLAIN",`[v=\\s]*${u[l.MAINVERSIONLOOSE]}${u[l.PRERELEASELOOSE]}?${u[l.BUILD]}?`),m("LOOSE",`^${u[l.LOOSEPLAIN]}$`),m("GTLT","((?:<|>)?=?)"),m("XRANGEIDENTIFIERLOOSE",`${u[l.NUMERICIDENTIFIERLOOSE]}|x|X|\\*`),m("XRANGEIDENTIFIER",`${u[l.NUMERICIDENTIFIER]}|x|X|\\*`),m("XRANGEPLAIN",`[v=\\s]*(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:\\.(${u[l.XRANGEIDENTIFIER]})(?:${u[l.PRERELEASE]})?${u[l.BUILD]}?)?)?`),m("XRANGEPLAINLOOSE",`[v=\\s]*(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:\\.(${u[l.XRANGEIDENTIFIERLOOSE]})(?:${u[l.PRERELEASELOOSE]})?${u[l.BUILD]}?)?)?`),m("XRANGE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAIN]}$`),m("XRANGELOOSE",`^${u[l.GTLT]}\\s*${u[l.XRANGEPLAINLOOSE]}$`),m("COERCEPLAIN",`(^|[^\\d])(\\d{1,${n}})(?:\\.(\\d{1,${n}}))?(?:\\.(\\d{1,${n}}))?`),m("COERCE",`${u[l.COERCEPLAIN]}(?:$|[^\\d])`),m("COERCEFULL",u[l.COERCEPLAIN]+`(?:${u[l.PRERELEASE]})?(?:${u[l.BUILD]})?(?:$|[^\\d])`),m("COERCERTL",u[l.COERCE],!0),m("COERCERTLFULL",u[l.COERCEFULL],!0),m("LONETILDE","(?:~>?)"),m("TILDETRIM",`(\\s*)${u[l.LONETILDE]}\\s+`,!0),e.tildeTrimReplace="$1~",m("TILDE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAIN]}$`),m("TILDELOOSE",`^${u[l.LONETILDE]}${u[l.XRANGEPLAINLOOSE]}$`),m("LONECARET","(?:\\^)"),m("CARETTRIM",`(\\s*)${u[l.LONECARET]}\\s+`,!0),e.caretTrimReplace="$1^",m("CARET",`^${u[l.LONECARET]}${u[l.XRANGEPLAIN]}$`),m("CARETLOOSE",`^${u[l.LONECARET]}${u[l.XRANGEPLAINLOOSE]}$`),m("COMPARATORLOOSE",`^${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]})$|^$`),m("COMPARATOR",`^${u[l.GTLT]}\\s*(${u[l.FULLPLAIN]})$|^$`),m("COMPARATORTRIM",`(\\s*)${u[l.GTLT]}\\s*(${u[l.LOOSEPLAIN]}|${u[l.XRANGEPLAIN]})`,!0),e.comparatorTrimReplace="$1$2$3",m("HYPHENRANGE",`^\\s*(${u[l.XRANGEPLAIN]})\\s+-\\s+(${u[l.XRANGEPLAIN]})\\s*$`),m("HYPHENRANGELOOSE",`^\\s*(${u[l.XRANGEPLAINLOOSE]})\\s+-\\s+(${u[l.XRANGEPLAINLOOSE]})\\s*$`),m("STAR","(<|>)?=?\\s*\\*"),m("GTE0","^\\s*>=\\s*0\\.0\\.0\\s*$"),m("GTE0PRE","^\\s*>=\\s*0\\.0\\.0-0\\s*$")})(ig,ig.exports);var xl=ig.exports;const _5=Object.freeze({loose:!0}),v5=Object.freeze({}),x5=t=>t?typeof t!="object"?_5:t:v5;var dy=x5;const E_=/^[0-9]+$/,RE=(t,e)=>{const n=E_.test(t),r=E_.test(e);return n&&r&&(t=+t,e=+e),t===e?0:n&&!r?-1:r&&!n?1:t<e?-1:1},S5=(t,e)=>RE(e,t);var jE={compareIdentifiers:RE,rcompareIdentifiers:S5};const pc=Vf,{MAX_LENGTH:A_,MAX_SAFE_INTEGER:mc}=Hf,{safeRe:T_,t:C_}=xl,k5=dy,{compareIdentifiers:Hi}=jE;let E5=class lr{constructor(e,n){if(n=k5(n),e instanceof lr){if(e.loose===!!n.loose&&e.includePrerelease===!!n.includePrerelease)return e;e=e.version}else if(typeof e!="string")throw new TypeError(`Invalid version. Must be a string. Got type "${typeof e}".`);if(e.length>A_)throw new TypeError(`version is longer than ${A_} characters`);pc("SemVer",e,n),this.options=n,this.loose=!!n.loose,this.includePrerelease=!!n.includePrerelease;const r=e.trim().match(n.loose?T_[C_.LOOSE]:T_[C_.FULL]);if(!r)throw new TypeError(`Invalid Version: ${e}`);if(this.raw=e,this.major=+r[1],this.minor=+r[2],this.patch=+r[3],this.major>mc||this.major<0)throw new TypeError("Invalid major version");if(this.minor>mc||this.minor<0)throw new TypeError("Invalid minor version");if(this.patch>mc||this.patch<0)throw new TypeError("Invalid patch version");r[4]?this.prerelease=r[4].split(".").map(s=>{if(/^[0-9]+$/.test(s)){const i=+s;if(i>=0&&i<mc)return i}return s}):this.prerelease=[],this.build=r[5]?r[5].split("."):[],this.format()}format(){return this.version=`${this.major}.${this.minor}.${this.patch}`,this.prerelease.length&&(this.version+=`-${this.prerelease.join(".")}`),this.version}toString(){return this.version}compare(e){if(pc("SemVer.compare",this.version,this.options,e),!(e instanceof lr)){if(typeof e=="string"&&e===this.version)return 0;e=new lr(e,this.options)}return e.version===this.version?0:this.compareMain(e)||this.comparePre(e)}compareMain(e){return e instanceof lr||(e=new lr(e,this.options)),Hi(this.major,e.major)||Hi(this.minor,e.minor)||Hi(this.patch,e.patch)}comparePre(e){if(e instanceof lr||(e=new lr(e,this.options)),this.prerelease.length&&!e.prerelease.length)return-1;if(!this.prerelease.length&&e.prerelease.length)return 1;if(!this.prerelease.length&&!e.prerelease.length)return 0;let n=0;do{const r=this.prerelease[n],s=e.prerelease[n];if(pc("prerelease compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return Hi(r,s)}while(++n)}compareBuild(e){e instanceof lr||(e=new lr(e,this.options));let n=0;do{const r=this.build[n],s=e.build[n];if(pc("build compare",n,r,s),r===void 0&&s===void 0)return 0;if(s===void 0)return 1;if(r===void 0)return-1;if(r===s)continue;return Hi(r,s)}while(++n)}inc(e,n,r){switch(e){case"premajor":this.prerelease.length=0,this.patch=0,this.minor=0,this.major++,this.inc("pre",n,r);break;case"preminor":this.prerelease.length=0,this.patch=0,this.minor++,this.inc("pre",n,r);break;case"prepatch":this.prerelease.length=0,this.inc("patch",n,r),this.inc("pre",n,r);break;case"prerelease":this.prerelease.length===0&&this.inc("patch",n,r),this.inc("pre",n,r);break;case"major":(this.minor!==0||this.patch!==0||this.prerelease.length===0)&&this.major++,this.minor=0,this.patch=0,this.prerelease=[];break;case"minor":(this.patch!==0||this.prerelease.length===0)&&this.minor++,this.patch=0,this.prerelease=[];break;case"patch":this.prerelease.length===0&&this.patch++,this.prerelease=[];break;case"pre":{const s=Number(r)?1:0;if(!n&&r===!1)throw new Error("invalid increment argument: identifier is empty");if(this.prerelease.length===0)this.prerelease=[s];else{let i=this.prerelease.length;for(;--i>=0;)typeof this.prerelease[i]=="number"&&(this.prerelease[i]++,i=-2);if(i===-1){if(n===this.prerelease.join(".")&&r===!1)throw new Error("invalid increment argument: identifier already exists");this.prerelease.push(s)}}if(n){let i=[n,s];r===!1&&(i=[n]),Hi(this.prerelease[0],n)===0?isNaN(this.prerelease[1])&&(this.prerelease=i):this.prerelease=i}break}default:throw new Error(`invalid increment argument: ${e}`)}return this.raw=this.format(),this.build.length&&(this.raw+=`+${this.build.join(".")}`),this}};var zt=E5;const P_=zt,A5=(t,e,n=!1)=>{if(t instanceof P_)return t;try{return new P_(t,e)}catch(r){if(!n)return null;throw r}};var ho=A5;const T5=ho,C5=(t,e)=>{const n=T5(t,e);return n?n.version:null};var P5=C5;const O5=ho,N5=(t,e)=>{const n=O5(t.trim().replace(/^[=v]+/,""),e);return n?n.version:null};var I5=N5;const O_=zt,R5=(t,e,n,r,s)=>{typeof n=="string"&&(s=r,r=n,n=void 0);try{return new O_(t instanceof O_?t.version:t,n).inc(e,r,s).version}catch{return null}};var j5=R5;const N_=ho,$5=(t,e)=>{const n=N_(t,null,!0),r=N_(e,null,!0),s=n.compare(r);if(s===0)return null;const i=s>0,a=i?n:r,o=i?r:n,u=!!a.prerelease.length;if(!!o.prerelease.length&&!u)return!o.patch&&!o.minor?"major":a.patch?"patch":a.minor?"minor":"major";const c=u?"pre":"";return n.major!==r.major?c+"major":n.minor!==r.minor?c+"minor":n.patch!==r.patch?c+"patch":"prerelease"};var L5=$5;const M5=zt,D5=(t,e)=>new M5(t,e).major;var F5=D5;const B5=zt,U5=(t,e)=>new B5(t,e).minor;var z5=U5;const q5=zt,H5=(t,e)=>new q5(t,e).patch;var V5=H5;const W5=ho,G5=(t,e)=>{const n=W5(t,e);return n&&n.prerelease.length?n.prerelease:null};var Z5=G5;const I_=zt,J5=(t,e,n)=>new I_(t,n).compare(new I_(e,n));var sr=J5;const K5=sr,Q5=(t,e,n)=>K5(e,t,n);var X5=Q5;const Y5=sr,e9=(t,e)=>Y5(t,e,!0);var t9=e9;const R_=zt,n9=(t,e,n)=>{const r=new R_(t,n),s=new R_(e,n);return r.compare(s)||r.compareBuild(s)};var fy=n9;const r9=fy,s9=(t,e)=>t.sort((n,r)=>r9(n,r,e));var i9=s9;const a9=fy,o9=(t,e)=>t.sort((n,r)=>a9(r,n,e));var u9=o9;const l9=sr,c9=(t,e,n)=>l9(t,e,n)>0;var Wf=c9;const d9=sr,f9=(t,e,n)=>d9(t,e,n)<0;var hy=f9;const h9=sr,p9=(t,e,n)=>h9(t,e,n)===0;var $E=p9;const m9=sr,g9=(t,e,n)=>m9(t,e,n)!==0;var LE=g9;const y9=sr,b9=(t,e,n)=>y9(t,e,n)>=0;var py=b9;const w9=sr,_9=(t,e,n)=>w9(t,e,n)<=0;var my=_9;const v9=$E,x9=LE,S9=Wf,k9=py,E9=hy,A9=my,T9=(t,e,n,r)=>{switch(e){case"===":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t===n;case"!==":return typeof t=="object"&&(t=t.version),typeof n=="object"&&(n=n.version),t!==n;case"":case"=":case"==":return v9(t,n,r);case"!=":return x9(t,n,r);case">":return S9(t,n,r);case">=":return k9(t,n,r);case"<":return E9(t,n,r);case"<=":return A9(t,n,r);default:throw new TypeError(`Invalid operator: ${e}`)}};var ME=T9;const C9=zt,P9=ho,{safeRe:gc,t:yc}=xl,O9=(t,e)=>{if(t instanceof C9)return t;if(typeof t=="number"&&(t=String(t)),typeof t!="string")return null;e=e||{};let n=null;if(!e.rtl)n=t.match(e.includePrerelease?gc[yc.COERCEFULL]:gc[yc.COERCE]);else{const u=e.includePrerelease?gc[yc.COERCERTLFULL]:gc[yc.COERCERTL];let l;for(;(l=u.exec(t))&&(!n||n.index+n[0].length!==t.length);)(!n||l.index+l[0].length!==n.index+n[0].length)&&(n=l),u.lastIndex=l.index+l[1].length+l[2].length;u.lastIndex=-1}if(n===null)return null;const r=n[2],s=n[3]||"0",i=n[4]||"0",a=e.includePrerelease&&n[5]?`-${n[5]}`:"",o=e.includePrerelease&&n[6]?`+${n[6]}`:"";return P9(`${r}.${s}.${i}${a}${o}`,e)};var N9=O9;class I9{constructor(){this.max=1e3,this.map=new Map}get(e){const n=this.map.get(e);if(n!==void 0)return this.map.delete(e),this.map.set(e,n),n}delete(e){return this.map.delete(e)}set(e,n){if(!this.delete(e)&&n!==void 0){if(this.map.size>=this.max){const s=this.map.keys().next().value;this.delete(s)}this.map.set(e,n)}return this}}var R9=I9,rp,j_;function ir(){if(j_)return rp;j_=1;const t=/\s+/g;class e{constructor(I,L){if(L=s(L),I instanceof e)return I.loose===!!L.loose&&I.includePrerelease===!!L.includePrerelease?I:new e(I.raw,L);if(I instanceof i)return this.raw=I.value,this.set=[[I]],this.formatted=void 0,this;if(this.options=L,this.loose=!!L.loose,this.includePrerelease=!!L.includePrerelease,this.raw=I.trim().replace(t," "),this.set=this.raw.split("||").map(F=>this.parseRange(F.trim())).filter(F=>F.length),!this.set.length)throw new TypeError(`Invalid SemVer Range: ${this.raw}`);if(this.set.length>1){const F=this.set[0];if(this.set=this.set.filter(A=>!y(A[0])),this.set.length===0)this.set=[F];else if(this.set.length>1){for(const A of this.set)if(A.length===1&&w(A[0])){this.set=[A];break}}}this.formatted=void 0}get range(){if(this.formatted===void 0){this.formatted="";for(let I=0;I<this.set.length;I++){I>0&&(this.formatted+="||");const L=this.set[I];for(let F=0;F<L.length;F++)F>0&&(this.formatted+=" "),this.formatted+=L[F].toString().trim()}}return this.formatted}format(){return this.range}toString(){return this.range}parseRange(I){const F=((this.options.includePrerelease&&h)|(this.options.loose&&m))+":"+I,A=r.get(F);if(A)return A;const C=this.options.loose,M=C?u[l.HYPHENRANGELOOSE]:u[l.HYPHENRANGE];I=I.replace(M,q(this.options.includePrerelease)),a("hyphen replace",I),I=I.replace(u[l.COMPARATORTRIM],c),a("comparator trim",I),I=I.replace(u[l.TILDETRIM],d),a("tilde trim",I),I=I.replace(u[l.CARETTRIM],f),a("caret trim",I);let W=I.split(" ").map(me=>b(me,this.options)).join(" ").split(/\s+/).map(me=>H(me,this.options));C&&(W=W.filter(me=>(a("loose invalid filter",me,this.options),!!me.match(u[l.COMPARATORLOOSE])))),a("range list",W);const J=new Map,fe=W.map(me=>new i(me,this.options));for(const me of fe){if(y(me))return[me];J.set(me.value,me)}J.size>1&&J.has("")&&J.delete("");const pe=[...J.values()];return r.set(F,pe),pe}intersects(I,L){if(!(I instanceof e))throw new TypeError("a Range is required");return this.set.some(F=>p(F,L)&&I.set.some(A=>p(A,L)&&F.every(C=>A.every(M=>C.intersects(M,L)))))}test(I){if(!I)return!1;if(typeof I=="string")try{I=new o(I,this.options)}catch{return!1}for(let L=0;L<this.set.length;L++)if(X(this.set[L],I,this.options))return!0;return!1}}rp=e;const n=R9,r=new n,s=dy,i=Gf(),a=Vf,o=zt,{safeRe:u,t:l,comparatorTrimReplace:c,tildeTrimReplace:d,caretTrimReplace:f}=xl,{FLAG_INCLUDE_PRERELEASE:h,FLAG_LOOSE:m}=Hf,y=O=>O.value==="<0.0.0-0",w=O=>O.value==="",p=(O,I)=>{let L=!0;const F=O.slice();let A=F.pop();for(;L&&F.length;)L=F.every(C=>A.intersects(C,I)),A=F.pop();return L},b=(O,I)=>(a("comp",O,I),O=E(O,I),a("caret",O),O=x(O,I),a("tildes",O),O=T(O,I),a("xrange",O),O=j(O,I),a("stars",O),O),_=O=>!O||O.toLowerCase()==="x"||O==="*",x=(O,I)=>O.trim().split(/\s+/).map(L=>S(L,I)).join(" "),S=(O,I)=>{const L=I.loose?u[l.TILDELOOSE]:u[l.TILDE];return O.replace(L,(F,A,C,M,W)=>{a("tilde",O,F,A,C,M,W);let J;return _(A)?J="":_(C)?J=`>=${A}.0.0 <${+A+1}.0.0-0`:_(M)?J=`>=${A}.${C}.0 <${A}.${+C+1}.0-0`:W?(a("replaceTilde pr",W),J=`>=${A}.${C}.${M}-${W} <${A}.${+C+1}.0-0`):J=`>=${A}.${C}.${M} <${A}.${+C+1}.0-0`,a("tilde return",J),J})},E=(O,I)=>O.trim().split(/\s+/).map(L=>k(L,I)).join(" "),k=(O,I)=>{a("caret",O,I);const L=I.loose?u[l.CARETLOOSE]:u[l.CARET],F=I.includePrerelease?"-0":"";return O.replace(L,(A,C,M,W,J)=>{a("caret",O,A,C,M,W,J);let fe;return _(C)?fe="":_(M)?fe=`>=${C}.0.0${F} <${+C+1}.0.0-0`:_(W)?C==="0"?fe=`>=${C}.${M}.0${F} <${C}.${+M+1}.0-0`:fe=`>=${C}.${M}.0${F} <${+C+1}.0.0-0`:J?(a("replaceCaret pr",J),C==="0"?M==="0"?fe=`>=${C}.${M}.${W}-${J} <${C}.${M}.${+W+1}-0`:fe=`>=${C}.${M}.${W}-${J} <${C}.${+M+1}.0-0`:fe=`>=${C}.${M}.${W}-${J} <${+C+1}.0.0-0`):(a("no pr"),C==="0"?M==="0"?fe=`>=${C}.${M}.${W}${F} <${C}.${M}.${+W+1}-0`:fe=`>=${C}.${M}.${W}${F} <${C}.${+M+1}.0-0`:fe=`>=${C}.${M}.${W} <${+C+1}.0.0-0`),a("caret return",fe),fe})},T=(O,I)=>(a("replaceXRanges",O,I),O.split(/\s+/).map(L=>$(L,I)).join(" ")),$=(O,I)=>{O=O.trim();const L=I.loose?u[l.XRANGELOOSE]:u[l.XRANGE];return O.replace(L,(F,A,C,M,W,J)=>{a("xRange",O,F,A,C,M,W,J);const fe=_(C),pe=fe||_(M),me=pe||_(W),De=me;return A==="="&&De&&(A=""),J=I.includePrerelease?"-0":"",fe?A===">"||A==="<"?F="<0.0.0-0":F="*":A&&De?(pe&&(M=0),W=0,A===">"?(A=">=",pe?(C=+C+1,M=0,W=0):(M=+M+1,W=0)):A==="<="&&(A="<",pe?C=+C+1:M=+M+1),A==="<"&&(J="-0"),F=`${A+C}.${M}.${W}${J}`):pe?F=`>=${C}.0.0${J} <${+C+1}.0.0-0`:me&&(F=`>=${C}.${M}.0${J} <${C}.${+M+1}.0-0`),a("xRange return",F),F})},j=(O,I)=>(a("replaceStars",O,I),O.trim().replace(u[l.STAR],"")),H=(O,I)=>(a("replaceGTE0",O,I),O.trim().replace(u[I.includePrerelease?l.GTE0PRE:l.GTE0],"")),q=O=>(I,L,F,A,C,M,W,J,fe,pe,me,De)=>(_(F)?L="":_(A)?L=`>=${F}.0.0${O?"-0":""}`:_(C)?L=`>=${F}.${A}.0${O?"-0":""}`:M?L=`>=${L}`:L=`>=${L}${O?"-0":""}`,_(fe)?J="":_(pe)?J=`<${+fe+1}.0.0-0`:_(me)?J=`<${fe}.${+pe+1}.0-0`:De?J=`<=${fe}.${pe}.${me}-${De}`:O?J=`<${fe}.${pe}.${+me+1}-0`:J=`<=${J}`,`${L} ${J}`.trim()),X=(O,I,L)=>{for(let F=0;F<O.length;F++)if(!O[F].test(I))return!1;if(I.prerelease.length&&!L.includePrerelease){for(let F=0;F<O.length;F++)if(a(O[F].semver),O[F].semver!==i.ANY&&O[F].semver.prerelease.length>0){const A=O[F].semver;if(A.major===I.major&&A.minor===I.minor&&A.patch===I.patch)return!0}return!1}return!0};return rp}var sp,$_;function Gf(){if($_)return sp;$_=1;const t=Symbol("SemVer ANY");class e{static get ANY(){return t}constructor(c,d){if(d=n(d),c instanceof e){if(c.loose===!!d.loose)return c;c=c.value}c=c.trim().split(/\s+/).join(" "),a("comparator",c,d),this.options=d,this.loose=!!d.loose,this.parse(c),this.semver===t?this.value="":this.value=this.operator+this.semver.version,a("comp",this)}parse(c){const d=this.options.loose?r[s.COMPARATORLOOSE]:r[s.COMPARATOR],f=c.match(d);if(!f)throw new TypeError(`Invalid comparator: ${c}`);this.operator=f[1]!==void 0?f[1]:"",this.operator==="="&&(this.operator=""),f[2]?this.semver=new o(f[2],this.options.loose):this.semver=t}toString(){return this.value}test(c){if(a("Comparator.test",c,this.options.loose),this.semver===t||c===t)return!0;if(typeof c=="string")try{c=new o(c,this.options)}catch{return!1}return i(c,this.operator,this.semver,this.options)}intersects(c,d){if(!(c instanceof e))throw new TypeError("a Comparator is required");return this.operator===""?this.value===""?!0:new u(c.value,d).test(this.value):c.operator===""?c.value===""?!0:new u(this.value,d).test(c.semver):(d=n(d),d.includePrerelease&&(this.value==="<0.0.0-0"||c.value==="<0.0.0-0")||!d.includePrerelease&&(this.value.startsWith("<0.0.0")||c.value.startsWith("<0.0.0"))?!1:!!(this.operator.startsWith(">")&&c.operator.startsWith(">")||this.operator.startsWith("<")&&c.operator.startsWith("<")||this.semver.version===c.semver.version&&this.operator.includes("=")&&c.operator.includes("=")||i(this.semver,"<",c.semver,d)&&this.operator.startsWith(">")&&c.operator.startsWith("<")||i(this.semver,">",c.semver,d)&&this.operator.startsWith("<")&&c.operator.startsWith(">")))}}sp=e;const n=dy,{safeRe:r,t:s}=xl,i=ME,a=Vf,o=zt,u=ir();return sp}const j9=ir(),$9=(t,e,n)=>{try{e=new j9(e,n)}catch{return!1}return e.test(t)};var Zf=$9;const L9=ir(),M9=(t,e)=>new L9(t,e).set.map(n=>n.map(r=>r.value).join(" ").trim().split(" "));var D9=M9;const F9=zt,B9=ir(),U9=(t,e,n)=>{let r=null,s=null,i=null;try{i=new B9(e,n)}catch{return null}return t.forEach(a=>{i.test(a)&&(!r||s.compare(a)===-1)&&(r=a,s=new F9(r,n))}),r};var z9=U9;const q9=zt,H9=ir(),V9=(t,e,n)=>{let r=null,s=null,i=null;try{i=new H9(e,n)}catch{return null}return t.forEach(a=>{i.test(a)&&(!r||s.compare(a)===1)&&(r=a,s=new q9(r,n))}),r};var W9=V9;const ip=zt,G9=ir(),L_=Wf,Z9=(t,e)=>{t=new G9(t,e);let n=new ip("0.0.0");if(t.test(n)||(n=new ip("0.0.0-0"),t.test(n)))return n;n=null;for(let r=0;r<t.set.length;++r){const s=t.set[r];let i=null;s.forEach(a=>{const o=new ip(a.semver.version);switch(a.operator){case">":o.prerelease.length===0?o.patch++:o.prerelease.push(0),o.raw=o.format();case"":case">=":(!i||L_(o,i))&&(i=o);break;case"<":case"<=":break;default:throw new Error(`Unexpected operation: ${a.operator}`)}}),i&&(!n||L_(n,i))&&(n=i)}return n&&t.test(n)?n:null};var J9=Z9;const K9=ir(),Q9=(t,e)=>{try{return new K9(t,e).range||"*"}catch{return null}};var X9=Q9;const Y9=zt,DE=Gf(),{ANY:eM}=DE,tM=ir(),nM=Zf,M_=Wf,D_=hy,rM=my,sM=py,iM=(t,e,n,r)=>{t=new Y9(t,r),e=new tM(e,r);let s,i,a,o,u;switch(n){case">":s=M_,i=rM,a=D_,o=">",u=">=";break;case"<":s=D_,i=sM,a=M_,o="<",u="<=";break;default:throw new TypeError('Must provide a hilo val of "<" or ">"')}if(nM(t,e,r))return!1;for(let l=0;l<e.set.length;++l){const c=e.set[l];let d=null,f=null;if(c.forEach(h=>{h.semver===eM&&(h=new DE(">=0.0.0")),d=d||h,f=f||h,s(h.semver,d.semver,r)?d=h:a(h.semver,f.semver,r)&&(f=h)}),d.operator===o||d.operator===u||(!f.operator||f.operator===o)&&i(t,f.semver))return!1;if(f.operator===u&&a(t,f.semver))return!1}return!0};var gy=iM;const aM=gy,oM=(t,e,n)=>aM(t,e,">",n);var uM=oM;const lM=gy,cM=(t,e,n)=>lM(t,e,"<",n);var dM=cM;const F_=ir(),fM=(t,e,n)=>(t=new F_(t,n),e=new F_(e,n),t.intersects(e,n));var hM=fM;const pM=Zf,mM=sr;var gM=(t,e,n)=>{const r=[];let s=null,i=null;const a=t.sort((c,d)=>mM(c,d,n));for(const c of a)pM(c,e,n)?(i=c,s||(s=c)):(i&&r.push([s,i]),i=null,s=null);s&&r.push([s,null]);const o=[];for(const[c,d]of r)c===d?o.push(c):!d&&c===a[0]?o.push("*"):d?c===a[0]?o.push(`<=${d}`):o.push(`${c} - ${d}`):o.push(`>=${c}`);const u=o.join(" || "),l=typeof e.raw=="string"?e.raw:String(e);return u.length<l.length?u:e};const B_=ir(),yy=Gf(),{ANY:ap}=yy,Do=Zf,by=sr,yM=(t,e,n={})=>{if(t===e)return!0;t=new B_(t,n),e=new B_(e,n);let r=!1;e:for(const s of t.set){for(const i of e.set){const a=wM(s,i,n);if(r=r||a!==null,a)continue e}if(r)return!1}return!0},bM=[new yy(">=0.0.0-0")],U_=[new yy(">=0.0.0")],wM=(t,e,n)=>{if(t===e)return!0;if(t.length===1&&t[0].semver===ap){if(e.length===1&&e[0].semver===ap)return!0;n.includePrerelease?t=bM:t=U_}if(e.length===1&&e[0].semver===ap){if(n.includePrerelease)return!0;e=U_}const r=new Set;let s,i;for(const h of t)h.operator===">"||h.operator===">="?s=z_(s,h,n):h.operator==="<"||h.operator==="<="?i=q_(i,h,n):r.add(h.semver);if(r.size>1)return null;let a;if(s&&i){if(a=by(s.semver,i.semver,n),a>0)return null;if(a===0&&(s.operator!==">="||i.operator!=="<="))return null}for(const h of r){if(s&&!Do(h,String(s),n)||i&&!Do(h,String(i),n))return null;for(const m of e)if(!Do(h,String(m),n))return!1;return!0}let o,u,l,c,d=i&&!n.includePrerelease&&i.semver.prerelease.length?i.semver:!1,f=s&&!n.includePrerelease&&s.semver.prerelease.length?s.semver:!1;d&&d.prerelease.length===1&&i.operator==="<"&&d.prerelease[0]===0&&(d=!1);for(const h of e){if(c=c||h.operator===">"||h.operator===">=",l=l||h.operator==="<"||h.operator==="<=",s){if(f&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===f.major&&h.semver.minor===f.minor&&h.semver.patch===f.patch&&(f=!1),h.operator===">"||h.operator===">="){if(o=z_(s,h,n),o===h&&o!==s)return!1}else if(s.operator===">="&&!Do(s.semver,String(h),n))return!1}if(i){if(d&&h.semver.prerelease&&h.semver.prerelease.length&&h.semver.major===d.major&&h.semver.minor===d.minor&&h.semver.patch===d.patch&&(d=!1),h.operator==="<"||h.operator==="<="){if(u=q_(i,h,n),u===h&&u!==i)return!1}else if(i.operator==="<="&&!Do(i.semver,String(h),n))return!1}if(!h.operator&&(i||s)&&a!==0)return!1}return!(s&&l&&!i&&a!==0||i&&c&&!s&&a!==0||f||d)},z_=(t,e,n)=>{if(!t)return e;const r=by(t.semver,e.semver,n);return r>0?t:r<0||e.operator===">"&&t.operator===">="?e:t},q_=(t,e,n)=>{if(!t)return e;const r=by(t.semver,e.semver,n);return r<0?t:r>0||e.operator==="<"&&t.operator==="<="?e:t};var _M=yM;const op=xl,H_=Hf,vM=zt,V_=jE,xM=ho,SM=P5,kM=I5,EM=j5,AM=L5,TM=F5,CM=z5,PM=V5,OM=Z5,NM=sr,IM=X5,RM=t9,jM=fy,$M=i9,LM=u9,MM=Wf,DM=hy,FM=$E,BM=LE,UM=py,zM=my,qM=ME,HM=N9,VM=Gf(),WM=ir(),GM=Zf,ZM=D9,JM=z9,KM=W9,QM=J9,XM=X9,YM=gy,eD=uM,tD=dM,nD=hM,rD=gM,sD=_M;op.re,op.src,op.t,H_.SEMVER_SPEC_VERSION,H_.RELEASE_TYPES,V_.compareIdentifiers,V_.rcompareIdentifiers;function as(t){if(!t||t.split("/").length>2||t.startsWith("/")||t.endsWith("/")||t.split(":").length>2)throw new Error(`Invalid identifier format: ${t}`);const[e,n]=t.split(":"),r=n||"latest";if(e.includes("/")){const[s,i]=e.split("/",2);if(!s||!i)throw new Error(`Invalid identifier format: ${t}`);return[s,i,r]}else{if(!e)throw new Error(`Invalid identifier format: ${t}`);return["-",e,r]}}class iD extends Error{constructor(e){super(e),this.name="LangSmithConflictError"}}async function ue(t,e,n){let r;if(t.ok){n&&(r=await t.text());return}r=await t.text();const s=`Failed to ${e}. Received status [${t.status}]: ${t.statusText}. Server response: ${r}`;throw t.status===409?new iD(s):new Error(s)}var W_="[...]",aD={result:"[Circular]"},zd=[],ha=[];function oD(){return{depthLimit:Number.MAX_SAFE_INTEGER,edgesLimit:Number.MAX_SAFE_INTEGER}}function sn(t,e,n,r){try{return JSON.stringify(t,e,n)}catch(a){if(!a.message?.includes("Converting circular structure to JSON"))return console.warn("[WARNING]: LangSmith received unserializable value."),"[Unserializable]";console.warn("[WARNING]: LangSmith received circular JSON. This will decrease tracer performance."),typeof r>"u"&&(r=oD()),ag(t,"",0,[],void 0,0,r);var s;try{ha.length===0?s=JSON.stringify(t,e,n):s=JSON.stringify(t,uD(e),n)}catch{return JSON.stringify("[unable to serialize, circular reference is too complex to analyze]")}finally{for(;zd.length!==0;){var i=zd.pop();i.length===4?Object.defineProperty(i[0],i[1],i[3]):i[0][i[1]]=i[2]}}return s}}function up(t,e,n,r){var s=Object.getOwnPropertyDescriptor(r,n);s.get!==void 0?s.configurable?(Object.defineProperty(r,n,{value:t}),zd.push([r,n,e,s])):ha.push([e,n,t]):(r[n]=t,zd.push([r,n,e]))}function ag(t,e,n,r,s,i,a){i+=1;var o;if(typeof t=="object"&&t!==null){for(o=0;o<r.length;o++)if(r[o]===t){up(aD,t,e,s);return}if(typeof a.depthLimit<"u"&&i>a.depthLimit){up(W_,t,e,s);return}if(typeof a.edgesLimit<"u"&&n+1>a.edgesLimit){up(W_,t,e,s);return}if(r.push(t),Array.isArray(t))for(o=0;o<t.length;o++)ag(t[o],o,o,r,t,i,a);else{var u=Object.keys(t);for(o=0;o<u.length;o++){var l=u[o];ag(t[l],l,o,r,t,i,a)}}r.pop()}}function uD(t){return t=typeof t<"u"?t:function(e,n){return n},function(e,n){if(ha.length>0)for(var r=0;r<ha.length;r++){var s=ha[r];if(s[1]===e&&s[0]===n){n=s[2],ha.splice(r,1);break}}return t.call(this,e,n)}}function G_(t){const e=UE(),n=vD(),r=t.extra??{},s=r.metadata;return t.extra={...r,runtime:{...e,...r?.runtime},metadata:{...n,...n.revision_id||t.revision_id?{revision_id:t.revision_id??n.revision_id}:{},...s}},t}const lD=()=>{const t=si("TRACING_SAMPLING_RATE");if(t===void 0)return;const e=parseFloat(t);if(e<0||e>1)throw new Error(`LANGSMITH_TRACING_SAMPLING_RATE must be between 0 and 1 if set. Got: ${e}`);return e},cD=t=>{const n=t.replace("http://","").replace("https://","").split("/")[0].split(":")[0];return n==="localhost"||n==="127.0.0.1"||n==="::1"};async function dD(t){const e=[];for await(const n of t)e.push(n);return e}function lp(t){if(t!==void 0)return t.trim().replace(/^"(.*)"$/,"$1").replace(/^'(.*)'$/,"$1")}const fD=async t=>{if(t?.status===429){const e=parseInt(t.headers.get("retry-after")??"30",10)*1e3;if(e>0)return await new Promise(n=>setTimeout(n,e)),!0}return!1};class hD{constructor(){Object.defineProperty(this,"items",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"sizeBytes",{enumerable:!0,configurable:!0,writable:!0,value:0})}peek(){return this.items[0]}push(e){let n;const r=new Promise(i=>{n=i}),s=sn(e.item).length;return this.items.push({action:e.action,payload:e.item,itemPromiseResolve:n,itemPromise:r,size:s}),this.sizeBytes+=s,r}pop(e){if(e<1)throw new Error("Number of bytes to pop off may not be less than 1.");const n=[];let r=0;for(;r+(this.peek()?.size??0)<e&&this.items.length>0;){const s=this.items.shift();s&&(n.push(s),r+=s.size,this.sizeBytes-=s.size)}if(n.length===0&&this.items.length>0){const s=this.items.shift();n.push(s),r+=s.size,this.sizeBytes-=s.size}return[n.map(s=>({action:s.action,item:s.payload})),()=>n.forEach(s=>s.itemPromiseResolve())]}}const pD=20971520,mD=2500;class Yu{constructor(e={}){Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"webUrl",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"batchIngestCaller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout_ms",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_tenantId",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(this,"hideInputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"hideOutputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingSampleRate",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filteredPostUuids",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(this,"autoBatchTracing",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"autoBatchQueue",{enumerable:!0,configurable:!0,writable:!0,value:new hD}),Object.defineProperty(this,"autoBatchTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"autoBatchAggregationDelayMs",{enumerable:!0,configurable:!0,writable:!0,value:250}),Object.defineProperty(this,"batchSizeBytesLimit",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fetchOptions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"settings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"blockOnRootRunFinalization",{enumerable:!0,configurable:!0,writable:!0,value:xs("LANGSMITH_TRACING_BACKGROUND")==="false"}),Object.defineProperty(this,"traceBatchConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:5}),Object.defineProperty(this,"_serverInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_getServerInfoPromise",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"manualFlushMode",{enumerable:!0,configurable:!0,writable:!0,value:!1});const n=Yu.getDefaultClientConfig();if(this.tracingSampleRate=lD(),this.apiUrl=lp(e.apiUrl??n.apiUrl)??"",this.apiUrl.endsWith("/")&&(this.apiUrl=this.apiUrl.slice(0,-1)),this.apiKey=lp(e.apiKey??n.apiKey),this.webUrl=lp(e.webUrl??n.webUrl),this.webUrl?.endsWith("/")&&(this.webUrl=this.webUrl.slice(0,-1)),this.timeout_ms=e.timeout_ms??9e4,this.caller=new v_(e.callerOptions??{}),this.traceBatchConcurrency=e.traceBatchConcurrency??this.traceBatchConcurrency,this.traceBatchConcurrency<1)throw new Error("Trace batch concurrency must be positive.");this.batchIngestCaller=new v_({maxRetries:2,maxConcurrency:this.traceBatchConcurrency,...e.callerOptions??{},onFailedResponseHook:fD}),this.hideInputs=e.hideInputs??e.anonymizer??n.hideInputs,this.hideOutputs=e.hideOutputs??e.anonymizer??n.hideOutputs,this.autoBatchTracing=e.autoBatchTracing??this.autoBatchTracing,this.blockOnRootRunFinalization=e.blockOnRootRunFinalization??this.blockOnRootRunFinalization,this.batchSizeBytesLimit=e.batchSizeBytesLimit,this.fetchOptions=e.fetchOptions||{},this.manualFlushMode=e.manualFlushMode??this.manualFlushMode}static getDefaultClientConfig(){const e=si("API_KEY"),n=si("ENDPOINT")??"https://api.smith.langchain.com",r=si("HIDE_INPUTS")==="true",s=si("HIDE_OUTPUTS")==="true";return{apiUrl:n,apiKey:e,webUrl:void 0,hideInputs:r,hideOutputs:s}}getHostUrl(){return this.webUrl?this.webUrl:cD(this.apiUrl)?(this.webUrl="http://localhost:3000",this.webUrl):this.apiUrl.includes("/api")&&!this.apiUrl.split(".",1)[0].endsWith("api")?(this.webUrl=this.apiUrl.replace("/api",""),this.webUrl):this.apiUrl.split(".",1)[0].includes("dev")?(this.webUrl="https://dev.smith.langchain.com",this.webUrl):this.apiUrl.split(".",1)[0].includes("eu")?(this.webUrl="https://eu.smith.langchain.com",this.webUrl):(this.webUrl="https://smith.langchain.com",this.webUrl)}get headers(){const e={"User-Agent":`langsmith-js/${FE}`};return this.apiKey&&(e["x-api-key"]=`${this.apiKey}`),e}processInputs(e){return this.hideInputs===!1?e:this.hideInputs===!0?{}:typeof this.hideInputs=="function"?this.hideInputs(e):e}processOutputs(e){return this.hideOutputs===!1?e:this.hideOutputs===!0?{}:typeof this.hideOutputs=="function"?this.hideOutputs(e):e}prepareRunCreateOrUpdateInputs(e){const n={...e};return n.inputs!==void 0&&(n.inputs=this.processInputs(n.inputs)),n.outputs!==void 0&&(n.outputs=this.processOutputs(n.outputs)),n}async _getResponse(e,n){const r=n?.toString()??"",s=`${this.apiUrl}${e}?${r}`,i=await this.caller.call(re(),s,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(i,`Failed to fetch ${e}`),i}async _get(e,n){return(await this._getResponse(e,n)).json()}async*_getPaginated(e,n=new URLSearchParams,r){let s=Number(n.get("offset"))||0;const i=Number(n.get("limit"))||100;for(;;){n.set("offset",String(s)),n.set("limit",String(i));const a=`${this.apiUrl}${e}?${n}`,o=await this.caller.call(re(),a,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(o,`Failed to fetch ${e}`);const u=r?r(await o.json()):await o.json();if(u.length===0||(yield u,u.length<i))break;s+=u.length}}async*_getCursorPaginatedList(e,n=null,r="POST",s="runs"){const i=n?{...n}:{};for(;;){const o=await(await this.caller.call(re(),`${this.apiUrl}${e}`,{method:r,headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions,body:JSON.stringify(i)})).json();if(!o||!o[s])break;yield o[s];const u=o.cursors;if(!u||!u.next)break;i.cursor=u.next}}_filterForSampling(e,n=!1){if(this.tracingSampleRate===void 0)return e;if(n){const r=[];for(const s of e)this.filteredPostUuids.has(s.id)?this.filteredPostUuids.delete(s.id):r.push(s);return r}else{const r=[];for(const s of e)s.id!==s.trace_id&&!this.filteredPostUuids.has(s.trace_id)||Math.random()<this.tracingSampleRate?r.push(s):this.filteredPostUuids.add(s.id);return r}}async _getBatchSizeLimitBytes(){const e=await this._ensureServerInfo();return this.batchSizeBytesLimit??e.batch_ingest_config?.size_limit_bytes??pD}async _getMultiPartSupport(){return(await this._ensureServerInfo()).instance_flags?.dataset_examples_multipart_enabled??!1}drainAutoBatchQueue(e){const n=[];for(;this.autoBatchQueue.items.length>0;){const[r,s]=this.autoBatchQueue.pop(e);if(!r.length){s();break}const i=this._processBatch(r,s).catch(console.error);n.push(i)}return Promise.all(n)}async _processBatch(e,n){if(!e.length){n();return}try{const r={runCreates:e.filter(i=>i.action==="create").map(i=>i.item),runUpdates:e.filter(i=>i.action==="update").map(i=>i.item)};(await this._ensureServerInfo())?.batch_ingest_config?.use_multipart_endpoint?await this.multipartIngestRuns(r):await this.batchIngestRuns(r)}finally{n()}}async processRunOperation(e){clearTimeout(this.autoBatchTimeout),this.autoBatchTimeout=void 0,e.action==="create"&&(e.item=G_(e.item));const n=this.autoBatchQueue.push(e);if(this.manualFlushMode)return n;const r=await this._getBatchSizeLimitBytes();return this.autoBatchQueue.sizeBytes>r&&this.drainAutoBatchQueue(r),this.autoBatchQueue.items.length>0&&(this.autoBatchTimeout=setTimeout(()=>{this.autoBatchTimeout=void 0,this.drainAutoBatchQueue(r)},this.autoBatchAggregationDelayMs)),n}async _getServerInfo(){const e=await re()(`${this.apiUrl}/info`,{method:"GET",headers:{Accept:"application/json"},signal:AbortSignal.timeout(mD),...this.fetchOptions});return await ue(e,"get server info"),e.json()}async _ensureServerInfo(){return this._getServerInfoPromise===void 0&&(this._getServerInfoPromise=(async()=>{if(this._serverInfo===void 0)try{this._serverInfo=await this._getServerInfo()}catch{console.warn("[WARNING]: LangSmith failed to fetch info on supported operations. Falling back to batch operations and default limits.")}return this._serverInfo??{}})()),this._getServerInfoPromise.then(e=>(this._serverInfo===void 0&&(this._getServerInfoPromise=void 0),e))}async _getSettings(){return this.settings||(this.settings=this._get("/settings")),await this.settings}async flush(){const e=await this._getBatchSizeLimitBytes();await this.drainAutoBatchQueue(e)}async createRun(e){if(!this._filterForSampling([e]).length)return;const n={...this.headers,"Content-Type":"application/json"},r=e.project_name;delete e.project_name;const s=this.prepareRunCreateOrUpdateInputs({session_name:r,...e,start_time:e.start_time??Date.now()});if(this.autoBatchTracing&&s.trace_id!==void 0&&s.dotted_order!==void 0){this.processRunOperation({action:"create",item:s}).catch(console.error);return}const i=G_(s),a=await this.caller.call(re(),`${this.apiUrl}/runs`,{method:"POST",headers:n,body:sn(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(a,"create run",!0)}async batchIngestRuns({runCreates:e,runUpdates:n}){if(e===void 0&&n===void 0)return;let r=e?.map(o=>this.prepareRunCreateOrUpdateInputs(o))??[],s=n?.map(o=>this.prepareRunCreateOrUpdateInputs(o))??[];if(r.length>0&&s.length>0){const o=r.reduce((l,c)=>(c.id&&(l[c.id]=c),l),{}),u=[];for(const l of s)l.id!==void 0&&o[l.id]?o[l.id]={...o[l.id],...l}:u.push(l);r=Object.values(o),s=u}const i={post:this._filterForSampling(r),patch:this._filterForSampling(s,!0)};if(!i.post.length&&!i.patch.length)return;const a={post:[],patch:[]};for(const o of["post","patch"]){const u=o,l=i[u].reverse();let c=l.pop();for(;c!==void 0;)a[u].push(c),c=l.pop()}(a.post.length>0||a.patch.length>0)&&await this._postBatchIngestRuns(sn(a))}async _postBatchIngestRuns(e){const n={...this.headers,"Content-Type":"application/json",Accept:"application/json"},r=await this.batchIngestCaller.call(re(),`${this.apiUrl}/runs/batch`,{method:"POST",headers:n,body:e,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(r,"batch create run",!0)}async multipartIngestRuns({runCreates:e,runUpdates:n}){if(e===void 0&&n===void 0)return;const r={};let s=[];for(const c of e??[]){const d=this.prepareRunCreateOrUpdateInputs(c);d.id!==void 0&&d.attachments!==void 0&&(r[d.id]=d.attachments),delete d.attachments,s.push(d)}let i=[];for(const c of n??[])i.push(this.prepareRunCreateOrUpdateInputs(c));if(s.find(c=>c.trace_id===void 0||c.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when creating a run');if(i.find(c=>c.trace_id===void 0||c.dotted_order===void 0)!==void 0)throw new Error('Multipart ingest requires "trace_id" and "dotted_order" to be set when updating a run');if(s.length>0&&i.length>0){const c=s.reduce((f,h)=>(h.id&&(f[h.id]=h),f),{}),d=[];for(const f of i)f.id!==void 0&&c[f.id]?c[f.id]={...c[f.id],...f}:d.push(f);s=Object.values(c),i=d}if(s.length===0&&i.length===0)return;const u=[],l=[];for(const[c,d]of[["post",s],["patch",i]])for(const f of d){const{inputs:h,outputs:m,events:y,attachments:w,...p}=f,b={inputs:h,outputs:m,events:y},_=sn(p);l.push({name:`${c}.${p.id}`,payload:new Blob([_],{type:`application/json; length=${_.length}`})});for(const[x,S]of Object.entries(b)){if(S===void 0)continue;const E=sn(S);l.push({name:`${c}.${p.id}.${x}`,payload:new Blob([E],{type:`application/json; length=${E.length}`})})}if(p.id!==void 0){const x=r[p.id];if(x){delete r[p.id];for(const[S,E]of Object.entries(x)){let k,T;if(Array.isArray(E)?[k,T]=E:(k=E.mimeType,T=E.data),S.includes(".")){console.warn(`Skipping attachment '${S}' for run ${p.id}: Invalid attachment name. Attachment names must not contain periods ('.'). Please rename the attachment and try again.`);continue}l.push({name:`attachment.${p.id}.${S}`,payload:new Blob([T],{type:`${k}; length=${T.byteLength}`})})}}}u.push(`trace=${p.trace_id},id=${p.id}`)}await this._sendMultipartRequest(l,u.join("; "))}async _sendMultipartRequest(e,n){try{const r="----LangSmithFormBoundary"+Math.random().toString(36).slice(2),s=[];for(const u of e)s.push(new Blob([`--${r}\r
`])),s.push(new Blob([`Content-Disposition: form-data; name="${u.name}"\r
`,`Content-Type: ${u.payload.type}\r
\r
`])),s.push(u.payload),s.push(new Blob([`\r
`]));s.push(new Blob([`--${r}--\r
`]));const a=await new Blob(s).arrayBuffer(),o=await this.batchIngestCaller.call(re(),`${this.apiUrl}/runs/multipart`,{method:"POST",headers:{...this.headers,"Content-Type":`multipart/form-data; boundary=${r}`},body:a,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(o,"ingest multipart runs",!0)}catch(r){console.warn(`${r.message.trim()}

Context: ${n}`)}}async updateRun(e,n){he(e),n.inputs&&(n.inputs=this.processInputs(n.inputs)),n.outputs&&(n.outputs=this.processOutputs(n.outputs));const r={...n,id:e};if(!this._filterForSampling([r],!0).length)return;if(this.autoBatchTracing&&r.trace_id!==void 0&&r.dotted_order!==void 0){if(n.end_time!==void 0&&r.parent_run_id===void 0&&this.blockOnRootRunFinalization&&!this.manualFlushMode){await this.processRunOperation({action:"update",item:r}).catch(console.error);return}else this.processRunOperation({action:"update",item:r}).catch(console.error);return}const s={...this.headers,"Content-Type":"application/json"},i=await this.caller.call(re(),`${this.apiUrl}/runs/${e}`,{method:"PATCH",headers:s,body:sn(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(i,"update run",!0)}async readRun(e,{loadChildRuns:n}={loadChildRuns:!1}){he(e);let r=await this._get(`/runs/${e}`);return n&&r.child_run_ids&&(r=await this._loadChildRuns(r)),r}async getRunUrl({runId:e,run:n,projectOpts:r}){if(n!==void 0){let s;n.session_id?s=n.session_id:r?.projectName?s=(await this.readProject({projectName:r?.projectName})).id:r?.projectId?s=r?.projectId:s=(await this.readProject({projectName:si("PROJECT")||"default"})).id;const i=await this._getTenantId();return`${this.getHostUrl()}/o/${i}/projects/p/${s}/r/${n.id}?poll=true`}else if(e!==void 0){const s=await this.readRun(e);if(!s.app_path)throw new Error(`Run ${e} has no app_path`);return`${this.getHostUrl()}${s.app_path}`}else throw new Error("Must provide either runId or run")}async _loadChildRuns(e){const n=await dD(this.listRuns({id:e.child_run_ids})),r={},s={};n.sort((i,a)=>(i?.dotted_order??"").localeCompare(a?.dotted_order??""));for(const i of n){if(i.parent_run_id===null||i.parent_run_id===void 0)throw new Error(`Child run ${i.id} has no parent`);i.parent_run_id in r||(r[i.parent_run_id]=[]),r[i.parent_run_id].push(i),s[i.id]=i}e.child_runs=r[e.id]||[];for(const i in r)i!==e.id&&(s[i].child_runs=r[i]);return e}async*listRuns(e){const{projectId:n,projectName:r,parentRunId:s,traceId:i,referenceExampleId:a,startTime:o,executionOrder:u,isRoot:l,runType:c,error:d,id:f,query:h,filter:m,traceFilter:y,treeFilter:w,limit:p,select:b}=e;let _=[];if(n&&(_=Array.isArray(n)?n:[n]),r){const k=Array.isArray(r)?r:[r],T=await Promise.all(k.map($=>this.readProject({projectName:$}).then(j=>j.id)));_.push(...T)}const x=["app_path","child_run_ids","completion_cost","completion_tokens","dotted_order","end_time","error","events","extra","feedback_stats","first_token_time","id","inputs","name","outputs","parent_run_id","parent_run_ids","prompt_cost","prompt_tokens","reference_example_id","run_type","session_id","start_time","status","tags","total_cost","total_tokens","trace_id"],S={session:_.length?_:null,run_type:c,reference_example:a,query:h,filter:m,trace_filter:y,tree_filter:w,execution_order:u,parent_run:s,start_time:o?o.toISOString():null,error:d,id:f,limit:p,trace:i,select:b||x,is_root:l};let E=0;for await(const k of this._getCursorPaginatedList("/runs/query",S))if(p){if(E>=p)break;if(k.length+E>p){yield*k.slice(0,p-E);break}E+=k.length,yield*k}else yield*k}async getRunStats({id:e,trace:n,parentRun:r,runType:s,projectNames:i,projectIds:a,referenceExampleIds:o,startTime:u,endTime:l,error:c,query:d,filter:f,traceFilter:h,treeFilter:m,isRoot:y,dataSourceType:w}){let p=a||[];i&&(p=[...a||[],...await Promise.all(i.map(E=>this.readProject({projectName:E}).then(k=>k.id)))]);const _=Object.fromEntries(Object.entries({id:e,trace:n,parent_run:r,run_type:s,session:p,reference_example:o,start_time:u,end_time:l,error:c,query:d,filter:f,trace_filter:h,tree_filter:m,is_root:y,data_source_type:w}).filter(([E,k])=>k!==void 0));return await(await this.caller.call(re(),`${this.apiUrl}/runs/stats`,{method:"POST",headers:this.headers,body:JSON.stringify(_),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async shareRun(e,{shareId:n}={}){const r={run_id:e,share_token:n||Jt()};he(e);const i=await(await this.caller.call(re(),`${this.apiUrl}/runs/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(i===null||!("share_token"in i))throw new Error("Invalid response from server");return`${this.getHostUrl()}/public/${i.share_token}/r`}async unshareRun(e){he(e);const n=await this.caller.call(re(),`${this.apiUrl}/runs/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(n,"unshare run",!0)}async readRunSharedLink(e){he(e);const r=await(await this.caller.call(re(),`${this.apiUrl}/runs/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();if(!(r===null||!("share_token"in r)))return`${this.getHostUrl()}/public/${r.share_token}/r`}async listSharedRuns(e,{runIds:n}={}){const r=new URLSearchParams({share_token:e});if(n!==void 0)for(const a of n)r.append("id",a);return he(e),await(await this.caller.call(re(),`${this.apiUrl}/public/${e}/runs${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async readDatasetSharedSchema(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id),he(e);const s=await(await this.caller.call(re(),`${this.apiUrl}/datasets/${e}/share`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return s.url=`${this.getHostUrl()}/public/${s.share_token}/d`,s}async shareDataset(e,n){if(!e&&!n)throw new Error("Either datasetId or datasetName must be given");e||(e=(await this.readDataset({datasetName:n})).id);const r={dataset_id:e};he(e);const i=await(await this.caller.call(re(),`${this.apiUrl}/datasets/${e}/share`,{method:"PUT",headers:this.headers,body:JSON.stringify(r),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json();return i.url=`${this.getHostUrl()}/public/${i.share_token}/d`,i}async unshareDataset(e){he(e);const n=await this.caller.call(re(),`${this.apiUrl}/datasets/${e}/share`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(n,"unshare dataset",!0)}async readSharedDataset(e){return he(e),await(await this.caller.call(re(),`${this.apiUrl}/public/${e}/datasets`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async listSharedExamples(e,n){const r={};n?.exampleIds&&(r.id=n.exampleIds);const s=new URLSearchParams;Object.entries(r).forEach(([o,u])=>{Array.isArray(u)?u.forEach(l=>s.append(o,l)):s.append(o,u)});const i=await this.caller.call(re(),`${this.apiUrl}/public/${e}/examples?${s.toString()}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),a=await i.json();if(!i.ok)throw"detail"in a?new Error(`Failed to list shared examples.
Status: ${i.status}
Message: ${a.detail.join(`
`)}`):new Error(`Failed to list shared examples: ${i.status} ${i.statusText}`);return a.map(o=>({...o,_hostUrl:this.getHostUrl()}))}async createProject({projectName:e,description:n=null,metadata:r=null,upsert:s=!1,projectExtra:i=null,referenceDatasetId:a=null}){const o=s?"?upsert=true":"",u=`${this.apiUrl}/sessions${o}`,l=i||{};r&&(l.metadata=r);const c={name:e,extra:l,description:n};a!==null&&(c.reference_dataset_id=a);const d=await this.caller.call(re(),u,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(d,"create project"),await d.json()}async updateProject(e,{name:n=null,description:r=null,metadata:s=null,projectExtra:i=null,endTime:a=null}){const o=`${this.apiUrl}/sessions/${e}`;let u=i;s&&(u={...u||{},metadata:s});const l={name:n,extra:u,description:r,end_time:a?new Date(a).toISOString():null},c=await this.caller.call(re(),o,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(l),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(c,"update project"),await c.json()}async hasProject({projectId:e,projectName:n}){let r="/sessions";const s=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)he(e),r+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide projectName or projectId");const i=await this.caller.call(re(),`${this.apiUrl}${r}?${s}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});try{const a=await i.json();return i.ok?Array.isArray(a)?a.length>0:!0:!1}catch{return!1}}async readProject({projectId:e,projectName:n,includeStats:r}){let s="/sessions";const i=new URLSearchParams;if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");if(e!==void 0)he(e),s+=`/${e}`;else if(n!==void 0)i.append("name",n);else throw new Error("Must provide projectName or projectId");r!==void 0&&i.append("include_stats",r.toString());const a=await this._get(s,i);let o;if(Array.isArray(a)){if(a.length===0)throw new Error(`Project[id=${e}, name=${n}] not found`);o=a[0]}else o=a;return o}async getProjectUrl({projectId:e,projectName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either projectName or projectId");const r=await this.readProject({projectId:e,projectName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/projects/p/${r.id}`}async getDatasetUrl({datasetId:e,datasetName:n}){if(e===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");const r=await this.readDataset({datasetId:e,datasetName:n}),s=await this._getTenantId();return`${this.getHostUrl()}/o/${s}/datasets/${r.id}`}async _getTenantId(){if(this._tenantId!==null)return this._tenantId;const e=new URLSearchParams({limit:"1"});for await(const n of this._getPaginated("/sessions",e))return this._tenantId=n[0].tenant_id,n[0].tenant_id;throw new Error("No projects found to resolve tenant.")}async*listProjects({projectIds:e,name:n,nameContains:r,referenceDatasetId:s,referenceDatasetName:i,referenceFree:a,metadata:o}={}){const u=new URLSearchParams;if(e!==void 0)for(const l of e)u.append("id",l);if(n!==void 0&&u.append("name",n),r!==void 0&&u.append("name_contains",r),s!==void 0)u.append("reference_dataset",s);else if(i!==void 0){const l=await this.readDataset({datasetName:i});u.append("reference_dataset",l.id)}a!==void 0&&u.append("reference_free",a.toString()),o!==void 0&&u.append("metadata",JSON.stringify(o));for await(const l of this._getPaginated("/sessions",u))yield*l}async deleteProject({projectId:e,projectName:n}){let r;if(e===void 0&&n===void 0)throw new Error("Must provide projectName or projectId");if(e!==void 0&&n!==void 0)throw new Error("Must provide either projectName or projectId, not both");e===void 0?r=(await this.readProject({projectName:n})).id:r=e,he(r);const s=await this.caller.call(re(),`${this.apiUrl}/sessions/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(s,`delete session ${r} (${n})`,!0)}async uploadCsv({csvFile:e,fileName:n,inputKeys:r,outputKeys:s,description:i,dataType:a,name:o}){const u=`${this.apiUrl}/datasets/upload`,l=new FormData;l.append("file",e,n),r.forEach(f=>{l.append("input_keys",f)}),s.forEach(f=>{l.append("output_keys",f)}),i&&l.append("description",i),a&&l.append("data_type",a),o&&l.append("name",o);const c=await this.caller.call(re(),u,{method:"POST",headers:this.headers,body:l,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(c,"upload CSV"),await c.json()}async createDataset(e,{description:n,dataType:r,inputsSchema:s,outputsSchema:i,metadata:a}={}){const o={name:e,description:n,extra:a?{metadata:a}:void 0};r&&(o.data_type=r),s&&(o.inputs_schema_definition=s),i&&(o.outputs_schema_definition=i);const u=await this.caller.call(re(),`${this.apiUrl}/datasets`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(u,"create dataset"),await u.json()}async readDataset({datasetId:e,datasetName:n}){let r="/datasets";const s=new URLSearchParams({limit:"1"});if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)he(e),r+=`/${e}`;else if(n!==void 0)s.append("name",n);else throw new Error("Must provide datasetName or datasetId");const i=await this._get(r,s);let a;if(Array.isArray(i)){if(i.length===0)throw new Error(`Dataset[id=${e}, name=${n}] not found`);a=i[0]}else a=i;return a}async hasDataset({datasetId:e,datasetName:n}){try{return await this.readDataset({datasetId:e,datasetName:n}),!0}catch(r){if(r instanceof Error&&r.message.toLocaleLowerCase().includes("not found"))return!1;throw r}}async diffDatasetVersions({datasetId:e,datasetName:n,fromVersion:r,toVersion:s}){let i=e;if(i===void 0&&n===void 0)throw new Error("Must provide either datasetName or datasetId");if(i!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");i===void 0&&(i=(await this.readDataset({datasetName:n})).id);const a=new URLSearchParams({from_version:typeof r=="string"?r:r.toISOString(),to_version:typeof s=="string"?s:s.toISOString()});return await this._get(`/datasets/${i}/versions/diff`,a)}async readDatasetOpenaiFinetuning({datasetId:e,datasetName:n}){const r="/datasets";if(e===void 0)if(n!==void 0)e=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide datasetName or datasetId");return(await(await this._getResponse(`${r}/${e}/openai_ft`)).text()).trim().split(`
`).map(o=>JSON.parse(o))}async*listDatasets({limit:e=100,offset:n=0,datasetIds:r,datasetName:s,datasetNameContains:i,metadata:a}={}){const o="/datasets",u=new URLSearchParams({limit:e.toString(),offset:n.toString()});if(r!==void 0)for(const l of r)u.append("id",l);s!==void 0&&u.append("name",s),i!==void 0&&u.append("name_contains",i),a!==void 0&&u.append("metadata",JSON.stringify(a));for await(const l of this._getPaginated(o,u))yield*l}async updateDataset(e){const{datasetId:n,datasetName:r,...s}=e;if(!n&&!r)throw new Error("Must provide either datasetName or datasetId");const i=n??(await this.readDataset({datasetName:r})).id;he(i);const a=await this.caller.call(re(),`${this.apiUrl}/datasets/${i}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(s),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"update dataset"),await a.json()}async deleteDataset({datasetId:e,datasetName:n}){let r="/datasets",s=e;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(n!==void 0&&(s=(await this.readDataset({datasetName:n})).id),s!==void 0)he(s),r+=`/${s}`;else throw new Error("Must provide datasetName or datasetId");const i=await this.caller.call(re(),this.apiUrl+r,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(i,`delete ${r}`),await i.json()}async indexDataset({datasetId:e,datasetName:n,tag:r}){let s=e;if(!s&&!n)throw new Error("Must provide either datasetName or datasetId");if(s&&n)throw new Error("Must provide either datasetName or datasetId, not both");s||(s=(await this.readDataset({datasetName:n})).id),he(s);const i={tag:r},a=await this.caller.call(re(),`${this.apiUrl}/datasets/${s}/index`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(a,"index dataset"),await a.json()}async similarExamples(e,n,r,{filter:s}={}){const i={limit:r,inputs:e};s!==void 0&&(i.filter=s),he(n);const a=await this.caller.call(re(),`${this.apiUrl}/datasets/${n}/search`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"fetch similar examples"),(await a.json()).examples}async createExample(e,n,{datasetId:r,datasetName:s,createdAt:i,exampleId:a,metadata:o,split:u,sourceRunId:l}){let c=r;if(c===void 0&&s===void 0)throw new Error("Must provide either datasetName or datasetId");if(c!==void 0&&s!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");c===void 0&&(c=(await this.readDataset({datasetName:s})).id);const f={dataset_id:c,inputs:e,outputs:n,created_at:(i||new Date)?.toISOString(),id:a,metadata:o,split:u,source_run_id:l},h=await this.caller.call(re(),`${this.apiUrl}/examples`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(f),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(h,"create example"),await h.json()}async createExamples(e){const{inputs:n,outputs:r,metadata:s,sourceRunIds:i,exampleIds:a,datasetId:o,datasetName:u}=e;let l=o;if(l===void 0&&u===void 0)throw new Error("Must provide either datasetName or datasetId");if(l!==void 0&&u!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");l===void 0&&(l=(await this.readDataset({datasetName:u})).id);const c=n.map((h,m)=>({dataset_id:l,inputs:h,outputs:r?r[m]:void 0,metadata:s?s[m]:void 0,split:e.splits?e.splits[m]:void 0,id:a?a[m]:void 0,source_run_id:i?i[m]:void 0})),d=await this.caller.call(re(),`${this.apiUrl}/examples/bulk`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(c),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(d,"create examples"),await d.json()}async createLLMExample(e,n,r){return this.createExample({input:e},{output:n},r)}async createChatExample(e,n,r){const s=e.map(a=>x_(a)?S_(a):a),i=x_(n)?S_(n):n;return this.createExample({input:s},{output:i},r)}async readExample(e){he(e);const n=`/examples/${e}`,r=await this._get(n),{attachment_urls:s,...i}=r,a=i;return s&&(a.attachments=Object.entries(s).reduce((o,[u,l])=>(o[u.slice(11)]={presigned_url:l.presigned_url},o),{})),a}async*listExamples({datasetId:e,datasetName:n,exampleIds:r,asOf:s,splits:i,inlineS3Urls:a,metadata:o,limit:u,offset:l,filter:c,includeAttachments:d}={}){let f;if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");if(e!==void 0)f=e;else if(n!==void 0)f=(await this.readDataset({datasetName:n})).id;else throw new Error("Must provide a datasetName or datasetId");const h=new URLSearchParams({dataset:f}),m=s?typeof s=="string"?s:s?.toISOString():void 0;m&&h.append("as_of",m);const y=a??!0;if(h.append("inline_s3_urls",y.toString()),r!==void 0)for(const p of r)h.append("id",p);if(i!==void 0)for(const p of i)h.append("splits",p);if(o!==void 0){const p=JSON.stringify(o);h.append("metadata",p)}u!==void 0&&h.append("limit",u.toString()),l!==void 0&&h.append("offset",l.toString()),c!==void 0&&h.append("filter",c),d===!0&&["attachment_urls","outputs","metadata"].forEach(p=>h.append("select",p));let w=0;for await(const p of this._getPaginated("/examples",h)){for(const b of p){const{attachment_urls:_,...x}=b,S=x;_&&(S.attachments=Object.entries(_).reduce((E,[k,T])=>(E[k.slice(11)]={presigned_url:T.presigned_url},E),{})),yield S,w++}if(u!==void 0&&w>=u)break}}async deleteExample(e){he(e);const n=`/examples/${e}`,r=await this.caller.call(re(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(r,`delete ${n}`),await r.json()}async updateExample(e,n){he(e);const r=await this.caller.call(re(),`${this.apiUrl}/examples/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(r,"update example"),await r.json()}async updateExamples(e){const n=await this.caller.call(re(),`${this.apiUrl}/examples/bulk`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(e),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(n,"update examples"),await n.json()}async listDatasetSplits({datasetId:e,datasetName:n,asOf:r}){let s;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?s=(await this.readDataset({datasetName:n})).id:s=e,he(s);const i=new URLSearchParams,a=r?typeof r=="string"?r:r?.toISOString():void 0;return a&&i.append("as_of",a),await this._get(`/datasets/${s}/splits`,i)}async updateDatasetSplits({datasetId:e,datasetName:n,splitName:r,exampleIds:s,remove:i=!1}){let a;if(e===void 0&&n===void 0)throw new Error("Must provide dataset name or ID");if(e!==void 0&&n!==void 0)throw new Error("Must provide either datasetName or datasetId, not both");e===void 0?a=(await this.readDataset({datasetName:n})).id:a=e,he(a);const o={split_name:r,examples:s.map(l=>(he(l),l)),remove:i},u=await this.caller.call(re(),`${this.apiUrl}/datasets/${a}/splits`,{method:"PUT",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(u,"update dataset splits",!0)}async evaluateRun(e,n,{sourceInfo:r,loadChildRuns:s,referenceExample:i}={loadChildRuns:!1}){NE("This method is deprecated and will be removed in future LangSmith versions, use `evaluate` from `langsmith/evaluation` instead.");let a;if(typeof e=="string")a=await this.readRun(e,{loadChildRuns:s});else if(typeof e=="object"&&"id"in e)a=e;else throw new Error(`Invalid run type: ${typeof e}`);a.reference_example_id!==null&&a.reference_example_id!==void 0&&(i=await this.readExample(a.reference_example_id));const o=await n.evaluateRun(a,i),[u,l]=await this._logEvaluationFeedback(o,a,r);return l[0]}async createFeedback(e,n,{score:r,value:s,correction:i,comment:a,sourceInfo:o,feedbackSourceType:u="api",sourceRunId:l,feedbackId:c,feedbackConfig:d,projectId:f,comparativeExperimentId:h}){if(!e&&!f)throw new Error("One of runId or projectId must be provided");if(e&&f)throw new Error("Only one of runId or projectId can be provided");const m={type:u??"api",metadata:o??{}};l!==void 0&&m?.metadata!==void 0&&!m.metadata.__run&&(m.metadata.__run={run_id:l}),m?.metadata!==void 0&&m.metadata.__run?.run_id!==void 0&&he(m.metadata.__run.run_id);const y={id:c??Jt(),run_id:e,key:n,score:r,value:s,correction:i,comment:a,feedback_source:m,comparative_experiment_id:h,feedbackConfig:d,session_id:f},w=`${this.apiUrl}/feedback`,p=await this.caller.call(re(),w,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(y),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(p,"create feedback",!0),y}async updateFeedback(e,{score:n,value:r,correction:s,comment:i}){const a={};n!=null&&(a.score=n),r!=null&&(a.value=r),s!=null&&(a.correction=s),i!=null&&(a.comment=i),he(e);const o=await this.caller.call(re(),`${this.apiUrl}/feedback/${e}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(a),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(o,"update feedback",!0)}async readFeedback(e){he(e);const n=`/feedback/${e}`;return await this._get(n)}async deleteFeedback(e){he(e);const n=`/feedback/${e}`,r=await this.caller.call(re(),this.apiUrl+n,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(r,`delete ${n}`),await r.json()}async*listFeedback({runIds:e,feedbackKeys:n,feedbackSourceTypes:r}={}){const s=new URLSearchParams;if(e&&s.append("run",e.join(",")),n)for(const i of n)s.append("key",i);if(r)for(const i of r)s.append("source",i);for await(const i of this._getPaginated("/feedback",s))yield*i}async createPresignedFeedbackToken(e,n,{expiration:r,feedbackConfig:s}={}){const i={run_id:e,feedback_key:n,feedback_config:s};return r?typeof r=="string"?i.expires_at=r:(r?.hours||r?.minutes||r?.days)&&(i.expires_in=r):i.expires_in={hours:3},await(await this.caller.call(re(),`${this.apiUrl}/feedback/tokens`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(i),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async createComparativeExperiment({name:e,experimentIds:n,referenceDatasetId:r,createdAt:s,description:i,metadata:a,id:o}){if(n.length===0)throw new Error("At least one experiment is required");if(r||(r=(await this.readProject({projectId:n[0]})).reference_dataset_id),!r==null)throw new Error("A reference dataset is required");const u={id:o,name:e,experiment_ids:n,reference_dataset_id:r,description:i,created_at:(s??new Date)?.toISOString(),extra:{}};return a&&(u.extra.metadata=a),await(await this.caller.call(re(),`${this.apiUrl}/datasets/comparative`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async*listPresignedFeedbackTokens(e){he(e);const n=new URLSearchParams({run_id:e});for await(const r of this._getPaginated("/feedback/tokens",n))yield*r}_selectEvalResults(e){let n;return"results"in e?n=e.results:n=[e],n}async _logEvaluationFeedback(e,n,r){const s=this._selectEvalResults(e),i=[];for(const a of s){let o=r||{};a.evaluatorInfo&&(o={...a.evaluatorInfo,...o});let u=null;a.targetRunId?u=a.targetRunId:n&&(u=n.id),i.push(await this.createFeedback(u,a.key,{score:a.score,value:a.value,comment:a.comment,correction:a.correction,sourceInfo:o,sourceRunId:a.sourceRunId,feedbackConfig:a.feedbackConfig,feedbackSourceType:"model"}))}return[s,i]}async logEvaluationFeedback(e,n,r){const[s]=await this._logEvaluationFeedback(e,n,r);return s}async*listAnnotationQueues(e={}){const{queueIds:n,name:r,nameContains:s,limit:i}=e,a=new URLSearchParams;n&&n.forEach((u,l)=>{he(u,`queueIds[${l}]`),a.append("ids",u)}),r&&a.append("name",r),s&&a.append("name_contains",s),a.append("limit",(i!==void 0?Math.min(i,100):100).toString());let o=0;for await(const u of this._getPaginated("/annotation-queues",a))if(yield*u,o++,i!==void 0&&o>=i)break}async createAnnotationQueue(e){const{name:n,description:r,queueId:s}=e,i={name:n,description:r,id:s||Jt()},a=await this.caller.call(re(),`${this.apiUrl}/annotation-queues`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(Object.fromEntries(Object.entries(i).filter(([u,l])=>l!==void 0))),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"create annotation queue"),await a.json()}async readAnnotationQueue(e){const n=await this.listAnnotationQueues({queueIds:[e]}).next();if(n.done)throw new Error(`Annotation queue with ID ${e} not found`);return n.value}async updateAnnotationQueue(e,n){const{name:r,description:s}=n,i=await this.caller.call(re(),`${this.apiUrl}/annotation-queues/${he(e,"queueId")}`,{method:"PATCH",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify({name:r,description:s}),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(i,"update annotation queue")}async deleteAnnotationQueue(e){const n=await this.caller.call(re(),`${this.apiUrl}/annotation-queues/${he(e,"queueId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(n,"delete annotation queue")}async addRunsToAnnotationQueue(e,n){const r=await this.caller.call(re(),`${this.apiUrl}/annotation-queues/${he(e,"queueId")}/runs`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(n.map((s,i)=>he(s,`runIds[${i}]`).toString())),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(r,"add runs to annotation queue")}async getRunFromAnnotationQueue(e,n){const r=`/annotation-queues/${he(e,"queueId")}/run`,s=await this.caller.call(re(),`${this.apiUrl}${r}/${n}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(s,"get run from annotation queue"),await s.json()}async deleteRunFromAnnotationQueue(e,n){const r=await this.caller.call(re(),`${this.apiUrl}/annotation-queues/${he(e,"queueId")}/runs/${he(n,"queueRunId")}`,{method:"DELETE",headers:{...this.headers,Accept:"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(r,"delete run from annotation queue")}async getSizeFromAnnotationQueue(e){const n=await this.caller.call(re(),`${this.apiUrl}/annotation-queues/${he(e,"queueId")}/size`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(n,"get size from annotation queue"),await n.json()}async _currentTenantIsOwner(e){const n=await this._getSettings();return e=="-"||n.tenant_handle===e}async _ownerConflictError(e,n){const r=await this._getSettings();return new Error(`Cannot ${e} for another tenant.

      Current tenant: ${r.tenant_handle}

      Requested tenant: ${n}`)}async _getLatestCommitHash(e){const n=await this.caller.call(re(),`${this.apiUrl}/commits/${e}/?limit=1&offset=0`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions}),r=await n.json();if(!n.ok){const s=typeof r.detail=="string"?r.detail:JSON.stringify(r.detail),i=new Error(`Error ${n.status}: ${n.statusText}
${s}`);throw i.statusCode=n.status,i}if(r.commits.length!==0)return r.commits[0].commit_hash}async _likeOrUnlikePrompt(e,n){const[r,s,i]=as(e),a=await this.caller.call(re(),`${this.apiUrl}/likes/${r}/${s}`,{method:"POST",body:JSON.stringify({like:n}),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,`${n?"like":"unlike"} prompt`),await a.json()}async _getPromptUrl(e){const[n,r,s]=as(e);if(await this._currentTenantIsOwner(n)){const i=await this._getSettings();return s!=="latest"?`${this.getHostUrl()}/prompts/${r}/${s.substring(0,8)}?organizationId=${i.id}`:`${this.getHostUrl()}/prompts/${r}?organizationId=${i.id}`}else return s!=="latest"?`${this.getHostUrl()}/hub/${n}/${r}/${s.substring(0,8)}`:`${this.getHostUrl()}/hub/${n}/${r}`}async promptExists(e){return!!await this.getPrompt(e)}async likePrompt(e){return this._likeOrUnlikePrompt(e,!0)}async unlikePrompt(e){return this._likeOrUnlikePrompt(e,!1)}async*listCommits(e){for await(const n of this._getPaginated(`/commits/${e}/`,new URLSearchParams,r=>r.commits))yield*n}async*listPrompts(e){const n=new URLSearchParams;n.append("sort_field",e?.sortField??"updated_at"),n.append("sort_direction","desc"),n.append("is_archived",(!!e?.isArchived).toString()),e?.isPublic!==void 0&&n.append("is_public",e.isPublic.toString()),e?.query&&n.append("query",e.query);for await(const r of this._getPaginated("/repos",n,s=>s.repos))yield*r}async getPrompt(e){const[n,r,s]=as(e),i=await this.caller.call(re(),`${this.apiUrl}/repos/${n}/${r}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});if(i.status===404)return null;await ue(i,"get prompt");const a=await i.json();return a.repo?a.repo:null}async createPrompt(e,n){const r=await this._getSettings();if(n?.isPublic&&!r.tenant_handle)throw new Error(`Cannot create a public prompt without first

        creating a LangChain Hub handle. 
        You can add a handle by creating a public prompt at:

        https://smith.langchain.com/prompts`);const[s,i,a]=as(e);if(!await this._currentTenantIsOwner(s))throw await this._ownerConflictError("create a prompt",s);const o={repo_handle:i,...n?.description&&{description:n.description},...n?.readme&&{readme:n.readme},...n?.tags&&{tags:n.tags},is_public:!!n?.isPublic},u=await this.caller.call(re(),`${this.apiUrl}/repos/`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(o),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(u,"create prompt");const{repo:l}=await u.json();return l}async createCommit(e,n,r){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[s,i,a]=as(e),o=r?.parentCommitHash==="latest"||!r?.parentCommitHash?await this._getLatestCommitHash(`${s}/${i}`):r?.parentCommitHash,u={manifest:JSON.parse(JSON.stringify(n)),parent_commit:o},l=await this.caller.call(re(),`${this.apiUrl}/commits/${s}/${i}`,{method:"POST",headers:{...this.headers,"Content-Type":"application/json"},body:JSON.stringify(u),signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(l,"create commit");const c=await l.json();return this._getPromptUrl(`${s}/${i}${c.commit_hash?`:${c.commit_hash}`:""}`)}async updateExamplesMultipart(e,n=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const r=new FormData;for(const a of n){const o=a.id,u={...a.metadata&&{metadata:a.metadata},...a.split&&{split:a.split}},l=sn(u),c=new Blob([l],{type:"application/json"});if(r.append(o,c),a.inputs){const d=sn(a.inputs),f=new Blob([d],{type:"application/json"});r.append(`${o}.inputs`,f)}if(a.outputs){const d=sn(a.outputs),f=new Blob([d],{type:"application/json"});r.append(`${o}.outputs`,f)}if(a.attachments)for(const[d,f]of Object.entries(a.attachments)){let h,m;Array.isArray(f)?[h,m]=f:(h=f.mimeType,m=f.data);const y=new Blob([m],{type:`${h}; length=${m.byteLength}`});r.append(`${o}.attachment.${d}`,y)}if(a.attachments_operations){const d=sn(a.attachments_operations),f=new Blob([d],{type:"application/json"});r.append(`${o}.attachments_operations`,f)}}return await(await this.caller.call(re(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"PATCH",headers:this.headers,body:r})).json()}async uploadExamplesMultipart(e,n=[]){if(!await this._getMultiPartSupport())throw new Error("Your LangSmith version does not allow using the multipart examples endpoint, please update to the latest version.");const r=new FormData;for(const a of n){const o=(a.id??Jt()).toString(),u={created_at:a.created_at,...a.metadata&&{metadata:a.metadata},...a.split&&{split:a.split}},l=sn(u),c=new Blob([l],{type:"application/json"});r.append(o,c);const d=sn(a.inputs),f=new Blob([d],{type:"application/json"});if(r.append(`${o}.inputs`,f),a.outputs){const h=sn(a.outputs),m=new Blob([h],{type:"application/json"});r.append(`${o}.outputs`,m)}if(a.attachments)for(const[h,m]of Object.entries(a.attachments)){let y,w;Array.isArray(m)?[y,w]=m:(y=m.mimeType,w=m.data);const p=new Blob([w],{type:`${y}; length=${w.byteLength}`});r.append(`${o}.attachment.${h}`,p)}}return await(await this.caller.call(re(),`${this.apiUrl}/v1/platform/datasets/${e}/examples`,{method:"POST",headers:this.headers,body:r})).json()}async updatePrompt(e,n){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[r,s]=as(e);if(!await this._currentTenantIsOwner(r))throw await this._ownerConflictError("update a prompt",r);const i={};if(n?.description!==void 0&&(i.description=n.description),n?.readme!==void 0&&(i.readme=n.readme),n?.tags!==void 0&&(i.tags=n.tags),n?.isPublic!==void 0&&(i.is_public=n.isPublic),n?.isArchived!==void 0&&(i.is_archived=n.isArchived),Object.keys(i).length===0)throw new Error("No valid update options provided");const a=await this.caller.call(re(),`${this.apiUrl}/repos/${r}/${s}`,{method:"PATCH",body:JSON.stringify(i),headers:{...this.headers,"Content-Type":"application/json"},signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});return await ue(a,"update prompt"),a.json()}async deletePrompt(e){if(!await this.promptExists(e))throw new Error("Prompt does not exist, you must create it first.");const[n,r,s]=as(e);if(!await this._currentTenantIsOwner(n))throw await this._ownerConflictError("delete a prompt",n);return await(await this.caller.call(re(),`${this.apiUrl}/repos/${n}/${r}`,{method:"DELETE",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions})).json()}async pullPromptCommit(e,n){const[r,s,i]=as(e),a=await this.caller.call(re(),`${this.apiUrl}/commits/${r}/${s}/${i}${n?.includeModel?"?include_model=true":""}`,{method:"GET",headers:this.headers,signal:AbortSignal.timeout(this.timeout_ms),...this.fetchOptions});await ue(a,"pull prompt commit");const o=await a.json();return{owner:r,repo:s,commit_hash:o.commit_hash,manifest:o.manifest,examples:o.examples}}async _pullPrompt(e,n){const r=await this.pullPromptCommit(e,{includeModel:n?.includeModel});return JSON.stringify(r.manifest)}async pushPrompt(e,n){return await this.promptExists(e)?n&&Object.keys(n).some(s=>s!=="object")&&await this.updatePrompt(e,{description:n?.description,readme:n?.readme,tags:n?.tags,isPublic:n?.isPublic}):await this.createPrompt(e,{description:n?.description,readme:n?.readme,tags:n?.tags,isPublic:n?.isPublic}),n?.object?await this.createCommit(e,n?.object,{parentCommitHash:n?.parentCommitHash}):await this._getPromptUrl(e)}async clonePublicDataset(e,n={}){const{sourceApiUrl:r=this.apiUrl,datasetName:s}=n,[i,a]=this.parseTokenOrUrl(e,r),o=new Yu({apiUrl:i,apiKey:"placeholder"}),u=await o.readSharedDataset(a),l=s||u.name;try{if(await this.hasDataset({datasetId:l})){console.log(`Dataset ${l} already exists in your tenant. Skipping.`);return}}catch{}const c=await o.listSharedExamples(a),d=await this.createDataset(l,{description:u.description,dataType:u.data_type||"kv",inputsSchema:u.inputs_schema_definition??void 0,outputsSchema:u.outputs_schema_definition??void 0});try{await this.createExamples({inputs:c.map(f=>f.inputs),outputs:c.flatMap(f=>f.outputs?[f.outputs]:[]),datasetId:d.id})}catch(f){throw console.error(`An error occurred while creating dataset ${l}. You should delete it manually.`),f}}parseTokenOrUrl(e,n,r=2,s="dataset"){try{return he(e),[n,e]}catch{}try{const a=new URL(e).pathname.split("/").filter(o=>o!=="");if(a.length>=r){const o=a[a.length-r];return[n,o]}else throw new Error(`Invalid public ${s} URL: ${e}`)}catch{throw new Error(`Invalid public ${s} URL or token: ${e}`)}}awaitPendingTraceBatches(){return this.manualFlushMode?(console.warn("[WARNING]: When tracing in manual flush mode, you must call `await client.flush()` manually to submit trace batches."),Promise.resolve()):Promise.all([...this.autoBatchQueue.items.map(({itemPromise:e})=>e),this.batchIngestCaller.queue.onIdle()])}}const FE="0.2.15";var og={};let Nr;const gD=()=>typeof window<"u"&&typeof window.document<"u",yD=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",bD=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),BE=()=>typeof Deno<"u",wD=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!BE(),_D=()=>Nr||(gD()?Nr="browser":wD()?Nr="node":yD()?Nr="webworker":bD()?Nr="jsdom":BE()?Nr="deno":Nr="other",Nr);let cp;function UE(){if(cp===void 0){const t=_D(),e=SD();cp={library:"langsmith",runtime:t,sdk:"langsmith-js",sdk_version:FE,...e}}return cp}function vD(){const t=xD()||{},e={},n=["LANGCHAIN_API_KEY","LANGCHAIN_ENDPOINT","LANGCHAIN_TRACING_V2","LANGCHAIN_PROJECT","LANGCHAIN_SESSION","LANGSMITH_API_KEY","LANGSMITH_ENDPOINT","LANGSMITH_TRACING_V2","LANGSMITH_PROJECT","LANGSMITH_SESSION"];for(const[r,s]of Object.entries(t))(r.startsWith("LANGCHAIN_")||r.startsWith("LANGSMITH_"))&&typeof s=="string"&&!n.includes(r)&&!r.toLowerCase().includes("key")&&!r.toLowerCase().includes("secret")&&!r.toLowerCase().includes("token")&&(r==="LANGCHAIN_REVISION_ID"?e.revision_id=s:e[r]=s);return e}function xD(){try{return typeof process<"u"&&og?Object.entries(og).reduce((t,[e,n])=>(t[e]=String(n),t),{}):void 0}catch{return}}function xs(t){try{return typeof process<"u"?og?.[t]:void 0}catch{return}}function si(t){return xs(`LANGSMITH_${t}`)||xs(`LANGCHAIN_${t}`)}let dp;function SD(){if(dp!==void 0)return dp;const t=["VERCEL_GIT_COMMIT_SHA","NEXT_PUBLIC_VERCEL_GIT_COMMIT_SHA","COMMIT_REF","RENDER_GIT_COMMIT","CI_COMMIT_SHA","CIRCLE_SHA1","CF_PAGES_COMMIT_SHA","REACT_APP_GIT_SHA","SOURCE_VERSION","GITHUB_SHA","TRAVIS_COMMIT","GIT_COMMIT","BUILD_VCS_NUMBER","bamboo_planRepository_revision","Build.SourceVersion","BITBUCKET_COMMIT","DRONE_COMMIT_SHA","SEMAPHORE_GIT_SHA","BUILDKITE_COMMIT"],e={};for(const n of t){const r=xs(n);r!==void 0&&(e[n]=r)}return dp=e,e}const kD=t=>!!["TRACING_V2","TRACING"].find(n=>si(n)==="true"),fp=Symbol.for("lc:context_variables");function ED(t){return t.replace(/[-:.]/g,"")}function AD(t,e,n=1){const r=n.toFixed(0).slice(0,3).padStart(3,"0");return ED(`${new Date(t).toISOString().slice(0,-1)}${r}Z`)+e}class qd{constructor(e,n){Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.metadata=e,this.tags=n}static fromHeader(e){const n=e.split(",");let r={},s=[];for(const i of n){const[a,o]=i.split("="),u=decodeURIComponent(o);a==="langsmith-metadata"?r=JSON.parse(u):a==="langsmith-tags"&&(s=u.split(","))}return new qd(r,s)}toHeader(){const e=[];return this.metadata&&Object.keys(this.metadata).length>0&&e.push(`langsmith-metadata=${encodeURIComponent(JSON.stringify(this.metadata))}`),this.tags&&this.tags.length>0&&e.push(`langsmith-tags=${encodeURIComponent(this.tags.join(","))}`),e.join(",")}}class un{constructor(e){if(Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"run_type",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"project_name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"parent_run",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_runs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"start_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"end_time",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"extra",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"error",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"serialized",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"inputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"outputs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reference_example_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"events",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"trace_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"dotted_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tracingEnabled",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"child_execution_order",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"attachments",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),zE(e)){Object.assign(this,{...e});return}const n=un.getDefaultConfig(),{metadata:r,...s}=e,i=s.client??un.getSharedClient(),a={...r,...s?.extra?.metadata};if(s.extra={...s.extra,metadata:a},Object.assign(this,{...n,...s,client:i}),this.trace_id||(this.parent_run?this.trace_id=this.parent_run.trace_id??this.id:this.trace_id=this.id),this.execution_order??=1,this.child_execution_order??=1,!this.dotted_order){const o=AD(this.start_time,this.id,this.execution_order);this.parent_run?this.dotted_order=this.parent_run.dotted_order+"."+o:this.dotted_order=o}}static getDefaultConfig(){return{id:Jt(),run_type:"chain",project_name:xs("LANGCHAIN_PROJECT")??xs("LANGCHAIN_SESSION")??"default",child_runs:[],api_url:xs("LANGCHAIN_ENDPOINT")??"http://localhost:1984",api_key:xs("LANGCHAIN_API_KEY"),caller_options:{},start_time:Date.now(),serialized:{},inputs:{},extra:{}}}static getSharedClient(){return un.sharedClient||(un.sharedClient=new Yu),un.sharedClient}createChild(e){const n=this.child_execution_order+1,r=new un({...e,parent_run:this,project_name:this.project_name,client:this.client,tracingEnabled:this.tracingEnabled,execution_order:n,child_execution_order:n});fp in this&&(r[fp]=this[fp]);const s=Symbol.for("lc:child_config"),i=e.extra?.[s]??this.extra[s];if(CD(i)){const u={...i},l=TD(u.callbacks)?u.callbacks.copy?.():void 0;l&&(Object.assign(l,{_parentRunId:r.id}),l.handlers?.find(qE)?.updateFromRunTree?.(r),u.callbacks=l),r.extra[s]=u}const a=new Set;let o=this;for(;o!=null&&!a.has(o.id);)a.add(o.id),o.child_execution_order=Math.max(o.child_execution_order,n),o=o.parent_run;return this.child_runs.push(r),r}async end(e,n,r=Date.now(),s){this.outputs=this.outputs??e,this.error=this.error??n,this.end_time=this.end_time??r,s&&Object.keys(s).length>0&&(this.extra=this.extra?{...this.extra,metadata:{...this.extra.metadata,...s}}:{metadata:s})}_convertToCreate(e,n,r=!0){const s=e.extra??{};if(s.runtime||(s.runtime={}),n)for(const[u,l]of Object.entries(n))s.runtime[u]||(s.runtime[u]=l);let i,a;return r?(a=e.parent_run?.id,i=[]):(i=e.child_runs.map(u=>this._convertToCreate(u,n,r)),a=void 0),{id:e.id,name:e.name,start_time:e.start_time,end_time:e.end_time,run_type:e.run_type,reference_example_id:e.reference_example_id,extra:s,serialized:e.serialized,error:e.error,inputs:e.inputs,outputs:e.outputs,session_name:e.project_name,child_runs:i,parent_run_id:a,trace_id:e.trace_id,dotted_order:e.dotted_order,tags:e.tags,attachments:e.attachments}}async postRun(e=!0){try{const n=UE(),r=await this._convertToCreate(this,n,!0);if(await this.client.createRun(r),!e){NE("Posting with excludeChildRuns=false is deprecated and will be removed in a future version.");for(const s of this.child_runs)await s.postRun(!1)}}catch(n){console.error(`Error in postRun for run ${this.id}:`,n)}}async patchRun(){try{const e={end_time:this.end_time,error:this.error,inputs:this.inputs,outputs:this.outputs,parent_run_id:this.parent_run?.id,reference_example_id:this.reference_example_id,extra:this.extra,events:this.events,dotted_order:this.dotted_order,trace_id:this.trace_id,tags:this.tags,attachments:this.attachments};await this.client.updateRun(this.id,e)}catch(e){console.error(`Error in patchRun for run ${this.id}`,e)}}toJSON(){return this._convertToCreate(this,void 0,!1)}static fromRunnableConfig(e,n){const r=e?.callbacks;let s,i,a,o=kD();if(r){const l=r?.getParentRunId?.()??"",c=r?.handlers?.find(d=>d?.name=="langchain_tracer");s=c?.getRun?.(l),i=c?.projectName,a=c?.client,o=o||!!c}return s?new un({name:s.name,id:s.id,trace_id:s.trace_id,dotted_order:s.dotted_order,client:a,tracingEnabled:o,project_name:i,tags:[...new Set((s?.tags??[]).concat(e?.tags??[]))],extra:{metadata:{...s?.extra?.metadata,...e?.metadata}}}).createChild(n):new un({...n,client:a,tracingEnabled:o,project_name:i})}static fromDottedOrder(e){return this.fromHeaders({"langsmith-trace":e})}static fromHeaders(e,n){const r="get"in e&&typeof e.get=="function"?{"langsmith-trace":e.get("langsmith-trace"),baggage:e.get("baggage")}:e,s=r["langsmith-trace"];if(!s||typeof s!="string")return;const i=s.trim(),a=i.split(".").map(l=>{const[c,d]=l.split("Z");return{strTime:c,time:Date.parse(c+"Z"),uuid:d}}),o=a[0].uuid,u={...n,name:n?.name??"parent",run_type:n?.run_type??"chain",start_time:n?.start_time??Date.now(),id:a.at(-1)?.uuid,trace_id:o,dotted_order:i};if(r.baggage&&typeof r.baggage=="string"){const l=qd.fromHeader(r.baggage);u.metadata=l.metadata,u.tags=l.tags}return new un(u)}toHeaders(e){const n={"langsmith-trace":this.dotted_order,baggage:new qd(this.extra?.metadata,this.tags).toHeader()};if(e)for(const[r,s]of Object.entries(n))e.set(r,s);return n}}Object.defineProperty(un,"sharedClient",{enumerable:!0,configurable:!0,writable:!0,value:null});function zE(t){return t!==void 0&&typeof t.createChild=="function"&&typeof t.postRun=="function"}function qE(t){return typeof t=="object"&&t!=null&&typeof t.name=="string"&&t.name==="langchain_tracer"}function Z_(t){return Array.isArray(t)&&t.some(e=>qE(e))}function TD(t){return typeof t=="object"&&t!=null&&Array.isArray(t.handlers)}function CD(t){return t!==void 0&&typeof t.callbacks=="object"&&(Z_(t.callbacks?.handlers)||Z_(t.callbacks))}let PD=class{getStore(){}run(e,n){return n()}};const hp=Symbol.for("ls:tracing_async_local_storage"),OD=new PD;let ND=class{getInstance(){return globalThis[hp]??OD}initializeGlobalInstance(e){globalThis[hp]===void 0&&(globalThis[hp]=e)}};const ID=new ND,RD=()=>{const t=ID.getInstance().getStore();if(!zE(t))throw new Error(["Could not get the current run tree.","","Please make sure you are calling this method within a traceable function or the tracing is enabled."].join(`
`));return t};function wy(t){return typeof t=="function"&&"langsmith:traceable"in t}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2017-2022 Joachim Wester
 * MIT licensed
 */const jD=Object.prototype.hasOwnProperty;function ug(t,e){return jD.call(t,e)}function lg(t){if(Array.isArray(t)){const n=new Array(t.length);for(let r=0;r<n.length;r++)n[r]=""+r;return n}if(Object.keys)return Object.keys(t);let e=[];for(let n in t)ug(t,n)&&e.push(n);return e}function br(t){switch(typeof t){case"object":return JSON.parse(JSON.stringify(t));case"undefined":return null;default:return t}}function cg(t){let e=0;const n=t.length;let r;for(;e<n;){if(r=t.charCodeAt(e),r>=48&&r<=57){e++;continue}return!1}return!0}function Vi(t){return t.indexOf("/")===-1&&t.indexOf("~")===-1?t:t.replace(/~/g,"~0").replace(/\//g,"~1")}function $D(t){return t.replace(/~1/g,"/").replace(/~0/g,"~")}function dg(t){if(t===void 0)return!0;if(t){if(Array.isArray(t)){for(let n=0,r=t.length;n<r;n++)if(dg(t[n]))return!0}else if(typeof t=="object"){const n=lg(t),r=n.length;for(var e=0;e<r;e++)if(dg(t[n[e]]))return!0}}return!1}function J_(t,e){const n=[t];for(const r in e){const s=typeof e[r]=="object"?JSON.stringify(e[r],null,2):e[r];typeof s<"u"&&n.push(`${r}: ${s}`)}return n.join(`
`)}class LD extends Error{constructor(e,n,r,s,i){super(J_(e,{name:n,index:r,operation:s,tree:i})),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"index",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"operation",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"tree",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.setPrototypeOf(this,new.target.prototype),this.message=J_(e,{name:n,index:r,operation:s,tree:i})}}const tt=LD,pa={add:function(t,e,n){return t[e]=this.value,{newDocument:n}},remove:function(t,e,n){var r=t[e];return delete t[e],{newDocument:n,removed:r}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:function(t,e,n){let r=fg(n,this.path);r&&(r=br(r));const s=fu(n,{op:"remove",path:this.from}).removed;return fu(n,{op:"add",path:this.path,value:s}),{newDocument:n,removed:r}},copy:function(t,e,n){const r=fg(n,this.from);return fu(n,{op:"add",path:this.path,value:br(r)}),{newDocument:n}},test:function(t,e,n){return{newDocument:n,test:Vd(t[e],this.value)}},_get:function(t,e,n){return this.value=t[e],{newDocument:n}}};var MD={add:function(t,e,n){return cg(e)?t.splice(e,0,this.value):t[e]=this.value,{newDocument:n,index:e}},remove:function(t,e,n){var r=t.splice(e,1);return{newDocument:n,removed:r[0]}},replace:function(t,e,n){var r=t[e];return t[e]=this.value,{newDocument:n,removed:r}},move:pa.move,copy:pa.copy,test:pa.test,_get:pa._get};function fg(t,e){if(e=="")return t;var n={op:"_get",path:e};return fu(t,n),n.value}function fu(t,e,n=!1,r=!0,s=!0,i=0){if(n&&(typeof n=="function"?n(e,0,t,e.path):hg(e,0)),e.path===""){let a={newDocument:t};if(e.op==="add")return a.newDocument=e.value,a;if(e.op==="replace")return a.newDocument=e.value,a.removed=t,a;if(e.op==="move"||e.op==="copy")return a.newDocument=fg(t,e.from),e.op==="move"&&(a.removed=t),a;if(e.op==="test"){if(a.test=Vd(t,e.value),a.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return a.newDocument=t,a}else{if(e.op==="remove")return a.removed=t,a.newDocument=null,a;if(e.op==="_get")return e.value=t,a;if(n)throw new tt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",i,e,t);return a}}else{r||(t=br(t));const o=(e.path||"").split("/");let u=t,l=1,c=o.length,d,f,h;for(typeof n=="function"?h=n:h=hg;;){if(f=o[l],f&&f.indexOf("~")!=-1&&(f=$D(f)),s&&(f=="__proto__"||f=="prototype"&&l>0&&o[l-1]=="constructor"))throw new TypeError("JSON-Patch: modifying `__proto__` or `constructor/prototype` prop is banned for security reasons, if this was on purpose, please set `banPrototypeModifications` flag false and pass it to this function. More info in fast-json-patch README");if(n&&d===void 0&&(u[f]===void 0?d=o.slice(0,l).join("/"):l==c-1&&(d=e.path),d!==void 0&&h(e,0,t,d)),l++,Array.isArray(u)){if(f==="-")f=u.length;else{if(n&&!cg(f))throw new tt("Expected an unsigned base-10 integer value, making the new referenced value the array element with the zero-based index","OPERATION_PATH_ILLEGAL_ARRAY_INDEX",i,e,t);cg(f)&&(f=~~f)}if(l>=c){if(n&&e.op==="add"&&f>u.length)throw new tt("The specified index MUST NOT be greater than the number of elements in the array","OPERATION_VALUE_OUT_OF_BOUNDS",i,e,t);const m=MD[e.op].call(e,u,f,t);if(m.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return m}}else if(l>=c){const m=pa[e.op].call(e,u,f,t);if(m.test===!1)throw new tt("Test operation failed","TEST_OPERATION_FAILED",i,e,t);return m}if(u=u[f],n&&l<c&&(!u||typeof u!="object"))throw new tt("Cannot perform operation at the desired path","OPERATION_PATH_UNRESOLVABLE",i,e,t)}}}function Hd(t,e,n,r=!0,s=!0){if(n&&!Array.isArray(e))throw new tt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");r||(t=br(t));const i=new Array(e.length);for(let a=0,o=e.length;a<o;a++)i[a]=fu(t,e[a],n,!0,s,a),t=i[a].newDocument;return i.newDocument=t,i}function hg(t,e,n,r){if(typeof t!="object"||t===null||Array.isArray(t))throw new tt("Operation is not an object","OPERATION_NOT_AN_OBJECT",e,t,n);if(pa[t.op]){if(typeof t.path!="string")throw new tt("Operation `path` property is not a string","OPERATION_PATH_INVALID",e,t,n);if(t.path.indexOf("/")!==0&&t.path.length>0)throw new tt('Operation `path` property must start with "/"',"OPERATION_PATH_INVALID",e,t,n);if((t.op==="move"||t.op==="copy")&&typeof t.from!="string")throw new tt("Operation `from` property is not present (applicable in `move` and `copy` operations)","OPERATION_FROM_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&t.value===void 0)throw new tt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_REQUIRED",e,t,n);if((t.op==="add"||t.op==="replace"||t.op==="test")&&dg(t.value))throw new tt("Operation `value` property is not present (applicable in `add`, `replace` and `test` operations)","OPERATION_VALUE_CANNOT_CONTAIN_UNDEFINED",e,t,n);if(n){if(t.op=="add"){var s=t.path.split("/").length,i=r.split("/").length;if(s!==i+1&&s!==i)throw new tt("Cannot perform an `add` operation at the desired path","OPERATION_PATH_CANNOT_ADD",e,t,n)}else if(t.op==="replace"||t.op==="remove"||t.op==="_get"){if(t.path!==r)throw new tt("Cannot perform the operation at a path that does not exist","OPERATION_PATH_UNRESOLVABLE",e,t,n)}else if(t.op==="move"||t.op==="copy"){var a={op:"_get",path:t.from,value:void 0},o=DD([a],n);if(o&&o.name==="OPERATION_PATH_UNRESOLVABLE")throw new tt("Cannot perform the operation from a path that does not exist","OPERATION_FROM_UNRESOLVABLE",e,t,n)}}}else throw new tt("Operation `op` property is not one of operations defined in RFC-6902","OPERATION_OP_INVALID",e,t,n)}function DD(t,e,n){try{if(!Array.isArray(t))throw new tt("Patch sequence must be an array","SEQUENCE_NOT_AN_ARRAY");if(e)Hd(br(e),br(t),n||!0);else{n=n||hg;for(var r=0;r<t.length;r++)n(t[r],r,e,void 0)}}catch(s){if(s instanceof tt)return s;throw s}}function Vd(t,e){if(t===e)return!0;if(t&&e&&typeof t=="object"&&typeof e=="object"){var n=Array.isArray(t),r=Array.isArray(e),s,i,a;if(n&&r){if(i=t.length,i!=e.length)return!1;for(s=i;s--!==0;)if(!Vd(t[s],e[s]))return!1;return!0}if(n!=r)return!1;var o=Object.keys(t);if(i=o.length,i!==Object.keys(e).length)return!1;for(s=i;s--!==0;)if(!e.hasOwnProperty(o[s]))return!1;for(s=i;s--!==0;)if(a=o[s],!Vd(t[a],e[a]))return!1;return!0}return t!==t&&e!==e}/*!
 * https://github.com/Starcounter-Jack/JSON-Patch
 * (c) 2013-2021 Joachim Wester
 * MIT license
 */function HE(t,e,n,r,s){if(e!==t){typeof e.toJSON=="function"&&(e=e.toJSON());for(var i=lg(e),a=lg(t),o=!1,u=a.length-1;u>=0;u--){var l=a[u],c=t[l];if(ug(e,l)&&!(e[l]===void 0&&c!==void 0&&Array.isArray(e)===!1)){var d=e[l];typeof c=="object"&&c!=null&&typeof d=="object"&&d!=null&&Array.isArray(c)===Array.isArray(d)?HE(c,d,n,r+"/"+Vi(l),s):c!==d&&(s&&n.push({op:"test",path:r+"/"+Vi(l),value:br(c)}),n.push({op:"replace",path:r+"/"+Vi(l),value:br(d)}))}else Array.isArray(t)===Array.isArray(e)?(s&&n.push({op:"test",path:r+"/"+Vi(l),value:br(c)}),n.push({op:"remove",path:r+"/"+Vi(l)}),o=!0):(s&&n.push({op:"test",path:r,value:t}),n.push({op:"replace",path:r,value:e}))}if(!(!o&&i.length==a.length))for(var u=0;u<i.length;u++){var l=i[u];!ug(t,l)&&e[l]!==void 0&&n.push({op:"add",path:r+"/"+Vi(l),value:br(e[l])})}}}function FD(t,e,n=!1){var r=[];return HE(t,e,r,"",n),r}var BD=function(t,e){if(typeof t!="string")throw new TypeError("Expected a string");return e=typeof e>"u"?"_":e,t.replace(/([a-z\d])([A-Z])/g,"$1"+e+"$2").replace(/([A-Z]+)([A-Z][a-z\d]+)/g,"$1"+e+"$2").toLowerCase()};const UD=Xa(BD);var VE={exports:{}};const zD=/[\p{Lu}]/u,qD=/[\p{Ll}]/u,K_=/^[\p{Lu}](?![\p{Lu}])/gu,WE=/([\p{Alpha}\p{N}_]|$)/u,GE=/[_.\- ]+/,HD=new RegExp("^"+GE.source),Q_=new RegExp(GE.source+WE.source,"gu"),X_=new RegExp("\\d+"+WE.source,"gu"),VD=(t,e,n)=>{let r=!1,s=!1,i=!1;for(let a=0;a<t.length;a++){const o=t[a];r&&zD.test(o)?(t=t.slice(0,a)+"-"+t.slice(a),r=!1,i=s,s=!0,a++):s&&i&&qD.test(o)?(t=t.slice(0,a-1)+"-"+t.slice(a-1),i=s,s=!1,r=!0):(r=e(o)===o&&n(o)!==o,i=s,s=n(o)===o&&e(o)!==o)}return t},WD=(t,e)=>(K_.lastIndex=0,t.replace(K_,n=>e(n))),GD=(t,e)=>(Q_.lastIndex=0,X_.lastIndex=0,t.replace(Q_,(n,r)=>e(r)).replace(X_,n=>e(n))),ZE=(t,e)=>{if(!(typeof t=="string"||Array.isArray(t)))throw new TypeError("Expected the input to be `string | string[]`");if(e={pascalCase:!1,preserveConsecutiveUppercase:!1,...e},Array.isArray(t)?t=t.map(i=>i.trim()).filter(i=>i.length).join("-"):t=t.trim(),t.length===0)return"";const n=e.locale===!1?i=>i.toLowerCase():i=>i.toLocaleLowerCase(e.locale),r=e.locale===!1?i=>i.toUpperCase():i=>i.toLocaleUpperCase(e.locale);return t.length===1?e.pascalCase?r(t):n(t):(t!==n(t)&&(t=VD(t,n,r)),t=t.replace(HD,""),e.preserveConsecutiveUppercase?t=WD(t,n):t=n(t),e.pascalCase&&(t=r(t.charAt(0))+t.slice(1)),GD(t,r))};VE.exports=ZE;VE.exports.default=ZE;function ZD(t,e){return e?.[t]||UD(t)}function JD(t,e,n){const r={};for(const s in t)Object.hasOwn(t,s)&&(r[e(s,n)]=t[s]);return r}function Y_(t){return Array.isArray(t)?[...t]:{...t}}function KD(t,e){const n=Y_(t);for(const[r,s]of Object.entries(e)){const[i,...a]=r.split(".").reverse();let o=n;for(const u of a.reverse()){if(o[u]===void 0)break;o[u]=Y_(o[u]),o=o[u]}o[i]!==void 0&&(o[i]={lc:1,type:"secret",id:[s]})}return n}function JE(t){const e=Object.getPrototypeOf(t);return typeof t.lc_name=="function"&&(typeof e.lc_name!="function"||t.lc_name()!==e.lc_name())?t.lc_name():t.name}class Bs{static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,JE(this.constructor)]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}constructor(e,...n){Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.lc_kwargs=e||{}}toJSON(){if(!this.lc_serializable)return this.toJSONNotImplemented();if(this.lc_kwargs instanceof Bs||typeof this.lc_kwargs!="object"||Array.isArray(this.lc_kwargs))return this.toJSONNotImplemented();const e={},n={},r=Object.keys(this.lc_kwargs).reduce((s,i)=>(s[i]=i in this?this[i]:this.lc_kwargs[i],s),{});for(let s=Object.getPrototypeOf(this);s;s=Object.getPrototypeOf(s))Object.assign(e,Reflect.get(s,"lc_aliases",this)),Object.assign(n,Reflect.get(s,"lc_secrets",this)),Object.assign(r,Reflect.get(s,"lc_attributes",this));return Object.keys(n).forEach(s=>{let i=this,a=r;const[o,...u]=s.split(".").reverse();for(const l of u.reverse()){if(!(l in i)||i[l]===void 0)return;(!(l in a)||a[l]===void 0)&&(typeof i[l]=="object"&&i[l]!=null?a[l]={}:Array.isArray(i[l])&&(a[l]=[])),i=i[l],a=a[l]}o in i&&i[o]!==void 0&&(a[o]=a[o]||i[o])}),{lc:1,type:"constructor",id:this.lc_id,kwargs:JD(Object.keys(n).length?KD(r,n):r,ZD,e)}}toJSONNotImplemented(){return{lc:1,type:"not_implemented",id:this.lc_id}}}var QD={};const XD=()=>typeof window<"u"&&typeof window.document<"u",YD=()=>typeof globalThis=="object"&&globalThis.constructor&&globalThis.constructor.name==="DedicatedWorkerGlobalScope",e7=()=>typeof window<"u"&&window.name==="nodejs"||typeof navigator<"u"&&(navigator.userAgent.includes("Node.js")||navigator.userAgent.includes("jsdom")),_y=()=>typeof Deno<"u",t7=()=>typeof process<"u"&&typeof process.versions<"u"&&typeof process.versions.node<"u"&&!_y(),n7=()=>{let t;return XD()?t="browser":t7()?t="node":YD()?t="webworker":e7()?t="jsdom":_y()?t="deno":t="other",t};let pp;async function r7(){return pp===void 0&&(pp={library:"langchain-js",runtime:n7()}),pp}function qe(t){try{return typeof process<"u"?QD?.[t]:_y()?Deno?.env.get(t):void 0}catch{return}}class s7{}function i7(t){return"lc_prefer_streaming"in t&&t.lc_prefer_streaming}class Sl extends s7{get lc_namespace(){return["langchain_core","callbacks",this.name]}get lc_secrets(){}get lc_attributes(){}get lc_aliases(){}static lc_name(){return this.name}get lc_id(){return[...this.lc_namespace,JE(this.constructor)]}constructor(e){super(),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreLLM",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreChain",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreAgent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreRetriever",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ignoreCustomEvent",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"raiseError",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"awaitHandlers",{enumerable:!0,configurable:!0,writable:!0,value:qe("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"}),this.lc_kwargs=e||{},e&&(this.ignoreLLM=e.ignoreLLM??this.ignoreLLM,this.ignoreChain=e.ignoreChain??this.ignoreChain,this.ignoreAgent=e.ignoreAgent??this.ignoreAgent,this.ignoreRetriever=e.ignoreRetriever??this.ignoreRetriever,this.ignoreCustomEvent=e.ignoreCustomEvent??this.ignoreCustomEvent,this.raiseError=e.raiseError??this.raiseError,this.awaitHandlers=this.raiseError||(e._awaitHandler??this.awaitHandlers))}copy(){return new this.constructor(this)}toJSON(){return Bs.prototype.toJSON.call(this)}toJSONNotImplemented(){return Bs.prototype.toJSONNotImplemented.call(this)}static fromMethods(e){class n extends Sl{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Jt()}),Object.assign(this,e)}}return new n}}const a7=t=>{const e=t;return e!==void 0&&typeof e.copy=="function"&&typeof e.name=="string"&&typeof e.awaitHandlers=="boolean"};function mp(t,e){return t&&!Array.isArray(t)&&typeof t=="object"?t:{[e]:t}}function o7(t){return t.replace(/[-:.]/g,"")}function u7(t,e,n){const r=n.toFixed(0).slice(0,3).padStart(3,"0");return o7(`${new Date(t).toISOString().slice(0,-1)}${r}Z`)+e}function Fo(t){return typeof t._addRunToRunMap=="function"}class kl extends Sl{constructor(e){super(...arguments),Object.defineProperty(this,"runMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map})}copy(){return this}stringifyError(e){return e instanceof Error?e.message+(e?.stack?`

${e.stack}`:""):typeof e=="string"?e:`${e}`}_addChildRun(e,n){e.child_runs.push(n)}_addRunToRunMap(e){const n=u7(e.start_time,e.id,e.execution_order),r={...e};if(r.parent_run_id!==void 0){const s=this.runMap.get(r.parent_run_id);s&&(this._addChildRun(s,r),s.child_execution_order=Math.max(s.child_execution_order,r.child_execution_order),r.trace_id=s.trace_id,s.dotted_order!==void 0&&(r.dotted_order=[s.dotted_order,n].join(".")))}else r.trace_id=r.id,r.dotted_order=n;return this.runMap.set(r.id,r),r}async _endTrace(e){const n=e.parent_run_id!==void 0&&this.runMap.get(e.parent_run_id);n?n.child_execution_order=Math.max(n.child_execution_order,e.child_execution_order):await this.persistRun(e),this.runMap.delete(e.id),await this.onRunUpdate?.(e)}_getExecutionOrder(e){const n=e!==void 0&&this.runMap.get(e);return n?n.child_execution_order+1:1}_createRunForLLMStart(e,n,r,s,i,a,o,u){const l=this._getExecutionOrder(s),c=Date.now(),d=o?{...i,metadata:o}:i,f={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{prompts:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:d??{},tags:a||[]};return this._addRunToRunMap(f)}async handleLLMStart(e,n,r,s,i,a,o,u){const l=this.runMap.get(r)??this._createRunForLLMStart(e,n,r,s,i,a,o,u);return await this.onRunCreate?.(l),await this.onLLMStart?.(l),l}_createRunForChatModelStart(e,n,r,s,i,a,o,u){const l=this._getExecutionOrder(s),c=Date.now(),d=o?{...i,metadata:o}:i,f={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:{messages:n},execution_order:l,child_runs:[],child_execution_order:l,run_type:"llm",extra:d??{},tags:a||[]};return this._addRunToRunMap(f)}async handleChatModelStart(e,n,r,s,i,a,o,u){const l=this.runMap.get(r)??this._createRunForChatModelStart(e,n,r,s,i,a,o,u);return await this.onRunCreate?.(l),await this.onLLMStart?.(l),l}async handleLLMEnd(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.outputs=e,r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onLLMEnd?.(r),await this._endTrace(r),r}async handleLLMError(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="llm")throw new Error("No LLM run to end.");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onLLMError?.(r),await this._endTrace(r),r}_createRunForChainStart(e,n,r,s,i,a,o,u){const l=this._getExecutionOrder(s),c=Date.now(),d={id:r,name:u??e.id[e.id.length-1],parent_run_id:s,start_time:c,serialized:e,events:[{name:"start",time:new Date(c).toISOString()}],inputs:n,execution_order:l,child_execution_order:l,run_type:o??"chain",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(d)}async handleChainStart(e,n,r,s,i,a,o,u){const l=this.runMap.get(r)??this._createRunForChainStart(e,n,r,s,i,a,o,u);return await this.onRunCreate?.(l),await this.onChainStart?.(l),l}async handleChainEnd(e,n,r,s,i){const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.outputs=mp(e,"output"),a.events.push({name:"end",time:new Date(a.end_time).toISOString()}),i?.inputs!==void 0&&(a.inputs=mp(i.inputs,"input")),await this.onChainEnd?.(a),await this._endTrace(a),a}async handleChainError(e,n,r,s,i){const a=this.runMap.get(n);if(!a)throw new Error("No chain run to end.");return a.end_time=Date.now(),a.error=this.stringifyError(e),a.events.push({name:"error",time:new Date(a.end_time).toISOString()}),i?.inputs!==void 0&&(a.inputs=mp(i.inputs,"input")),await this.onChainError?.(a),await this._endTrace(a),a}_createRunForToolStart(e,n,r,s,i,a,o){const u=this._getExecutionOrder(s),l=Date.now(),c={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{input:n},execution_order:u,child_execution_order:u,run_type:"tool",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(c)}async handleToolStart(e,n,r,s,i,a,o){const u=this.runMap.get(r)??this._createRunForToolStart(e,n,r,s,i,a,o);return await this.onRunCreate?.(u),await this.onToolStart?.(u),u}async handleToolEnd(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.outputs={output:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onToolEnd?.(r),await this._endTrace(r),r}async handleToolError(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="tool")throw new Error("No tool run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onToolError?.(r),await this._endTrace(r),r}async handleAgentAction(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="chain")return;const s=r;s.actions=s.actions||[],s.actions.push(e),s.events.push({name:"agent_action",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentAction?.(r)}async handleAgentEnd(e,n){const r=this.runMap.get(n);!r||r?.run_type!=="chain"||(r.events.push({name:"agent_end",time:new Date().toISOString(),kwargs:{action:e}}),await this.onAgentEnd?.(r))}_createRunForRetrieverStart(e,n,r,s,i,a,o){const u=this._getExecutionOrder(s),l=Date.now(),c={id:r,name:o??e.id[e.id.length-1],parent_run_id:s,start_time:l,serialized:e,events:[{name:"start",time:new Date(l).toISOString()}],inputs:{query:n},execution_order:u,child_execution_order:u,run_type:"retriever",child_runs:[],extra:a?{metadata:a}:{},tags:i||[]};return this._addRunToRunMap(c)}async handleRetrieverStart(e,n,r,s,i,a,o){const u=this.runMap.get(r)??this._createRunForRetrieverStart(e,n,r,s,i,a,o);return await this.onRunCreate?.(u),await this.onRetrieverStart?.(u),u}async handleRetrieverEnd(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.outputs={documents:e},r.events.push({name:"end",time:new Date(r.end_time).toISOString()}),await this.onRetrieverEnd?.(r),await this._endTrace(r),r}async handleRetrieverError(e,n){const r=this.runMap.get(n);if(!r||r?.run_type!=="retriever")throw new Error("No retriever run to end");return r.end_time=Date.now(),r.error=this.stringifyError(e),r.events.push({name:"error",time:new Date(r.end_time).toISOString()}),await this.onRetrieverError?.(r),await this._endTrace(r),r}async handleText(e,n){const r=this.runMap.get(n);!r||r?.run_type!=="chain"||(r.events.push({name:"text",time:new Date().toISOString(),kwargs:{text:e}}),await this.onText?.(r))}async handleLLMNewToken(e,n,r,s,i,a){const o=this.runMap.get(r);if(!o||o?.run_type!=="llm")throw new Error('Invalid "runId" provided to "handleLLMNewToken" callback.');return o.events.push({name:"new_token",time:new Date().toISOString(),kwargs:{token:e,idx:n,chunk:a?.chunk}}),await this.onLLMNewToken?.(o,e,{chunk:a?.chunk}),o}}var vy={exports:{}};vy.exports;(function(t){const n=(i=0)=>a=>`\x1B[${38+i};5;${a}m`,r=(i=0)=>(a,o,u)=>`\x1B[${38+i};2;${a};${o};${u}m`;function s(){const i=new Map,a={modifier:{reset:[0,0],bold:[1,22],dim:[2,22],italic:[3,23],underline:[4,24],overline:[53,55],inverse:[7,27],hidden:[8,28],strikethrough:[9,29]},color:{black:[30,39],red:[31,39],green:[32,39],yellow:[33,39],blue:[34,39],magenta:[35,39],cyan:[36,39],white:[37,39],blackBright:[90,39],redBright:[91,39],greenBright:[92,39],yellowBright:[93,39],blueBright:[94,39],magentaBright:[95,39],cyanBright:[96,39],whiteBright:[97,39]},bgColor:{bgBlack:[40,49],bgRed:[41,49],bgGreen:[42,49],bgYellow:[43,49],bgBlue:[44,49],bgMagenta:[45,49],bgCyan:[46,49],bgWhite:[47,49],bgBlackBright:[100,49],bgRedBright:[101,49],bgGreenBright:[102,49],bgYellowBright:[103,49],bgBlueBright:[104,49],bgMagentaBright:[105,49],bgCyanBright:[106,49],bgWhiteBright:[107,49]}};a.color.gray=a.color.blackBright,a.bgColor.bgGray=a.bgColor.bgBlackBright,a.color.grey=a.color.blackBright,a.bgColor.bgGrey=a.bgColor.bgBlackBright;for(const[o,u]of Object.entries(a)){for(const[l,c]of Object.entries(u))a[l]={open:`\x1B[${c[0]}m`,close:`\x1B[${c[1]}m`},u[l]=a[l],i.set(c[0],c[1]);Object.defineProperty(a,o,{value:u,enumerable:!1})}return Object.defineProperty(a,"codes",{value:i,enumerable:!1}),a.color.close="\x1B[39m",a.bgColor.close="\x1B[49m",a.color.ansi256=n(),a.color.ansi16m=r(),a.bgColor.ansi256=n(10),a.bgColor.ansi16m=r(10),Object.defineProperties(a,{rgbToAnsi256:{value:(o,u,l)=>o===u&&u===l?o<8?16:o>248?231:Math.round((o-8)/247*24)+232:16+36*Math.round(o/255*5)+6*Math.round(u/255*5)+Math.round(l/255*5),enumerable:!1},hexToRgb:{value:o=>{const u=/(?<colorString>[a-f\d]{6}|[a-f\d]{3})/i.exec(o.toString(16));if(!u)return[0,0,0];let{colorString:l}=u.groups;l.length===3&&(l=l.split("").map(d=>d+d).join(""));const c=Number.parseInt(l,16);return[c>>16&255,c>>8&255,c&255]},enumerable:!1},hexToAnsi256:{value:o=>a.rgbToAnsi256(...a.hexToRgb(o)),enumerable:!1}}),a}Object.defineProperty(t,"exports",{enumerable:!0,get:s})})(vy);var l7=vy.exports;const KE=Xa(l7);function Nt(t,e){return`${t.open}${e}${t.close}`}function _n(t,e){try{return JSON.stringify(t,null,2)}catch{return e}}function ev(t){return typeof t=="string"?t.trim():t==null?t:_n(t,t.toString())}function os(t){if(!t.end_time)return"";const e=t.end_time-t.start_time;return e<1e3?`${e}ms`:`${(e/1e3).toFixed(2)}s`}const{color:Ht}=KE;class tv extends kl{constructor(){super(...arguments),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"console_callback_handler"})}persistRun(e){return Promise.resolve()}getParents(e){const n=[];let r=e;for(;r.parent_run_id;){const s=this.runMap.get(r.parent_run_id);if(s)n.push(s),r=s;else break}return n}getBreadcrumbs(e){const r=[...this.getParents(e).reverse(),e].map((s,i,a)=>{const o=`${s.execution_order}:${s.run_type}:${s.name}`;return i===a.length-1?Nt(KE.bold,o):o}).join(" > ");return Nt(Ht.grey,r)}onChainStart(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.green,"[chain/start]")} [${n}] Entering Chain run with input: ${_n(e.inputs,"[inputs]")}`)}onChainEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.cyan,"[chain/end]")} [${n}] [${os(e)}] Exiting Chain run with output: ${_n(e.outputs,"[outputs]")}`)}onChainError(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.red,"[chain/error]")} [${n}] [${os(e)}] Chain run errored with error: ${_n(e.error,"[error]")}`)}onLLMStart(e){const n=this.getBreadcrumbs(e),r="prompts"in e.inputs?{prompts:e.inputs.prompts.map(s=>s.trim())}:e.inputs;console.log(`${Nt(Ht.green,"[llm/start]")} [${n}] Entering LLM run with input: ${_n(r,"[inputs]")}`)}onLLMEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.cyan,"[llm/end]")} [${n}] [${os(e)}] Exiting LLM run with output: ${_n(e.outputs,"[response]")}`)}onLLMError(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.red,"[llm/error]")} [${n}] [${os(e)}] LLM run errored with error: ${_n(e.error,"[error]")}`)}onToolStart(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.green,"[tool/start]")} [${n}] Entering Tool run with input: "${ev(e.inputs.input)}"`)}onToolEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.cyan,"[tool/end]")} [${n}] [${os(e)}] Exiting Tool run with output: "${ev(e.outputs?.output)}"`)}onToolError(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.red,"[tool/error]")} [${n}] [${os(e)}] Tool run errored with error: ${_n(e.error,"[error]")}`)}onRetrieverStart(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.green,"[retriever/start]")} [${n}] Entering Retriever run with input: ${_n(e.inputs,"[inputs]")}`)}onRetrieverEnd(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.cyan,"[retriever/end]")} [${n}] [${os(e)}] Exiting Retriever run with output: ${_n(e.outputs,"[outputs]")}`)}onRetrieverError(e){const n=this.getBreadcrumbs(e);console.log(`${Nt(Ht.red,"[retriever/error]")} [${n}] [${os(e)}] Retriever run errored with error: ${_n(e.error,"[error]")}`)}onAgentAction(e){const n=e,r=this.getBreadcrumbs(e);console.log(`${Nt(Ht.blue,"[agent/action]")} [${r}] Agent selected action: ${_n(n.actions[n.actions.length-1],"[action]")}`)}}function QE(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function XE(t){return!!(t&&typeof t=="object"&&"type"in t&&t.type==="tool_call")}class c7 extends Error{constructor(e,n){super(e),Object.defineProperty(this,"output",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.output=n}}function nv(t,e=xy){t=t.trim();const n=/```(json)?(.*)```/s.exec(t);return e(n?n[2]:t)}function xy(t){if(typeof t>"u")return null;try{return JSON.parse(t)}catch{}let e="";const n=[];let r=!1,s=!1;for(let i of t){if(r)i==='"'&&!s?r=!1:i===`
`&&!s?i="\\n":i==="\\"?s=!s:s=!1;else if(i==='"')r=!0,s=!1;else if(i==="{")n.push("}");else if(i==="[")n.push("]");else if(i==="}"||i==="]")if(n[n.length-1]===i)n.pop();else return null;e+=i}r&&(e+='"');for(let i=n.length-1;i>=0;i-=1)e+=n[i];try{return JSON.parse(e)}catch{return null}}function po(t,e){return typeof t=="string"?typeof e=="string"?t+e:[{type:"text",text:t},...e]:Array.isArray(e)?Jf(t,e)??[...t,...e]:[...t,{type:"text",text:e}]}function d7(t,e){return t==="error"||e==="error"?"error":"success"}function f7(t,e){function n(r,s){if(typeof r!="object"||r===null||r===void 0)return r;if(s>=e)return Array.isArray(r)?"[Array]":"[Object]";if(Array.isArray(r))return r.map(a=>n(a,s+1));const i={};for(const a of Object.keys(r))i[a]=n(r[a],s+1);return i}return JSON.stringify(n(t,0),null,2)}class mo extends Bs{get lc_aliases(){return{additional_kwargs:"additional_kwargs",response_metadata:"response_metadata"}}get text(){return typeof this.content=="string"?this.content:""}getType(){return this._getType()}constructor(e,n){typeof e=="string"&&(e={content:e,additional_kwargs:n,response_metadata:{}}),e.additional_kwargs||(e.additional_kwargs={}),e.response_metadata||(e.response_metadata={}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","messages"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"content",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"additional_kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"response_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.content=e.content,this.additional_kwargs=e.additional_kwargs,this.response_metadata=e.response_metadata,this.id=e.id}toDict(){return{type:this._getType(),data:this.toJSON().kwargs}}static lc_name(){return"BaseMessage"}get _printableFields(){return{id:this.id,content:this.content,name:this.name,additional_kwargs:this.additional_kwargs,response_metadata:this.response_metadata}}_updateId(e){this.id=e,this.lc_kwargs.id=e}get[Symbol.toStringTag](){return this.constructor.lc_name()}[Symbol.for("nodejs.util.inspect.custom")](e){if(e===null)return this;const n=f7(this._printableFields,Math.max(4,e));return`${this.constructor.lc_name()} ${n}`}}function Ft(t,e){const n={...t};for(const[r,s]of Object.entries(e))if(n[r]==null)n[r]=s;else{if(s==null)continue;if(typeof n[r]!=typeof s||Array.isArray(n[r])!==Array.isArray(s))throw new Error(`field[${r}] already exists in the message chunk, but with a different type.`);if(typeof n[r]=="string"){if(r==="type")continue;n[r]+=s}else if(typeof n[r]=="object"&&!Array.isArray(n[r]))n[r]=Ft(n[r],s);else if(Array.isArray(n[r]))n[r]=Jf(n[r],s);else{if(n[r]===s)continue;console.warn(`field[${r}] already exists in this message chunk and value has unsupported type.`)}}return n}function Jf(t,e){if(!(t===void 0&&e===void 0)){if(t===void 0||e===void 0)return t||e;{const n=[...t];for(const r of e)if(typeof r=="object"&&"index"in r&&typeof r.index=="number"){const s=n.findIndex(i=>i.index===r.index);s!==-1?n[s]=Ft(n[s],r):n.push(r)}else{if(typeof r=="object"&&"text"in r&&r.text==="")continue;n.push(r)}return n}}}function h7(t,e){if(!t&&!e)throw new Error("Cannot merge two undefined objects.");if(!t||!e)return t||e;if(typeof t!=typeof e)throw new Error(`Cannot merge objects of different types.
Left ${typeof t}
Right ${typeof e}`);if(typeof t=="string"&&typeof e=="string")return t+e;if(Array.isArray(t)&&Array.isArray(e))return Jf(t,e);if(typeof t=="object"&&typeof e=="object")return Ft(t,e);if(t===e)return t;throw new Error(`Can not merge objects of different types.
Left ${t}
Right ${e}`)}class go extends mo{}function p7(t){return typeof t.role=="string"}function Sy(t){return typeof t?._getType=="function"}function m7(t){return Sy(t)&&typeof t.concat=="function"}class g7 extends mo{static lc_name(){return"ToolMessage"}get lc_aliases(){return{tool_call_id:"tool_call_id"}}constructor(e,n,r){typeof e=="string"&&(e={content:e,name:r,tool_call_id:n}),super(e),Object.defineProperty(this,"lc_direct_tool_output",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}_getType(){return"tool"}static isInstance(e){return e._getType()==="tool"}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}class ky extends go{constructor(e){super(e),Object.defineProperty(this,"tool_call_id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"status",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"artifact",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_id=e.tool_call_id,this.artifact=e.artifact,this.status=e.status}static lc_name(){return"ToolMessageChunk"}_getType(){return"tool"}concat(e){return new ky({content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),artifact:h7(this.artifact,e.artifact),tool_call_id:this.tool_call_id,id:this.id??e.id,status:d7(this.status,e.status)})}get _printableFields(){return{...super._printableFields,tool_call_id:this.tool_call_id,artifact:this.artifact}}}function y7(t){const e=[],n=[];for(const r of t)if(r.function){const s=r.function.name;try{const i=JSON.parse(r.function.arguments),a={name:s||"",args:i||{},id:r.id};e.push(a)}catch{n.push({name:s,args:r.function.arguments,id:r.id,error:"Malformed args."})}}else continue;return[e,n]}class el extends mo{get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls"}}constructor(e,n){let r;if(typeof e=="string")r={content:e,tool_calls:[],invalid_tool_calls:[],additional_kwargs:n??{}};else{r=e;const s=r.additional_kwargs?.tool_calls,i=r.tool_calls;s!=null&&s.length>0&&(i===void 0||i.length===0)&&console.warn(["New LangChain packages are available that more efficiently handle",`tool calling.

Please upgrade your packages to versions that set`,"message tool calls. e.g., `yarn add @langchain/anthropic`,","yarn add @langchain/openai`, etc."].join(" "));try{if(s!=null&&i===void 0){const[a,o]=y7(s);r.tool_calls=a??[],r.invalid_tool_calls=o??[]}else r.tool_calls=r.tool_calls??[],r.invalid_tool_calls=r.invalid_tool_calls??[]}catch{r.tool_calls=[],r.invalid_tool_calls=[]}}super(r),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof r!="string"&&(this.tool_calls=r.tool_calls??this.tool_calls,this.invalid_tool_calls=r.invalid_tool_calls??this.invalid_tool_calls),this.usage_metadata=r.usage_metadata}static lc_name(){return"AIMessage"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}}function Ey(t){return t._getType()==="ai"}function rv(t){return t._getType()==="ai"}class $i extends go{constructor(e){let n;if(typeof e=="string")n={content:e,tool_calls:[],invalid_tool_calls:[],tool_call_chunks:[]};else if(e.tool_call_chunks===void 0)n={...e,tool_calls:e.tool_calls??[],invalid_tool_calls:[],tool_call_chunks:[],usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0};else{const r=[],s=[];for(const i of e.tool_call_chunks){let a={};try{if(a=xy(i.args||"{}"),a===null||typeof a!="object"||Array.isArray(a))throw new Error("Malformed tool call chunk args.");r.push({name:i.name??"",args:a,id:i.id,type:"tool_call"})}catch{s.push({name:i.name,args:i.args,id:i.id,error:"Malformed args.",type:"invalid_tool_call"})}}n={...e,tool_calls:r,invalid_tool_calls:s,usage_metadata:e.usage_metadata!==void 0?e.usage_metadata:void 0}}super(n),Object.defineProperty(this,"tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"invalid_tool_calls",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tool_call_chunks",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"usage_metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.tool_call_chunks=n.tool_call_chunks??this.tool_call_chunks,this.tool_calls=n.tool_calls??this.tool_calls,this.invalid_tool_calls=n.invalid_tool_calls??this.invalid_tool_calls,this.usage_metadata=n.usage_metadata}get lc_aliases(){return{...super.lc_aliases,tool_calls:"tool_calls",invalid_tool_calls:"invalid_tool_calls",tool_call_chunks:"tool_call_chunks"}}static lc_name(){return"AIMessageChunk"}_getType(){return"ai"}get _printableFields(){return{...super._printableFields,tool_calls:this.tool_calls,tool_call_chunks:this.tool_call_chunks,invalid_tool_calls:this.invalid_tool_calls,usage_metadata:this.usage_metadata}}concat(e){const n={content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),tool_call_chunks:[],id:this.id??e.id};if(this.tool_call_chunks!==void 0||e.tool_call_chunks!==void 0){const r=Jf(this.tool_call_chunks,e.tool_call_chunks);r!==void 0&&r.length>0&&(n.tool_call_chunks=r)}if(this.usage_metadata!==void 0||e.usage_metadata!==void 0){const r={...(this.usage_metadata?.input_token_details?.audio!==void 0||e.usage_metadata?.input_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.input_token_details?.audio??0)+(e.usage_metadata?.input_token_details?.audio??0)},...(this.usage_metadata?.input_token_details?.cache_read!==void 0||e.usage_metadata?.input_token_details?.cache_read!==void 0)&&{cache_read:(this.usage_metadata?.input_token_details?.cache_read??0)+(e.usage_metadata?.input_token_details?.cache_read??0)},...(this.usage_metadata?.input_token_details?.cache_creation!==void 0||e.usage_metadata?.input_token_details?.cache_creation!==void 0)&&{cache_creation:(this.usage_metadata?.input_token_details?.cache_creation??0)+(e.usage_metadata?.input_token_details?.cache_creation??0)}},s={...(this.usage_metadata?.output_token_details?.audio!==void 0||e.usage_metadata?.output_token_details?.audio!==void 0)&&{audio:(this.usage_metadata?.output_token_details?.audio??0)+(e.usage_metadata?.output_token_details?.audio??0)},...(this.usage_metadata?.output_token_details?.reasoning!==void 0||e.usage_metadata?.output_token_details?.reasoning!==void 0)&&{reasoning:(this.usage_metadata?.output_token_details?.reasoning??0)+(e.usage_metadata?.output_token_details?.reasoning??0)}},i=this.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},a=e.usage_metadata??{input_tokens:0,output_tokens:0,total_tokens:0},o={input_tokens:i.input_tokens+a.input_tokens,output_tokens:i.output_tokens+a.output_tokens,total_tokens:i.total_tokens+a.total_tokens,...Object.keys(r).length>0&&{input_token_details:r},...Object.keys(s).length>0&&{output_token_details:s}};n.usage_metadata=o}return new $i(n)}}class El extends mo{static lc_name(){return"ChatMessage"}static _chatMessageClass(){return El}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}static isInstance(e){return e._getType()==="generic"}get _printableFields(){return{...super._printableFields,role:this.role}}}class Kf extends go{static lc_name(){return"ChatMessageChunk"}constructor(e,n){typeof e=="string"&&(e={content:e,role:n}),super(e),Object.defineProperty(this,"role",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.role=e.role}_getType(){return"generic"}concat(e){return new Kf({content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),role:this.role,id:this.id??e.id})}get _printableFields(){return{...super._printableFields,role:this.role}}}class Qf extends go{static lc_name(){return"FunctionMessageChunk"}_getType(){return"function"}concat(e){return new Qf({content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),name:this.name??"",id:this.id??e.id})}}class wi extends mo{static lc_name(){return"HumanMessage"}_getType(){return"human"}}class Xf extends go{static lc_name(){return"HumanMessageChunk"}_getType(){return"human"}concat(e){return new Xf({content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),id:this.id??e.id})}}class hu extends mo{static lc_name(){return"SystemMessage"}_getType(){return"system"}}class tl extends go{static lc_name(){return"SystemMessageChunk"}_getType(){return"system"}concat(e){return new tl({content:po(this.content,e.content),additional_kwargs:Ft(this.additional_kwargs,e.additional_kwargs),response_metadata:Ft(this.response_metadata,e.response_metadata),id:this.id??e.id})}}function b7(t){return XE(t)?t:typeof t.id=="string"&&t.type==="function"&&typeof t.function=="object"&&t.function!==null&&"arguments"in t.function&&typeof t.function.arguments=="string"&&"name"in t.function&&typeof t.function.name=="string"?{id:t.id,args:JSON.parse(t.function.arguments),name:t.function.name,type:"tool_call"}:t}function w7(t){return typeof t=="object"&&t!=null&&t.lc===1&&Array.isArray(t.id)&&t.kwargs!=null&&typeof t.kwargs=="object"}function gp(t){let e,n;if(w7(t)){const r=t.id.at(-1);r==="HumanMessage"||r==="HumanMessageChunk"?e="user":r==="AIMessage"||r==="AIMessageChunk"?e="assistant":r==="SystemMessage"||r==="SystemMessageChunk"?e="system":e="unknown",n=t.kwargs}else{const{type:r,...s}=t;e=r,n=s}if(e==="human"||e==="user")return new wi(n);if(e==="ai"||e==="assistant"){const{tool_calls:r,...s}=n;if(!Array.isArray(r))return new el(n);const i=r.map(b7);return new el({...s,tool_calls:i})}else{if(e==="system")return new hu(n);if(e==="developer")return new hu({...n,additional_kwargs:{...n.additional_kwargs,__openai_role__:"developer"}});if(e==="tool"&&"tool_call_id"in n)return new g7({...n,content:n.content,tool_call_id:n.tool_call_id,name:n.name});throw QE(new Error(`Unable to coerce message from array: only human, AI, system, developer, or tool message coercion is currently supported.

Received: ${JSON.stringify(t,null,2)}`),"MESSAGE_COERCION_FAILURE")}}function Zo(t){if(typeof t=="string")return new wi(t);if(Sy(t))return t;if(Array.isArray(t)){const[e,n]=t;return gp({type:e,content:n})}else if(p7(t)){const{role:e,...n}=t;return gp({...n,type:e})}else return gp(t)}function YE(t,e="Human",n="AI"){const r=[];for(const s of t){let i;if(s._getType()==="human")i=e;else if(s._getType()==="ai")i=n;else if(s._getType()==="system")i="System";else if(s._getType()==="function")i="Function";else if(s._getType()==="tool")i="Tool";else if(s._getType()==="generic")i=s.role;else throw new Error(`Got unsupported message type: ${s._getType()}`);const a=s.name?`${s.name}, `:"",o=typeof s.content=="string"?s.content:JSON.stringify(s.content,null,2);r.push(`${i}: ${a}${o}`)}return r.join(`
`)}function _7(t){const e=t._getType();if(e==="human")return new Xf({...t});if(e==="ai"){let n={...t};return"tool_calls"in n&&(n={...n,tool_call_chunks:n.tool_calls?.map(r=>({...r,type:"tool_call_chunk",index:void 0,args:JSON.stringify(r.args)}))}),new $i({...n})}else{if(e==="system")return new tl({...t});if(e==="function")return new Qf({...t});if(El.isInstance(t))return new Kf({...t});throw new Error("Unknown message type.")}}let yp;const v7=()=>{if(yp===void 0){const t=qe("LANGCHAIN_CALLBACKS_BACKGROUND")==="false"?{blockOnRootRunFinalization:!0}:{};yp=new Yu(t)}return yp};class pu extends kl{constructor(e={}){super(e),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"langchain_tracer"}),Object.defineProperty(this,"projectName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"exampleId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0});const{exampleId:n,projectName:r,client:s}=e;this.projectName=r??qe("LANGCHAIN_PROJECT")??qe("LANGCHAIN_SESSION"),this.exampleId=n,this.client=s??v7();const i=pu.getTraceableRunTree();i&&this.updateFromRunTree(i)}async _convertToCreate(e,n=void 0){return{...e,extra:{...e.extra,runtime:await r7()},child_runs:void 0,session_name:this.projectName,reference_example_id:e.parent_run_id?void 0:n}}async persistRun(e){}async onRunCreate(e){const n=await this._convertToCreate(e,this.exampleId);await this.client.createRun(n)}async onRunUpdate(e){const n={end_time:e.end_time,error:e.error,outputs:e.outputs,events:e.events,inputs:e.inputs,trace_id:e.trace_id,dotted_order:e.dotted_order,parent_run_id:e.parent_run_id};await this.client.updateRun(e.id,n)}getRun(e){return this.runMap.get(e)}updateFromRunTree(e){let n=e;const r=new Set;for(;n.parent_run&&!(r.has(n.id)||(r.add(n.id),!n.parent_run));)n=n.parent_run;r.clear();const s=[n];for(;s.length>0;){const i=s.shift();!i||r.has(i.id)||(r.add(i.id),this.runMap.set(i.id,i),i.child_runs&&s.push(...i.child_runs))}this.client=e.client??this.client,this.projectName=e.project_name??this.projectName,this.exampleId=e.reference_example_id??this.exampleId}convertToRunTree(e){const n={},r=[];for(const[s,i]of this.runMap){const a=new un({...i,child_runs:[],parent_run:void 0,client:this.client,project_name:this.projectName,reference_example_id:this.exampleId,tracingEnabled:!0});n[s]=a,r.push([s,i.dotted_order])}r.sort((s,i)=>!s[1]||!i[1]?0:s[1].localeCompare(i[1]));for(const[s]of r){const i=this.runMap.get(s),a=n[s];if(!(!i||!a)&&i.parent_run_id){const o=n[i.parent_run_id];o&&(o.child_runs.push(a),a.parent_run=o)}}return n[e]}static getTraceableRunTree(){try{return RD()}catch{return}}}const e3=Symbol.for("ls:tracing_async_local_storage"),Gc=Symbol.for("lc:context_variables"),x7=t=>{globalThis[e3]=t},nl=()=>globalThis[e3];let mu;function S7(){const t="default"in Gr?Gr.default:Gr;return new t({autoStart:!0,concurrency:1})}function k7(){return typeof mu>"u"&&(mu=S7()),mu}async function lt(t,e){if(e===!0){const n=nl();n!==void 0?await n.run(void 0,async()=>t()):await t()}else mu=k7(),mu.add(async()=>{const n=nl();n!==void 0?await n.run(void 0,async()=>t()):await t()})}const E7=t=>!!["LANGSMITH_TRACING_V2","LANGCHAIN_TRACING_V2","LANGSMITH_TRACING","LANGCHAIN_TRACING"].find(n=>qe(n)==="true");function t3(t){const e=nl();return e===void 0?void 0:e.getStore()?.[Gc]?.[t]}const A7=Symbol("lc:configure_hooks"),T7=()=>t3(A7)||[];function C7(t){return t?Array.isArray(t)||"name"in t?{callbacks:t}:t:{}}class P7{setHandler(e){return this.setHandlers([e])}}class Yf{constructor(e,n,r,s,i,a,o,u){Object.defineProperty(this,"runId",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:s}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:o}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:u})}get parentRunId(){return this._parentRunId}async handleText(e){await Promise.all(this.handlers.map(n=>lt(async()=>{try{await n.handleText?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleText: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}async handleCustomEvent(e,n,r,s,i){await Promise.all(this.handlers.map(a=>lt(async()=>{try{await a.handleCustomEvent?.(e,n,this.runId,this.tags,this.metadata)}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleCustomEvent: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}}class O7 extends Yf{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleRetrieverEnd(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreRetriever)try{await n.handleRetrieverEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetriever`),n.raiseError)throw r}},n.awaitHandlers)))}async handleRetrieverError(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreRetriever)try{await n.handleRetrieverError?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleRetrieverError: ${r}`),n.raiseError)throw e}},n.awaitHandlers)))}}class sv extends Yf{async handleLLMNewToken(e,n,r,s,i,a){await Promise.all(this.handlers.map(o=>lt(async()=>{if(!o.ignoreLLM)try{await o.handleLLMNewToken?.(e,n??{prompt:0,completion:0},this.runId,this._parentRunId,this.tags,a)}catch(u){if((o.raiseError?console.error:console.warn)(`Error in handler ${o.constructor.name}, handleLLMNewToken: ${u}`),o.raiseError)throw u}},o.awaitHandlers)))}async handleLLMError(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreLLM)try{await n.handleLLMError?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMError: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}async handleLLMEnd(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreLLM)try{await n.handleLLMEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleLLMEnd: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}}class N7 extends Yf{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleChainError(e,n,r,s,i){await Promise.all(this.handlers.map(a=>lt(async()=>{if(!a.ignoreChain)try{await a.handleChainError?.(e,this.runId,this._parentRunId,this.tags,i)}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainError: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}async handleChainEnd(e,n,r,s,i){await Promise.all(this.handlers.map(a=>lt(async()=>{if(!a.ignoreChain)try{await a.handleChainEnd?.(e,this.runId,this._parentRunId,this.tags,i)}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleChainEnd: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}async handleAgentAction(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreAgent)try{await n.handleAgentAction?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentAction: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}async handleAgentEnd(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreAgent)try{await n.handleAgentEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleAgentEnd: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}}class I7 extends Yf{getChild(e){const n=new Lt(this.runId);return n.setHandlers(this.inheritableHandlers),n.addTags(this.inheritableTags),n.addMetadata(this.inheritableMetadata),e&&n.addTags([e],!1),n}async handleToolError(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreAgent)try{await n.handleToolError?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolError: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}async handleToolEnd(e){await Promise.all(this.handlers.map(n=>lt(async()=>{if(!n.ignoreAgent)try{await n.handleToolEnd?.(e,this.runId,this._parentRunId,this.tags)}catch(r){if((n.raiseError?console.error:console.warn)(`Error in handler ${n.constructor.name}, handleToolEnd: ${r}`),n.raiseError)throw r}},n.awaitHandlers)))}}class Lt extends P7{constructor(e,n){super(),Object.defineProperty(this,"handlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableHandlers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"inheritableTags",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"inheritableMetadata",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"callback_manager"}),Object.defineProperty(this,"_parentRunId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.handlers=n?.handlers??this.handlers,this.inheritableHandlers=n?.inheritableHandlers??this.inheritableHandlers,this.tags=n?.tags??this.tags,this.inheritableTags=n?.inheritableTags??this.inheritableTags,this.metadata=n?.metadata??this.metadata,this.inheritableMetadata=n?.inheritableMetadata??this.inheritableMetadata,this._parentRunId=e}getParentRunId(){return this._parentRunId}async handleLLMStart(e,n,r=void 0,s=void 0,i=void 0,a=void 0,o=void 0,u=void 0){return Promise.all(n.map(async(l,c)=>{const d=c===0&&r?r:Jt();return await Promise.all(this.handlers.map(f=>{if(!f.ignoreLLM)return Fo(f)&&f._createRunForLLMStart(e,[l],d,this._parentRunId,i,this.tags,this.metadata,u),lt(async()=>{try{await f.handleLLMStart?.(e,[l],d,this._parentRunId,i,this.tags,this.metadata,u)}catch(h){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleLLMStart: ${h}`),f.raiseError)throw h}},f.awaitHandlers)})),new sv(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChatModelStart(e,n,r=void 0,s=void 0,i=void 0,a=void 0,o=void 0,u=void 0){return Promise.all(n.map(async(l,c)=>{const d=c===0&&r?r:Jt();return await Promise.all(this.handlers.map(f=>{if(!f.ignoreLLM)return Fo(f)&&f._createRunForChatModelStart(e,[l],d,this._parentRunId,i,this.tags,this.metadata,u),lt(async()=>{try{if(f.handleChatModelStart)await f.handleChatModelStart?.(e,[l],d,this._parentRunId,i,this.tags,this.metadata,u);else if(f.handleLLMStart){const h=YE(l);await f.handleLLMStart?.(e,[h],d,this._parentRunId,i,this.tags,this.metadata,u)}}catch(h){if((f.raiseError?console.error:console.warn)(`Error in handler ${f.constructor.name}, handleLLMStart: ${h}`),f.raiseError)throw h}},f.awaitHandlers)})),new sv(d,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}))}async handleChainStart(e,n,r=Jt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreChain)return Fo(u)&&u._createRunForChainStart(e,n,r,this._parentRunId,this.tags,this.metadata,s,o),lt(async()=>{try{await u.handleChainStart?.(e,n,r,this._parentRunId,this.tags,this.metadata,s,o)}catch(l){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleChainStart: ${l}`),u.raiseError)throw l}},u.awaitHandlers)})),new N7(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleToolStart(e,n,r=Jt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreAgent)return Fo(u)&&u._createRunForToolStart(e,n,r,this._parentRunId,this.tags,this.metadata,o),lt(async()=>{try{await u.handleToolStart?.(e,n,r,this._parentRunId,this.tags,this.metadata,o)}catch(l){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleToolStart: ${l}`),u.raiseError)throw l}},u.awaitHandlers)})),new I7(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleRetrieverStart(e,n,r=Jt(),s=void 0,i=void 0,a=void 0,o=void 0){return await Promise.all(this.handlers.map(u=>{if(!u.ignoreRetriever)return Fo(u)&&u._createRunForRetrieverStart(e,n,r,this._parentRunId,this.tags,this.metadata,o),lt(async()=>{try{await u.handleRetrieverStart?.(e,n,r,this._parentRunId,this.tags,this.metadata,o)}catch(l){if((u.raiseError?console.error:console.warn)(`Error in handler ${u.constructor.name}, handleRetrieverStart: ${l}`),u.raiseError)throw l}},u.awaitHandlers)})),new O7(r,this.handlers,this.inheritableHandlers,this.tags,this.inheritableTags,this.metadata,this.inheritableMetadata,this._parentRunId)}async handleCustomEvent(e,n,r,s,i){await Promise.all(this.handlers.map(a=>lt(async()=>{if(!a.ignoreCustomEvent)try{await a.handleCustomEvent?.(e,n,r,this.tags,this.metadata)}catch(o){if((a.raiseError?console.error:console.warn)(`Error in handler ${a.constructor.name}, handleCustomEvent: ${o}`),a.raiseError)throw o}},a.awaitHandlers)))}addHandler(e,n=!0){this.handlers.push(e),n&&this.inheritableHandlers.push(e)}removeHandler(e){this.handlers=this.handlers.filter(n=>n!==e),this.inheritableHandlers=this.inheritableHandlers.filter(n=>n!==e)}setHandlers(e,n=!0){this.handlers=[],this.inheritableHandlers=[];for(const r of e)this.addHandler(r,n)}addTags(e,n=!0){this.removeTags(e),this.tags.push(...e),n&&this.inheritableTags.push(...e)}removeTags(e){this.tags=this.tags.filter(n=>!e.includes(n)),this.inheritableTags=this.inheritableTags.filter(n=>!e.includes(n))}addMetadata(e,n=!0){this.metadata={...this.metadata,...e},n&&(this.inheritableMetadata={...this.inheritableMetadata,...e})}removeMetadata(e){for(const n of Object.keys(e))delete this.metadata[n],delete this.inheritableMetadata[n]}copy(e=[],n=!0){const r=new Lt(this._parentRunId);for(const s of this.handlers){const i=this.inheritableHandlers.includes(s);r.addHandler(s,i)}for(const s of this.tags){const i=this.inheritableTags.includes(s);r.addTags([s],i)}for(const s of Object.keys(this.metadata)){const i=Object.keys(this.inheritableMetadata).includes(s);r.addMetadata({[s]:this.metadata[s]},i)}for(const s of e)r.handlers.filter(i=>i.name==="console_callback_handler").some(i=>i.name===s.name)||r.addHandler(s,n);return r}static fromHandlers(e){class n extends Sl{constructor(){super(),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:Jt()}),Object.assign(this,e)}}const r=new this;return r.addHandler(new n),r}static configure(e,n,r,s,i,a,o){return this._configureSync(e,n,r,s,i,a,o)}static _configureSync(e,n,r,s,i,a,o){let u;(e||n)&&(Array.isArray(e)||!e?(u=new Lt,u.setHandlers(e?.map(Wd)??[],!0)):u=e,u=u.copy(Array.isArray(n)?n.map(Wd):n?.handlers,!1));const l=qe("LANGCHAIN_VERBOSE")==="true"||o?.verbose,c=pu.getTraceableRunTree()?.tracingEnabled||E7(),d=c||(qe("LANGCHAIN_TRACING")??!1);if(l||d){if(u||(u=new Lt),l&&!u.handlers.some(f=>f.name===tv.prototype.name)){const f=new tv;u.addHandler(f,!0)}if(d&&!u.handlers.some(f=>f.name==="langchain_tracer")&&c){const f=new pu;u.addHandler(f,!0),u._parentRunId=pu.getTraceableRunTree()?.id??u._parentRunId}}for(const{contextVar:f,inheritable:h=!0,handlerClass:m,envVar:y}of T7()){const w=y&&qe(y)==="true"&&m;let p;const b=f!==void 0?t3(f):void 0;b&&a7(b)?p=b:w&&(p=new m({})),p!==void 0&&(u||(u=new Lt),u.handlers.some(_=>_.name===p.name)||u.addHandler(p,h))}return(r||s)&&u&&(u.addTags(r??[]),u.addTags(s??[],!1)),(i||a)&&u&&(u.addMetadata(i??{}),u.addMetadata(a??{},!1)),u}}function Wd(t){return"name"in t?t:Sl.fromMethods(t)}class R7{getStore(){}run(e,n){return n()}enterWith(e){}}const j7=new R7,iv=Symbol.for("lc:child_config");class $7{getInstance(){return nl()??j7}getRunnableConfig(){return this.getInstance().getStore()?.extra?.[iv]}runWithConfig(e,n,r){const s=Lt._configureSync(e?.callbacks,void 0,e?.tags,void 0,e?.metadata),i=this.getInstance(),a=i.getStore(),o=s?.getParentRunId(),u=s?.handlers?.find(c=>c?.name==="langchain_tracer");let l;return u&&o?l=u.convertToRunTree(o):r||(l=new un({name:"<runnable_lambda>",tracingEnabled:!1})),l&&(l.extra={...l.extra,[iv]:e}),a!==void 0&&a[Gc]!==void 0&&(l[Gc]=a[Gc]),i.run(l,n)}initializeGlobalInstance(e){nl()===void 0&&x7(e)}}const Us=new $7,bp=25;async function Kn(t){return Lt._configureSync(t?.callbacks,void 0,t?.tags,void 0,t?.metadata)}function av(...t){const e={};for(const n of t.filter(r=>!!r))for(const r of Object.keys(n))if(r==="metadata")e[r]={...e[r],...n[r]};else if(r==="tags"){const s=e[r]??[];e[r]=[...new Set(s.concat(n[r]??[]))]}else if(r==="configurable")e[r]={...e[r],...n[r]};else if(r==="timeout")e.timeout===void 0?e.timeout=n.timeout:n.timeout!==void 0&&(e.timeout=Math.min(e.timeout,n.timeout));else if(r==="signal")e.signal===void 0?e.signal=n.signal:n.signal!==void 0&&("any"in AbortSignal?e.signal=AbortSignal.any([e.signal,n.signal]):e.signal=n.signal);else if(r==="callbacks"){const s=e.callbacks,i=n.callbacks;if(Array.isArray(i))if(!s)e.callbacks=i;else if(Array.isArray(s))e.callbacks=s.concat(i);else{const a=s.copy();for(const o of i)a.addHandler(Wd(o),!0);e.callbacks=a}else if(i)if(!s)e.callbacks=i;else if(Array.isArray(s)){const a=i.copy();for(const o of s)a.addHandler(Wd(o),!0);e.callbacks=a}else e.callbacks=new Lt(i._parentRunId,{handlers:s.handlers.concat(i.handlers),inheritableHandlers:s.inheritableHandlers.concat(i.inheritableHandlers),tags:Array.from(new Set(s.tags.concat(i.tags))),inheritableTags:Array.from(new Set(s.inheritableTags.concat(i.inheritableTags))),metadata:{...s.metadata,...i.metadata}})}else{const s=r;e[s]=n[s]??e[s]}return e}const L7=new Set(["string","number","boolean"]);function Se(t){const e=Us.getRunnableConfig();let n={tags:[],metadata:{},recursionLimit:25,runId:void 0};if(e){const{runId:r,runName:s,...i}=e;n=Object.entries(i).reduce((a,[o,u])=>(u!==void 0&&(a[o]=u),a),n)}if(t&&(n=Object.entries(t).reduce((r,[s,i])=>(i!==void 0&&(r[s]=i),r),n)),n?.configurable)for(const r of Object.keys(n.configurable))L7.has(typeof n.configurable[r])&&!n.metadata?.[r]&&(n.metadata||(n.metadata={}),n.metadata[r]=n.configurable[r]);if(n.timeout!==void 0){if(n.timeout<=0)throw new Error("Timeout must be a positive number");const r=AbortSignal.timeout(n.timeout);n.signal!==void 0?"any"in AbortSignal&&(n.signal=AbortSignal.any([n.signal,r])):n.signal=r,delete n.timeout}return n}function Ct(t={},{callbacks:e,maxConcurrency:n,recursionLimit:r,runName:s,configurable:i,runId:a}={}){const o=Se(t);return e!==void 0&&(delete o.runName,o.callbacks=e),r!==void 0&&(o.recursionLimit=r),n!==void 0&&(o.maxConcurrency=n),s!==void 0&&(o.runName=s),i!==void 0&&(o.configurable={...o.configurable,...i}),a!==void 0&&delete o.runId,o}function Va(t){return t?{configurable:t.configurable,recursionLimit:t.recursionLimit,callbacks:t.callbacks,tags:t.tags,metadata:t.metadata,maxConcurrency:t.maxConcurrency,timeout:t.timeout,signal:t.signal}:void 0}async function zs(t,e){if(e===void 0)return t;let n;return Promise.race([t.catch(r=>{if(!e?.aborted)throw r}),new Promise((r,s)=>{n=()=>{s(new Error("Aborted"))},e.addEventListener("abort",n),e.aborted&&s(new Error("Aborted"))})]).finally(()=>e.removeEventListener("abort",n))}class yn extends ReadableStream{constructor(){super(...arguments),Object.defineProperty(this,"reader",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}ensureReader(){this.reader||(this.reader=this.getReader())}async next(){this.ensureReader();try{const e=await this.reader.read();return e.done?(this.reader.releaseLock(),{done:!0,value:void 0}):{done:!1,value:e.value}}catch(e){throw this.reader.releaseLock(),e}}async return(){if(this.ensureReader(),this.locked){const e=this.reader.cancel();this.reader.releaseLock(),await e}return{done:!0,value:void 0}}async throw(e){if(this.ensureReader(),this.locked){const n=this.reader.cancel();this.reader.releaseLock(),await n}throw e}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}static fromReadableStream(e){const n=e.getReader();return new yn({start(r){return s();function s(){return n.read().then(({done:i,value:a})=>{if(i){r.close();return}return r.enqueue(a),s()})}},cancel(){n.releaseLock()}})}static fromAsyncGenerator(e){return new yn({async pull(n){const{value:r,done:s}=await e.next();s&&n.close(),n.enqueue(r)},async cancel(n){await e.return(n)}})}}function n3(t,e=2){const n=Array.from({length:e},()=>[]);return n.map(async function*(s){for(;;)if(s.length===0){const i=await t.next();for(const a of n)a.push(i)}else{if(s[0].done)return;yield s.shift().value}})}function Qn(t,e){if(Array.isArray(t)&&Array.isArray(e))return t.concat(e);if(typeof t=="string"&&typeof e=="string")return t+e;if(typeof t=="number"&&typeof e=="number")return t+e;if("concat"in t&&typeof t.concat=="function")return t.concat(e);if(typeof t=="object"&&typeof e=="object"){const n={...t};for(const[r,s]of Object.entries(e))r in n&&!Array.isArray(n[r])?n[r]=Qn(n[r],s):n[r]=s;return n}else throw new Error(`Cannot concat ${typeof t} and ${typeof e}`)}class yo{constructor(e){Object.defineProperty(this,"generator",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"setup",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"signal",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResult",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"firstResultUsed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.generator=e.generator,this.config=e.config,this.signal=e.signal??this.config?.signal,this.setup=new Promise((n,r)=>{Us.runWithConfig(Va(e.config),async()=>{this.firstResult=e.generator.next(),e.startSetup?this.firstResult.then(e.startSetup).then(n,r):this.firstResult.then(s=>n(void 0),r)},!0)})}async next(...e){return this.signal?.throwIfAborted(),this.firstResultUsed?Us.runWithConfig(Va(this.config),this.signal?async()=>zs(this.generator.next(...e),this.signal):async()=>this.generator.next(...e),!0):(this.firstResultUsed=!0,this.firstResult)}async return(e){return this.generator.return(e)}async throw(e){return this.generator.throw(e)}[Symbol.asyncIterator](){return this}async[Symbol.asyncDispose](){await this.return()}}async function M7(t,e,n,r,...s){const i=new yo({generator:e,startSetup:n,signal:r}),a=await i.setup;return{output:t(i,a,...s),setup:a}}class ms{constructor(e){Object.defineProperty(this,"ops",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.ops=e.ops??[]}concat(e){const n=this.ops.concat(e.ops),r=Hd({},n);return new rl({ops:n,state:r[r.length-1].newDocument})}}class rl extends ms{constructor(e){super(e),Object.defineProperty(this,"state",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.state=e.state}concat(e){const n=this.ops.concat(e.ops),r=Hd(this.state,e.ops);return new rl({ops:n,state:r[r.length-1].newDocument})}static fromRunLogPatch(e){const n=Hd({},e.ops);return new rl({ops:e.ops,state:n[n.length-1].newDocument})}}const D7=t=>t.name==="log_stream_tracer";async function ov(t,e){if(e==="original")throw new Error("Do not assign inputs with original schema drop the key for now. When inputs are added to streamLog they should be added with standardized schema for streaming events.");const{inputs:n}=t;if(["retriever","llm","prompt"].includes(t.run_type))return n;if(!(Object.keys(n).length===1&&n?.input===""))return n.input}async function uv(t,e){const{outputs:n}=t;return e==="original"||["retriever","llm","prompt"].includes(t.run_type)?n:n!==void 0&&Object.keys(n).length===1&&n?.output!==void 0?n.output:n}function F7(t){return t!==void 0&&t.message!==void 0}class lv extends kl{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_schemaFormat",{enumerable:!0,configurable:!0,writable:!0,value:"original"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"keyMapByRunId",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"counterMapByRunName",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"log_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this._schemaFormat=e?._schemaFormat??this._schemaFormat,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=yn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){if(e.id===this.rootId)return!1;const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.run_type)),this.includeTags!==void 0&&(r=r||n.find(s=>this.includeTags?.includes(s))!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.run_type)),this.excludeTags!==void 0&&(r=r&&n.every(s=>!this.excludeTags?.includes(s))),r}async*tapOutputIterable(e,n){for await(const r of n){if(e!==this.rootId){const s=this.keyMapByRunId[e];s&&await this.writer.write(new ms({ops:[{op:"add",path:`/logs/${s}/streamed_output/-`,value:r}]}))}yield r}}async onRunCreate(e){if(this.rootId===void 0&&(this.rootId=e.id,await this.writer.write(new ms({ops:[{op:"replace",path:"",value:{id:e.id,name:e.name,type:e.run_type,streamed_output:[],final_output:void 0,logs:{}}}]}))),!this._includeRun(e))return;this.counterMapByRunName[e.name]===void 0&&(this.counterMapByRunName[e.name]=0),this.counterMapByRunName[e.name]+=1;const n=this.counterMapByRunName[e.name];this.keyMapByRunId[e.id]=n===1?e.name:`${e.name}:${n}`;const r={id:e.id,name:e.name,type:e.run_type,tags:e.tags??[],metadata:e.extra?.metadata??{},start_time:new Date(e.start_time).toISOString(),streamed_output:[],streamed_output_str:[],final_output:void 0,end_time:void 0};this._schemaFormat==="streaming_events"&&(r.inputs=await ov(e,this._schemaFormat)),await this.writer.write(new ms({ops:[{op:"add",path:`/logs/${this.keyMapByRunId[e.id]}`,value:r}]}))}async onRunUpdate(e){try{const n=this.keyMapByRunId[e.id];if(n===void 0)return;const r=[];this._schemaFormat==="streaming_events"&&r.push({op:"replace",path:`/logs/${n}/inputs`,value:await ov(e,this._schemaFormat)}),r.push({op:"add",path:`/logs/${n}/final_output`,value:await uv(e,this._schemaFormat)}),e.end_time!==void 0&&r.push({op:"add",path:`/logs/${n}/end_time`,value:new Date(e.end_time).toISOString()});const s=new ms({ops:r});await this.writer.write(s)}finally{if(e.id===this.rootId){const n=new ms({ops:[{op:"replace",path:"/final_output",value:await uv(e,this._schemaFormat)}]});await this.writer.write(n),this.autoClose&&await this.writer.close()}}}async onLLMNewToken(e,n,r){const s=this.keyMapByRunId[e.id];if(s===void 0)return;const i=e.inputs.messages!==void 0;let a;i?F7(r?.chunk)?a=r?.chunk:a=new $i({id:`run-${e.id}`,content:n}):a=n;const o=new ms({ops:[{op:"add",path:`/logs/${s}/streamed_output_str/-`,value:n},{op:"add",path:`/logs/${s}/streamed_output/-`,value:a}]});await this.writer.write(o)}}const cv="__run";class Wa{constructor(e){Object.defineProperty(this,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"generationInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.text=e.text,this.generationInfo=e.generationInfo}concat(e){return new Wa({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo}})}}class Ga extends Wa{constructor(e){super(e),Object.defineProperty(this,"message",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.message=e.message}concat(e){return new Ga({text:this.text+e.text,generationInfo:{...this.generationInfo,...e.generationInfo},message:this.message.concat(e.message)})}}function bc({name:t,serialized:e}){return t!==void 0?t:e?.name!==void 0?e.name:e?.id!==void 0&&Array.isArray(e?.id)?e.id[e.id.length-1]:"Unnamed"}const B7=t=>t.name==="event_stream_tracer";class U7 extends kl{constructor(e){super({_awaitHandler:!0,...e}),Object.defineProperty(this,"autoClose",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"runInfoMap",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"tappedPromises",{enumerable:!0,configurable:!0,writable:!0,value:new Map}),Object.defineProperty(this,"transformStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"writer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"receiveStream",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"event_stream_tracer"}),Object.defineProperty(this,"lc_prefer_streaming",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.autoClose=e?.autoClose??!0,this.includeNames=e?.includeNames,this.includeTypes=e?.includeTypes,this.includeTags=e?.includeTags,this.excludeNames=e?.excludeNames,this.excludeTypes=e?.excludeTypes,this.excludeTags=e?.excludeTags,this.transformStream=new TransformStream,this.writer=this.transformStream.writable.getWriter(),this.receiveStream=yn.fromReadableStream(this.transformStream.readable)}[Symbol.asyncIterator](){return this.receiveStream}async persistRun(e){}_includeRun(e){const n=e.tags??[];let r=this.includeNames===void 0&&this.includeTags===void 0&&this.includeTypes===void 0;return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(e.runType)),this.includeTags!==void 0&&(r=r||n.find(s=>this.includeTags?.includes(s))!==void 0),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(e.runType)),this.excludeTags!==void 0&&(r=r&&n.every(s=>!this.excludeTags?.includes(s))),r}async*tapOutputIterable(e,n){const r=await n.next();if(r.done)return;const s=this.runInfoMap.get(e);if(s===void 0){yield r.value;return}function i(o,u){return o==="llm"&&typeof u=="string"?new Wa({text:u}):u}let a=this.tappedPromises.get(e);if(a===void 0){let o;a=new Promise(u=>{o=u}),this.tappedPromises.set(e,a);try{const u={event:`on_${s.runType}_stream`,run_id:e,name:s.name,tags:s.tags,metadata:s.metadata,data:{}};await this.send({...u,data:{chunk:i(s.runType,r.value)}},s),yield r.value;for await(const l of n)s.runType!=="tool"&&s.runType!=="retriever"&&await this.send({...u,data:{chunk:i(s.runType,l)}},s),yield l}finally{o()}}else{yield r.value;for await(const o of n)yield o}}async send(e,n){this._includeRun(n)&&await this.writer.write(e)}async sendEndEvent(e,n){const r=this.tappedPromises.get(e.run_id);r!==void 0?r.then(()=>{this.send(e,n)}):await this.send(e,n)}async onLLMStart(e){const n=bc(e),r=e.inputs.messages!==void 0?"chat_model":"llm",s={tags:e.tags??[],metadata:e.extra?.metadata??{},name:n,runType:r,inputs:e.inputs};this.runInfoMap.set(e.id,s);const i=`on_${r}_start`;await this.send({event:i,data:{input:e.inputs},name:n,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},s)}async onLLMNewToken(e,n,r){const s=this.runInfoMap.get(e.id);let i,a;if(s===void 0)throw new Error(`onLLMNewToken: Run ID ${e.id} not found in run map.`);if(this.runInfoMap.size!==1){if(s.runType==="chat_model")a="on_chat_model_stream",r?.chunk===void 0?i=new $i({content:n,id:`run-${e.id}`}):i=r.chunk.message;else if(s.runType==="llm")a="on_llm_stream",r?.chunk===void 0?i=new Wa({text:n}):i=r.chunk;else throw new Error(`Unexpected run type ${s.runType}`);await this.send({event:a,data:{chunk:i},run_id:e.id,name:s.name,tags:s.tags,metadata:s.metadata},s)}}async onLLMEnd(e){const n=this.runInfoMap.get(e.id);this.runInfoMap.delete(e.id);let r;if(n===void 0)throw new Error(`onLLMEnd: Run ID ${e.id} not found in run map.`);const s=e.outputs?.generations;let i;if(n.runType==="chat_model"){for(const a of s??[]){if(i!==void 0)break;i=a[0]?.message}r="on_chat_model_end"}else if(n.runType==="llm")i={generations:s?.map(a=>a.map(o=>({text:o.text,generationInfo:o.generationInfo}))),llmOutput:e.outputs?.llmOutput??{}},r="on_llm_end";else throw new Error(`onLLMEnd: Unexpected run type: ${n.runType}`);await this.sendEndEvent({event:r,data:{output:i,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onChainStart(e){const n=bc(e),r=e.run_type??"chain",s={tags:e.tags??[],metadata:e.extra?.metadata??{},name:n,runType:e.run_type};let i={};e.inputs.input===""&&Object.keys(e.inputs).length===1?(i={},s.inputs={}):e.inputs.input!==void 0?(i.input=e.inputs.input,s.inputs=e.inputs.input):(i.input=e.inputs,s.inputs=e.inputs),this.runInfoMap.set(e.id,s),await this.send({event:`on_${r}_start`,data:i,name:n,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},s)}async onChainEnd(e){const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onChainEnd: Run ID ${e.id} not found in run map.`);const r=`on_${e.run_type}_end`,s=e.inputs??n.inputs??{},a={output:e.outputs?.output??e.outputs,input:s};s.input&&Object.keys(s).length===1&&(a.input=s.input,n.inputs=s.input),await this.sendEndEvent({event:r,data:a,run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata??{}},n)}async onToolStart(e){const n=bc(e),r={tags:e.tags??[],metadata:e.extra?.metadata??{},name:n,runType:"tool",inputs:e.inputs??{}};this.runInfoMap.set(e.id,r),await this.send({event:"on_tool_start",data:{input:e.inputs??{}},name:n,run_id:e.id,tags:e.tags??[],metadata:e.extra?.metadata??{}},r)}async onToolEnd(e){const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onToolEnd: Run ID ${e.id} not found in run map.`);if(n.inputs===void 0)throw new Error(`onToolEnd: Run ID ${e.id} is a tool call, and is expected to have traced inputs.`);const r=e.outputs?.output===void 0?e.outputs:e.outputs.output;await this.sendEndEvent({event:"on_tool_end",data:{output:r,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async onRetrieverStart(e){const n=bc(e),s={tags:e.tags??[],metadata:e.extra?.metadata??{},name:n,runType:"retriever",inputs:{query:e.inputs.query}};this.runInfoMap.set(e.id,s),await this.send({event:"on_retriever_start",data:{input:{query:e.inputs.query}},name:n,tags:e.tags??[],run_id:e.id,metadata:e.extra?.metadata??{}},s)}async onRetrieverEnd(e){const n=this.runInfoMap.get(e.id);if(this.runInfoMap.delete(e.id),n===void 0)throw new Error(`onRetrieverEnd: Run ID ${e.id} not found in run map.`);await this.sendEndEvent({event:"on_retriever_end",data:{output:e.outputs?.documents??e.outputs,input:n.inputs},run_id:e.id,name:n.name,tags:n.tags,metadata:n.metadata},n)}async handleCustomEvent(e,n,r){const s=this.runInfoMap.get(r);if(s===void 0)throw new Error(`handleCustomEvent: Run ID ${r} not found in run map.`);await this.send({event:"on_custom_event",run_id:r,name:e,tags:s.tags,metadata:s.metadata,data:n},s)}async finish(){const e=[...this.tappedPromises.values()];Promise.all(e).finally(()=>{this.writer.close()})}}const z7=[400,401,402,403,404,405,406,407,409],q7=t=>{if(t.message.startsWith("Cancel")||t.message.startsWith("AbortError")||t.name==="AbortError"||t?.code==="ECONNABORTED")throw t;const e=t?.response?.status??t?.status;if(e&&z7.includes(+e))throw t;if(t?.error?.code==="insufficient_quota"){const n=new Error(t?.message);throw n.name="InsufficientQuotaError",n}};class eh{constructor(e){Object.defineProperty(this,"maxConcurrency",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxRetries",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"queue",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.maxConcurrency=e.maxConcurrency??1/0,this.maxRetries=e.maxRetries??6,this.onFailedAttempt=e.onFailedAttempt??q7;const n="default"in Gr?Gr.default:Gr;this.queue=new n({concurrency:this.maxConcurrency})}call(e,...n){return this.queue.add(()=>Ud(()=>e(...n).catch(r=>{throw r instanceof Error?r:new Error(r)}),{onFailedAttempt:this.onFailedAttempt,retries:this.maxRetries,randomize:!0}),{throwOnTimeout:!0})}callWithOptions(e,n,...r){return e.signal?Promise.race([this.call(n,...r),new Promise((s,i)=>{e.signal?.addEventListener("abort",()=>{i(new Error("AbortError"))})})]):this.call(n,...r)}fetch(...e){return this.call(()=>fetch(...e).then(n=>n.ok?n:Promise.reject(n)))}}class r3 extends kl{constructor({config:e,onStart:n,onEnd:r,onError:s}){super({_awaitHandler:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:"RootListenersTracer"}),Object.defineProperty(this,"rootId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnStart",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnEnd",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"argOnError",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.config=e,this.argOnStart=n,this.argOnEnd=r,this.argOnError=s}persistRun(e){return Promise.resolve()}async onRunCreate(e){this.rootId||(this.rootId=e.id,this.argOnStart&&await this.argOnStart(e,this.config))}async onRunUpdate(e){e.id===this.rootId&&(e.error?this.argOnError&&await this.argOnError(e,this.config):this.argOnEnd&&await this.argOnEnd(e,this.config))}}function Ay(t){return t?t.lc_runnable:!1}class H7{constructor(e){Object.defineProperty(this,"includeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"includeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeNames",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTypes",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"excludeTags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.includeNames=e.includeNames,this.includeTypes=e.includeTypes,this.includeTags=e.includeTags,this.excludeNames=e.excludeNames,this.excludeTypes=e.excludeTypes,this.excludeTags=e.excludeTags}includeEvent(e,n){let r=this.includeNames===void 0&&this.includeTypes===void 0&&this.includeTags===void 0;const s=e.tags??[];return this.includeNames!==void 0&&(r=r||this.includeNames.includes(e.name)),this.includeTypes!==void 0&&(r=r||this.includeTypes.includes(n)),this.includeTags!==void 0&&(r=r||s.some(i=>this.includeTags?.includes(i))),this.excludeNames!==void 0&&(r=r&&!this.excludeNames.includes(e.name)),this.excludeTypes!==void 0&&(r=r&&!this.excludeTypes.includes(n)),this.excludeTags!==void 0&&(r=r&&s.every(i=>!this.excludeTags?.includes(i))),r}}const V7=Symbol("Let zodToJsonSchema decide on which parser to use"),W7={name:void 0,$refStrategy:"root",basePath:["#"],effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,definitions:{},errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},G7=t=>({...W7,...t}),Z7=t=>{const e=G7(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[s._def,{def:s._def,path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function s3(t,e,n,r){r?.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function Oe(t,e,n,r,s){t[e]=n,s3(t,e,r,s)}function J7(){return{}}function K7(t,e){const n={type:"array"};return t.type?._def&&t.type?._def?.typeName!==P.ZodAny&&(n.items=Ae(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Oe(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Oe(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Oe(n,"minItems",t.exactLength.value,t.exactLength.message,e),Oe(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function Q7(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Oe(n,"minimum",r.value,r.message,e):Oe(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Oe(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Oe(n,"maximum",r.value,r.message,e):Oe(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Oe(n,"maximum",r.value,r.message,e));break;case"multipleOf":Oe(n,"multipleOf",r.value,r.message,e);break}return n}function X7(){return{type:"boolean"}}function i3(t,e){return Ae(t.type._def,e)}const Y7=(t,e)=>Ae(t.innerType._def,e);function a3(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>a3(t,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return eF(t,e)}}const eF=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":Oe(n,"minimum",r.value,r.message,e);break;case"max":Oe(n,"maximum",r.value,r.message,e);break}return n};function tF(t,e){return{...Ae(t.innerType._def,e),default:t.defaultValue()}}function nF(t,e){return e.effectStrategy==="input"?Ae(t.schema._def,e):{}}function rF(t){return{type:"string",enum:Array.from(t.values)}}const sF=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function iF(t,e){const n=[Ae(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),Ae(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(sF(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...u}=i;a=u}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function aF(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let wp;const Rn={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(wp===void 0&&(wp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),wp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv4Cidr:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\/(3[0-2]|[12]?[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,ipv6Cidr:/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))\/(12[0-8]|1[01][0-9]|[1-9]?[0-9])$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,base64url:/^([0-9a-zA-Z-_]{4})*(([0-9a-zA-Z-_]{2}(==)?)|([0-9a-zA-Z-_]{3}(=)?))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/,jwt:/^[A-Za-z0-9-_]+\.[A-Za-z0-9-_]+\.[A-Za-z0-9-_]*$/};function o3(t,e){const n={type:"string"};if(t.checks)for(const r of t.checks)switch(r.kind){case"min":Oe(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e);break;case"max":Oe(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"email":switch(e.emailStrategy){case"format:email":jn(n,"email",r.message,e);break;case"format:idn-email":jn(n,"idn-email",r.message,e);break;case"pattern:zod":It(n,Rn.email,r.message,e);break}break;case"url":jn(n,"uri",r.message,e);break;case"uuid":jn(n,"uuid",r.message,e);break;case"regex":It(n,r.regex,r.message,e);break;case"cuid":It(n,Rn.cuid,r.message,e);break;case"cuid2":It(n,Rn.cuid2,r.message,e);break;case"startsWith":It(n,RegExp(`^${_p(r.value,e)}`),r.message,e);break;case"endsWith":It(n,RegExp(`${_p(r.value,e)}$`),r.message,e);break;case"datetime":jn(n,"date-time",r.message,e);break;case"date":jn(n,"date",r.message,e);break;case"time":jn(n,"time",r.message,e);break;case"duration":jn(n,"duration",r.message,e);break;case"length":Oe(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,r.value):r.value,r.message,e),Oe(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,r.value):r.value,r.message,e);break;case"includes":{It(n,RegExp(_p(r.value,e)),r.message,e);break}case"ip":{r.version!=="v6"&&jn(n,"ipv4",r.message,e),r.version!=="v4"&&jn(n,"ipv6",r.message,e);break}case"base64url":It(n,Rn.base64url,r.message,e);break;case"jwt":It(n,Rn.jwt,r.message,e);break;case"cidr":{r.version!=="v6"&&It(n,Rn.ipv4Cidr,r.message,e),r.version!=="v4"&&It(n,Rn.ipv6Cidr,r.message,e);break}case"emoji":It(n,Rn.emoji(),r.message,e);break;case"ulid":{It(n,Rn.ulid,r.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{jn(n,"binary",r.message,e);break}case"contentEncoding:base64":{Oe(n,"contentEncoding","base64",r.message,e);break}case"pattern:zod":{It(n,Rn.base64,r.message,e);break}}break}case"nanoid":It(n,Rn.nanoid,r.message,e)}return n}function _p(t,e){return e.patternStrategy==="escape"?uF(t):t}const oF=new Set("ABCDEFGHIJKLMNOPQRSTUVXYZabcdefghijklmnopqrstuvxyz0123456789");function uF(t){let e="";for(let n=0;n<t.length;n++)oF.has(t[n])||(e+="\\"),e+=t[n];return e}function jn(t,e,n,r){t.format||t.anyOf?.some(s=>s.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Oe(t,"format",e,n,r)}function It(t,e,n,r){t.pattern||t.allOf?.some(s=>s.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:dv(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Oe(t,"pattern",dv(e,r),n,r)}function dv(t,e){if(!e.applyRegexFlags||!t.flags)return t.source;const n={i:t.flags.includes("i"),m:t.flags.includes("m"),s:t.flags.includes("s")},r=n.i?t.source.toLowerCase():t.source;let s="",i=!1,a=!1,o=!1;for(let u=0;u<r.length;u++){if(i){s+=r[u],i=!1;continue}if(n.i){if(a){if(r[u].match(/[a-z]/)){o?(s+=r[u],s+=`${r[u-2]}-${r[u]}`.toUpperCase(),o=!1):r[u+1]==="-"&&r[u+2]?.match(/[a-z]/)?(s+=r[u],o=!0):s+=`${r[u]}${r[u].toUpperCase()}`;continue}}else if(r[u].match(/[a-z]/)){s+=`[${r[u]}${r[u].toUpperCase()}]`;continue}}if(n.m){if(r[u]==="^"){s+=`(^|(?<=[\r
]))`;continue}else if(r[u]==="$"){s+=`($|(?=[\r
]))`;continue}}if(n.s&&r[u]==="."){s+=a?`${r[u]}\r
`:`[${r[u]}\r
]`;continue}s+=r[u],r[u]==="\\"?i=!0:a&&r[u]==="]"?a=!1:!a&&r[u]==="["&&(a=!0)}try{new RegExp(s)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),t.source}return s}function u3(t,e){if(e.target==="openAi"&&console.warn("Warning: OpenAI may not support records in schemas! Try an array of key-value pairs instead."),e.target==="openApi3"&&t.keyType?._def.typeName===P.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((r,s)=>({...r,[s]:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",s]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(t.keyType?._def.typeName===P.ZodString&&t.keyType._def.checks?.length){const{type:r,...s}=o3(t.keyType._def,e);return{...n,propertyNames:s}}else{if(t.keyType?._def.typeName===P.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};if(t.keyType?._def.typeName===P.ZodBranded&&t.keyType._def.type._def.typeName===P.ZodString&&t.keyType._def.type._def.checks?.length){const{type:r,...s}=i3(t.keyType._def,e);return{...n,propertyNames:s}}}return n}function lF(t,e){if(e.mapStrategy==="record")return u3(t,e);const n=Ae(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function cF(t){const e=t.values,r=Object.keys(t.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function dF(){return{not:{}}}function fF(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const Gd={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function hF(t,e){if(e.target==="openApi3")return fv(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in Gd&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=Gd[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return fv(t,e)}const fv=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,s)=>Ae(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function pF(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"?{type:Gd[t.innerType._def.typeName],nullable:!0}:{type:[Gd[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function mF(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",s3(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Oe(n,"minimum",r.value,r.message,e):Oe(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Oe(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Oe(n,"maximum",r.value,r.message,e):Oe(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Oe(n,"maximum",r.value,r.message,e));break;case"multipleOf":Oe(n,"multipleOf",r.value,r.message,e);break}return n}function gF(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":Ae(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":Ae(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function yF(t,e){const n=e.target==="openAi",r={type:"object",...Object.entries(t.shape()).reduce((s,[i,a])=>{if(a===void 0||a._def===void 0)return s;let o=a.isOptional();o&&n&&(a instanceof Jn&&(a=a._def.innerType),a.isNullable()||(a=a.nullable()),o=!1);const u=Ae(a._def,{...e,currentPath:[...e.currentPath,"properties",i],propertyPath:[...e.currentPath,"properties",i]});return u===void 0?s:{properties:{...s.properties,[i]:u},required:o?s.required:[...s.required,i]}},{properties:{},required:[]}),additionalProperties:gF(t,e)};return r.required.length||delete r.required,r}const bF=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return Ae(t.innerType._def,e);const n=Ae(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},wF=(t,e)=>{if(e.pipeStrategy==="input")return Ae(t.in._def,e);if(e.pipeStrategy==="output")return Ae(t.out._def,e);const n=Ae(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=Ae(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function _F(t,e){return Ae(t.type._def,e)}function vF(t,e){const r={type:"array",uniqueItems:!0,items:Ae(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Oe(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Oe(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function xF(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>Ae(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:Ae(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>Ae(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function SF(){return{not:{}}}function kF(){return{}}const EF=(t,e)=>Ae(t.innerType._def,e);function Ae(t,e,n=!1){const r=e.seen.get(t);if(e.override){const a=e.override?.(t,e,r,n);if(a!==V7)return a}if(r&&!n){const a=AF(r,e);if(a!==void 0)return a}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const i=CF(t,t.typeName,e);return i&&PF(t,e,i),s.jsonSchema=i,i}const AF=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"relative":return{$ref:TF(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((n,r)=>e.currentPath[r]===n)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},TF=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},CF=(t,e,n)=>{switch(e){case P.ZodString:return o3(t,n);case P.ZodNumber:return mF(t,n);case P.ZodObject:return yF(t,n);case P.ZodBigInt:return Q7(t,n);case P.ZodBoolean:return X7();case P.ZodDate:return a3(t,n);case P.ZodUndefined:return SF();case P.ZodNull:return fF(n);case P.ZodArray:return K7(t,n);case P.ZodUnion:case P.ZodDiscriminatedUnion:return hF(t,n);case P.ZodIntersection:return iF(t,n);case P.ZodTuple:return xF(t,n);case P.ZodRecord:return u3(t,n);case P.ZodLiteral:return aF(t,n);case P.ZodEnum:return rF(t);case P.ZodNativeEnum:return cF(t);case P.ZodNullable:return pF(t,n);case P.ZodOptional:return bF(t,n);case P.ZodMap:return lF(t,n);case P.ZodSet:return vF(t,n);case P.ZodLazy:return Ae(t.getter()._def,n);case P.ZodPromise:return _F(t,n);case P.ZodNaN:case P.ZodNever:return dF();case P.ZodEffects:return nF(t,n);case P.ZodAny:return J7();case P.ZodUnknown:return kF();case P.ZodDefault:return tF(t,n);case P.ZodBranded:return i3(t,n);case P.ZodReadonly:return EF(t,n);case P.ZodCatch:return Y7(t,n);case P.ZodPipeline:return wF(t,n);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return(r=>{})()}},PF=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),Al=(t,e)=>{const n=Z7(e),r=void 0,s=e?.name,i=Ae(t._def,n,!1)??{},a=s===void 0?r?{...i,[n.definitionPath]:r}:i:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,s].join("/"),[n.definitionPath]:{...r,[s]:i}};return n.target==="jsonSchema7"?a.$schema="http://json-schema.org/draft-07/schema#":(n.target==="jsonSchema2019-09"||n.target==="openAi")&&(a.$schema="https://json-schema.org/draft/2019-09/schema#"),n.target==="openAi"&&("anyOf"in a||"oneOf"in a||"allOf"in a||"type"in a&&Array.isArray(a.type))&&console.warn("Warning: OpenAI may not support schemas with unions as roots! Try wrapping it in an object property."),a};function vp(t){return t.replace(/[^a-zA-Z-_0-9]/g,"_")}const OF=["*","_","`"];function NF(t){let e="";for(const[n,r]of Object.entries(t))e+=`	classDef ${n} ${r};
`;return e}function IF(t,e,n){const{firstNode:r,lastNode:s,nodeColors:i,withStyles:a=!0,curveStyle:o="linear",wrapLabelNWords:u=9}=n;let l=a?`%%{init: {'flowchart': {'curve': '${o}'}}}%%
graph TD;
`:`graph TD;
`;if(a){const h="default",m={[h]:"{0}({1})"};r!==void 0&&(m[r]="{0}([{1}]):::first"),s!==void 0&&(m[s]="{0}([{1}]):::last");for(const[y,w]of Object.entries(t)){const p=w.name.split(":").pop()??"";let _=OF.some(S=>p.startsWith(S)&&p.endsWith(S))?`<p>${p}</p>`:p;Object.keys(w.metadata??{}).length&&(_+=`<hr/><small><em>${Object.entries(w.metadata??{}).map(([S,E])=>`${S} = ${E}`).join(`
`)}</em></small>`);const x=(m[y]??m[h]).replace("{0}",vp(y)).replace("{1}",_);l+=`	${x}
`}}const c={};for(const h of e){const m=h.source.split(":"),y=h.target.split(":"),w=m.filter((p,b)=>p===y[b]).join(":");c[w]||(c[w]=[]),c[w].push(h)}const d=new Set;function f(h,m){const y=h.length===1&&h[0].source===h[0].target;if(m&&!y){const w=m.split(":").pop();if(d.has(w))throw new Error(`Found duplicate subgraph '${w}' -- this likely means that you're reusing a subgraph node with the same name. Please adjust your graph to have subgraph nodes with unique names.`);d.add(w),l+=`	subgraph ${w}
`}for(const w of h){const{source:p,target:b,data:_,conditional:x}=w;let S="";if(_!==void 0){let E=_;const k=E.split(" ");k.length>u&&(E=Array.from({length:Math.ceil(k.length/u)},(T,$)=>k.slice($*u,($+1)*u).join(" ")).join("&nbsp;<br>&nbsp;")),S=x?` -. &nbsp;${E}&nbsp; .-> `:` -- &nbsp;${E}&nbsp; --> `}else S=x?" -.-> ":" --> ";l+=`	${vp(p)}${S}${vp(b)};
`}for(const w in c)w.startsWith(`${m}:`)&&w!==m&&f(c[w],w);m&&!y&&(l+=`	end
`)}f(c[""]??[],"");for(const h in c)!h.includes(":")&&h!==""&&f(c[h],h);return a&&(l+=NF(i??{})),l}async function RF(t,e){let{backgroundColor:n="white"}=e;const r=btoa(t);n!==void 0&&(/^#(?:[0-9a-fA-F]{3}){1,2}$/.test(n)||(n=`!${n}`));const s=`https://mermaid.ink/img/${r}?bgColor=${n}`,i=await fetch(s);if(!i.ok)throw new Error(["Failed to render the graph using the Mermaid.INK API.",`Status code: ${i.status}`,`Status text: ${i.statusText}`].join(`
`));return await i.blob()}function jF(t,e){if(t!==void 0&&!du(t))return t;if(Ay(e))try{let n=e.getName();return n=n.startsWith("Runnable")?n.slice(8):n,n}catch{return e.getName()}else return e.name??"UnknownSchema"}function $F(t){return Ay(t.data)?{type:"runnable",data:{id:t.data.lc_id,name:t.data.getName()}}:{type:"schema",data:{...Al(t.data.schema),title:t.data.name}}}class th{constructor(e){Object.defineProperty(this,"nodes",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(this,"edges",{enumerable:!0,configurable:!0,writable:!0,value:[]}),this.nodes=e?.nodes??this.nodes,this.edges=e?.edges??this.edges}toJSON(){const e={};return Object.values(this.nodes).forEach((n,r)=>{e[n.id]=du(n.id)?r:n.id}),{nodes:Object.values(this.nodes).map(n=>({id:e[n.id],...$F(n)})),edges:this.edges.map(n=>{const r={source:e[n.source],target:e[n.target]};return typeof n.data<"u"&&(r.data=n.data),typeof n.conditional<"u"&&(r.conditional=n.conditional),r})}}addNode(e,n,r){if(n!==void 0&&this.nodes[n]!==void 0)throw new Error(`Node with id ${n} already exists`);const s=n??Jt(),i={id:s,data:e,name:jF(n,e),metadata:r};return this.nodes[s]=i,i}removeNode(e){delete this.nodes[e.id],this.edges=this.edges.filter(n=>n.source!==e.id&&n.target!==e.id)}addEdge(e,n,r,s){if(this.nodes[e.id]===void 0)throw new Error(`Source node ${e.id} not in graph`);if(this.nodes[n.id]===void 0)throw new Error(`Target node ${n.id} not in graph`);const i={source:e.id,target:n.id,data:r,conditional:s};return this.edges.push(i),i}firstNode(){return hv(this)}lastNode(){return pv(this)}extend(e,n=""){let r=n;Object.values(e.nodes).map(l=>l.id).every(du)&&(r="");const i=l=>r?`${r}:${l}`:l;Object.entries(e.nodes).forEach(([l,c])=>{this.nodes[i(l)]={...c,id:i(l)}});const a=e.edges.map(l=>({...l,source:i(l.source),target:i(l.target)}));this.edges=[...this.edges,...a];const o=e.firstNode(),u=e.lastNode();return[o?{id:i(o.id),data:o.data}:void 0,u?{id:i(u.id),data:u.data}:void 0]}trimFirstNode(){const e=this.firstNode();e&&hv(this,[e.id])&&this.removeNode(e)}trimLastNode(){const e=this.lastNode();e&&pv(this,[e.id])&&this.removeNode(e)}reid(){const e=Object.fromEntries(Object.values(this.nodes).map(s=>[s.id,s.name])),n=new Map;Object.values(e).forEach(s=>{n.set(s,(n.get(s)||0)+1)});const r=s=>{const i=e[s];return du(s)&&n.get(i)===1?i:s};return new th({nodes:Object.fromEntries(Object.entries(this.nodes).map(([s,i])=>[r(s),{...i,id:r(s)}])),edges:this.edges.map(s=>({...s,source:r(s.source),target:r(s.target)}))})}drawMermaid(e){const{withStyles:n,curveStyle:r,nodeColors:s={default:"fill:#f2f0ff,line-height:1.2",first:"fill-opacity:0",last:"fill:#bfb6fc"},wrapLabelNWords:i}=e??{},a=this.reid(),o=a.firstNode(),u=a.lastNode();return IF(a.nodes,a.edges,{firstNode:o?.id,lastNode:u?.id,withStyles:n,curveStyle:r,nodeColors:s,wrapLabelNWords:i})}async drawMermaidPng(e){const n=this.drawMermaid(e);return RF(n,{backgroundColor:e?.backgroundColor})}}function hv(t,e=[]){const n=new Set(t.edges.filter(s=>!e.includes(s.source)).map(s=>s.target)),r=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function pv(t,e=[]){const n=new Set(t.edges.filter(s=>!e.includes(s.target)).map(s=>s.source)),r=[];for(const s of Object.values(t.nodes))!e.includes(s.id)&&!n.has(s.id)&&r.push(s);return r.length===1?r[0]:void 0}function LF(t){const e=new TextEncoder,n=new ReadableStream({async start(r){for await(const s of t)r.enqueue(e.encode(`event: data
data: ${JSON.stringify(s)}

`));r.enqueue(e.encode(`event: end

`)),r.close()}});return yn.fromReadableStream(n)}function mv(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.iterator]=="function"&&typeof t.next=="function"}const MF=t=>t!=null&&typeof t=="object"&&"next"in t&&typeof t.next=="function";function pg(t){return typeof t=="object"&&t!==null&&typeof t[Symbol.asyncIterator]=="function"}function*gv(t,e){for(;;){const{value:n,done:r}=Us.runWithConfig(Va(t),e.next.bind(e),!0);if(r)break;yield n}}async function*mg(t,e){const n=e[Symbol.asyncIterator]();for(;;){const{value:r,done:s}=await Us.runWithConfig(Va(t),n.next.bind(e),!0);if(s)break;yield r}}function gt(t,e){return t&&!Array.isArray(t)&&!(t instanceof Date)&&typeof t=="object"?t:{[e]:t}}class it extends Bs{constructor(){super(...arguments),Object.defineProperty(this,"lc_runnable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0})}getName(e){const n=this.name??this.constructor.lc_name()??this.constructor.name;return e?`${n}${e}`:n}bind(e){return new _i({bound:this,kwargs:e,config:{}})}map(){return new Zd({bound:this})}withRetry(e){return new DF({bound:this,kwargs:{},config:{},maxAttemptNumber:e?.stopAfterAttempt,...e})}withConfig(e){return new _i({bound:this,config:e,kwargs:{}})}withFallbacks(e){const n=Array.isArray(e)?e:e.fallbacks;return new BF({runnable:this,fallbacks:n})}_getOptionsList(e,n=0){if(Array.isArray(e)&&e.length!==n)throw new Error(`Passed "options" must be an array with the same length as the inputs, but got ${e.length} options for ${n} inputs`);if(Array.isArray(e))return e.map(Se);if(n>1&&!Array.isArray(e)&&e.runId){console.warn("Provided runId will be used only for the first element of the batch.");const r=Object.fromEntries(Object.entries(e).filter(([s])=>s!=="runId"));return Array.from({length:n},(s,i)=>Se(i===0?e:r))}return Array.from({length:n},()=>Se(e))}async batch(e,n,r){const s=this._getOptionsList(n??{},e.length),i=s[0]?.maxConcurrency??r?.maxConcurrency,a=new eh({maxConcurrency:i,onFailedAttempt:u=>{throw u}}),o=e.map((u,l)=>a.call(async()=>{try{return await this.invoke(u,s[l])}catch(c){if(r?.returnExceptions)return c;throw c}}));return Promise.all(o)}async*_streamIterator(e,n){yield this.invoke(e,n)}async stream(e,n){const r=Se(n),s=new yo({generator:this._streamIterator(e,r),config:r});return await s.setup,yn.fromAsyncGenerator(s)}_separateRunnableConfigFromCallOptions(e){let n;e===void 0?n=Se(e):n=Se({callbacks:e.callbacks,tags:e.tags,metadata:e.metadata,runName:e.runName,configurable:e.configurable,recursionLimit:e.recursionLimit,maxConcurrency:e.maxConcurrency,runId:e.runId,timeout:e.timeout,signal:e.signal});const r={...e};return delete r.callbacks,delete r.tags,delete r.metadata,delete r.runName,delete r.configurable,delete r.recursionLimit,delete r.maxConcurrency,delete r.runId,delete r.timeout,delete r.signal,[n,r]}async _callWithConfig(e,n,r){const s=Se(r),a=await(await Kn(s))?.handleChainStart(this.toJSON(),gt(n,"input"),s.runId,s?.runType,void 0,void 0,s?.runName??this.getName());delete s.runId;let o;try{const u=e.call(this,n,s,a);o=await zs(u,r?.signal)}catch(u){throw await a?.handleChainError(u),u}return await a?.handleChainEnd(gt(o,"output")),o}async _batchWithConfig(e,n,r,s){const i=this._getOptionsList(r??{},n.length),a=await Promise.all(i.map(Kn)),o=await Promise.all(a.map(async(l,c)=>{const d=await l?.handleChainStart(this.toJSON(),gt(n[c],"input"),i[c].runId,i[c].runType,void 0,void 0,i[c].runName??this.getName());return delete i[c].runId,d}));let u;try{const l=e.call(this,n,i,o,s);u=await zs(l,i?.[0]?.signal)}catch(l){throw await Promise.all(o.map(c=>c?.handleChainError(l))),l}return await Promise.all(o.map(l=>l?.handleChainEnd(gt(u,"output")))),u}async*_transformStreamWithConfig(e,n,r){let s,i=!0,a,o=!0;const u=Se(r),l=await Kn(u);async function*c(){for await(const f of e){if(i)if(s===void 0)s=f;else try{s=Qn(s,f)}catch{s=void 0,i=!1}yield f}}let d;try{const f=await M7(n.bind(this),c(),async()=>l?.handleChainStart(this.toJSON(),{input:""},u.runId,u.runType,void 0,void 0,u.runName??this.getName()),r?.signal,u);delete u.runId,d=f.setup;const h=d?.handlers.find(B7);let m=f.output;h!==void 0&&d!==void 0&&(m=h.tapOutputIterable(d.runId,m));const y=d?.handlers.find(D7);y!==void 0&&d!==void 0&&(m=y.tapOutputIterable(d.runId,m));for await(const w of m)if(yield w,o)if(a===void 0)a=w;else try{a=Qn(a,w)}catch{a=void 0,o=!1}}catch(f){throw await d?.handleChainError(f,void 0,void 0,void 0,{inputs:gt(s,"input")}),f}await d?.handleChainEnd(a??{},void 0,void 0,void 0,{inputs:gt(s,"input")})}getGraph(e){const n=new th,r=n.addNode({name:`${this.getName()}Input`,schema:bi.any()}),s=n.addNode(this),i=n.addNode({name:`${this.getName()}Output`,schema:bi.any()});return n.addEdge(r,s),n.addEdge(s,i),n}pipe(e){return new Hr({first:this,last:fi(e)})}pick(e){return this.pipe(new UF(e))}assign(e){return this.pipe(new l3(new bo({steps:e})))}async*transform(e,n){let r;for await(const s of e)r===void 0?r=s:r=Qn(r,s);yield*this._streamIterator(r,Se(n))}async*streamLog(e,n,r){const s=new lv({...r,autoClose:!1,_schemaFormat:"original"}),i=Se(n);yield*this._streamLog(e,s,i)}async*_streamLog(e,n,r){const{callbacks:s}=r;if(s===void 0)r.callbacks=[n];else if(Array.isArray(s))r.callbacks=s.concat([n]);else{const u=s.copy();u.addHandler(n,!0),r.callbacks=u}const i=this.stream(e,r);async function a(){try{const u=await i;for await(const l of u){const c=new ms({ops:[{op:"add",path:"/streamed_output/-",value:l}]});await n.writer.write(c)}}finally{await n.writer.close()}}const o=a();try{for await(const u of n)yield u}finally{await o}}streamEvents(e,n,r){let s;if(n.version==="v1")s=this._streamEventsV1(e,n,r);else if(n.version==="v2")s=this._streamEventsV2(e,n,r);else throw new Error('Only versions "v1" and "v2" of the schema are currently supported.');return n.encoding==="text/event-stream"?LF(s):yn.fromAsyncGenerator(s)}async*_streamEventsV2(e,n,r){const s=new U7({...r,autoClose:!1}),i=Se(n),a=i.runId??Jt();i.runId=a;const o=i.callbacks;if(o===void 0)i.callbacks=[s];else if(Array.isArray(o))i.callbacks=o.concat(s);else{const h=o.copy();h.addHandler(s,!0),i.callbacks=h}const u=this;async function l(){try{const h=await u.stream(e,i),m=s.tapOutputIterable(a,h);for await(const y of m);}finally{await s.finish()}}const c=l();let d=!1,f;try{for await(const h of s){if(!d){h.data.input=e,d=!0,f=h.run_id,yield h;continue}h.run_id===f&&h.event.endsWith("_end")&&h.data?.input&&delete h.data.input,yield h}}finally{await c}}async*_streamEventsV1(e,n,r){let s,i=!1;const a=Se(n),o=a.tags??[],u=a.metadata??{},l=a.runName??this.getName(),c=new lv({...r,autoClose:!1,_schemaFormat:"streaming_events"}),d=new H7({...r}),f=this._streamLog(e,c,a);for await(const m of f){if(s?s=s.concat(m):s=rl.fromRunLogPatch(m),s.state===void 0)throw new Error('Internal error: "streamEvents" state is missing. Please open a bug report.');if(!i){i=!0;const b={...s.state},_={run_id:b.id,event:`on_${b.type}_start`,name:l,tags:o,metadata:u,data:{input:e}};d.includeEvent(_,b.type)&&(yield _)}const y=m.ops.filter(b=>b.path.startsWith("/logs/")).map(b=>b.path.split("/")[2]),w=[...new Set(y)];for(const b of w){let _,x={};const S=s.state.logs[b];if(S.end_time===void 0?S.streamed_output.length>0?_="stream":_="start":_="end",_==="start")S.inputs!==void 0&&(x.input=S.inputs);else if(_==="end")S.inputs!==void 0&&(x.input=S.inputs),x.output=S.final_output;else if(_==="stream"){const E=S.streamed_output.length;if(E!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${E} instead. Encountered in: "${S.name}"`);x={chunk:S.streamed_output[0]},S.streamed_output=[]}yield{event:`on_${S.type}_${_}`,name:S.name,run_id:S.id,tags:S.tags,metadata:S.metadata,data:x}}const{state:p}=s;if(p.streamed_output.length>0){const b=p.streamed_output.length;if(b!==1)throw new Error(`Expected exactly one chunk of streamed output, got ${b} instead. Encountered in: "${p.name}"`);const _={chunk:p.streamed_output[0]};p.streamed_output=[];const x={event:`on_${p.type}_stream`,run_id:p.id,tags:o,metadata:u,name:l,data:_};d.includeEvent(x,p.type)&&(yield x)}}const h=s?.state;if(h!==void 0){const m={event:`on_${h.type}_end`,name:l,run_id:h.id,tags:o,metadata:u,data:{output:h.final_output}};d.includeEvent(m,h.type)&&(yield m)}}static isRunnable(e){return Ay(e)}withListeners({onStart:e,onEnd:n,onError:r}){return new _i({bound:this,config:{},configFactories:[s=>({callbacks:[new r3({config:s,onStart:e,onEnd:n,onError:r})]})]})}asTool(e){return zF(this,e)}}class _i extends it{static lc_name(){return"RunnableBinding"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"config",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"kwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"configFactories",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound,this.kwargs=e.kwargs,this.config=e.config,this.configFactories=e.configFactories}getName(e){return this.bound.getName(e)}async _mergeConfig(...e){const n=av(this.config,...e);return av(n,...this.configFactories?await Promise.all(this.configFactories.map(async r=>await r(n))):[])}bind(e){return new this.constructor({bound:this.bound,kwargs:{...this.kwargs,...e},config:this.config})}withConfig(e){return new this.constructor({bound:this.bound,kwargs:this.kwargs,config:{...this.config,...e}})}withRetry(e){return new this.constructor({bound:this.bound.withRetry(e),kwargs:this.kwargs,config:this.config})}async invoke(e,n){return this.bound.invoke(e,await this._mergeConfig(Se(n),this.kwargs))}async batch(e,n,r){const s=Array.isArray(n)?await Promise.all(n.map(async i=>this._mergeConfig(Se(i),this.kwargs))):await this._mergeConfig(Se(n),this.kwargs);return this.bound.batch(e,s,r)}async*_streamIterator(e,n){yield*this.bound._streamIterator(e,await this._mergeConfig(Se(n),this.kwargs))}async stream(e,n){return this.bound.stream(e,await this._mergeConfig(Se(n),this.kwargs))}async*transform(e,n){yield*this.bound.transform(e,await this._mergeConfig(Se(n),this.kwargs))}streamEvents(e,n,r){const s=this,i=async function*(){yield*s.bound.streamEvents(e,{...await s._mergeConfig(Se(n),s.kwargs),version:n.version},r)};return yn.fromAsyncGenerator(i())}static isRunnableBinding(e){return e.bound&&it.isRunnable(e.bound)}withListeners({onStart:e,onEnd:n,onError:r}){return new _i({bound:this.bound,kwargs:this.kwargs,config:this.config,configFactories:[s=>({callbacks:[new r3({config:s,onStart:e,onEnd:n,onError:r})]})]})}}class Zd extends it{static lc_name(){return"RunnableEach"}constructor(e){super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"bound",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.bound=e.bound}bind(e){return new Zd({bound:this.bound.bind(e)})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _invoke(e,n,r){return this.bound.batch(e,Ct(n,{callbacks:r?.getChild()}))}withListeners({onStart:e,onEnd:n,onError:r}){return new Zd({bound:this.bound.withListeners({onStart:e,onEnd:n,onError:r})})}}class DF extends _i{static lc_name(){return"RunnableRetry"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"maxAttemptNumber",{enumerable:!0,configurable:!0,writable:!0,value:3}),Object.defineProperty(this,"onFailedAttempt",{enumerable:!0,configurable:!0,writable:!0,value:()=>{}}),this.maxAttemptNumber=e.maxAttemptNumber??this.maxAttemptNumber,this.onFailedAttempt=e.onFailedAttempt??this.onFailedAttempt}_patchConfigForRetry(e,n,r){const s=e>1?`retry:attempt:${e}`:void 0;return Ct(n,{callbacks:r?.getChild(s)})}async _invoke(e,n,r){return Ud(s=>super.invoke(e,this._patchConfigForRetry(s,n,r)),{onFailedAttempt:s=>this.onFailedAttempt(s,e),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async _batch(e,n,r,s){const i={};try{await Ud(async a=>{const o=e.map((f,h)=>h).filter(f=>i[f.toString()]===void 0||i[f.toString()]instanceof Error),u=o.map(f=>e[f]),l=o.map(f=>this._patchConfigForRetry(a,n?.[f],r?.[f])),c=await super.batch(u,l,{...s,returnExceptions:!0});let d;for(let f=0;f<c.length;f+=1){const h=c[f],m=o[f];h instanceof Error&&d===void 0&&(d=h,d.input=u[f]),i[m.toString()]=h}if(d)throw d;return c},{onFailedAttempt:a=>this.onFailedAttempt(a,a.input),retries:Math.max(this.maxAttemptNumber-1,0),randomize:!0})}catch(a){if(s?.returnExceptions!==!0)throw a}return Object.keys(i).sort((a,o)=>parseInt(a,10)-parseInt(o,10)).map(a=>i[parseInt(a,10)])}async batch(e,n,r){return this._batchWithConfig(this._batch.bind(this),e,n,r)}}class Hr extends it{static lc_name(){return"RunnableSequence"}constructor(e){super(e),Object.defineProperty(this,"first",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"middle",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"last",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"omitSequenceTags",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),this.first=e.first,this.middle=e.middle??this.middle,this.last=e.last,this.name=e.name,this.omitSequenceTags=e.omitSequenceTags??this.omitSequenceTags}get steps(){return[this.first,...this.middle,this.last]}async invoke(e,n){const r=Se(n),i=await(await Kn(r))?.handleChainStart(this.toJSON(),gt(e,"input"),r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;let a=e,o;try{const u=[this.first,...this.middle];for(let l=0;l<u.length;l+=1){const d=u[l].invoke(a,Ct(r,{callbacks:i?.getChild(this.omitSequenceTags?void 0:`seq:step:${l+1}`)}));a=await zs(d,n?.signal)}if(n?.signal?.aborted)throw new Error("Aborted");o=await this.last.invoke(a,Ct(r,{callbacks:i?.getChild(this.omitSequenceTags?void 0:`seq:step:${this.steps.length}`)}))}catch(u){throw await i?.handleChainError(u),u}return await i?.handleChainEnd(gt(o,"output")),o}async batch(e,n,r){const s=this._getOptionsList(n??{},e.length),i=await Promise.all(s.map(Kn)),a=await Promise.all(i.map(async(u,l)=>{const c=await u?.handleChainStart(this.toJSON(),gt(e[l],"input"),s[l].runId,void 0,void 0,void 0,s[l].runName);return delete s[l].runId,c}));let o=e;try{for(let u=0;u<this.steps.length;u+=1){const c=this.steps[u].batch(o,a.map((d,f)=>{const h=d?.getChild(this.omitSequenceTags?void 0:`seq:step:${u+1}`);return Ct(s[f],{callbacks:h})}),r);o=await zs(c,s[0]?.signal)}}catch(u){throw await Promise.all(a.map(l=>l?.handleChainError(u))),u}return await Promise.all(a.map(u=>u?.handleChainEnd(gt(o,"output")))),o}async*_streamIterator(e,n){const r=await Kn(n),{runId:s,...i}=n??{},a=await r?.handleChainStart(this.toJSON(),gt(e,"input"),s,void 0,void 0,void 0,i?.runName),o=[this.first,...this.middle,this.last];let u=!0,l;async function*c(){yield e}try{let d=o[0].transform(c(),Ct(i,{callbacks:a?.getChild(this.omitSequenceTags?void 0:"seq:step:1")}));for(let f=1;f<o.length;f+=1)d=await o[f].transform(d,Ct(i,{callbacks:a?.getChild(this.omitSequenceTags?void 0:`seq:step:${f+1}`)}));for await(const f of d)if(n?.signal?.throwIfAborted(),yield f,u)if(l===void 0)l=f;else try{l=Qn(l,f)}catch{l=void 0,u=!1}}catch(d){throw await a?.handleChainError(d),d}await a?.handleChainEnd(gt(l,"output"))}getGraph(e){const n=new th;let r=null;return this.steps.forEach((s,i)=>{const a=s.getGraph(e);i!==0&&a.trimFirstNode(),i!==this.steps.length-1&&a.trimLastNode(),n.extend(a);const o=a.firstNode();if(!o)throw new Error(`Runnable ${s} has no first node`);r&&n.addEdge(r,o),r=a.lastNode()}),n}pipe(e){return Hr.isRunnableSequence(e)?new Hr({first:this.first,middle:this.middle.concat([this.last,e.first,...e.middle]),last:e.last,name:this.name??e.name}):new Hr({first:this.first,middle:[...this.middle,this.last],last:fi(e),name:this.name})}static isRunnableSequence(e){return Array.isArray(e.middle)&&it.isRunnable(e)}static from([e,...n],r){let s={};return typeof r=="string"?s.name=r:r!==void 0&&(s=r),new Hr({...s,first:fi(e),middle:n.slice(0,-1).map(fi),last:fi(n[n.length-1])})}}class bo extends it{static lc_name(){return"RunnableMap"}getStepsKeys(){return Object.keys(this.steps)}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"steps",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.steps={};for(const[n,r]of Object.entries(e.steps))this.steps[n]=fi(r)}static from(e){return new bo({steps:e})}async invoke(e,n){const r=Se(n),i=await(await Kn(r))?.handleChainStart(this.toJSON(),{input:e},r.runId,void 0,void 0,void 0,r?.runName);delete r.runId;const a={};try{const o=Object.entries(this.steps).map(async([u,l])=>{a[u]=await l.invoke(e,Ct(r,{callbacks:i?.getChild(`map:key:${u}`)}))});await zs(Promise.all(o),n?.signal)}catch(o){throw await i?.handleChainError(o),o}return await i?.handleChainEnd(a),a}async*_transform(e,n,r){const s={...this.steps},i=n3(e,Object.keys(s).length),a=new Map(Object.entries(s).map(([o,u],l)=>{const c=u.transform(i[l],Ct(r,{callbacks:n?.getChild(`map:key:${o}`)}));return[o,c.next().then(d=>({key:o,gen:c,result:d}))]}));for(;a.size;){const o=Promise.race(a.values()),{key:u,result:l,gen:c}=await zs(o,r?.signal);a.delete(u),l.done||(yield{[u]:l.value},a.set(u,c.next().then(d=>({key:u,gen:c,result:d}))))}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=Se(n),i=new yo({generator:this.transform(r(),s),config:s});return await i.setup,yn.fromAsyncGenerator(i)}}class Ty extends it{constructor(e){if(super(e),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),!wy(e.func))throw new Error("RunnableTraceable requires a function that is wrapped in traceable higher-order function");this.func=e.func}async invoke(e,n){const[r]=this._getOptionsList(n??{},1),s=await Kn(r),i=this.func(Ct(r,{callbacks:s}),e);return zs(i,r?.signal)}async*_streamIterator(e,n){const[r]=this._getOptionsList(n??{},1),s=await this.invoke(e,n);if(pg(s)){for await(const i of s)r?.signal?.throwIfAborted(),yield i;return}if(MF(s)){for(;;){r?.signal?.throwIfAborted();const i=s.next();if(i.done)break;yield i.value}return}yield s}static from(e){return new Ty({func:e})}}function FF(t){if(wy(t))throw new Error("RunnableLambda requires a function that is not wrapped in traceable higher-order function. This shouldn't happen.")}class Tl extends it{static lc_name(){return"RunnableLambda"}constructor(e){if(wy(e.func))return Ty.from(e.func);super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),FF(e.func),this.func=e.func}static from(e){return new Tl({func:e})}async _invoke(e,n,r){return new Promise((s,i)=>{const a=Ct(n,{callbacks:r?.getChild(),recursionLimit:(n?.recursionLimit??bp)-1});Us.runWithConfig(Va(a),async()=>{try{let o=await this.func(e,{...a});if(o&&it.isRunnable(o)){if(n?.recursionLimit===0)throw new Error("Recursion limit reached.");o=await o.invoke(e,{...a,recursionLimit:(a.recursionLimit??bp)-1})}else if(pg(o)){let u;for await(const l of mg(a,o))if(n?.signal?.throwIfAborted(),u===void 0)u=l;else try{u=Qn(u,l)}catch{u=l}o=u}else if(mv(o)){let u;for(const l of gv(a,o))if(n?.signal?.throwIfAborted(),u===void 0)u=l;else try{u=Qn(u,l)}catch{u=l}o=u}s(o)}catch(o){i(o)}})})}async invoke(e,n){return this._callWithConfig(this._invoke.bind(this),e,n)}async*_transform(e,n,r){let s;for await(const o of e)if(s===void 0)s=o;else try{s=Qn(s,o)}catch{s=o}const i=Ct(r,{callbacks:n?.getChild(),recursionLimit:(r?.recursionLimit??bp)-1}),a=await new Promise((o,u)=>{Us.runWithConfig(Va(i),async()=>{try{const l=await this.func(s,{...i,config:i});o(l)}catch(l){u(l)}})});if(a&&it.isRunnable(a)){if(r?.recursionLimit===0)throw new Error("Recursion limit reached.");const o=await a.stream(s,i);for await(const u of o)yield u}else if(pg(a))for await(const o of mg(i,a))r?.signal?.throwIfAborted(),yield o;else if(mv(a))for(const o of gv(i,a))r?.signal?.throwIfAborted(),yield o;else yield a}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=Se(n),i=new yo({generator:this.transform(r(),s),config:s});return await i.setup,yn.fromAsyncGenerator(i)}}class BF extends it{static lc_name(){return"RunnableWithFallbacks"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"runnable",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fallbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.runnable=e.runnable,this.fallbacks=e.fallbacks}*runnables(){yield this.runnable;for(const e of this.fallbacks)yield e}async invoke(e,n){const r=Se(n),s=await Kn(r),{runId:i,...a}=r,o=await s?.handleChainStart(this.toJSON(),gt(e,"input"),i,void 0,void 0,void 0,a?.runName),u=Ct(a,{callbacks:o?.getChild()});return await Us.runWithConfig(u,async()=>{let c;for(const d of this.runnables()){r?.signal?.throwIfAborted();try{const f=await d.invoke(e,u);return await o?.handleChainEnd(gt(f,"output")),f}catch(f){c===void 0&&(c=f)}}throw c===void 0?new Error("No error stored at end of fallback."):(await o?.handleChainError(c),c)})}async*_streamIterator(e,n){const r=Se(n),s=await Kn(r),{runId:i,...a}=r,o=await s?.handleChainStart(this.toJSON(),gt(e,"input"),i,void 0,void 0,void 0,a?.runName);let u,l;for(const d of this.runnables()){r?.signal?.throwIfAborted();const f=Ct(a,{callbacks:o?.getChild()});try{const h=await d.stream(e,f);l=mg(f,h);break}catch(h){u===void 0&&(u=h)}}if(l===void 0){const d=u??new Error("No error stored at end of fallback.");throw await o?.handleChainError(d),d}let c;try{for await(const d of l){yield d;try{c=c===void 0?c:Qn(c,d)}catch{c=void 0}}}catch(d){throw await o?.handleChainError(d),d}await o?.handleChainEnd(gt(c,"output"))}async batch(e,n,r){if(r?.returnExceptions)throw new Error("Not implemented.");const s=this._getOptionsList(n??{},e.length),i=await Promise.all(s.map(u=>Kn(u))),a=await Promise.all(i.map(async(u,l)=>{const c=await u?.handleChainStart(this.toJSON(),gt(e[l],"input"),s[l].runId,void 0,void 0,void 0,s[l].runName);return delete s[l].runId,c}));let o;for(const u of this.runnables()){s[0].signal?.throwIfAborted();try{const l=await u.batch(e,a.map((c,d)=>Ct(s[d],{callbacks:c?.getChild()})),r);return await Promise.all(a.map((c,d)=>c?.handleChainEnd(gt(l[d],"output")))),l}catch(l){o===void 0&&(o=l)}}throw o?(await Promise.all(a.map(u=>u?.handleChainError(o))),o):new Error("No error stored at end of fallbacks.")}}function fi(t){if(typeof t=="function")return new Tl({func:t});if(it.isRunnable(t))return t;if(!Array.isArray(t)&&typeof t=="object"){const e={};for(const[n,r]of Object.entries(t))e[n]=fi(r);return new bo({steps:e})}else throw new Error(`Expected a Runnable, function or object.
Instead got an unsupported type.`)}class l3 extends it{static lc_name(){return"RunnableAssign"}constructor(e){e instanceof bo&&(e={mapper:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"mapper",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.mapper=e.mapper}async invoke(e,n){const r=await this.mapper.invoke(e,n);return{...e,...r}}async*_transform(e,n,r){const s=this.mapper.getStepsKeys(),[i,a]=n3(e),o=this.mapper.transform(a,Ct(r,{callbacks:n?.getChild()})),u=o.next();for await(const l of i){if(typeof l!="object"||Array.isArray(l))throw new Error(`RunnableAssign can only be used with objects as input, got ${typeof l}`);const c=Object.fromEntries(Object.entries(l).filter(([d])=>!s.includes(d)));Object.keys(c).length>0&&(yield c)}yield(await u).value;for await(const l of o)yield l}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=Se(n),i=new yo({generator:this.transform(r(),s),config:s});return await i.setup,yn.fromAsyncGenerator(i)}}class UF extends it{static lc_name(){return"RunnablePick"}constructor(e){(typeof e=="string"||Array.isArray(e))&&(e={keys:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"keys",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keys=e.keys}async _pick(e){if(typeof this.keys=="string")return e[this.keys];{const n=this.keys.map(r=>[r,e[r]]).filter(r=>r[1]!==void 0);return n.length===0?void 0:Object.fromEntries(n)}}async invoke(e,n){return this._callWithConfig(this._pick.bind(this),e,n)}async*_transform(e){for await(const n of e){const r=await this._pick(n);r!==void 0&&(yield r)}}transform(e,n){return this._transformStreamWithConfig(e,this._transform.bind(this),n)}async stream(e,n){async function*r(){yield e}const s=Se(n),i=new yo({generator:this.transform(r(),s),config:s});return await i.setup,yn.fromAsyncGenerator(i)}}class yv extends _i{constructor(e){const n=Hr.from([Tl.from(async r=>{let s;if(XE(r))try{s=await this.schema.parseAsync(r.args)}catch{throw new c7("Received tool input did not match expected schema",JSON.stringify(r.args))}else s=r;return s}).withConfig({runName:`${e.name}:parse_input`}),e.bound]).withConfig({runName:e.name});super({bound:n,config:e.config??{}}),Object.defineProperty(this,"name",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"description",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.name=e.name,this.description=e.description,this.schema=e.schema}static lc_name(){return"RunnableToolLike"}}function zF(t,e){const n=e.name??t.getName(),r=e.description??e.schema?.description;return e.schema.constructor===bi.ZodString?new yv({name:n,description:r,schema:bi.object({input:bi.string()}).transform(s=>s.input),bound:t}):new yv({name:n,description:r,schema:e.schema,bound:t})}class qF extends it{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","documents","transformers"]})}invoke(e,n){return this.transformDocuments(e)}}class HF extends qF{async transformDocuments(e){const n=[];for(const r of e){const s=await this._transformDocument(r);n.push(s)}return n}}const gg="RFC3986",yg={RFC1738:t=>String(t).replace(/%20/g,"+"),RFC3986:t=>String(t)},VF="RFC1738",WF=Array.isArray,or=(()=>{const t=[];for(let e=0;e<256;++e)t.push("%"+((e<16?"0":"")+e.toString(16)).toUpperCase());return t})(),xp=1024,GF=(t,e,n,r,s)=>{if(t.length===0)return t;let i=t;if(typeof t=="symbol"?i=Symbol.prototype.toString.call(t):typeof t!="string"&&(i=String(t)),n==="iso-8859-1")return escape(i).replace(/%u[0-9a-f]{4}/gi,function(o){return"%26%23"+parseInt(o.slice(2),16)+"%3B"});let a="";for(let o=0;o<i.length;o+=xp){const u=i.length>=xp?i.slice(o,o+xp):i,l=[];for(let c=0;c<u.length;++c){let d=u.charCodeAt(c);if(d===45||d===46||d===95||d===126||d>=48&&d<=57||d>=65&&d<=90||d>=97&&d<=122||s===VF&&(d===40||d===41)){l[l.length]=u.charAt(c);continue}if(d<128){l[l.length]=or[d];continue}if(d<2048){l[l.length]=or[192|d>>6]+or[128|d&63];continue}if(d<55296||d>=57344){l[l.length]=or[224|d>>12]+or[128|d>>6&63]+or[128|d&63];continue}c+=1,d=65536+((d&1023)<<10|u.charCodeAt(c)&1023),l[l.length]=or[240|d>>18]+or[128|d>>12&63]+or[128|d>>6&63]+or[128|d&63]}a+=l.join("")}return a};function ZF(t){return!t||typeof t!="object"?!1:!!(t.constructor&&t.constructor.isBuffer&&t.constructor.isBuffer(t))}function bv(t,e){if(WF(t)){const n=[];for(let r=0;r<t.length;r+=1)n.push(e(t[r]));return n}return e(t)}const JF=Object.prototype.hasOwnProperty,c3={brackets(t){return String(t)+"[]"},comma:"comma",indices(t,e){return String(t)+"["+e+"]"},repeat(t){return String(t)}},cr=Array.isArray,KF=Array.prototype.push,d3=function(t,e){KF.apply(t,cr(e)?e:[e])},QF=Date.prototype.toISOString,ut={addQueryPrefix:!1,allowDots:!1,allowEmptyArrays:!1,arrayFormat:"indices",charset:"utf-8",charsetSentinel:!1,delimiter:"&",encode:!0,encodeDotInKeys:!1,encoder:GF,encodeValuesOnly:!1,format:gg,formatter:yg[gg],indices:!1,serializeDate(t){return QF.call(t)},skipNulls:!1,strictNullHandling:!1};function XF(t){return typeof t=="string"||typeof t=="number"||typeof t=="boolean"||typeof t=="symbol"||typeof t=="bigint"}const Sp={};function f3(t,e,n,r,s,i,a,o,u,l,c,d,f,h,m,y,w,p){let b=t,_=p,x=0,S=!1;for(;(_=_.get(Sp))!==void 0&&!S;){const j=_.get(t);if(x+=1,typeof j<"u"){if(j===x)throw new RangeError("Cyclic object value");S=!0}typeof _.get(Sp)>"u"&&(x=0)}if(typeof l=="function"?b=l(e,b):b instanceof Date?b=f?.(b):n==="comma"&&cr(b)&&(b=bv(b,function(j){return j instanceof Date?f?.(j):j})),b===null){if(i)return u&&!y?u(e,ut.encoder,w,"key",h):e;b=""}if(XF(b)||ZF(b)){if(u){const j=y?e:u(e,ut.encoder,w,"key",h);return[m?.(j)+"="+m?.(u(b,ut.encoder,w,"value",h))]}return[m?.(e)+"="+m?.(String(b))]}const E=[];if(typeof b>"u")return E;let k;if(n==="comma"&&cr(b))y&&u&&(b=bv(b,u)),k=[{value:b.length>0?b.join(",")||null:void 0}];else if(cr(l))k=l;else{const j=Object.keys(b);k=c?j.sort(c):j}const T=o?String(e).replace(/\./g,"%2E"):String(e),$=r&&cr(b)&&b.length===1?T+"[]":T;if(s&&cr(b)&&b.length===0)return $+"[]";for(let j=0;j<k.length;++j){const H=k[j],q=typeof H=="object"&&typeof H.value<"u"?H.value:b[H];if(a&&q===null)continue;const X=d&&o?H.replace(/\./g,"%2E"):H,O=cr(b)?typeof n=="function"?n($,X):$:$+(d?"."+X:"["+X+"]");p.set(t,x);const I=new WeakMap;I.set(Sp,p),d3(E,f3(q,O,n,r,s,i,a,o,n==="comma"&&y&&cr(b)?null:u,l,c,d,f,h,m,y,w,I))}return E}function YF(t=ut){if(typeof t.allowEmptyArrays<"u"&&typeof t.allowEmptyArrays!="boolean")throw new TypeError("`allowEmptyArrays` option can only be `true` or `false`, when provided");if(typeof t.encodeDotInKeys<"u"&&typeof t.encodeDotInKeys!="boolean")throw new TypeError("`encodeDotInKeys` option can only be `true` or `false`, when provided");if(t.encoder!==null&&typeof t.encoder<"u"&&typeof t.encoder!="function")throw new TypeError("Encoder has to be a function.");const e=t.charset||ut.charset;if(typeof t.charset<"u"&&t.charset!=="utf-8"&&t.charset!=="iso-8859-1")throw new TypeError("The charset option must be either utf-8, iso-8859-1, or undefined");let n=gg;if(typeof t.format<"u"){if(!JF.call(yg,t.format))throw new TypeError("Unknown format option provided.");n=t.format}const r=yg[n];let s=ut.filter;(typeof t.filter=="function"||cr(t.filter))&&(s=t.filter);let i;if(t.arrayFormat&&t.arrayFormat in c3?i=t.arrayFormat:"indices"in t?i=t.indices?"indices":"repeat":i=ut.arrayFormat,"commaRoundTrip"in t&&typeof t.commaRoundTrip!="boolean")throw new TypeError("`commaRoundTrip` must be a boolean, or absent");const a=typeof t.allowDots>"u"?t.encodeDotInKeys?!0:ut.allowDots:!!t.allowDots;return{addQueryPrefix:typeof t.addQueryPrefix=="boolean"?t.addQueryPrefix:ut.addQueryPrefix,allowDots:a,allowEmptyArrays:typeof t.allowEmptyArrays=="boolean"?!!t.allowEmptyArrays:ut.allowEmptyArrays,arrayFormat:i,charset:e,charsetSentinel:typeof t.charsetSentinel=="boolean"?t.charsetSentinel:ut.charsetSentinel,commaRoundTrip:!!t.commaRoundTrip,delimiter:typeof t.delimiter>"u"?ut.delimiter:t.delimiter,encode:typeof t.encode=="boolean"?t.encode:ut.encode,encodeDotInKeys:typeof t.encodeDotInKeys=="boolean"?t.encodeDotInKeys:ut.encodeDotInKeys,encoder:typeof t.encoder=="function"?t.encoder:ut.encoder,encodeValuesOnly:typeof t.encodeValuesOnly=="boolean"?t.encodeValuesOnly:ut.encodeValuesOnly,filter:s,format:n,formatter:r,serializeDate:typeof t.serializeDate=="function"?t.serializeDate:ut.serializeDate,skipNulls:typeof t.skipNulls=="boolean"?t.skipNulls:ut.skipNulls,sort:typeof t.sort=="function"?t.sort:null,strictNullHandling:typeof t.strictNullHandling=="boolean"?t.strictNullHandling:ut.strictNullHandling}}function eB(t,e={}){let n=t;const r=YF(e);let s,i;typeof r.filter=="function"?(i=r.filter,n=i("",n)):cr(r.filter)&&(i=r.filter,s=i);const a=[];if(typeof n!="object"||n===null)return"";const o=c3[r.arrayFormat],u=o==="comma"&&r.commaRoundTrip;s||(s=Object.keys(n)),r.sort&&s.sort(r.sort);const l=new WeakMap;for(let f=0;f<s.length;++f){const h=s[f];r.skipNulls&&n[h]===null||d3(a,f3(n[h],h,o,u,r.allowEmptyArrays,r.strictNullHandling,r.skipNulls,r.encodeDotInKeys,r.encode?r.encoder:null,r.filter,r.sort,r.allowDots,r.serializeDate,r.format,r.formatter,r.encodeValuesOnly,r.charset,l))}const c=a.join(r.delimiter);let d=r.addQueryPrefix===!0?"?":"";return r.charsetSentinel&&(r.charset==="iso-8859-1"?d+="utf8=%26%2310003%3B&":d+="utf8=%E2%9C%93&"),c.length>0?d+c:""}const Qi="4.80.1";let wv=!1,gu,h3,p3,bg,m3,g3,y3,b3,w3;function tB(t,e={auto:!1}){if(wv)throw new Error(`you must \`import 'openai/shims/${t.kind}'\` before importing anything else from openai`);if(gu)throw new Error(`can't \`import 'openai/shims/${t.kind}'\` after \`import 'openai/shims/${gu}'\``);wv=e.auto,gu=t.kind,h3=t.fetch,p3=t.FormData,bg=t.File,m3=t.ReadableStream,g3=t.getMultipartRequestOptions,y3=t.getDefaultAgent,b3=t.fileFromPath,w3=t.isFsReadStream}class nB{constructor(e){this.body=e}get[Symbol.toStringTag](){return"MultipartBody"}}function rB({manuallyImported:t}={}){const e=t?"You may need to use polyfills":"Add one of these imports before your first `import  from 'openai'`:\n- `import 'openai/shims/node'` (if you're running on Node)\n- `import 'openai/shims/web'` (otherwise)\n";let n,r,s,i;try{n=fetch,r=Request,s=Response,i=Headers}catch(a){throw new Error(`this environment is missing the following Web Fetch API type: ${a.message}. ${e}`)}return{kind:"web",fetch:n,Request:r,Response:s,Headers:i,FormData:typeof FormData<"u"?FormData:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'FormData' is undefined. ${e}`)}},Blob:typeof Blob<"u"?Blob:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'Blob' is undefined. ${e}`)}},File:typeof File<"u"?File:class{constructor(){throw new Error(`file uploads aren't supported in this environment yet as 'File' is undefined. ${e}`)}},ReadableStream:typeof ReadableStream<"u"?ReadableStream:class{constructor(){throw new Error(`streaming isn't supported in this environment yet as 'ReadableStream' is undefined. ${e}`)}},getMultipartRequestOptions:async(a,o)=>({...o,body:new nB(a)}),getDefaultAgent:a=>{},fileFromPath:()=>{throw new Error("The `fileFromPath` function is only supported in Node. See the README for more details: https://www.github.com/openai/openai-node#file-uploads")},isFsReadStream:a=>!1}}gu||tB(rB(),{auto:!0});class ge extends Error{}class St extends ge{constructor(e,n,r,s){super(`${St.makeMessage(e,n,r)}`),this.status=e,this.headers=s,this.request_id=s?.["x-request-id"],this.error=n;const i=n;this.code=i?.code,this.param=i?.param,this.type=i?.type}static makeMessage(e,n,r){const s=n?.message?typeof n.message=="string"?n.message:JSON.stringify(n.message):n?JSON.stringify(n):r;return e&&s?`${e} ${s}`:e?`${e} status code (no body)`:s||"(no status code or body)"}static generate(e,n,r,s){if(!e||!s)return new nh({message:r,cause:_g(n)});const i=n?.error;return e===400?new _3(e,i,r,s):e===401?new v3(e,i,r,s):e===403?new x3(e,i,r,s):e===404?new S3(e,i,r,s):e===409?new k3(e,i,r,s):e===422?new E3(e,i,r,s):e===429?new A3(e,i,r,s):e>=500?new T3(e,i,r,s):new St(e,i,r,s)}}class En extends St{constructor({message:e}={}){super(void 0,void 0,e||"Request was aborted.",void 0)}}class nh extends St{constructor({message:e,cause:n}){super(void 0,void 0,e||"Connection error.",void 0),n&&(this.cause=n)}}class rh extends nh{constructor({message:e}={}){super({message:e??"Request timed out."})}}class _3 extends St{}class v3 extends St{}class x3 extends St{}class S3 extends St{}class k3 extends St{}class E3 extends St{}class A3 extends St{}class T3 extends St{}class C3 extends ge{constructor(){super("Could not parse response content as the length limit was reached")}}class P3 extends ge{constructor(){super("Could not parse response content as the request was rejected by the content filter")}}class Pi{constructor(){this.buffer=[],this.trailingCR=!1}decode(e){let n=this.decodeText(e);if(this.trailingCR&&(n="\r"+n,this.trailingCR=!1),n.endsWith("\r")&&(this.trailingCR=!0,n=n.slice(0,-1)),!n)return[];const r=Pi.NEWLINE_CHARS.has(n[n.length-1]||"");let s=n.split(Pi.NEWLINE_REGEXP);return r&&s.pop(),s.length===1&&!r?(this.buffer.push(s[0]),[]):(this.buffer.length>0&&(s=[this.buffer.join("")+s[0],...s.slice(1)],this.buffer=[]),r||(this.buffer=[s.pop()||""]),s)}decodeText(e){if(e==null)return"";if(typeof e=="string")return e;if(typeof Buffer<"u"){if(e instanceof Buffer)return e.toString();if(e instanceof Uint8Array)return Buffer.from(e).toString();throw new ge(`Unexpected: received non-Uint8Array (${e.constructor.name}) stream chunk in an environment with a global "Buffer" defined, which this library assumes to be Node. Please report this error.`)}if(typeof TextDecoder<"u"){if(e instanceof Uint8Array||e instanceof ArrayBuffer)return this.textDecoder??(this.textDecoder=new TextDecoder("utf8")),this.textDecoder.decode(e);throw new ge(`Unexpected: received non-Uint8Array/ArrayBuffer (${e.constructor.name}) in a web platform. Please report this error.`)}throw new ge("Unexpected: neither Buffer nor TextDecoder are available as globals. Please report this error.")}flush(){if(!this.buffer.length&&!this.trailingCR)return[];const e=[this.buffer.join("")];return this.buffer=[],this.trailingCR=!1,e}}Pi.NEWLINE_CHARS=new Set([`
`,"\r"]);Pi.NEWLINE_REGEXP=/\r\n|[\n\r]/g;function O3(t){if(t[Symbol.asyncIterator])return t;const e=t.getReader();return{async next(){try{const n=await e.read();return n?.done&&e.releaseLock(),n}catch(n){throw e.releaseLock(),n}},async return(){const n=e.cancel();return e.releaseLock(),await n,{done:!0,value:void 0}},[Symbol.asyncIterator](){return this}}}class wr{constructor(e,n){this.iterator=e,this.controller=n}static fromSSEResponse(e,n){let r=!1;async function*s(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let i=!1;try{for await(const a of sB(e,n))if(!i){if(a.data.startsWith("[DONE]")){i=!0;continue}if(a.event===null){let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(o&&o.error)throw new St(void 0,o.error,void 0,void 0);yield o}else{let o;try{o=JSON.parse(a.data)}catch(u){throw console.error("Could not parse message into JSON:",a.data),console.error("From chunk:",a.raw),u}if(a.event=="error")throw new St(void 0,o.error,o.message,void 0);yield{event:a.event,data:o}}}i=!0}catch(a){if(a instanceof Error&&a.name==="AbortError")return;throw a}finally{i||n.abort()}}return new wr(s,n)}static fromReadableStream(e,n){let r=!1;async function*s(){const a=new Pi,o=O3(e);for await(const u of o)for(const l of a.decode(u))yield l;for(const u of a.flush())yield u}async function*i(){if(r)throw new Error("Cannot iterate over a consumed stream, use `.tee()` to split the stream.");r=!0;let a=!1;try{for await(const o of s())a||o&&(yield JSON.parse(o));a=!0}catch(o){if(o instanceof Error&&o.name==="AbortError")return;throw o}finally{a||n.abort()}}return new wr(i,n)}[Symbol.asyncIterator](){return this.iterator()}tee(){const e=[],n=[],r=this.iterator(),s=i=>({next:()=>{if(i.length===0){const a=r.next();e.push(a),n.push(a)}return i.shift()}});return[new wr(()=>s(e),this.controller),new wr(()=>s(n),this.controller)]}toReadableStream(){const e=this;let n;const r=new TextEncoder;return new m3({async start(){n=e[Symbol.asyncIterator]()},async pull(s){try{const{value:i,done:a}=await n.next();if(a)return s.close();const o=r.encode(JSON.stringify(i)+`
`);s.enqueue(o)}catch(i){s.error(i)}},async cancel(){await n.return?.()}})}}async function*sB(t,e){if(!t.body)throw e.abort(),new ge("Attempted to iterate over a response with no body");const n=new oB,r=new Pi,s=O3(t.body);for await(const i of iB(s))for(const a of r.decode(i)){const o=n.decode(a);o&&(yield o)}for(const i of r.flush()){const a=n.decode(i);a&&(yield a)}}async function*iB(t){let e=new Uint8Array;for await(const n of t){if(n==null)continue;const r=n instanceof ArrayBuffer?new Uint8Array(n):typeof n=="string"?new TextEncoder().encode(n):n;let s=new Uint8Array(e.length+r.length);s.set(e),s.set(r,e.length),e=s;let i;for(;(i=aB(e))!==-1;)yield e.slice(0,i),e=e.slice(i)}e.length>0&&(yield e)}function aB(t){for(let r=0;r<t.length-2;r++){if(t[r]===10&&t[r+1]===10||t[r]===13&&t[r+1]===13)return r+2;if(t[r]===13&&t[r+1]===10&&r+3<t.length&&t[r+2]===13&&t[r+3]===10)return r+4}return-1}class oB{constructor(){this.event=null,this.data=[],this.chunks=[]}decode(e){if(e.endsWith("\r")&&(e=e.substring(0,e.length-1)),!e){if(!this.event&&!this.data.length)return null;const i={event:this.event,data:this.data.join(`
`),raw:this.chunks};return this.event=null,this.data=[],this.chunks=[],i}if(this.chunks.push(e),e.startsWith(":"))return null;let[n,r,s]=uB(e,":");return s.startsWith(" ")&&(s=s.substring(1)),n==="event"?this.event=s:n==="data"&&this.data.push(s),null}}function uB(t,e){const n=t.indexOf(e);return n!==-1?[t.substring(0,n),e,t.substring(n+e.length)]:[t,"",""]}const N3=t=>t!=null&&typeof t=="object"&&typeof t.url=="string"&&typeof t.blob=="function",I3=t=>t!=null&&typeof t=="object"&&typeof t.name=="string"&&typeof t.lastModified=="number"&&sh(t),sh=t=>t!=null&&typeof t=="object"&&typeof t.size=="number"&&typeof t.type=="string"&&typeof t.text=="function"&&typeof t.slice=="function"&&typeof t.arrayBuffer=="function",lB=t=>I3(t)||N3(t)||w3(t);async function R3(t,e,n){if(t=await t,I3(t))return t;if(N3(t)){const s=await t.blob();e||(e=new URL(t.url).pathname.split(/[\\/]/).pop()??"unknown_file");const i=sh(s)?[await s.arrayBuffer()]:[s];return new bg(i,e,n)}const r=await cB(t);if(e||(e=fB(t)??"unknown_file"),!n?.type){const s=r[0]?.type;typeof s=="string"&&(n={...n,type:s})}return new bg(r,e,n)}async function cB(t){let e=[];if(typeof t=="string"||ArrayBuffer.isView(t)||t instanceof ArrayBuffer)e.push(t);else if(sh(t))e.push(await t.arrayBuffer());else if(hB(t))for await(const n of t)e.push(n);else throw new Error(`Unexpected data type: ${typeof t}; constructor: ${t?.constructor?.name}; props: ${dB(t)}`);return e}function dB(t){return`[${Object.getOwnPropertyNames(t).map(n=>`"${n}"`).join(", ")}]`}function fB(t){return kp(t.name)||kp(t.filename)||kp(t.path)?.split(/[\\/]/).pop()}const kp=t=>{if(typeof t=="string")return t;if(typeof Buffer<"u"&&t instanceof Buffer)return String(t)},hB=t=>t!=null&&typeof t=="object"&&typeof t[Symbol.asyncIterator]=="function",_v=t=>t&&typeof t=="object"&&t.body&&t[Symbol.toStringTag]==="MultipartBody",Za=async t=>{const e=await pB(t.body);return g3(e,t)},pB=async t=>{const e=new p3;return await Promise.all(Object.entries(t||{}).map(([n,r])=>wg(e,n,r))),e},wg=async(t,e,n)=>{if(n!==void 0){if(n==null)throw new TypeError(`Received null for "${e}"; to pass null in FormData, you must use the string 'null'`);if(typeof n=="string"||typeof n=="number"||typeof n=="boolean")t.append(e,String(n));else if(lB(n)){const r=await R3(n);t.append(e,r)}else if(Array.isArray(n))await Promise.all(n.map(r=>wg(t,e+"[]",r)));else if(typeof n=="object")await Promise.all(Object.entries(n).map(([r,s])=>wg(t,`${e}[${r}]`,s)));else throw new TypeError(`Invalid value given to form, expected a string, number, boolean, object, Array, File or Blob but got ${n} instead`)}};var j3={},mB=function(t,e,n,r,s){if(typeof e=="function"?t!==e||!0:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return e.set(t,n),n},gB=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},wc;async function $3(t){const{response:e}=t;if(t.options.stream)return Ta("response",e.status,e.url,e.headers,e.body),t.options.__streamClass?t.options.__streamClass.fromSSEResponse(e,t.controller):wr.fromSSEResponse(e,t.controller);if(e.status===204)return null;if(t.options.__binaryResponse)return e;const n=e.headers.get("content-type");if(n?.includes("application/json")||n?.includes("application/vnd.api+json")){const i=await e.json();return Ta("response",e.status,e.url,e.headers,i),L3(i,e)}const s=await e.text();return Ta("response",e.status,e.url,e.headers,s),s}function L3(t,e){return!t||typeof t!="object"||Array.isArray(t)?t:Object.defineProperty(t,"_request_id",{value:e.headers.get("x-request-id"),enumerable:!1})}class ih extends Promise{constructor(e,n=$3){super(r=>{r(null)}),this.responsePromise=e,this.parseResponse=n}_thenUnwrap(e){return new ih(this.responsePromise,async n=>L3(e(await this.parseResponse(n),n),n.response))}asResponse(){return this.responsePromise.then(e=>e.response)}async withResponse(){const[e,n]=await Promise.all([this.parse(),this.asResponse()]);return{data:e,response:n,request_id:n.headers.get("x-request-id")}}parse(){return this.parsedPromise||(this.parsedPromise=this.responsePromise.then(this.parseResponse)),this.parsedPromise}then(e,n){return this.parse().then(e,n)}catch(e){return this.parse().catch(e)}finally(e){return this.parse().finally(e)}}class yB{constructor({baseURL:e,maxRetries:n=2,timeout:r=6e5,httpAgent:s,fetch:i}){this.baseURL=e,this.maxRetries=Ep("maxRetries",n),this.timeout=Ep("timeout",r),this.httpAgent=s,this.fetch=i??h3}authHeaders(e){return{}}defaultHeaders(e){return{Accept:"application/json","Content-Type":"application/json","User-Agent":this.getUserAgent(),...SB(),...this.authHeaders(e)}}validateHeaders(e,n){}defaultIdempotencyKey(){return`stainless-node-retry-${TB()}`}get(e,n){return this.methodRequest("get",e,n)}post(e,n){return this.methodRequest("post",e,n)}patch(e,n){return this.methodRequest("patch",e,n)}put(e,n){return this.methodRequest("put",e,n)}delete(e,n){return this.methodRequest("delete",e,n)}methodRequest(e,n,r){return this.request(Promise.resolve(r).then(async s=>{const i=s&&sh(s?.body)?new DataView(await s.body.arrayBuffer()):s?.body instanceof DataView?s.body:s?.body instanceof ArrayBuffer?new DataView(s.body):s&&ArrayBuffer.isView(s?.body)?new DataView(s.body.buffer):s?.body;return{method:e,path:n,...s,body:i}}))}getAPIList(e,n,r){return this.requestAPIList(n,{method:"get",path:e,...r})}calculateContentLength(e){if(typeof e=="string"){if(typeof Buffer<"u")return Buffer.byteLength(e,"utf8").toString();if(typeof TextEncoder<"u")return new TextEncoder().encode(e).length.toString()}else if(ArrayBuffer.isView(e))return e.byteLength.toString();return null}buildRequest(e,{retryCount:n=0}={}){const{method:r,path:s,query:i,headers:a={}}=e,o=ArrayBuffer.isView(e.body)||e.__binaryRequest&&typeof e.body=="string"?e.body:_v(e.body)?e.body.body:e.body?JSON.stringify(e.body,null,2):null,u=this.calculateContentLength(o),l=this.buildURL(s,i);"timeout"in e&&Ep("timeout",e.timeout);const c=e.timeout??this.timeout,d=e.httpAgent??this.httpAgent??y3(l),f=c+1e3;typeof d?.options?.timeout=="number"&&f>(d.options.timeout??0)&&(d.options.timeout=f),this.idempotencyHeader&&r!=="get"&&(e.idempotencyKey||(e.idempotencyKey=this.defaultIdempotencyKey()),a[this.idempotencyHeader]=e.idempotencyKey);const h=this.buildHeaders({options:e,headers:a,contentLength:u,retryCount:n});return{req:{method:r,...o&&{body:o},headers:h,...d&&{agent:d},signal:e.signal??null},url:l,timeout:c}}buildHeaders({options:e,headers:n,contentLength:r,retryCount:s}){const i={};r&&(i["content-length"]=r);const a=this.defaultHeaders(e);return kv(i,a),kv(i,n),_v(e.body)&&gu!=="node"&&delete i["content-type"],Av(a,"x-stainless-retry-count")===void 0&&Av(n,"x-stainless-retry-count")===void 0&&(i["x-stainless-retry-count"]=String(s)),this.validateHeaders(i,n),i}async prepareOptions(e){}async prepareRequest(e,{url:n,options:r}){}parseHeaders(e){return e?Symbol.iterator in e?Object.fromEntries(Array.from(e).map(n=>[...n])):{...e}:{}}makeStatusError(e,n,r,s){return St.generate(e,n,r,s)}request(e,n=null){return new ih(this.makeRequest(e,n))}async makeRequest(e,n){const r=await e,s=r.maxRetries??this.maxRetries;n==null&&(n=s),await this.prepareOptions(r);const{req:i,url:a,timeout:o}=this.buildRequest(r,{retryCount:s-n});if(await this.prepareRequest(i,{url:a,options:r}),Ta("request",a,r,i.headers),r.signal?.aborted)throw new En;const u=new AbortController,l=await this.fetchWithTimeout(a,i,o,u).catch(_g);if(l instanceof Error){if(r.signal?.aborted)throw new En;if(n)return this.retryRequest(r,n);throw l.name==="AbortError"?new rh:new nh({cause:l})}const c=wB(l.headers);if(!l.ok){if(n&&this.shouldRetry(l)){const w=`retrying, ${n} attempts remaining`;return Ta(`response (error; ${w})`,l.status,a,c),this.retryRequest(r,n,c)}const d=await l.text().catch(w=>_g(w).message),f=kB(d),h=f?void 0:d;throw Ta(`response (error; ${n?"(error; no more retries left)":"(error; not retryable)"})`,l.status,a,c,h),this.makeStatusError(l.status,f,h,c)}return{response:l,options:r,controller:u}}requestAPIList(e,n){const r=this.makeRequest(n,null);return new bB(this,r,e)}buildURL(e,n){const r=AB(e)?new URL(e):new URL(this.baseURL+(this.baseURL.endsWith("/")&&e.startsWith("/")?e.slice(1):e)),s=this.defaultQuery();return D3(s)||(n={...s,...n}),typeof n=="object"&&n&&!Array.isArray(n)&&(r.search=this.stringifyQuery(n)),r.toString()}stringifyQuery(e){return Object.entries(e).filter(([n,r])=>typeof r<"u").map(([n,r])=>{if(typeof r=="string"||typeof r=="number"||typeof r=="boolean")return`${encodeURIComponent(n)}=${encodeURIComponent(r)}`;if(r===null)return`${encodeURIComponent(n)}=`;throw new ge(`Cannot stringify type ${typeof r}; Expected string, number, boolean, or null. If you need to pass nested query parameters, you can manually encode them, e.g. { query: { 'foo[key1]': value1, 'foo[key2]': value2 } }, and please open a GitHub issue requesting better support for your use case.`)}).join("&")}async fetchWithTimeout(e,n,r,s){const{signal:i,...a}=n||{};i&&i.addEventListener("abort",()=>s.abort());const o=setTimeout(()=>s.abort(),r),u={signal:s.signal,...a};return u.method&&(u.method=u.method.toUpperCase()),this.fetch.call(void 0,e,u).finally(()=>{clearTimeout(o)})}shouldRetry(e){const n=e.headers.get("x-should-retry");return n==="true"?!0:n==="false"?!1:e.status===408||e.status===409||e.status===429||e.status>=500}async retryRequest(e,n,r){let s;const i=r?.["retry-after-ms"];if(i){const o=parseFloat(i);Number.isNaN(o)||(s=o)}const a=r?.["retry-after"];if(a&&!s){const o=parseFloat(a);Number.isNaN(o)?s=Date.parse(a)-Date.now():s=o*1e3}if(!(s&&0<=s&&s<60*1e3)){const o=e.maxRetries??this.maxRetries;s=this.calculateDefaultRetryTimeoutMillis(n,o)}return await Cl(s),this.makeRequest(e,n-1)}calculateDefaultRetryTimeoutMillis(e,n){const i=n-e,a=Math.min(.5*Math.pow(2,i),8),o=1-Math.random()*.25;return a*o*1e3}getUserAgent(){return`${this.constructor.name}/JS ${Qi}`}}class M3{constructor(e,n,r,s){wc.set(this,void 0),mB(this,wc,e),this.options=s,this.response=n,this.body=r}hasNextPage(){return this.getPaginatedItems().length?this.nextPageInfo()!=null:!1}async getNextPage(){const e=this.nextPageInfo();if(!e)throw new ge("No next page expected; please check `.hasNextPage()` before calling `.getNextPage()`.");const n={...this.options};if("params"in e&&typeof n.query=="object")n.query={...n.query,...e.params};else if("url"in e){const r=[...Object.entries(n.query||{}),...e.url.searchParams.entries()];for(const[s,i]of r)e.url.searchParams.set(s,i);n.query=void 0,n.path=e.url.toString()}return await gB(this,wc,"f").requestAPIList(this.constructor,n)}async*iterPages(){let e=this;for(yield e;e.hasNextPage();)e=await e.getNextPage(),yield e}async*[(wc=new WeakMap,Symbol.asyncIterator)](){for await(const e of this.iterPages())for(const n of e.getPaginatedItems())yield n}}class bB extends ih{constructor(e,n,r){super(n,async s=>new r(e,s.response,await $3(s),s.options))}async*[Symbol.asyncIterator](){const e=await this;for await(const n of e)yield n}}const wB=t=>new Proxy(Object.fromEntries(t.entries()),{get(e,n){const r=n.toString();return e[r.toLowerCase()]||e[r]}}),_B={method:!0,path:!0,query:!0,body:!0,headers:!0,maxRetries:!0,stream:!0,timeout:!0,httpAgent:!0,signal:!0,idempotencyKey:!0,__binaryRequest:!0,__binaryResponse:!0,__streamClass:!0},nn=t=>typeof t=="object"&&t!==null&&!D3(t)&&Object.keys(t).every(e=>F3(_B,e)),vB=()=>{if(typeof Deno<"u"&&Deno.build!=null)return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":xv(Deno.build.os),"X-Stainless-Arch":vv(Deno.build.arch),"X-Stainless-Runtime":"deno","X-Stainless-Runtime-Version":typeof Deno.version=="string"?Deno.version:Deno.version?.deno??"unknown"};if(typeof EdgeRuntime<"u")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":`other:${EdgeRuntime}`,"X-Stainless-Runtime":"edge","X-Stainless-Runtime-Version":process.version};if(Object.prototype.toString.call(typeof process<"u"?process:0)==="[object process]")return{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":xv(process.platform),"X-Stainless-Arch":vv(process.arch),"X-Stainless-Runtime":"node","X-Stainless-Runtime-Version":process.version};const t=xB();return t?{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":`browser:${t.browser}`,"X-Stainless-Runtime-Version":t.version}:{"X-Stainless-Lang":"js","X-Stainless-Package-Version":Qi,"X-Stainless-OS":"Unknown","X-Stainless-Arch":"unknown","X-Stainless-Runtime":"unknown","X-Stainless-Runtime-Version":"unknown"}};function xB(){if(typeof navigator>"u"||!navigator)return null;const t=[{key:"edge",pattern:/Edge(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/MSIE(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"ie",pattern:/Trident(?:.*rv\:(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"chrome",pattern:/Chrome(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"firefox",pattern:/Firefox(?:\W+(\d+)\.(\d+)(?:\.(\d+))?)?/},{key:"safari",pattern:/(?:Version\W+(\d+)\.(\d+)(?:\.(\d+))?)?(?:\W+Mobile\S*)?\W+Safari/}];for(const{key:e,pattern:n}of t){const r=n.exec(navigator.userAgent);if(r){const s=r[1]||0,i=r[2]||0,a=r[3]||0;return{browser:e,version:`${s}.${i}.${a}`}}}return null}const vv=t=>t==="x32"?"x32":t==="x86_64"||t==="x64"?"x64":t==="arm"?"arm":t==="aarch64"||t==="arm64"?"arm64":t?`other:${t}`:"unknown",xv=t=>(t=t.toLowerCase(),t.includes("ios")?"iOS":t==="android"?"Android":t==="darwin"?"MacOS":t==="win32"?"Windows":t==="freebsd"?"FreeBSD":t==="openbsd"?"OpenBSD":t==="linux"?"Linux":t?`Other:${t}`:"Unknown");let Sv;const SB=()=>Sv??(Sv=vB()),kB=t=>{try{return JSON.parse(t)}catch{return}},EB=/^[a-z][a-z0-9+.-]*:/i,AB=t=>EB.test(t),Cl=t=>new Promise(e=>setTimeout(e,t)),Ep=(t,e)=>{if(typeof e!="number"||!Number.isInteger(e))throw new ge(`${t} must be an integer`);if(e<0)throw new ge(`${t} must be a positive integer`);return e},_g=t=>{if(t instanceof Error)return t;if(typeof t=="object"&&t!==null)try{return new Error(JSON.stringify(t))}catch{}return new Error(t)},_c=t=>{if(typeof process<"u")return j3?.[t]?.trim()??void 0;if(typeof Deno<"u")return Deno.env?.get?.(t)?.trim()};function D3(t){if(!t)return!0;for(const e in t)return!1;return!0}function F3(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function kv(t,e){for(const n in e){if(!F3(e,n))continue;const r=n.toLowerCase();if(!r)continue;const s=e[n];s===null?delete t[r]:s!==void 0&&(t[r]=s)}}const Ev=new Set(["authorization","api-key"]);function Ta(t,...e){if(typeof process<"u"&&j3?.DEBUG==="true"){const n=e.map(r=>{if(!r)return r;if(r.headers){const i={...r,headers:{...r.headers}};for(const a in r.headers)Ev.has(a.toLowerCase())&&(i.headers[a]="REDACTED");return i}let s=null;for(const i in r)Ev.has(i.toLowerCase())&&(s??(s={...r}),s[i]="REDACTED");return s??r});console.log(`OpenAI:DEBUG:${t}`,...n)}}const TB=()=>"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,t=>{const e=Math.random()*16|0;return(t==="x"?e:e&3|8).toString(16)}),CB=()=>typeof window<"u"&&typeof window.document<"u"&&typeof navigator<"u",PB=t=>typeof t?.get=="function",Av=(t,e)=>{const n=e.toLowerCase();if(PB(t)){const r=e[0]?.toUpperCase()+e.substring(1).replace(/([^\w])(\w)/g,(s,i,a)=>i+a.toUpperCase());for(const s of[e,n,e.toUpperCase(),r]){const i=t.get(s);if(i)return i}}for(const[r,s]of Object.entries(t))if(r.toLowerCase()===n)return Array.isArray(s)?(s.length<=1||console.warn(`Received ${s.length} entries for the ${e} header, using the first entry.`),s[0]):s};function Ap(t){return t!=null&&typeof t=="object"&&!Array.isArray(t)}class OB extends M3{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[],this.object=r.object}getPaginatedItems(){return this.data??[]}nextPageParams(){return null}nextPageInfo(){return null}}class ar extends M3{constructor(e,n,r,s){super(e,n,r,s),this.data=r.data||[]}getPaginatedItems(){return this.data??[]}nextPageParams(){const e=this.nextPageInfo();if(!e)return null;if("params"in e)return e.params;const n=Object.fromEntries(e.url.searchParams);return Object.keys(n).length?n:null}nextPageInfo(){const e=this.getPaginatedItems();if(!e.length)return null;const n=e[e.length-1]?.id;return n?{params:{after:n}}:null}}class Te{constructor(e){this._client=e}}let B3=class extends Te{create(e,n){return this._client.post("/chat/completions",{body:e,...n,stream:e.stream??!1})}},Cy=class extends Te{constructor(){super(...arguments),this.completions=new B3(this._client)}};Cy.Completions=B3;class U3 extends Te{create(e,n){return this._client.post("/audio/speech",{body:e,...n,headers:{Accept:"application/octet-stream",...n?.headers},__binaryResponse:!0})}}class z3 extends Te{create(e,n){return this._client.post("/audio/transcriptions",Za({body:e,...n}))}}class q3 extends Te{create(e,n){return this._client.post("/audio/translations",Za({body:e,...n}))}}class Pl extends Te{constructor(){super(...arguments),this.transcriptions=new z3(this._client),this.translations=new q3(this._client),this.speech=new U3(this._client)}}Pl.Transcriptions=z3;Pl.Translations=q3;Pl.Speech=U3;class Py extends Te{create(e,n){return this._client.post("/batches",{body:e,...n})}retrieve(e,n){return this._client.get(`/batches/${e}`,n)}list(e={},n){return nn(e)?this.list({},e):this._client.getAPIList("/batches",Oy,{query:e,...n})}cancel(e,n){return this._client.post(`/batches/${e}/cancel`,n)}}class Oy extends ar{}Py.BatchesPage=Oy;class Ny extends Te{create(e,n){return this._client.post("/assistants",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,n){return this._client.get(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,n,r){return this._client.post(`/assistants/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},n){return nn(e)?this.list({},e):this._client.getAPIList("/assistants",Iy,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,n){return this._client.delete(`/assistants/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class Iy extends ar{}Ny.AssistantsPage=Iy;function Tv(t){return typeof t.parse=="function"}const Ca=t=>t?.role==="assistant",H3=t=>t?.role==="function",V3=t=>t?.role==="tool";var Fn=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},We=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},vg,Zc,Jc,Jo,Ko,Kc,Qo,jr,Xo,Jd,Kd,Xi,W3;class G3{constructor(){vg.add(this),this.controller=new AbortController,Zc.set(this,void 0),Jc.set(this,()=>{}),Jo.set(this,()=>{}),Ko.set(this,void 0),Kc.set(this,()=>{}),Qo.set(this,()=>{}),jr.set(this,{}),Xo.set(this,!1),Jd.set(this,!1),Kd.set(this,!1),Xi.set(this,!1),Fn(this,Zc,new Promise((e,n)=>{Fn(this,Jc,e,"f"),Fn(this,Jo,n,"f")}),"f"),Fn(this,Ko,new Promise((e,n)=>{Fn(this,Kc,e,"f"),Fn(this,Qo,n,"f")}),"f"),We(this,Zc,"f").catch(()=>{}),We(this,Ko,"f").catch(()=>{})}_run(e){setTimeout(()=>{e().then(()=>{this._emitFinal(),this._emit("end")},We(this,vg,"m",W3).bind(this))},0)}_connected(){this.ended||(We(this,Jc,"f").call(this),this._emit("connect"))}get ended(){return We(this,Xo,"f")}get errored(){return We(this,Jd,"f")}get aborted(){return We(this,Kd,"f")}abort(){this.controller.abort()}on(e,n){return(We(this,jr,"f")[e]||(We(this,jr,"f")[e]=[])).push({listener:n}),this}off(e,n){const r=We(this,jr,"f")[e];if(!r)return this;const s=r.findIndex(i=>i.listener===n);return s>=0&&r.splice(s,1),this}once(e,n){return(We(this,jr,"f")[e]||(We(this,jr,"f")[e]=[])).push({listener:n,once:!0}),this}emitted(e){return new Promise((n,r)=>{Fn(this,Xi,!0,"f"),e!=="error"&&this.once("error",r),this.once(e,n)})}async done(){Fn(this,Xi,!0,"f"),await We(this,Ko,"f")}_emit(e,...n){if(We(this,Xo,"f"))return;e==="end"&&(Fn(this,Xo,!0,"f"),We(this,Kc,"f").call(this));const r=We(this,jr,"f")[e];if(r&&(We(this,jr,"f")[e]=r.filter(s=>!s.once),r.forEach(({listener:s})=>s(...n))),e==="abort"){const s=n[0];!We(this,Xi,"f")&&!r?.length&&Promise.reject(s),We(this,Jo,"f").call(this,s),We(this,Qo,"f").call(this,s),this._emit("end");return}if(e==="error"){const s=n[0];!We(this,Xi,"f")&&!r?.length&&Promise.reject(s),We(this,Jo,"f").call(this,s),We(this,Qo,"f").call(this,s),this._emit("end")}}_emitFinal(){}}Zc=new WeakMap,Jc=new WeakMap,Jo=new WeakMap,Ko=new WeakMap,Kc=new WeakMap,Qo=new WeakMap,jr=new WeakMap,Xo=new WeakMap,Jd=new WeakMap,Kd=new WeakMap,Xi=new WeakMap,vg=new WeakSet,W3=function(e){if(Fn(this,Jd,!0,"f"),e instanceof Error&&e.name==="AbortError"&&(e=new En),e instanceof En)return Fn(this,Kd,!0,"f"),this._emit("abort",e);if(e instanceof ge)return this._emit("error",e);if(e instanceof Error){const n=new ge(e.message);return n.cause=e,this._emit("error",n)}return this._emit("error",new ge(String(e)))};function NB(t,e){const n={...t};return Object.defineProperties(n,{$brand:{value:"auto-parseable-response-format",enumerable:!1},$parseRaw:{value:e,enumerable:!1}}),n}function Z3(t){return t?.$brand==="auto-parseable-response-format"}function IB(t,{parser:e,callback:n}){const r={...t};return Object.defineProperties(r,{$brand:{value:"auto-parseable-tool",enumerable:!1},$parseRaw:{value:e,enumerable:!1},$callback:{value:n,enumerable:!1}}),r}function Ol(t){return t?.$brand==="auto-parseable-tool"}function RB(t,e){return!e||!J3(e)?{...t,choices:t.choices.map(n=>({...n,message:{...n.message,parsed:null,tool_calls:n.message.tool_calls??[]}}))}:Ry(t,e)}function Ry(t,e){const n=t.choices.map(r=>{if(r.finish_reason==="length")throw new C3;if(r.finish_reason==="content_filter")throw new P3;return{...r,message:{...r.message,tool_calls:r.message.tool_calls?.map(s=>$B(e,s))??[],parsed:r.message.content&&!r.message.refusal?jB(e,r.message.content):null}}});return{...t,choices:n}}function jB(t,e){return t.response_format?.type!=="json_schema"?null:t.response_format?.type==="json_schema"?"$parseRaw"in t.response_format?t.response_format.$parseRaw(e):JSON.parse(e):null}function $B(t,e){const n=t.tools?.find(r=>r.function?.name===e.function.name);return{...e,function:{...e.function,parsed_arguments:Ol(n)?n.$parseRaw(e.function.arguments):n?.function.strict?JSON.parse(e.function.arguments):null}}}function LB(t,e){if(!t)return!1;const n=t.tools?.find(r=>r.function?.name===e.function.name);return Ol(n)||n?.function.strict||!1}function J3(t){return Z3(t.response_format)?!0:t.tools?.some(e=>Ol(e)||e.type==="function"&&e.function.strict===!0)??!1}function MB(t){for(const e of t??[]){if(e.type!=="function")throw new ge(`Currently only \`function\` tool types support auto-parsing; Received \`${e.type}\``);if(e.function.strict!==!0)throw new ge(`The \`${e.function.name}\` tool is not marked with \`strict: true\`. Only strict function tools can be auto-parsed`)}}var Wt=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},At,xg,Qd,Sg,kg,Eg,K3,Ag;const Cv=10;class Q3 extends G3{constructor(){super(...arguments),At.add(this),this._chatCompletions=[],this.messages=[]}_addChatCompletion(e){this._chatCompletions.push(e),this._emit("chatCompletion",e);const n=e.choices[0]?.message;return n&&this._addMessage(n),e}_addMessage(e,n=!0){if("content"in e||(e.content=null),this.messages.push(e),n){if(this._emit("message",e),(H3(e)||V3(e))&&e.content)this._emit("functionCallResult",e.content);else if(Ca(e)&&e.function_call)this._emit("functionCall",e.function_call);else if(Ca(e)&&e.tool_calls)for(const r of e.tool_calls)r.type==="function"&&this._emit("functionCall",r.function)}}async finalChatCompletion(){await this.done();const e=this._chatCompletions[this._chatCompletions.length-1];if(!e)throw new ge("stream ended without producing a ChatCompletion");return e}async finalContent(){return await this.done(),Wt(this,At,"m",xg).call(this)}async finalMessage(){return await this.done(),Wt(this,At,"m",Qd).call(this)}async finalFunctionCall(){return await this.done(),Wt(this,At,"m",Sg).call(this)}async finalFunctionCallResult(){return await this.done(),Wt(this,At,"m",kg).call(this)}async totalUsage(){return await this.done(),Wt(this,At,"m",Eg).call(this)}allChatCompletions(){return[...this._chatCompletions]}_emitFinal(){const e=this._chatCompletions[this._chatCompletions.length-1];e&&this._emit("finalChatCompletion",e);const n=Wt(this,At,"m",Qd).call(this);n&&this._emit("finalMessage",n);const r=Wt(this,At,"m",xg).call(this);r&&this._emit("finalContent",r);const s=Wt(this,At,"m",Sg).call(this);s&&this._emit("finalFunctionCall",s);const i=Wt(this,At,"m",kg).call(this);i!=null&&this._emit("finalFunctionCallResult",i),this._chatCompletions.some(a=>a.usage)&&this._emit("totalUsage",Wt(this,At,"m",Eg).call(this))}async _createChatCompletion(e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),Wt(this,At,"m",K3).call(this,n);const i=await e.chat.completions.create({...n,stream:!1},{...r,signal:this.controller.signal});return this._connected(),this._addChatCompletion(Ry(i,n))}async _runChatCompletion(e,n,r){for(const s of n.messages)this._addMessage(s,!1);return await this._createChatCompletion(e,n,r)}async _runFunctions(e,n,r){const s="function",{function_call:i="auto",stream:a,...o}=n,u=typeof i!="string"&&i?.name,{maxChatCompletions:l=Cv}=r||{},c={};for(const f of n.functions)c[f.name||f.function.name]=f;const d=n.functions.map(f=>({name:f.name||f.function.name,parameters:f.parameters,description:f.description}));for(const f of n.messages)this._addMessage(f,!1);for(let f=0;f<l;++f){const m=(await this._createChatCompletion(e,{...o,function_call:i,functions:d,messages:[...this.messages]},r)).choices[0]?.message;if(!m)throw new ge("missing message in ChatCompletion response");if(!m.function_call)return;const{name:y,arguments:w}=m.function_call,p=c[y];if(p){if(u&&u!==y){const S=`Invalid function_call: ${JSON.stringify(y)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,name:y,content:S});continue}}else{const S=`Invalid function_call: ${JSON.stringify(y)}. Available options are: ${d.map(E=>JSON.stringify(E.name)).join(", ")}. Please try again`;this._addMessage({role:s,name:y,content:S});continue}let b;try{b=Tv(p)?await p.parse(w):w}catch(S){this._addMessage({role:s,name:y,content:S instanceof Error?S.message:String(S)});continue}const _=await p.function(b,this),x=Wt(this,At,"m",Ag).call(this,_);if(this._addMessage({role:s,name:y,content:x}),u)return}}async _runTools(e,n,r){const s="tool",{tool_choice:i="auto",stream:a,...o}=n,u=typeof i!="string"&&i?.function?.name,{maxChatCompletions:l=Cv}=r||{},c=n.tools.map(h=>{if(Ol(h)){if(!h.$callback)throw new ge("Tool given to `.runTools()` that does not have an associated function");return{type:"function",function:{function:h.$callback,name:h.function.name,description:h.function.description||"",parameters:h.function.parameters,parse:h.$parseRaw,strict:!0}}}return h}),d={};for(const h of c)h.type==="function"&&(d[h.function.name||h.function.function.name]=h.function);const f="tools"in n?c.map(h=>h.type==="function"?{type:"function",function:{name:h.function.name||h.function.function.name,parameters:h.function.parameters,description:h.function.description,strict:h.function.strict}}:h):void 0;for(const h of n.messages)this._addMessage(h,!1);for(let h=0;h<l;++h){const y=(await this._createChatCompletion(e,{...o,tool_choice:i,tools:f,messages:[...this.messages]},r)).choices[0]?.message;if(!y)throw new ge("missing message in ChatCompletion response");if(!y.tool_calls?.length)return;for(const w of y.tool_calls){if(w.type!=="function")continue;const p=w.id,{name:b,arguments:_}=w.function,x=d[b];if(x){if(u&&u!==b){const T=`Invalid tool_call: ${JSON.stringify(b)}. ${JSON.stringify(u)} requested. Please try again`;this._addMessage({role:s,tool_call_id:p,content:T});continue}}else{const T=`Invalid tool_call: ${JSON.stringify(b)}. Available options are: ${Object.keys(d).map($=>JSON.stringify($)).join(", ")}. Please try again`;this._addMessage({role:s,tool_call_id:p,content:T});continue}let S;try{S=Tv(x)?await x.parse(_):_}catch(T){const $=T instanceof Error?T.message:String(T);this._addMessage({role:s,tool_call_id:p,content:$});continue}const E=await x.function(S,this),k=Wt(this,At,"m",Ag).call(this,E);if(this._addMessage({role:s,tool_call_id:p,content:k}),u)return}}}}At=new WeakSet,xg=function(){return Wt(this,At,"m",Qd).call(this).content??null},Qd=function(){let e=this.messages.length;for(;e-- >0;){const n=this.messages[e];if(Ca(n)){const{function_call:r,...s}=n,i={...s,content:n.content??null,refusal:n.refusal??null};return r&&(i.function_call=r),i}}throw new ge("stream ended without producing a ChatCompletionMessage with role=assistant")},Sg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(Ca(n)&&n?.function_call)return n.function_call;if(Ca(n)&&n?.tool_calls?.length)return n.tool_calls.at(-1)?.function}},kg=function(){for(let e=this.messages.length-1;e>=0;e--){const n=this.messages[e];if(H3(n)&&n.content!=null||V3(n)&&n.content!=null&&typeof n.content=="string"&&this.messages.some(r=>r.role==="assistant"&&r.tool_calls?.some(s=>s.type==="function"&&s.id===n.tool_call_id)))return n.content}},Eg=function(){const e={completion_tokens:0,prompt_tokens:0,total_tokens:0};for(const{usage:n}of this._chatCompletions)n&&(e.completion_tokens+=n.completion_tokens,e.prompt_tokens+=n.prompt_tokens,e.total_tokens+=n.total_tokens);return e},K3=function(e){if(e.n!=null&&e.n>1)throw new ge("ChatCompletion convenience helpers only support n=1 at this time. To use n>1, please use chat.completions.create() directly.")},Ag=function(e){return typeof e=="string"?e:e===void 0?"undefined":JSON.stringify(e)};class sl extends Q3{static runFunctions(e,n,r){const s=new sl,i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new sl,i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}_addMessage(e,n=!0){super._addMessage(e,n),Ca(e)&&e.content&&this._emit("content",e.content)}}const X3=1,Y3=2,eA=4,tA=8,nA=16,rA=32,sA=64,iA=128,aA=256,oA=iA|aA,uA=nA|rA|oA|sA,lA=X3|Y3|uA,cA=eA|tA,DB=lA|cA,ht={STR:X3,NUM:Y3,ARR:eA,OBJ:tA,NULL:nA,BOOL:rA,NAN:sA,INFINITY:iA,MINUS_INFINITY:aA,INF:oA,SPECIAL:uA,ATOM:lA,COLLECTION:cA,ALL:DB};class FB extends Error{}class BB extends Error{}function UB(t,e=ht.ALL){if(typeof t!="string")throw new TypeError(`expecting str, got ${typeof t}`);if(!t.trim())throw new Error(`${t} is empty`);return zB(t.trim(),e)}const zB=(t,e)=>{const n=t.length;let r=0;const s=f=>{throw new FB(`${f} at position ${r}`)},i=f=>{throw new BB(`${f} at position ${r}`)},a=()=>(d(),r>=n&&s("Unexpected end of input"),t[r]==='"'?o():t[r]==="{"?u():t[r]==="["?l():t.substring(r,r+4)==="null"||ht.NULL&e&&n-r<4&&"null".startsWith(t.substring(r))?(r+=4,null):t.substring(r,r+4)==="true"||ht.BOOL&e&&n-r<4&&"true".startsWith(t.substring(r))?(r+=4,!0):t.substring(r,r+5)==="false"||ht.BOOL&e&&n-r<5&&"false".startsWith(t.substring(r))?(r+=5,!1):t.substring(r,r+8)==="Infinity"||ht.INFINITY&e&&n-r<8&&"Infinity".startsWith(t.substring(r))?(r+=8,1/0):t.substring(r,r+9)==="-Infinity"||ht.MINUS_INFINITY&e&&1<n-r&&n-r<9&&"-Infinity".startsWith(t.substring(r))?(r+=9,-1/0):t.substring(r,r+3)==="NaN"||ht.NAN&e&&n-r<3&&"NaN".startsWith(t.substring(r))?(r+=3,NaN):c()),o=()=>{const f=r;let h=!1;for(r++;r<n&&(t[r]!=='"'||h&&t[r-1]==="\\");)h=t[r]==="\\"?!h:!1,r++;if(t.charAt(r)=='"')try{return JSON.parse(t.substring(f,++r-Number(h)))}catch(m){i(String(m))}else if(ht.STR&e)try{return JSON.parse(t.substring(f,r-Number(h))+'"')}catch{return JSON.parse(t.substring(f,t.lastIndexOf("\\"))+'"')}s("Unterminated string literal")},u=()=>{r++,d();const f={};try{for(;t[r]!=="}";){if(d(),r>=n&&ht.OBJ&e)return f;const h=o();d(),r++;try{const m=a();Object.defineProperty(f,h,{value:m,writable:!0,enumerable:!0,configurable:!0})}catch(m){if(ht.OBJ&e)return f;throw m}d(),t[r]===","&&r++}}catch{if(ht.OBJ&e)return f;s("Expected '}' at end of object")}return r++,f},l=()=>{r++;const f=[];try{for(;t[r]!=="]";)f.push(a()),d(),t[r]===","&&r++}catch{if(ht.ARR&e)return f;s("Expected ']' at end of array")}return r++,f},c=()=>{if(r===0){t==="-"&&ht.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t)}catch(h){if(ht.NUM&e)try{return t[t.length-1]==="."?JSON.parse(t.substring(0,t.lastIndexOf("."))):JSON.parse(t.substring(0,t.lastIndexOf("e")))}catch{}i(String(h))}}const f=r;for(t[r]==="-"&&r++;t[r]&&!",]}".includes(t[r]);)r++;r==n&&!(ht.NUM&e)&&s("Unterminated number literal");try{return JSON.parse(t.substring(f,r))}catch{t.substring(f,r)==="-"&&ht.NUM&e&&s("Not sure what '-' is");try{return JSON.parse(t.substring(f,t.lastIndexOf("e")))}catch(m){i(String(m))}}},d=()=>{for(;r<n&&` 
\r	`.includes(t[r]);)r++};return a()},Pv=t=>UB(t,ht.ALL^ht.NUM);var Wi=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},je=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},ot,Ir,Gi,us,Tp,vc,Cp,Pp,Op,xc,Np,Ov;class il extends Q3{constructor(e){super(),ot.add(this),Ir.set(this,void 0),Gi.set(this,void 0),us.set(this,void 0),Wi(this,Ir,e,"f"),Wi(this,Gi,[],"f")}get currentChatCompletionSnapshot(){return je(this,us,"f")}static fromReadableStream(e){const n=new il(null);return n._run(()=>n._fromReadableStream(e)),n}static createChatCompletion(e,n,r){const s=new il(n);return s._run(()=>s._runChatCompletion(e,{...n,stream:!0},{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}async _createChatCompletion(e,n,r){super._createChatCompletion;const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort())),je(this,ot,"m",Tp).call(this);const i=await e.chat.completions.create({...n,stream:!0},{...r,signal:this.controller.signal});this._connected();for await(const a of i)je(this,ot,"m",Cp).call(this,a);if(i.controller.signal?.aborted)throw new En;return this._addChatCompletion(je(this,ot,"m",xc).call(this))}async _fromReadableStream(e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),je(this,ot,"m",Tp).call(this),this._connected();const s=wr.fromReadableStream(e,this.controller);let i;for await(const a of s)i&&i!==a.id&&this._addChatCompletion(je(this,ot,"m",xc).call(this)),je(this,ot,"m",Cp).call(this,a),i=a.id;if(s.controller.signal?.aborted)throw new En;return this._addChatCompletion(je(this,ot,"m",xc).call(this))}[(Ir=new WeakMap,Gi=new WeakMap,us=new WeakMap,ot=new WeakSet,Tp=function(){this.ended||Wi(this,us,void 0,"f")},vc=function(n){let r=je(this,Gi,"f")[n.index];return r||(r={content_done:!1,refusal_done:!1,logprobs_content_done:!1,logprobs_refusal_done:!1,done_tool_calls:new Set,current_tool_call_index:null},je(this,Gi,"f")[n.index]=r,r)},Cp=function(n){if(this.ended)return;const r=je(this,ot,"m",Ov).call(this,n);this._emit("chunk",n,r);for(const s of n.choices){const i=r.choices[s.index];s.delta.content!=null&&i.message?.role==="assistant"&&i.message?.content&&(this._emit("content",s.delta.content,i.message.content),this._emit("content.delta",{delta:s.delta.content,snapshot:i.message.content,parsed:i.message.parsed})),s.delta.refusal!=null&&i.message?.role==="assistant"&&i.message?.refusal&&this._emit("refusal.delta",{delta:s.delta.refusal,snapshot:i.message.refusal}),s.logprobs?.content!=null&&i.message?.role==="assistant"&&this._emit("logprobs.content.delta",{content:s.logprobs?.content,snapshot:i.logprobs?.content??[]}),s.logprobs?.refusal!=null&&i.message?.role==="assistant"&&this._emit("logprobs.refusal.delta",{refusal:s.logprobs?.refusal,snapshot:i.logprobs?.refusal??[]});const a=je(this,ot,"m",vc).call(this,i);i.finish_reason&&(je(this,ot,"m",Op).call(this,i),a.current_tool_call_index!=null&&je(this,ot,"m",Pp).call(this,i,a.current_tool_call_index));for(const o of s.delta.tool_calls??[])a.current_tool_call_index!==o.index&&(je(this,ot,"m",Op).call(this,i),a.current_tool_call_index!=null&&je(this,ot,"m",Pp).call(this,i,a.current_tool_call_index)),a.current_tool_call_index=o.index;for(const o of s.delta.tool_calls??[]){const u=i.message.tool_calls?.[o.index];u?.type&&(u?.type==="function"?this._emit("tool_calls.function.arguments.delta",{name:u.function?.name,index:o.index,arguments:u.function.arguments,parsed_arguments:u.function.parsed_arguments,arguments_delta:o.function?.arguments??""}):(u?.type,void 0))}}},Pp=function(n,r){if(je(this,ot,"m",vc).call(this,n).done_tool_calls.has(r))return;const i=n.message.tool_calls?.[r];if(!i)throw new Error("no tool call snapshot");if(!i.type)throw new Error("tool call snapshot missing `type`");if(i.type==="function"){const a=je(this,Ir,"f")?.tools?.find(o=>o.type==="function"&&o.function.name===i.function.name);this._emit("tool_calls.function.arguments.done",{name:i.function.name,index:r,arguments:i.function.arguments,parsed_arguments:Ol(a)?a.$parseRaw(i.function.arguments):a?.function.strict?JSON.parse(i.function.arguments):null})}else i.type},Op=function(n){const r=je(this,ot,"m",vc).call(this,n);if(n.message.content&&!r.content_done){r.content_done=!0;const s=je(this,ot,"m",Np).call(this);this._emit("content.done",{content:n.message.content,parsed:s?s.$parseRaw(n.message.content):null})}n.message.refusal&&!r.refusal_done&&(r.refusal_done=!0,this._emit("refusal.done",{refusal:n.message.refusal})),n.logprobs?.content&&!r.logprobs_content_done&&(r.logprobs_content_done=!0,this._emit("logprobs.content.done",{content:n.logprobs.content})),n.logprobs?.refusal&&!r.logprobs_refusal_done&&(r.logprobs_refusal_done=!0,this._emit("logprobs.refusal.done",{refusal:n.logprobs.refusal}))},xc=function(){if(this.ended)throw new ge("stream has ended, this shouldn't happen");const n=je(this,us,"f");if(!n)throw new ge("request ended without sending any chunks");return Wi(this,us,void 0,"f"),Wi(this,Gi,[],"f"),qB(n,je(this,Ir,"f"))},Np=function(){const n=je(this,Ir,"f")?.response_format;return Z3(n)?n:null},Ov=function(n){var r,s,i,a;let o=je(this,us,"f");const{choices:u,...l}=n;o?Object.assign(o,l):o=Wi(this,us,{...l,choices:[]},"f");for(const{delta:c,finish_reason:d,index:f,logprobs:h=null,...m}of n.choices){let y=o.choices[f];if(y||(y=o.choices[f]={finish_reason:d,index:f,message:{},logprobs:h,...m}),h)if(!y.logprobs)y.logprobs=Object.assign({},h);else{const{content:E,refusal:k,...T}=h;Object.assign(y.logprobs,T),E&&((r=y.logprobs).content??(r.content=[]),y.logprobs.content.push(...E)),k&&((s=y.logprobs).refusal??(s.refusal=[]),y.logprobs.refusal.push(...k))}if(d&&(y.finish_reason=d,je(this,Ir,"f")&&J3(je(this,Ir,"f")))){if(d==="length")throw new C3;if(d==="content_filter")throw new P3}if(Object.assign(y,m),!c)continue;const{content:w,refusal:p,function_call:b,role:_,tool_calls:x,...S}=c;if(Object.assign(y.message,S),p&&(y.message.refusal=(y.message.refusal||"")+p),_&&(y.message.role=_),b&&(y.message.function_call?(b.name&&(y.message.function_call.name=b.name),b.arguments&&((i=y.message.function_call).arguments??(i.arguments=""),y.message.function_call.arguments+=b.arguments)):y.message.function_call=b),w&&(y.message.content=(y.message.content||"")+w,!y.message.refusal&&je(this,ot,"m",Np).call(this)&&(y.message.parsed=Pv(y.message.content))),x){y.message.tool_calls||(y.message.tool_calls=[]);for(const{index:E,id:k,type:T,function:$,...j}of x){const H=(a=y.message.tool_calls)[E]??(a[E]={});Object.assign(H,j),k&&(H.id=k),T&&(H.type=T),$&&(H.function??(H.function={name:$.name??"",arguments:""})),$?.name&&(H.function.name=$.name),$?.arguments&&(H.function.arguments+=$.arguments,LB(je(this,Ir,"f"),H)&&(H.function.parsed_arguments=Pv(H.function.arguments)))}}}return o},Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("chunk",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>n.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}toReadableStream(){return new wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}}function qB(t,e){const{id:n,choices:r,created:s,model:i,system_fingerprint:a,...o}=t,u={...o,id:n,choices:r.map(({message:l,finish_reason:c,index:d,logprobs:f,...h})=>{if(!c)throw new ge(`missing finish_reason for choice ${d}`);const{content:m=null,function_call:y,tool_calls:w,...p}=l,b=l.role;if(!b)throw new ge(`missing role for choice ${d}`);if(y){const{arguments:_,name:x}=y;if(_==null)throw new ge(`missing function_call.arguments for choice ${d}`);if(!x)throw new ge(`missing function_call.name for choice ${d}`);return{...h,message:{content:m,function_call:{arguments:_,name:x},role:b,refusal:l.refusal??null},finish_reason:c,index:d,logprobs:f}}return w?{...h,index:d,finish_reason:c,logprobs:f,message:{...p,role:b,content:m,refusal:l.refusal??null,tool_calls:w.map((_,x)=>{const{function:S,type:E,id:k,...T}=_,{arguments:$,name:j,...H}=S||{};if(k==null)throw new ge(`missing choices[${d}].tool_calls[${x}].id
${Sc(t)}`);if(E==null)throw new ge(`missing choices[${d}].tool_calls[${x}].type
${Sc(t)}`);if(j==null)throw new ge(`missing choices[${d}].tool_calls[${x}].function.name
${Sc(t)}`);if($==null)throw new ge(`missing choices[${d}].tool_calls[${x}].function.arguments
${Sc(t)}`);return{...T,id:k,type:E,function:{...H,name:j,arguments:$}}})}}:{...h,message:{...p,content:m,role:b,refusal:l.refusal??null},finish_reason:c,index:d,logprobs:f}}),created:s,model:i,object:"chat.completion",...a?{system_fingerprint:a}:{}};return RB(u,e)}function Sc(t){return JSON.stringify(t)}class Pa extends il{static fromReadableStream(e){const n=new Pa(null);return n._run(()=>n._fromReadableStream(e)),n}static runFunctions(e,n,r){const s=new Pa(null),i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runFunctions"}};return s._run(()=>s._runFunctions(e,n,i)),s}static runTools(e,n,r){const s=new Pa(n),i={...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"runTools"}};return s._run(()=>s._runTools(e,n,i)),s}}let dA=class extends Te{parse(e,n){return MB(e.tools),this._client.chat.completions.create(e,{...n,headers:{...n?.headers,"X-Stainless-Helper-Method":"beta.chat.completions.parse"}})._thenUnwrap(r=>Ry(r,e))}runFunctions(e,n){return e.stream?Pa.runFunctions(this._client,e,n):sl.runFunctions(this._client,e,n)}runTools(e,n){return e.stream?Pa.runTools(this._client,e,n):sl.runTools(this._client,e,n)}stream(e,n){return il.createChatCompletion(this._client,e,n)}};class fA extends Te{constructor(){super(...arguments),this.completions=new dA(this._client)}}(function(t){t.Completions=dA})(fA);class hA extends Te{create(e,n){return this._client.post("/realtime/sessions",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class jy extends Te{constructor(){super(...arguments),this.sessions=new hA(this._client)}}jy.Sessions=hA;var se=function(t,e,n,r){if(n==="a"&&!r)throw new TypeError("Private accessor was defined without a getter");if(typeof e=="function"?t!==e||!r:!e.has(t))throw new TypeError("Cannot read private member from an object whose class did not declare it");return n==="m"?r:n==="a"?r.call(t):r?r.value:e.get(t)},rn=function(t,e,n,r,s){if(r==="m")throw new TypeError("Private method is not writable");if(r==="a"&&!s)throw new TypeError("Private accessor was defined without a setter");if(typeof e=="function"?t!==e||!s:!e.has(t))throw new TypeError("Cannot write private member to an object whose class did not declare it");return r==="a"?s.call(t,n):s?s.value=n:e.set(t,n),n},wt,Tg,dr,Qc,Un,hi,ma,ii,Xd,on,Xc,Yc,yu,Yo,eu,Nv,Iv,Rv,jv,$v,Lv,Mv;class Vn extends G3{constructor(){super(...arguments),wt.add(this),Tg.set(this,[]),dr.set(this,{}),Qc.set(this,{}),Un.set(this,void 0),hi.set(this,void 0),ma.set(this,void 0),ii.set(this,void 0),Xd.set(this,void 0),on.set(this,void 0),Xc.set(this,void 0),Yc.set(this,void 0),yu.set(this,void 0)}[(Tg=new WeakMap,dr=new WeakMap,Qc=new WeakMap,Un=new WeakMap,hi=new WeakMap,ma=new WeakMap,ii=new WeakMap,Xd=new WeakMap,on=new WeakMap,Xc=new WeakMap,Yc=new WeakMap,yu=new WeakMap,wt=new WeakSet,Symbol.asyncIterator)](){const e=[],n=[];let r=!1;return this.on("event",s=>{const i=n.shift();i?i.resolve(s):e.push(s)}),this.on("end",()=>{r=!0;for(const s of n)s.resolve(void 0);n.length=0}),this.on("abort",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),this.on("error",s=>{r=!0;for(const i of n)i.reject(s);n.length=0}),{next:async()=>e.length?{value:e.shift(),done:!1}:r?{value:void 0,done:!0}:new Promise((i,a)=>n.push({resolve:i,reject:a})).then(i=>i?{value:i,done:!1}:{value:void 0,done:!0}),return:async()=>(this.abort(),{value:void 0,done:!0})}}static fromReadableStream(e){const n=new Vn;return n._run(()=>n._fromReadableStream(e)),n}async _fromReadableStream(e,n){const r=n?.signal;r&&(r.aborted&&this.controller.abort(),r.addEventListener("abort",()=>this.controller.abort())),this._connected();const s=wr.fromReadableStream(e,this.controller);for await(const i of s)se(this,wt,"m",Yo).call(this,i);if(s.controller.signal?.aborted)throw new En;return this._addRun(se(this,wt,"m",eu).call(this))}toReadableStream(){return new wr(this[Symbol.asyncIterator].bind(this),this.controller).toReadableStream()}static createToolAssistantStream(e,n,r,s,i){const a=new Vn;return a._run(()=>a._runToolAssistantStream(e,n,r,s,{...i,headers:{...i?.headers,"X-Stainless-Helper-Method":"stream"}})),a}async _createToolAssistantStream(e,n,r,s,i){const a=i?.signal;a&&(a.aborted&&this.controller.abort(),a.addEventListener("abort",()=>this.controller.abort()));const o={...s,stream:!0},u=await e.submitToolOutputs(n,r,o,{...i,signal:this.controller.signal});this._connected();for await(const l of u)se(this,wt,"m",Yo).call(this,l);if(u.controller.signal?.aborted)throw new En;return this._addRun(se(this,wt,"m",eu).call(this))}static createThreadAssistantStream(e,n,r){const s=new Vn;return s._run(()=>s._threadAssistantStream(e,n,{...r,headers:{...r?.headers,"X-Stainless-Helper-Method":"stream"}})),s}static createAssistantStream(e,n,r,s){const i=new Vn;return i._run(()=>i._runAssistantStream(e,n,r,{...s,headers:{...s?.headers,"X-Stainless-Helper-Method":"stream"}})),i}currentEvent(){return se(this,Xc,"f")}currentRun(){return se(this,Yc,"f")}currentMessageSnapshot(){return se(this,Un,"f")}currentRunStepSnapshot(){return se(this,yu,"f")}async finalRunSteps(){return await this.done(),Object.values(se(this,dr,"f"))}async finalMessages(){return await this.done(),Object.values(se(this,Qc,"f"))}async finalRun(){if(await this.done(),!se(this,hi,"f"))throw Error("Final run was not received.");return se(this,hi,"f")}async _createThreadAssistantStream(e,n,r){const s=r?.signal;s&&(s.aborted&&this.controller.abort(),s.addEventListener("abort",()=>this.controller.abort()));const i={...n,stream:!0},a=await e.createAndRun(i,{...r,signal:this.controller.signal});this._connected();for await(const o of a)se(this,wt,"m",Yo).call(this,o);if(a.controller.signal?.aborted)throw new En;return this._addRun(se(this,wt,"m",eu).call(this))}async _createAssistantStream(e,n,r,s){const i=s?.signal;i&&(i.aborted&&this.controller.abort(),i.addEventListener("abort",()=>this.controller.abort()));const a={...r,stream:!0},o=await e.create(n,a,{...s,signal:this.controller.signal});this._connected();for await(const u of o)se(this,wt,"m",Yo).call(this,u);if(o.controller.signal?.aborted)throw new En;return this._addRun(se(this,wt,"m",eu).call(this))}static accumulateDelta(e,n){for(const[r,s]of Object.entries(n)){if(!e.hasOwnProperty(r)){e[r]=s;continue}let i=e[r];if(i==null){e[r]=s;continue}if(r==="index"||r==="type"){e[r]=s;continue}if(typeof i=="string"&&typeof s=="string")i+=s;else if(typeof i=="number"&&typeof s=="number")i+=s;else if(Ap(i)&&Ap(s))i=this.accumulateDelta(i,s);else if(Array.isArray(i)&&Array.isArray(s)){if(i.every(a=>typeof a=="string"||typeof a=="number")){i.push(...s);continue}for(const a of s){if(!Ap(a))throw new Error(`Expected array delta entry to be an object but got: ${a}`);const o=a.index;if(o==null)throw console.error(a),new Error("Expected array delta entry to have an `index` property");if(typeof o!="number")throw new Error(`Expected array delta entry \`index\` property to be a number but got ${o}`);const u=i[o];u==null?i.push(a):i[o]=this.accumulateDelta(u,a)}continue}else throw Error(`Unhandled record type: ${r}, deltaValue: ${s}, accValue: ${i}`);e[r]=i}return e}_addRun(e){return e}async _threadAssistantStream(e,n,r){return await this._createThreadAssistantStream(n,e,r)}async _runAssistantStream(e,n,r,s){return await this._createAssistantStream(n,e,r,s)}async _runToolAssistantStream(e,n,r,s,i){return await this._createToolAssistantStream(r,e,n,s,i)}}Yo=function(e){if(!this.ended)switch(rn(this,Xc,e,"f"),se(this,wt,"m",Rv).call(this,e),e.event){case"thread.created":break;case"thread.run.created":case"thread.run.queued":case"thread.run.in_progress":case"thread.run.requires_action":case"thread.run.completed":case"thread.run.failed":case"thread.run.cancelling":case"thread.run.cancelled":case"thread.run.expired":se(this,wt,"m",Mv).call(this,e);break;case"thread.run.step.created":case"thread.run.step.in_progress":case"thread.run.step.delta":case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":se(this,wt,"m",Iv).call(this,e);break;case"thread.message.created":case"thread.message.in_progress":case"thread.message.delta":case"thread.message.completed":case"thread.message.incomplete":se(this,wt,"m",Nv).call(this,e);break;case"error":throw new Error("Encountered an error event in event processing - errors should be processed earlier")}},eu=function(){if(this.ended)throw new ge("stream has ended, this shouldn't happen");if(!se(this,hi,"f"))throw Error("Final run has not been received");return se(this,hi,"f")},Nv=function(e){const[n,r]=se(this,wt,"m",$v).call(this,e,se(this,Un,"f"));rn(this,Un,n,"f"),se(this,Qc,"f")[n.id]=n;for(const s of r){const i=n.content[s.index];i?.type=="text"&&this._emit("textCreated",i.text)}switch(e.event){case"thread.message.created":this._emit("messageCreated",e.data);break;case"thread.message.in_progress":break;case"thread.message.delta":if(this._emit("messageDelta",e.data.delta,n),e.data.delta.content)for(const s of e.data.delta.content){if(s.type=="text"&&s.text){let i=s.text,a=n.content[s.index];if(a&&a.type=="text")this._emit("textDelta",i,a.text);else throw Error("The snapshot associated with this text delta is not text or missing")}if(s.index!=se(this,ma,"f")){if(se(this,ii,"f"))switch(se(this,ii,"f").type){case"text":this._emit("textDone",se(this,ii,"f").text,se(this,Un,"f"));break;case"image_file":this._emit("imageFileDone",se(this,ii,"f").image_file,se(this,Un,"f"));break}rn(this,ma,s.index,"f")}rn(this,ii,n.content[s.index],"f")}break;case"thread.message.completed":case"thread.message.incomplete":if(se(this,ma,"f")!==void 0){const s=e.data.content[se(this,ma,"f")];if(s)switch(s.type){case"image_file":this._emit("imageFileDone",s.image_file,se(this,Un,"f"));break;case"text":this._emit("textDone",s.text,se(this,Un,"f"));break}}se(this,Un,"f")&&this._emit("messageDone",e.data),rn(this,Un,void 0,"f")}},Iv=function(e){const n=se(this,wt,"m",jv).call(this,e);switch(rn(this,yu,n,"f"),e.event){case"thread.run.step.created":this._emit("runStepCreated",e.data);break;case"thread.run.step.delta":const r=e.data.delta;if(r.step_details&&r.step_details.type=="tool_calls"&&r.step_details.tool_calls&&n.step_details.type=="tool_calls")for(const i of r.step_details.tool_calls)i.index==se(this,Xd,"f")?this._emit("toolCallDelta",i,n.step_details.tool_calls[i.index]):(se(this,on,"f")&&this._emit("toolCallDone",se(this,on,"f")),rn(this,Xd,i.index,"f"),rn(this,on,n.step_details.tool_calls[i.index],"f"),se(this,on,"f")&&this._emit("toolCallCreated",se(this,on,"f")));this._emit("runStepDelta",e.data.delta,n);break;case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":rn(this,yu,void 0,"f"),e.data.step_details.type=="tool_calls"&&se(this,on,"f")&&(this._emit("toolCallDone",se(this,on,"f")),rn(this,on,void 0,"f")),this._emit("runStepDone",e.data,n);break}},Rv=function(e){se(this,Tg,"f").push(e),this._emit("event",e)},jv=function(e){switch(e.event){case"thread.run.step.created":return se(this,dr,"f")[e.data.id]=e.data,e.data;case"thread.run.step.delta":let n=se(this,dr,"f")[e.data.id];if(!n)throw Error("Received a RunStepDelta before creation of a snapshot");let r=e.data;if(r.delta){const s=Vn.accumulateDelta(n,r.delta);se(this,dr,"f")[e.data.id]=s}return se(this,dr,"f")[e.data.id];case"thread.run.step.completed":case"thread.run.step.failed":case"thread.run.step.cancelled":case"thread.run.step.expired":case"thread.run.step.in_progress":se(this,dr,"f")[e.data.id]=e.data;break}if(se(this,dr,"f")[e.data.id])return se(this,dr,"f")[e.data.id];throw new Error("No snapshot available")},$v=function(e,n){let r=[];switch(e.event){case"thread.message.created":return[e.data,r];case"thread.message.delta":if(!n)throw Error("Received a delta with no existing snapshot (there should be one from message creation)");let s=e.data;if(s.delta.content)for(const i of s.delta.content)if(i.index in n.content){let a=n.content[i.index];n.content[i.index]=se(this,wt,"m",Lv).call(this,i,a)}else n.content[i.index]=i,r.push(i);return[n,r];case"thread.message.in_progress":case"thread.message.completed":case"thread.message.incomplete":if(n)return[n,r];throw Error("Received thread message event with no existing snapshot")}throw Error("Tried to accumulate a non-message event")},Lv=function(e,n){return Vn.accumulateDelta(n,e)},Mv=function(e){switch(rn(this,Yc,e.data,"f"),e.event){case"thread.run.created":break;case"thread.run.queued":break;case"thread.run.in_progress":break;case"thread.run.requires_action":case"thread.run.cancelled":case"thread.run.failed":case"thread.run.completed":case"thread.run.expired":rn(this,hi,e.data,"f"),se(this,on,"f")&&(this._emit("toolCallDone",se(this,on,"f")),rn(this,on,void 0,"f"));break}};class $y extends Te{create(e,n,r){return this._client.post(`/threads/${e}/messages`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,n,r){return this._client.get(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/messages/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,n={},r){return nn(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/messages`,Ly,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,n,r){return this._client.delete(`/threads/${e}/messages/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}}class Ly extends ar{}$y.MessagesPage=Ly;class My extends Te{retrieve(e,n,r,s={},i){return nn(s)?this.retrieve(e,n,r,{},s):this._client.get(`/threads/${e}/runs/${n}/steps/${r}`,{query:s,...i,headers:{"OpenAI-Beta":"assistants=v2",...i?.headers}})}list(e,n,r={},s){return nn(r)?this.list(e,n,{},r):this._client.getAPIList(`/threads/${e}/runs/${n}/steps`,Dy,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}}class Dy extends ar{}My.RunStepsPage=Dy;class Nl extends Te{constructor(){super(...arguments),this.steps=new My(this._client)}create(e,n,r){const{include:s,...i}=n;return this._client.post(`/threads/${e}/runs`,{query:{include:s},body:i,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers},stream:n.stream??!1})}retrieve(e,n,r){return this._client.get(`/threads/${e}/runs/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}update(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}list(e,n={},r){return nn(n)?this.list(e,{},n):this._client.getAPIList(`/threads/${e}/runs`,Fy,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,n,r){return this._client.post(`/threads/${e}/runs/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}createAndStream(e,n,r){return Vn.createAssistantStream(e,this._client.beta.threads.runs,n,r)}async poll(e,n,r){const s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,n,{...r,headers:{...r?.headers,...s}}).withResponse();switch(i.status){case"queued":case"in_progress":case"cancelling":let o=5e3;if(r?.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await Cl(o);break;case"requires_action":case"incomplete":case"cancelled":case"completed":case"failed":case"expired":return i}}}stream(e,n,r){return Vn.createAssistantStream(e,this._client.beta.threads.runs,n,r)}submitToolOutputs(e,n,r,s){return this._client.post(`/threads/${e}/runs/${n}/submit_tool_outputs`,{body:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers},stream:r.stream??!1})}async submitToolOutputsAndPoll(e,n,r,s){const i=await this.submitToolOutputs(e,n,r,s);return await this.poll(e,i.id,s)}submitToolOutputsStream(e,n,r,s){return Vn.createToolAssistantStream(e,n,this._client.beta.threads.runs,r,s)}}class Fy extends ar{}Nl.RunsPage=Fy;Nl.Steps=My;Nl.RunStepsPage=Dy;class wo extends Te{constructor(){super(...arguments),this.runs=new Nl(this._client),this.messages=new $y(this._client)}create(e={},n){return nn(e)?this.create({},e):this._client.post("/threads",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,n){return this._client.get(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,n,r){return this._client.post(`/threads/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,n){return this._client.delete(`/threads/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}createAndRun(e,n){return this._client.post("/threads/runs",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers},stream:e.stream??!1})}async createAndRunPoll(e,n){const r=await this.createAndRun(e,n);return await this.runs.poll(r.thread_id,r.id,n)}createAndRunStream(e,n){return Vn.createThreadAssistantStream(e,this._client.beta.threads,n)}}wo.Runs=Nl;wo.RunsPage=Fy;wo.Messages=$y;wo.MessagesPage=Ly;const HB=async t=>{const e=await Promise.allSettled(t),n=e.filter(s=>s.status==="rejected");if(n.length){for(const s of n)console.error(s.reason);throw new Error(`${n.length} promise(s) failed - see the above errors`)}const r=[];for(const s of e)s.status==="fulfilled"&&r.push(s.value);return r};let By=class extends Te{create(e,n,r){return this._client.post(`/vector_stores/${e}/files`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e,n={},r){return nn(n)?this.list(e,{},n):this._client.getAPIList(`/vector_stores/${e}/files`,ah,{query:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}del(e,n,r){return this._client.delete(`/vector_stores/${e}/files/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n,r);return await this.poll(e,s.id,r)}async poll(e,n,r){const s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const i=await this.retrieve(e,n,{...r,headers:s}).withResponse(),a=i.data;switch(a.status){case"in_progress":let o=5e3;if(r?.pollIntervalMs)o=r.pollIntervalMs;else{const u=i.response.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await Cl(o);break;case"failed":case"completed":return a}}}async upload(e,n,r){const s=await this._client.files.create({file:n,purpose:"assistants"},r);return this.create(e,{file_id:s.id},r)}async uploadAndPoll(e,n,r){const s=await this.upload(e,n,r);return await this.poll(e,s.id,r)}};class ah extends ar{}By.VectorStoreFilesPage=ah;class pA extends Te{create(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}retrieve(e,n,r){return this._client.get(`/vector_stores/${e}/file_batches/${n}`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}cancel(e,n,r){return this._client.post(`/vector_stores/${e}/file_batches/${n}/cancel`,{...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}async createAndPoll(e,n,r){const s=await this.create(e,n);return await this.poll(e,s.id,r)}listFiles(e,n,r={},s){return nn(r)?this.listFiles(e,n,{},r):this._client.getAPIList(`/vector_stores/${e}/file_batches/${n}/files`,ah,{query:r,...s,headers:{"OpenAI-Beta":"assistants=v2",...s?.headers}})}async poll(e,n,r){const s={...r?.headers,"X-Stainless-Poll-Helper":"true"};for(r?.pollIntervalMs&&(s["X-Stainless-Custom-Poll-Interval"]=r.pollIntervalMs.toString());;){const{data:i,response:a}=await this.retrieve(e,n,{...r,headers:s}).withResponse();switch(i.status){case"in_progress":let o=5e3;if(r?.pollIntervalMs)o=r.pollIntervalMs;else{const u=a.headers.get("openai-poll-after-ms");if(u){const l=parseInt(u);isNaN(l)||(o=l)}}await Cl(o);break;case"failed":case"cancelled":case"completed":return i}}}async uploadAndPoll(e,{files:n,fileIds:r=[]},s){if(n==null||n.length==0)throw new Error("No `files` provided to process. If you've already uploaded files you should use `.createAndPoll()` instead");const i=s?.maxConcurrency??5,a=Math.min(i,n.length),o=this._client,u=n.values(),l=[...r];async function c(f){for(let h of f){const m=await o.files.create({file:h,purpose:"assistants"},s);l.push(m.id)}}const d=Array(a).fill(u).map(c);return await HB(d),await this.createAndPoll(e,{file_ids:l})}}class _o extends Te{constructor(){super(...arguments),this.files=new By(this._client),this.fileBatches=new pA(this._client)}create(e,n){return this._client.post("/vector_stores",{body:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}retrieve(e,n){return this._client.get(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}update(e,n,r){return this._client.post(`/vector_stores/${e}`,{body:n,...r,headers:{"OpenAI-Beta":"assistants=v2",...r?.headers}})}list(e={},n){return nn(e)?this.list({},e):this._client.getAPIList("/vector_stores",Uy,{query:e,...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}del(e,n){return this._client.delete(`/vector_stores/${e}`,{...n,headers:{"OpenAI-Beta":"assistants=v2",...n?.headers}})}}class Uy extends ar{}_o.VectorStoresPage=Uy;_o.Files=By;_o.VectorStoreFilesPage=ah;_o.FileBatches=pA;class Zs extends Te{constructor(){super(...arguments),this.realtime=new jy(this._client),this.vectorStores=new _o(this._client),this.chat=new fA(this._client),this.assistants=new Ny(this._client),this.threads=new wo(this._client)}}Zs.Realtime=jy;Zs.VectorStores=_o;Zs.VectorStoresPage=Uy;Zs.Assistants=Ny;Zs.AssistantsPage=Iy;Zs.Threads=wo;class mA extends Te{create(e,n){return this._client.post("/completions",{body:e,...n,stream:e.stream??!1})}}let gA=class extends Te{create(e,n){return this._client.post("/embeddings",{body:e,...n})}};class zy extends Te{create(e,n){return this._client.post("/files",Za({body:e,...n}))}retrieve(e,n){return this._client.get(`/files/${e}`,n)}list(e={},n){return nn(e)?this.list({},e):this._client.getAPIList("/files",qy,{query:e,...n})}del(e,n){return this._client.delete(`/files/${e}`,n)}content(e,n){return this._client.get(`/files/${e}/content`,{...n,headers:{Accept:"application/binary",...n?.headers},__binaryResponse:!0})}retrieveContent(e,n){return this._client.get(`/files/${e}/content`,n)}async waitForProcessing(e,{pollInterval:n=5e3,maxWait:r=30*60*1e3}={}){const s=new Set(["processed","error","deleted"]),i=Date.now();let a=await this.retrieve(e);for(;!a.status||!s.has(a.status);)if(await Cl(n),a=await this.retrieve(e),Date.now()-i>r)throw new rh({message:`Giving up on waiting for file ${e} to finish processing after ${r} milliseconds.`});return a}}class qy extends ar{}zy.FileObjectsPage=qy;class Hy extends Te{list(e,n={},r){return nn(n)?this.list(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/checkpoints`,Vy,{query:n,...r})}}class Vy extends ar{}Hy.FineTuningJobCheckpointsPage=Vy;class vo extends Te{constructor(){super(...arguments),this.checkpoints=new Hy(this._client)}create(e,n){return this._client.post("/fine_tuning/jobs",{body:e,...n})}retrieve(e,n){return this._client.get(`/fine_tuning/jobs/${e}`,n)}list(e={},n){return nn(e)?this.list({},e):this._client.getAPIList("/fine_tuning/jobs",Wy,{query:e,...n})}cancel(e,n){return this._client.post(`/fine_tuning/jobs/${e}/cancel`,n)}listEvents(e,n={},r){return nn(n)?this.listEvents(e,{},n):this._client.getAPIList(`/fine_tuning/jobs/${e}/events`,Gy,{query:n,...r})}}class Wy extends ar{}class Gy extends ar{}vo.FineTuningJobsPage=Wy;vo.FineTuningJobEventsPage=Gy;vo.Checkpoints=Hy;vo.FineTuningJobCheckpointsPage=Vy;class Il extends Te{constructor(){super(...arguments),this.jobs=new vo(this._client)}}Il.Jobs=vo;Il.FineTuningJobsPage=Wy;Il.FineTuningJobEventsPage=Gy;class yA extends Te{createVariation(e,n){return this._client.post("/images/variations",Za({body:e,...n}))}edit(e,n){return this._client.post("/images/edits",Za({body:e,...n}))}generate(e,n){return this._client.post("/images/generations",{body:e,...n})}}class Zy extends Te{retrieve(e,n){return this._client.get(`/models/${e}`,n)}list(e){return this._client.getAPIList("/models",Jy,e)}del(e,n){return this._client.delete(`/models/${e}`,n)}}class Jy extends OB{}Zy.ModelsPage=Jy;class bA extends Te{create(e,n){return this._client.post("/moderations",{body:e,...n})}}class wA extends Te{create(e,n,r){return this._client.post(`/uploads/${e}/parts`,Za({body:n,...r}))}}class Ky extends Te{constructor(){super(...arguments),this.parts=new wA(this._client)}create(e,n){return this._client.post("/uploads",{body:e,...n})}cancel(e,n){return this._client.post(`/uploads/${e}/cancel`,n)}complete(e,n,r){return this._client.post(`/uploads/${e}/complete`,{body:n,...r})}}Ky.Parts=wA;var _A;let we=class extends yB{constructor({baseURL:e=_c("OPENAI_BASE_URL"),apiKey:n=_c("OPENAI_API_KEY"),organization:r=_c("OPENAI_ORG_ID")??null,project:s=_c("OPENAI_PROJECT_ID")??null,...i}={}){if(n===void 0)throw new ge("The OPENAI_API_KEY environment variable is missing or empty; either provide it, or instantiate the OpenAI client with an apiKey option, like new OpenAI({ apiKey: 'My API Key' }).");const a={apiKey:n,organization:r,project:s,...i,baseURL:e||"https://api.openai.com/v1"};if(!a.dangerouslyAllowBrowser&&CB())throw new ge(`It looks like you're running in a browser-like environment.

This is disabled by default, as it risks exposing your secret API credentials to attackers.
If you understand the risks and have appropriate mitigations in place,
you can set the \`dangerouslyAllowBrowser\` option to \`true\`, e.g.,

new OpenAI({ apiKey, dangerouslyAllowBrowser: true });

https://help.openai.com/en/articles/5112595-best-practices-for-api-key-safety
`);super({baseURL:a.baseURL,timeout:a.timeout??6e5,httpAgent:a.httpAgent,maxRetries:a.maxRetries,fetch:a.fetch}),this.completions=new mA(this),this.chat=new Cy(this),this.embeddings=new gA(this),this.files=new zy(this),this.images=new yA(this),this.audio=new Pl(this),this.moderations=new bA(this),this.models=new Zy(this),this.fineTuning=new Il(this),this.beta=new Zs(this),this.batches=new Py(this),this.uploads=new Ky(this),this._options=a,this.apiKey=n,this.organization=r,this.project=s}defaultQuery(){return this._options.defaultQuery}defaultHeaders(e){return{...super.defaultHeaders(e),"OpenAI-Organization":this.organization,"OpenAI-Project":this.project,...this._options.defaultHeaders}}authHeaders(e){return{Authorization:`Bearer ${this.apiKey}`}}stringifyQuery(e){return eB(e,{arrayFormat:"brackets"})}};_A=we;we.OpenAI=_A;we.DEFAULT_TIMEOUT=6e5;we.OpenAIError=ge;we.APIError=St;we.APIConnectionError=nh;we.APIConnectionTimeoutError=rh;we.APIUserAbortError=En;we.NotFoundError=S3;we.ConflictError=k3;we.RateLimitError=A3;we.BadRequestError=_3;we.AuthenticationError=v3;we.InternalServerError=T3;we.PermissionDeniedError=x3;we.UnprocessableEntityError=E3;we.toFile=R3;we.fileFromPath=b3;we.Completions=mA;we.Chat=Cy;we.Embeddings=gA;we.Files=zy;we.FileObjectsPage=qy;we.Images=yA;we.Audio=Pl;we.Moderations=bA;we.Models=Zy;we.ModelsPage=Jy;we.FineTuning=Il;we.Beta=Zs;we.Batches=Py;we.BatchesPage=Oy;we.Uploads=Ky;/*
 * [js-sha1]{@link https://github.com/emn178/js-sha1}
 *
 * @version 0.6.0
 * @author Chen, Yi-Cyuan [emn178@gmail.com]
 * @copyright Chen, Yi-Cyuan 2014-2017
 * @license MIT
 */var VB=typeof window=="object"?window:{},le="0123456789abcdef".split(""),WB=[-2147483648,8388608,32768,128],$n=[24,16,8,0],dt=[];function tr(t){t?(dt[0]=dt[16]=dt[1]=dt[2]=dt[3]=dt[4]=dt[5]=dt[6]=dt[7]=dt[8]=dt[9]=dt[10]=dt[11]=dt[12]=dt[13]=dt[14]=dt[15]=0,this.blocks=dt):this.blocks=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],this.h0=1732584193,this.h1=4023233417,this.h2=2562383102,this.h3=271733878,this.h4=3285377520,this.block=this.start=this.bytes=this.hBytes=0,this.finalized=this.hashed=!1,this.first=!0}tr.prototype.update=function(t){if(!this.finalized){var e=typeof t!="string";e&&t.constructor===VB.ArrayBuffer&&(t=new Uint8Array(t));for(var n,r=0,s,i=t.length||0,a=this.blocks;r<i;){if(this.hashed&&(this.hashed=!1,a[0]=this.block,a[16]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=a[9]=a[10]=a[11]=a[12]=a[13]=a[14]=a[15]=0),e)for(s=this.start;r<i&&s<64;++r)a[s>>2]|=t[r]<<$n[s++&3];else for(s=this.start;r<i&&s<64;++r)n=t.charCodeAt(r),n<128?a[s>>2]|=n<<$n[s++&3]:n<2048?(a[s>>2]|=(192|n>>6)<<$n[s++&3],a[s>>2]|=(128|n&63)<<$n[s++&3]):n<55296||n>=57344?(a[s>>2]|=(224|n>>12)<<$n[s++&3],a[s>>2]|=(128|n>>6&63)<<$n[s++&3],a[s>>2]|=(128|n&63)<<$n[s++&3]):(n=65536+((n&1023)<<10|t.charCodeAt(++r)&1023),a[s>>2]|=(240|n>>18)<<$n[s++&3],a[s>>2]|=(128|n>>12&63)<<$n[s++&3],a[s>>2]|=(128|n>>6&63)<<$n[s++&3],a[s>>2]|=(128|n&63)<<$n[s++&3]);this.lastByteIndex=s,this.bytes+=s-this.start,s>=64?(this.block=a[16],this.start=s-64,this.hash(),this.hashed=!0):this.start=s}return this.bytes>4294967295&&(this.hBytes+=this.bytes/4294967296<<0,this.bytes=this.bytes%4294967296),this}};tr.prototype.finalize=function(){if(!this.finalized){this.finalized=!0;var t=this.blocks,e=this.lastByteIndex;t[16]=this.block,t[e>>2]|=WB[e&3],this.block=t[16],e>=56&&(this.hashed||this.hash(),t[0]=this.block,t[16]=t[1]=t[2]=t[3]=t[4]=t[5]=t[6]=t[7]=t[8]=t[9]=t[10]=t[11]=t[12]=t[13]=t[14]=t[15]=0),t[14]=this.hBytes<<3|this.bytes>>>29,t[15]=this.bytes<<3,this.hash()}};tr.prototype.hash=function(){var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4,i,a,o,u=this.blocks;for(a=16;a<80;++a)o=u[a-3]^u[a-8]^u[a-14]^u[a-16],u[a]=o<<1|o>>>31;for(a=0;a<20;a+=5)i=e&n|~e&r,o=t<<5|t>>>27,s=o+i+s+1518500249+u[a]<<0,e=e<<30|e>>>2,i=t&e|~t&n,o=s<<5|s>>>27,r=o+i+r+1518500249+u[a+1]<<0,t=t<<30|t>>>2,i=s&t|~s&e,o=r<<5|r>>>27,n=o+i+n+1518500249+u[a+2]<<0,s=s<<30|s>>>2,i=r&s|~r&t,o=n<<5|n>>>27,e=o+i+e+1518500249+u[a+3]<<0,r=r<<30|r>>>2,i=n&r|~n&s,o=e<<5|e>>>27,t=o+i+t+1518500249+u[a+4]<<0,n=n<<30|n>>>2;for(;a<40;a+=5)i=e^n^r,o=t<<5|t>>>27,s=o+i+s+1859775393+u[a]<<0,e=e<<30|e>>>2,i=t^e^n,o=s<<5|s>>>27,r=o+i+r+1859775393+u[a+1]<<0,t=t<<30|t>>>2,i=s^t^e,o=r<<5|r>>>27,n=o+i+n+1859775393+u[a+2]<<0,s=s<<30|s>>>2,i=r^s^t,o=n<<5|n>>>27,e=o+i+e+1859775393+u[a+3]<<0,r=r<<30|r>>>2,i=n^r^s,o=e<<5|e>>>27,t=o+i+t+1859775393+u[a+4]<<0,n=n<<30|n>>>2;for(;a<60;a+=5)i=e&n|e&r|n&r,o=t<<5|t>>>27,s=o+i+s-1894007588+u[a]<<0,e=e<<30|e>>>2,i=t&e|t&n|e&n,o=s<<5|s>>>27,r=o+i+r-1894007588+u[a+1]<<0,t=t<<30|t>>>2,i=s&t|s&e|t&e,o=r<<5|r>>>27,n=o+i+n-1894007588+u[a+2]<<0,s=s<<30|s>>>2,i=r&s|r&t|s&t,o=n<<5|n>>>27,e=o+i+e-1894007588+u[a+3]<<0,r=r<<30|r>>>2,i=n&r|n&s|r&s,o=e<<5|e>>>27,t=o+i+t-1894007588+u[a+4]<<0,n=n<<30|n>>>2;for(;a<80;a+=5)i=e^n^r,o=t<<5|t>>>27,s=o+i+s-899497514+u[a]<<0,e=e<<30|e>>>2,i=t^e^n,o=s<<5|s>>>27,r=o+i+r-899497514+u[a+1]<<0,t=t<<30|t>>>2,i=s^t^e,o=r<<5|r>>>27,n=o+i+n-899497514+u[a+2]<<0,s=s<<30|s>>>2,i=r^s^t,o=n<<5|n>>>27,e=o+i+e-899497514+u[a+3]<<0,r=r<<30|r>>>2,i=n^r^s,o=e<<5|e>>>27,t=o+i+t-899497514+u[a+4]<<0,n=n<<30|n>>>2;this.h0=this.h0+t<<0,this.h1=this.h1+e<<0,this.h2=this.h2+n<<0,this.h3=this.h3+r<<0,this.h4=this.h4+s<<0};tr.prototype.hex=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4;return le[t>>28&15]+le[t>>24&15]+le[t>>20&15]+le[t>>16&15]+le[t>>12&15]+le[t>>8&15]+le[t>>4&15]+le[t&15]+le[e>>28&15]+le[e>>24&15]+le[e>>20&15]+le[e>>16&15]+le[e>>12&15]+le[e>>8&15]+le[e>>4&15]+le[e&15]+le[n>>28&15]+le[n>>24&15]+le[n>>20&15]+le[n>>16&15]+le[n>>12&15]+le[n>>8&15]+le[n>>4&15]+le[n&15]+le[r>>28&15]+le[r>>24&15]+le[r>>20&15]+le[r>>16&15]+le[r>>12&15]+le[r>>8&15]+le[r>>4&15]+le[r&15]+le[s>>28&15]+le[s>>24&15]+le[s>>20&15]+le[s>>16&15]+le[s>>12&15]+le[s>>8&15]+le[s>>4&15]+le[s&15]};tr.prototype.toString=tr.prototype.hex;tr.prototype.digest=function(){this.finalize();var t=this.h0,e=this.h1,n=this.h2,r=this.h3,s=this.h4;return[t>>24&255,t>>16&255,t>>8&255,t&255,e>>24&255,e>>16&255,e>>8&255,e&255,n>>24&255,n>>16&255,n>>8&255,n&255,r>>24&255,r>>16&255,r>>8&255,r&255,s>>24&255,s>>16&255,s>>8&255,s&255]};tr.prototype.array=tr.prototype.digest;tr.prototype.arrayBuffer=function(){this.finalize();var t=new ArrayBuffer(20),e=new DataView(t);return e.setUint32(0,this.h0),e.setUint32(4,this.h1),e.setUint32(8,this.h2),e.setUint32(12,this.h3),e.setUint32(16,this.h4),t};const GB=t=>new tr(!0).update(t).hex(),Dv=(...t)=>GB(t.join("_"));class ZB{}const JB=new Map;class Qy extends ZB{constructor(e){super(),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.cache=e??new Map}lookup(e,n){return Promise.resolve(this.cache.get(Dv(e,n))??null)}async update(e,n,r){this.cache.set(Dv(e,n),r)}static global(){return new Qy(JB)}}class vA extends Bs{}class KB extends vA{static lc_name(){return"StringPromptValue"}constructor(e){super({value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"value",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.value=e}toString(){return this.value}toChatMessages(){return[new wi(this.value)]}}class QB extends vA{static lc_name(){return"ChatPromptValue"}constructor(e){Array.isArray(e)&&(e={messages:e}),super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","prompt_values"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"messages",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.messages=e.messages}toString(){return YE(this.messages)}toChatMessages(){return this.messages}}var oh={};oh.byteLength=eU;oh.toByteArray=nU;oh.fromByteArray=iU;var mr=[],vn=[],XB=typeof Uint8Array<"u"?Uint8Array:Array,Ip="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/";for(var Zi=0,YB=Ip.length;Zi<YB;++Zi)mr[Zi]=Ip[Zi],vn[Ip.charCodeAt(Zi)]=Zi;vn[45]=62;vn[95]=63;function xA(t){var e=t.length;if(e%4>0)throw new Error("Invalid string. Length must be a multiple of 4");var n=t.indexOf("=");n===-1&&(n=e);var r=n===e?0:4-n%4;return[n,r]}function eU(t){var e=xA(t),n=e[0],r=e[1];return(n+r)*3/4-r}function tU(t,e,n){return(e+n)*3/4-n}function nU(t){var e,n=xA(t),r=n[0],s=n[1],i=new XB(tU(t,r,s)),a=0,o=s>0?r-4:r,u;for(u=0;u<o;u+=4)e=vn[t.charCodeAt(u)]<<18|vn[t.charCodeAt(u+1)]<<12|vn[t.charCodeAt(u+2)]<<6|vn[t.charCodeAt(u+3)],i[a++]=e>>16&255,i[a++]=e>>8&255,i[a++]=e&255;return s===2&&(e=vn[t.charCodeAt(u)]<<2|vn[t.charCodeAt(u+1)]>>4,i[a++]=e&255),s===1&&(e=vn[t.charCodeAt(u)]<<10|vn[t.charCodeAt(u+1)]<<4|vn[t.charCodeAt(u+2)]>>2,i[a++]=e>>8&255,i[a++]=e&255),i}function rU(t){return mr[t>>18&63]+mr[t>>12&63]+mr[t>>6&63]+mr[t&63]}function sU(t,e,n){for(var r,s=[],i=e;i<n;i+=3)r=(t[i]<<16&16711680)+(t[i+1]<<8&65280)+(t[i+2]&255),s.push(rU(r));return s.join("")}function iU(t){for(var e,n=t.length,r=n%3,s=[],i=16383,a=0,o=n-r;a<o;a+=i)s.push(sU(t,a,a+i>o?o:a+i));return r===1?(e=t[n-1],s.push(mr[e>>2]+mr[e<<4&63]+"==")):r===2&&(e=(t[n-2]<<8)+t[n-1],s.push(mr[e>>10]+mr[e>>4&63]+mr[e<<2&63]+"=")),s.join("")}var aU=Object.defineProperty,oU=(t,e,n)=>e in t?aU(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,uU=(t,e,n)=>(oU(t,e+"",n),n);function lU(t,e){let n=Array.from({length:t.length},(r,s)=>({start:s,end:s+1}));for(;n.length>1;){let r=null;for(let s=0;s<n.length-1;s++){const i=t.slice(n[s].start,n[s+1].end),a=e.get(i.join(","));a!=null&&(r==null||a<r[0])&&(r=[a,s])}if(r!=null){const s=r[1];n[s]={start:n[s].start,end:n[s+1].end},n.splice(s+1,1)}else break}return n}function cU(t,e){return t.length===1?[e.get(t.join(","))]:lU(t,e).map(n=>e.get(t.slice(n.start,n.end).join(","))).filter(n=>n!=null)}function dU(t){return t.replace(/[\\^$*+?.()|[\]{}]/g,"\\$&")}var Cg=class{specialTokens;inverseSpecialTokens;patStr;textEncoder=new TextEncoder;textDecoder=new TextDecoder("utf-8");rankMap=new Map;textMap=new Map;constructor(t,e){this.patStr=t.pat_str;const n=t.bpe_ranks.split(`
`).filter(Boolean).reduce((r,s)=>{const[i,a,...o]=s.split(" "),u=Number.parseInt(a,10);return o.forEach((l,c)=>r[l]=u+c),r},{});for(const[r,s]of Object.entries(n)){const i=oh.toByteArray(r);this.rankMap.set(i.join(","),s),this.textMap.set(s,i)}this.specialTokens={...t.special_tokens,...e},this.inverseSpecialTokens=Object.entries(this.specialTokens).reduce((r,[s,i])=>(r[i]=this.textEncoder.encode(s),r),{})}encode(t,e=[],n="all"){const r=new RegExp(this.patStr,"ug"),s=Cg.specialTokenRegex(Object.keys(this.specialTokens)),i=[],a=new Set(e==="all"?Object.keys(this.specialTokens):e),o=new Set(n==="all"?Object.keys(this.specialTokens).filter(l=>!a.has(l)):n);if(o.size>0){const l=Cg.specialTokenRegex([...o]),c=t.match(l);if(c!=null)throw new Error(`The text contains a special token that is not allowed: ${c[0]}`)}let u=0;for(;;){let l=null,c=u;for(;s.lastIndex=c,l=s.exec(t),!(l==null||a.has(l[0]));)c=l.index+1;const d=l?.index??t.length;for(const h of t.substring(u,d).matchAll(r)){const m=this.textEncoder.encode(h[0]),y=this.rankMap.get(m.join(","));if(y!=null){i.push(y);continue}i.push(...cU(m,this.rankMap))}if(l==null)break;let f=this.specialTokens[l[0]];i.push(f),u=l.index+l[0].length}return i}decode(t){const e=[];let n=0;for(let i=0;i<t.length;++i){const a=t[i],o=this.textMap.get(a)??this.inverseSpecialTokens[a];o!=null&&(e.push(o),n+=o.length)}const r=new Uint8Array(n);let s=0;for(const i of e)r.set(i,s),s+=i.length;return this.textDecoder.decode(r)}},SA=Cg;uU(SA,"specialTokenRegex",t=>new RegExp(t.map(e=>dU(e)).join("|"),"g"));function fU(t){switch(t){case"gpt2":return"gpt2";case"code-cushman-001":case"code-cushman-002":case"code-davinci-001":case"code-davinci-002":case"cushman-codex":case"davinci-codex":case"davinci-002":case"text-davinci-002":case"text-davinci-003":return"p50k_base";case"code-davinci-edit-001":case"text-davinci-edit-001":return"p50k_edit";case"ada":case"babbage":case"babbage-002":case"code-search-ada-code-001":case"code-search-babbage-code-001":case"curie":case"davinci":case"text-ada-001":case"text-babbage-001":case"text-curie-001":case"text-davinci-001":case"text-search-ada-doc-001":case"text-search-babbage-doc-001":case"text-search-curie-doc-001":case"text-search-davinci-doc-001":case"text-similarity-ada-001":case"text-similarity-babbage-001":case"text-similarity-curie-001":case"text-similarity-davinci-001":return"r50k_base";case"gpt-3.5-turbo-instruct-0914":case"gpt-3.5-turbo-instruct":case"gpt-3.5-turbo-16k-0613":case"gpt-3.5-turbo-16k":case"gpt-3.5-turbo-0613":case"gpt-3.5-turbo-0301":case"gpt-3.5-turbo":case"gpt-4-32k-0613":case"gpt-4-32k-0314":case"gpt-4-32k":case"gpt-4-0613":case"gpt-4-0314":case"gpt-4":case"gpt-3.5-turbo-1106":case"gpt-35-turbo":case"gpt-4-1106-preview":case"gpt-4-vision-preview":case"gpt-3.5-turbo-0125":case"gpt-4-turbo":case"gpt-4-turbo-2024-04-09":case"gpt-4-turbo-preview":case"gpt-4-0125-preview":case"text-embedding-ada-002":case"text-embedding-3-small":case"text-embedding-3-large":return"cl100k_base";case"gpt-4o":case"gpt-4o-2024-05-13":case"gpt-4o-2024-08-06":case"gpt-4o-mini-2024-07-18":case"gpt-4o-mini":case"o1-2024-12-17":case"o1-mini":case"o1-preview":case"o1-preview-2024-09-12":case"o1-mini-2024-09-12":case"chatgpt-4o-latest":case"gpt-4o-realtime":case"gpt-4o-realtime-preview-2024-10-01":return"o200k_base";default:throw new Error("Unknown model")}}const kc={},hU=new eh({});async function pU(t){return t in kc||(kc[t]=hU.fetch(`https://tiktoken.pages.dev/js/${t}.json`).then(e=>e.json()).then(e=>new SA(e)).catch(e=>{throw delete kc[t],e})),await kc[t]}async function mU(t){return pU(fU(t))}const gU=t=>t.startsWith("gpt-3.5-turbo-16k")?"gpt-3.5-turbo-16k":t.startsWith("gpt-3.5-turbo-")?"gpt-3.5-turbo":t.startsWith("gpt-4-32k")?"gpt-4-32k":t.startsWith("gpt-4-")?"gpt-4":t.startsWith("gpt-4o")?"gpt-4o":t;function yU(t){return typeof t!="object"||!t?!1:!!("type"in t&&t.type==="function"&&"function"in t&&typeof t.function=="object"&&t.function&&"name"in t.function&&"parameters"in t.function)}const bU=()=>!1;class wU extends it{get lc_attributes(){return{callbacks:void 0,verbose:void 0}}constructor(e){super(e),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.verbose=e.verbose??bU(),this.callbacks=e.callbacks,this.tags=e.tags??[],this.metadata=e.metadata??{}}}class _U extends wU{get callKeys(){return["stop","timeout","signal","tags","metadata","callbacks"]}constructor({callbacks:e,callbackManager:n,...r}){const{cache:s,...i}=r;super({callbacks:e??n,...i}),Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"cache",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"_encoding",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),typeof s=="object"?this.cache=s:s?this.cache=Qy.global():this.cache=void 0,this.caller=new eh(r??{})}async getNumTokens(e){if(typeof e!="string")return 0;let n=Math.ceil(e.length/4);if(!this._encoding)try{this._encoding=await mU("modelName"in this?gU(this.modelName):"gpt2")}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}if(this._encoding)try{n=this._encoding.encode(e).length}catch(r){console.warn("Failed to calculate number of tokens, falling back to approximate count",r)}return n}static _convertInputToPromptValue(e){return typeof e=="string"?new KB(e):Array.isArray(e)?new QB(e.map(Zo)):e}_identifyingParams(){return{}}_getSerializedCacheKeyParametersForCall({config:e,...n}){const r={...this._identifyingParams(),...n,_type:this._llmType(),_model:this._modelType()};return Object.entries(r).filter(([a,o])=>o!==void 0).map(([a,o])=>`${a}:${JSON.stringify(o)}`).sort().join(",")}serialize(){return{...this._identifyingParams(),_type:this._llmType(),_model:this._modelType()}}static async deserialize(e){throw new Error("Use .toJSON() instead")}}class Yd extends it{static lc_name(){return"RunnablePassthrough"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","runnables"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"func",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),e&&(this.func=e.func)}async invoke(e,n){const r=Se(n);return this.func&&await this.func(e,r),this._callWithConfig(s=>Promise.resolve(s),e,r)}async*transform(e,n){const r=Se(n);let s,i=!0;for await(const a of this._transformStreamWithConfig(e,o=>o,r))if(yield a,i)if(s===void 0)s=a;else try{s=Qn(s,a)}catch{s=void 0,i=!1}this.func&&s!==void 0&&await this.func(s,r)}static assign(e){return new l3(new bo({steps:e}))}}function kA(t){return typeof t?.parse=="function"}class gs extends _U{constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","chat_models",this._llmType()]}),Object.defineProperty(this,"disableStreaming",{enumerable:!0,configurable:!0,writable:!0,value:!1})}_separateRunnableConfigFromCallOptionsCompat(e){const[n,r]=super._separateRunnableConfigFromCallOptions(e);return r.signal=n.signal,[n,r]}async invoke(e,n){const r=gs._convertInputToPromptValue(e);return(await this.generatePrompt([r],n,n?.callbacks)).generations[0][0].message}async*_streamResponseChunks(e,n,r){throw new Error("Not implemented.")}async*_streamIterator(e,n){if(this._streamResponseChunks===gs.prototype._streamResponseChunks||this.disableStreaming)yield this.invoke(e,n);else{const s=gs._convertInputToPromptValue(e).toChatMessages(),[i,a]=this._separateRunnableConfigFromCallOptionsCompat(n),o={...i.metadata,...this.getLsParams(a)},u=await Lt.configure(i.callbacks,this.callbacks,i.tags,this.tags,o,this.metadata,{verbose:this.verbose}),l={options:a,invocation_params:this?.invocationParams(a),batch_size:1},c=await u?.handleChatModelStart(this.toJSON(),[s],i.runId,void 0,l,void 0,void 0,i.runName);let d,f;try{for await(const h of this._streamResponseChunks(s,a,c?.[0])){if(h.message.id==null){const m=c?.at(0)?.runId;m!=null&&h.message._updateId(`run-${m}`)}h.message.response_metadata={...h.generationInfo,...h.message.response_metadata},yield h.message,d?d=d.concat(h):d=h,rv(h.message)&&h.message.usage_metadata!==void 0&&(f={tokenUsage:{promptTokens:h.message.usage_metadata.input_tokens,completionTokens:h.message.usage_metadata.output_tokens,totalTokens:h.message.usage_metadata.total_tokens}})}}catch(h){throw await Promise.all((c??[]).map(m=>m?.handleLLMError(h))),h}await Promise.all((c??[]).map(h=>h?.handleLLMEnd({generations:[[d]],llmOutput:f})))}}getLsParams(e){const n=this.getName().startsWith("Chat")?this.getName().replace("Chat",""):this.getName();return{ls_model_type:"chat",ls_stop:e.stop,ls_provider:n}}async _generateUncached(e,n,r){const s=e.map(h=>h.map(Zo)),i={...r.metadata,...this.getLsParams(n)},a=await Lt.configure(r.callbacks,this.callbacks,r.tags,this.tags,i,this.metadata,{verbose:this.verbose}),o={options:n,invocation_params:this?.invocationParams(n),batch_size:1},u=await a?.handleChatModelStart(this.toJSON(),s,r.runId,void 0,o,void 0,void 0,r.runName),l=[],c=[];if(!!u?.[0].handlers.find(i7)&&s.length===1&&this._streamResponseChunks!==gs.prototype._streamResponseChunks)try{const h=await this._streamResponseChunks(s[0],n,u?.[0]);let m,y;for await(const w of h){if(w.message.id==null){const p=u?.at(0)?.runId;p!=null&&w.message._updateId(`run-${p}`)}m===void 0?m=w:m=Qn(m,w),rv(w.message)&&w.message.usage_metadata!==void 0&&(y={tokenUsage:{promptTokens:w.message.usage_metadata.input_tokens,completionTokens:w.message.usage_metadata.output_tokens,totalTokens:w.message.usage_metadata.total_tokens}})}if(m===void 0)throw new Error("Received empty response from chat model call.");l.push([m]),await u?.[0].handleLLMEnd({generations:l,llmOutput:y})}catch(h){throw await u?.[0].handleLLMError(h),h}else{const h=await Promise.allSettled(s.map((m,y)=>this._generate(m,{...n,promptIndex:y},u?.[y])));await Promise.all(h.map(async(m,y)=>{if(m.status==="fulfilled"){const w=m.value;for(const p of w.generations){if(p.message.id==null){const b=u?.at(0)?.runId;b!=null&&p.message._updateId(`run-${b}`)}p.message.response_metadata={...p.generationInfo,...p.message.response_metadata}}return w.generations.length===1&&(w.generations[0].message.response_metadata={...w.llmOutput,...w.generations[0].message.response_metadata}),l[y]=w.generations,c[y]=w.llmOutput,u?.[y]?.handleLLMEnd({generations:[w.generations],llmOutput:w.llmOutput})}else return await u?.[y]?.handleLLMError(m.reason),Promise.reject(m.reason)}))}const f={generations:l,llmOutput:c.length?this._combineLLMOutput?.(...c):void 0};return Object.defineProperty(f,cv,{value:u?{runIds:u?.map(h=>h.runId)}:void 0,configurable:!0}),f}async _generateCached({messages:e,cache:n,llmStringKey:r,parsedOptions:s,handledOptions:i}){const a=e.map(w=>w.map(Zo)),o={...i.metadata,...this.getLsParams(s)},u=await Lt.configure(i.callbacks,this.callbacks,i.tags,this.tags,o,this.metadata,{verbose:this.verbose}),l={options:s,invocation_params:this?.invocationParams(s),batch_size:1,cached:!0},c=await u?.handleChatModelStart(this.toJSON(),a,i.runId,void 0,l,void 0,void 0,i.runName),d=[],h=(await Promise.allSettled(a.map(async(w,p)=>{const b=gs._convertInputToPromptValue(w).toString(),_=await n.lookup(b,r);return _==null&&d.push(p),_}))).map((w,p)=>({result:w,runManager:c?.[p]})).filter(({result:w})=>w.status==="fulfilled"&&w.value!=null||w.status==="rejected"),m=[];await Promise.all(h.map(async({result:w,runManager:p},b)=>{if(w.status==="fulfilled"){const _=w.value;return m[b]=_,_.length&&await p?.handleLLMNewToken(_[0].text),p?.handleLLMEnd({generations:[_]})}else return await p?.handleLLMError(w.reason),Promise.reject(w.reason)}));const y={generations:m,missingPromptIndices:d};return Object.defineProperty(y,cv,{value:c?{runIds:c?.map(w=>w.runId)}:void 0,configurable:!0}),y}async generate(e,n,r){let s;Array.isArray(n)?s={stop:n}:s=n;const i=e.map(h=>h.map(Zo)),[a,o]=this._separateRunnableConfigFromCallOptionsCompat(s);if(a.callbacks=a.callbacks??r,!this.cache)return this._generateUncached(i,o,a);const{cache:u}=this,l=this._getSerializedCacheKeyParametersForCall(o),{generations:c,missingPromptIndices:d}=await this._generateCached({messages:i,cache:u,llmStringKey:l,parsedOptions:o,handledOptions:a});let f={};if(d.length>0){const h=await this._generateUncached(d.map(m=>i[m]),o,a);await Promise.all(h.generations.map(async(m,y)=>{const w=d[y];c[w]=m;const p=gs._convertInputToPromptValue(i[w]).toString();return u.update(p,l,m)})),f=h.llmOutput??{}}return{generations:c,llmOutput:f}}invocationParams(e){return{}}_modelType(){return"base_chat_model"}serialize(){return{...this.invocationParams(),_type:this._llmType(),_model:this._modelType()}}async generatePrompt(e,n,r){const s=e.map(i=>i.toChatMessages());return this.generate(s,n,r)}async call(e,n,r){return(await this.generate([e.map(Zo)],n,r)).generations[0][0].message}async callPrompt(e,n,r){const s=e.toChatMessages();return this.call(s,n,r)}async predictMessages(e,n,r){return this.call(e,n,r)}async predict(e,n,r){const s=new wi(e),i=await this.call([s],n,r);if(typeof i.content!="string")throw new Error("Cannot use predict when output is not a string.");return i.content}withStructuredOutput(e,n){if(typeof this.bindTools!="function")throw new Error('Chat model must implement ".bindTools()" to use withStructuredOutput.');if(n?.strict)throw new Error('"strict" mode is not supported for this model by default.');const r=e,s=n?.name,i=r.description??"A function available to call.",a=n?.method,o=n?.includeRaw;if(a==="jsonMode")throw new Error('Base withStructuredOutput implementation only supports "functionCalling" as a method.');let u=s??"extract",l;kA(r)?l=[{type:"function",function:{name:u,description:i,parameters:Al(r)}}]:("name"in r&&(u=r.name),l=[{type:"function",function:{name:u,description:i,parameters:r}}]);const c=this.bindTools(l),d=Tl.from(y=>{if(!y.tool_calls||y.tool_calls.length===0)throw new Error("No tool calls found in the response.");const w=y.tool_calls.find(p=>p.name===u);if(!w)throw new Error(`No tool call found with name ${u}.`);return w.args});if(!o)return c.pipe(d).withConfig({runName:"StructuredOutput"});const f=Yd.assign({parsed:(y,w)=>d.invoke(y.raw,w)}),h=Yd.assign({parsed:()=>null}),m=f.withFallbacks({fallbacks:[h]});return Hr.from([{raw:c},m]).withConfig({runName:"StructuredOutputRunnable"})}}class vU extends it{parseResultWithPrompt(e,n,r){return this.parseResult(e,r)}_baseMessageToString(e){return typeof e.content=="string"?e.content:this._baseMessageContentToString(e.content)}_baseMessageContentToString(e){return JSON.stringify(e)}async invoke(e,n){return typeof e=="string"?this._callWithConfig(async(r,s)=>this.parseResult([{text:r}],s?.callbacks),e,{...n,runType:"parser"}):this._callWithConfig(async(r,s)=>this.parseResult([{message:r,text:this._baseMessageToString(r)}],s?.callbacks),e,{...n,runType:"parser"})}}class EA extends vU{parseResult(e,n){return this.parse(e[0].text,n)}async parseWithPrompt(e,n,r){return this.parse(e,r)}_type(){throw new Error("_type not implemented")}}class Xy extends Error{constructor(e,n,r,s=!1){if(super(e),Object.defineProperty(this,"llmOutput",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"observation",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"sendToLLM",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.llmOutput=n,this.observation=r,this.sendToLLM=s,s&&(r===void 0||n===void 0))throw new Error("Arguments 'observation' & 'llmOutput' are required if 'sendToLlm' is true");QE(this,"OUTPUT_PARSING_FAILURE")}}function Pg(t,e){const n=typeof t;if(n!==typeof e)return!1;if(Array.isArray(t)){if(!Array.isArray(e))return!1;const r=t.length;if(r!==e.length)return!1;for(let s=0;s<r;s++)if(!Pg(t[s],e[s]))return!1;return!0}if(n==="object"){if(!t||!e)return t===e;const r=Object.keys(t),s=Object.keys(e);if(r.length!==s.length)return!1;for(const a of r)if(!Pg(t[a],e[a]))return!1;return!0}return t===e}class xU extends EA{async*_transform(e){for await(const n of e)typeof n=="string"?yield this.parseResult([{text:n}]):yield this.parseResult([{message:n,text:this._baseMessageToString(n)}])}async*transform(e,n){yield*this._transformStreamWithConfig(e,this._transform.bind(this),{...n,runType:"parser"})}}class AA extends xU{constructor(e){super(e),Object.defineProperty(this,"diff",{enumerable:!0,configurable:!0,writable:!0,value:!1}),this.diff=e?.diff??this.diff}async*_transform(e){let n,r;for await(const s of e){if(typeof s!="string"&&typeof s.content!="string")throw new Error("Cannot handle non-string output.");let i;if(m7(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");i=new Ga({message:s,text:s.content})}else if(Sy(s)){if(typeof s.content!="string")throw new Error("Cannot handle non-string message output.");i=new Ga({message:_7(s),text:s.content})}else i=new Wa({text:s});r===void 0?r=i:r=r.concat(i);const a=await this.parsePartialResult([r]);a!=null&&!Pg(a,n)&&(this.diff?yield this._diff(n,a):yield a,n=a)}}getFormatInstructions(){return""}}class Fv extends EA{static lc_name(){return"StructuredOutputParser"}toJSON(){return this.toJSONNotImplemented()}constructor(e){super(e),Object.defineProperty(this,"schema",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","structured"]})}static fromZodSchema(e){return new this(e)}static fromNamesAndDescriptions(e){const n=bi.object(Object.fromEntries(Object.entries(e).map(([r,s])=>[r,bi.string().describe(s)])));return new this(n)}getFormatInstructions(){return`You must format your output as a JSON value that adheres to a given "JSON Schema" instance.

"JSON Schema" is a declarative language that allows you to annotate and validate JSON documents.

For example, the example "JSON Schema" instance {{"properties": {{"foo": {{"description": "a list of test words", "type": "array", "items": {{"type": "string"}}}}}}, "required": ["foo"]}}}}
would match an object with one required property, "foo". The "type" property specifies "foo" must be an "array", and the "description" property semantically describes it as "a list of test words". The items within "foo" must be strings.
Thus, the object {{"foo": ["bar", "baz"]}} is a well-formatted instance of this example "JSON Schema". The object {{"properties": {{"foo": ["bar", "baz"]}}}} is not well-formatted.

Your output will be parsed and type-checked according to the provided schema instance, so make sure all fields in your output match the schema exactly and there are no trailing commas!

Here is the JSON Schema instance your output must adhere to. Include the enclosing markdown codeblock:
\`\`\`json
${JSON.stringify(Al(this.schema))}
\`\`\`
`}async parse(e){try{const r=(e.includes("```")?e.trim().split(/```(?:json)?/)[1]:e.trim()).replace(/"([^"\\]*(\\.[^"\\]*)*)"/g,(s,i)=>`"${i.replace(/\n/g,"\\n")}"`).replace(/\n/g,"");return await this.schema.parseAsync(JSON.parse(r))}catch(n){throw new Xy(`Failed to parse. Text: "${e}". Error: ${n}`,e)}}}class Bv extends AA{constructor(){super(...arguments),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain_core","output_parsers"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0})}static lc_name(){return"JsonOutputParser"}_diff(e,n){if(n)return e?FD(e,n):[{op:"replace",path:"",value:n}]}async parsePartialResult(e){return nv(e[0].text)}async parse(e){return nv(e,JSON.parse)}getFormatInstructions(){return""}}function TA(t,e){if(t.function===void 0)return;let n;if(e?.partial)try{n=xy(t.function.arguments??"{}")}catch{return}else try{n=JSON.parse(t.function.arguments)}catch(s){throw new Xy([`Function "${t.function.name}" arguments:`,"",t.function.arguments,"","are not valid JSON.",`Error: ${s.message}`].join(`
`))}const r={name:t.function.name,args:n,type:"tool_call"};return e?.returnId&&(r.id=t.id),r}function SU(t){if(t.id===void 0)throw new Error('All OpenAI tool calls must have an "id" field.');return{id:t.id,type:"function",function:{name:t.name,arguments:JSON.stringify(t.args)}}}function kU(t,e){return{name:t.function?.name,args:t.function?.arguments,id:t.id,error:e,type:"invalid_tool_call"}}class EU extends AA{static lc_name(){return"JsonOutputToolsParser"}constructor(e){super(e),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),this.returnId=e?.returnId??this.returnId}_diff(){throw new Error("Not supported.")}async parse(){throw new Error("Not implemented.")}async parseResult(e){return await this.parsePartialResult(e,!1)}async parsePartialResult(e,n=!0){const r=e[0].message;let s;if(Ey(r)&&r.tool_calls?.length?s=r.tool_calls.map(a=>{const{id:o,...u}=a;return this.returnId?{id:o,...u}:u}):r.additional_kwargs.tool_calls!==void 0&&(s=JSON.parse(JSON.stringify(r.additional_kwargs.tool_calls)).map(o=>TA(o,{returnId:this.returnId,partial:n}))),!s)return[];const i=[];for(const a of s)if(a!==void 0){const o={type:a.name,args:a.args,id:a.id};i.push(o)}return i}}class Uv extends EU{static lc_name(){return"JsonOutputKeyToolsParser"}constructor(e){super(e),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","output_parsers","openai_tools"]}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"returnId",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"keyName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"returnSingle",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"zodSchema",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.keyName=e.keyName,this.returnSingle=e.returnSingle??this.returnSingle,this.zodSchema=e.zodSchema}async _validateResult(e){if(this.zodSchema===void 0)return e;const n=await this.zodSchema.safeParseAsync(e);if(n.success)return n.data;throw new Xy(`Failed to parse. Text: "${JSON.stringify(e,null,2)}". Error: ${JSON.stringify(n.error.errors)}`,JSON.stringify(e,null,2))}async parsePartialResult(e){const r=(await super.parsePartialResult(e)).filter(i=>i.type===this.keyName);let s=r;if(r.length)return this.returnId||(s=r.map(i=>i.args)),this.returnSingle?s[0]:s}async parseResult(e){const r=(await super.parsePartialResult(e,!1)).filter(a=>a.type===this.keyName);let s=r;return r.length?(this.returnId||(s=r.map(a=>a.args)),this.returnSingle?this._validateResult(s[0]):await Promise.all(s.map(a=>this._validateResult(a)))):void 0}}const AU=Symbol("Let zodToJsonSchema decide on which parser to use"),zv={name:void 0,$refStrategy:"root",effectStrategy:"input",pipeStrategy:"all",dateStrategy:"format:date-time",mapStrategy:"entries",nullableStrategy:"from-target",removeAdditionalStrategy:"passthrough",definitionPath:"definitions",target:"jsonSchema7",strictUnions:!1,errorMessages:!1,markdownDescription:!1,patternStrategy:"escape",applyRegexFlags:!1,emailStrategy:"format:email",base64Strategy:"contentEncoding:base64",nameStrategy:"ref"},TU=t=>typeof t=="string"?{...zv,basePath:["#"],definitions:{},name:t}:{...zv,basePath:["#"],definitions:{},...t},Og=t=>"_def"in t?t._def:t;function CU(t){if(!t)return!0;for(const e in t)return!1;return!0}const PU=t=>{const e=TU(t),n=e.name!==void 0?[...e.basePath,e.definitionPath,e.name]:e.basePath;return{...e,currentPath:n,propertyPath:void 0,seenRefs:new Set,seen:new Map(Object.entries(e.definitions).map(([r,s])=>[Og(s),{def:Og(s),path:[...e.basePath,e.definitionPath,r],jsonSchema:void 0}]))}};function CA(t,e,n,r){r?.errorMessages&&n&&(t.errorMessage={...t.errorMessage,[e]:n})}function Ne(t,e,n,r,s){t[e]=n,CA(t,e,r,s)}function OU(){return{}}function NU(t,e){const n={type:"array"};return t.type?._def?.typeName!==P.ZodAny&&(n.items=ke(t.type._def,{...e,currentPath:[...e.currentPath,"items"]})),t.minLength&&Ne(n,"minItems",t.minLength.value,t.minLength.message,e),t.maxLength&&Ne(n,"maxItems",t.maxLength.value,t.maxLength.message,e),t.exactLength&&(Ne(n,"minItems",t.exactLength.value,t.exactLength.message,e),Ne(n,"maxItems",t.exactLength.value,t.exactLength.message,e)),n}function IU(t,e){const n={type:"integer",format:"int64"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"min":e.target==="jsonSchema7"?r.inclusive?Ne(n,"minimum",r.value,r.message,e):Ne(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ne(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ne(n,"maximum",r.value,r.message,e):Ne(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ne(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ne(n,"multipleOf",r.value,r.message,e);break}return n}function RU(){return{type:"boolean"}}function jU(t,e){return ke(t.type._def,e)}const $U=(t,e)=>ke(t.innerType._def,e);function PA(t,e,n){const r=n??e.dateStrategy;if(Array.isArray(r))return{anyOf:r.map((s,i)=>PA(t,e,s))};switch(r){case"string":case"format:date-time":return{type:"string",format:"date-time"};case"format:date":return{type:"string",format:"date"};case"integer":return LU(t,e)}}const LU=(t,e)=>{const n={type:"integer",format:"unix-time"};if(e.target==="openApi3")return n;for(const r of t.checks)switch(r.kind){case"min":Ne(n,"minimum",r.value,r.message,e);break;case"max":Ne(n,"maximum",r.value,r.message,e);break}return n};function MU(t,e){return{...ke(t.innerType._def,e),default:t.defaultValue()}}function DU(t,e,n){return e.effectStrategy==="input"?ke(t.schema._def,e,n):{}}function FU(t){return{type:"string",enum:[...t.values]}}const BU=t=>"type"in t&&t.type==="string"?!1:"allOf"in t;function UU(t,e){const n=[ke(t.left._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),ke(t.right._def,{...e,currentPath:[...e.currentPath,"allOf","1"]})].filter(i=>!!i);let r=e.target==="jsonSchema2019-09"?{unevaluatedProperties:!1}:void 0;const s=[];return n.forEach(i=>{if(BU(i))s.push(...i.allOf),i.unevaluatedProperties===void 0&&(r=void 0);else{let a=i;if("additionalProperties"in i&&i.additionalProperties===!1){const{additionalProperties:o,...u}=i;a=u}else r=void 0;s.push(a)}}),s.length?{allOf:s,...r}:void 0}function zU(t,e){const n=typeof t.value;return n!=="bigint"&&n!=="number"&&n!=="boolean"&&n!=="string"?{type:Array.isArray(t.value)?"array":"object"}:e.target==="openApi3"?{type:n==="bigint"?"integer":n,enum:[t.value]}:{type:n==="bigint"?"integer":n,const:t.value}}let Rp;const Qs={cuid:/^[cC][^\s-]{8,}$/,cuid2:/^[0-9a-z]+$/,ulid:/^[0-9A-HJKMNP-TV-Z]{26}$/,email:/^(?!\.)(?!.*\.\.)([a-zA-Z0-9_'+\-\.]*)[a-zA-Z0-9_+-]@([a-zA-Z0-9][a-zA-Z0-9\-]*\.)+[a-zA-Z]{2,}$/,emoji:()=>(Rp===void 0&&(Rp=RegExp("^(\\p{Extended_Pictographic}|\\p{Emoji_Component})+$","u")),Rp),uuid:/^[0-9a-fA-F]{8}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{4}\b-[0-9a-fA-F]{12}$/,ipv4:/^(?:(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])\.){3}(?:25[0-5]|2[0-4][0-9]|1[0-9][0-9]|[1-9][0-9]|[0-9])$/,ipv6:/^(([a-f0-9]{1,4}:){7}|::([a-f0-9]{1,4}:){0,6}|([a-f0-9]{1,4}:){1}:([a-f0-9]{1,4}:){0,5}|([a-f0-9]{1,4}:){2}:([a-f0-9]{1,4}:){0,4}|([a-f0-9]{1,4}:){3}:([a-f0-9]{1,4}:){0,3}|([a-f0-9]{1,4}:){4}:([a-f0-9]{1,4}:){0,2}|([a-f0-9]{1,4}:){5}:([a-f0-9]{1,4}:){0,1})([a-f0-9]{1,4}|(((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2}))\.){3}((25[0-5])|(2[0-4][0-9])|(1[0-9]{2})|([0-9]{1,2})))$/,base64:/^([0-9a-zA-Z+/]{4})*(([0-9a-zA-Z+/]{2}==)|([0-9a-zA-Z+/]{3}=))?$/,nanoid:/^[a-zA-Z0-9_-]{21}$/};function OA(t,e){const n={type:"string"};function r(s){return e.patternStrategy==="escape"?qU(s):s}if(t.checks)for(const s of t.checks)switch(s.kind){case"min":Ne(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e);break;case"max":Ne(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"email":switch(e.emailStrategy){case"format:email":Ln(n,"email",s.message,e);break;case"format:idn-email":Ln(n,"idn-email",s.message,e);break;case"pattern:zod":Mn(n,Qs.email,s.message,e);break}break;case"url":Ln(n,"uri",s.message,e);break;case"uuid":Ln(n,"uuid",s.message,e);break;case"regex":Mn(n,s.regex,s.message,e);break;case"cuid":Mn(n,Qs.cuid,s.message,e);break;case"cuid2":Mn(n,Qs.cuid2,s.message,e);break;case"startsWith":Mn(n,RegExp(`^${r(s.value)}`),s.message,e);break;case"endsWith":Mn(n,RegExp(`${r(s.value)}$`),s.message,e);break;case"datetime":Ln(n,"date-time",s.message,e);break;case"date":Ln(n,"date",s.message,e);break;case"time":Ln(n,"time",s.message,e);break;case"duration":Ln(n,"duration",s.message,e);break;case"length":Ne(n,"minLength",typeof n.minLength=="number"?Math.max(n.minLength,s.value):s.value,s.message,e),Ne(n,"maxLength",typeof n.maxLength=="number"?Math.min(n.maxLength,s.value):s.value,s.message,e);break;case"includes":{Mn(n,RegExp(r(s.value)),s.message,e);break}case"ip":{s.version!=="v6"&&Ln(n,"ipv4",s.message,e),s.version!=="v4"&&Ln(n,"ipv6",s.message,e);break}case"emoji":Mn(n,Qs.emoji,s.message,e);break;case"ulid":{Mn(n,Qs.ulid,s.message,e);break}case"base64":{switch(e.base64Strategy){case"format:binary":{Ln(n,"binary",s.message,e);break}case"contentEncoding:base64":{Ne(n,"contentEncoding","base64",s.message,e);break}case"pattern:zod":{Mn(n,Qs.base64,s.message,e);break}}break}case"nanoid":Mn(n,Qs.nanoid,s.message,e)}return n}const qU=t=>Array.from(t).map(e=>/[a-zA-Z0-9]/.test(e)?e:`\\${e}`).join(""),Ln=(t,e,n,r)=>{t.format||t.anyOf?.some(s=>s.format)?(t.anyOf||(t.anyOf=[]),t.format&&(t.anyOf.push({format:t.format,...t.errorMessage&&r.errorMessages&&{errorMessage:{format:t.errorMessage.format}}}),delete t.format,t.errorMessage&&(delete t.errorMessage.format,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.anyOf.push({format:e,...n&&r.errorMessages&&{errorMessage:{format:n}}})):Ne(t,"format",e,n,r)},Mn=(t,e,n,r)=>{t.pattern||t.allOf?.some(s=>s.pattern)?(t.allOf||(t.allOf=[]),t.pattern&&(t.allOf.push({pattern:t.pattern,...t.errorMessage&&r.errorMessages&&{errorMessage:{pattern:t.errorMessage.pattern}}}),delete t.pattern,t.errorMessage&&(delete t.errorMessage.pattern,Object.keys(t.errorMessage).length===0&&delete t.errorMessage)),t.allOf.push({pattern:qv(e,r),...n&&r.errorMessages&&{errorMessage:{pattern:n}}})):Ne(t,"pattern",qv(e,r),n,r)},qv=(t,e)=>{const n=typeof t=="function"?t():t;if(!e.applyRegexFlags||!n.flags)return n.source;const r={i:n.flags.includes("i"),m:n.flags.includes("m"),s:n.flags.includes("s")},s=r.i?n.source.toLowerCase():n.source;let i="",a=!1,o=!1,u=!1;for(let l=0;l<s.length;l++){if(a){i+=s[l],a=!1;continue}if(r.i){if(o){if(s[l].match(/[a-z]/)){u?(i+=s[l],i+=`${s[l-2]}-${s[l]}`.toUpperCase(),u=!1):s[l+1]==="-"&&s[l+2]?.match(/[a-z]/)?(i+=s[l],u=!0):i+=`${s[l]}${s[l].toUpperCase()}`;continue}}else if(s[l].match(/[a-z]/)){i+=`[${s[l]}${s[l].toUpperCase()}]`;continue}}if(r.m){if(s[l]==="^"){i+=`(^|(?<=[\r
]))`;continue}else if(s[l]==="$"){i+=`($|(?=[\r
]))`;continue}}if(r.s&&s[l]==="."){i+=o?`${s[l]}\r
`:`[${s[l]}\r
]`;continue}i+=s[l],s[l]==="\\"?a=!0:o&&s[l]==="]"?o=!1:!o&&s[l]==="["&&(o=!0)}try{const l=new RegExp(i)}catch{return console.warn(`Could not convert regex pattern at ${e.currentPath.join("/")} to a flag-independent form! Falling back to the flag-ignorant source`),n.source}return i};function NA(t,e){if(e.target==="openApi3"&&t.keyType?._def.typeName===P.ZodEnum)return{type:"object",required:t.keyType._def.values,properties:t.keyType._def.values.reduce((r,s)=>({...r,[s]:ke(t.valueType._def,{...e,currentPath:[...e.currentPath,"properties",s]})??{}}),{}),additionalProperties:!1};const n={type:"object",additionalProperties:ke(t.valueType._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??{}};if(e.target==="openApi3")return n;if(t.keyType?._def.typeName===P.ZodString&&t.keyType._def.checks?.length){const r=Object.entries(OA(t.keyType._def,e)).reduce((s,[i,a])=>i==="type"?s:{...s,[i]:a},{});return{...n,propertyNames:r}}else if(t.keyType?._def.typeName===P.ZodEnum)return{...n,propertyNames:{enum:t.keyType._def.values}};return n}function HU(t,e){if(e.mapStrategy==="record")return NA(t,e);const n=ke(t.keyType._def,{...e,currentPath:[...e.currentPath,"items","items","0"]})||{},r=ke(t.valueType._def,{...e,currentPath:[...e.currentPath,"items","items","1"]})||{};return{type:"array",maxItems:125,items:{type:"array",items:[n,r],minItems:2,maxItems:2}}}function VU(t){const e=t.values,r=Object.keys(t.values).filter(i=>typeof e[e[i]]!="number").map(i=>e[i]),s=Array.from(new Set(r.map(i=>typeof i)));return{type:s.length===1?s[0]==="string"?"string":"number":["string","number"],enum:r}}function WU(){return{not:{}}}function GU(t){return t.target==="openApi3"?{enum:["null"],nullable:!0}:{type:"null"}}const ef={ZodString:"string",ZodNumber:"number",ZodBigInt:"integer",ZodBoolean:"boolean",ZodNull:"null"};function ZU(t,e){if(e.target==="openApi3")return Hv(t,e);const n=t.options instanceof Map?Array.from(t.options.values()):t.options;if(n.every(r=>r._def.typeName in ef&&(!r._def.checks||!r._def.checks.length))){const r=n.reduce((s,i)=>{const a=ef[i._def.typeName];return a&&!s.includes(a)?[...s,a]:s},[]);return{type:r.length>1?r:r[0]}}else if(n.every(r=>r._def.typeName==="ZodLiteral"&&!r.description)){const r=n.reduce((s,i)=>{const a=typeof i._def.value;switch(a){case"string":case"number":case"boolean":return[...s,a];case"bigint":return[...s,"integer"];case"object":if(i._def.value===null)return[...s,"null"];case"symbol":case"undefined":case"function":default:return s}},[]);if(r.length===n.length){const s=r.filter((i,a,o)=>o.indexOf(i)===a);return{type:s.length>1?s:s[0],enum:n.reduce((i,a)=>i.includes(a._def.value)?i:[...i,a._def.value],[])}}}else if(n.every(r=>r._def.typeName==="ZodEnum"))return{type:"string",enum:n.reduce((r,s)=>[...r,...s._def.values.filter(i=>!r.includes(i))],[])};return Hv(t,e)}const Hv=(t,e)=>{const n=(t.options instanceof Map?Array.from(t.options.values()):t.options).map((r,s)=>ke(r._def,{...e,currentPath:[...e.currentPath,"anyOf",`${s}`]})).filter(r=>!!r&&(!e.strictUnions||typeof r=="object"&&Object.keys(r).length>0));return n.length?{anyOf:n}:void 0};function JU(t,e){if(["ZodString","ZodNumber","ZodBigInt","ZodBoolean","ZodNull"].includes(t.innerType._def.typeName)&&(!t.innerType._def.checks||!t.innerType._def.checks.length))return e.target==="openApi3"||e.nullableStrategy==="property"?{type:ef[t.innerType._def.typeName],nullable:!0}:{type:[ef[t.innerType._def.typeName],"null"]};if(e.target==="openApi3"){const r=ke(t.innerType._def,{...e,currentPath:[...e.currentPath]});return r&&"$ref"in r?{allOf:[r],nullable:!0}:r&&{...r,nullable:!0}}const n=ke(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","0"]});return n&&{anyOf:[n,{type:"null"}]}}function KU(t,e){const n={type:"number"};if(!t.checks)return n;for(const r of t.checks)switch(r.kind){case"int":n.type="integer",CA(n,"type",r.message,e);break;case"min":e.target==="jsonSchema7"?r.inclusive?Ne(n,"minimum",r.value,r.message,e):Ne(n,"exclusiveMinimum",r.value,r.message,e):(r.inclusive||(n.exclusiveMinimum=!0),Ne(n,"minimum",r.value,r.message,e));break;case"max":e.target==="jsonSchema7"?r.inclusive?Ne(n,"maximum",r.value,r.message,e):Ne(n,"exclusiveMaximum",r.value,r.message,e):(r.inclusive||(n.exclusiveMaximum=!0),Ne(n,"maximum",r.value,r.message,e));break;case"multipleOf":Ne(n,"multipleOf",r.value,r.message,e);break}return n}function QU(t,e){return e.removeAdditionalStrategy==="strict"?t.catchall._def.typeName==="ZodNever"?t.unknownKeys!=="strict":ke(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0:t.catchall._def.typeName==="ZodNever"?t.unknownKeys==="passthrough":ke(t.catchall._def,{...e,currentPath:[...e.currentPath,"additionalProperties"]})??!0}function XU(t,e){const n={type:"object",...Object.entries(t.shape()).reduce((r,[s,i])=>{if(i===void 0||i._def===void 0)return r;const a=ke(i._def,{...e,currentPath:[...e.currentPath,"properties",s],propertyPath:[...e.currentPath,"properties",s]});return a===void 0?r:{properties:{...r.properties,[s]:a},required:i.isOptional()&&!e.openaiStrictMode?r.required:[...r.required,s]}},{properties:{},required:[]}),additionalProperties:QU(t,e)};return n.required.length||delete n.required,n}const YU=(t,e)=>{if(e.currentPath.toString()===e.propertyPath?.toString())return ke(t.innerType._def,e);const n=ke(t.innerType._def,{...e,currentPath:[...e.currentPath,"anyOf","1"]});return n?{anyOf:[{not:{}},n]}:{}},ez=(t,e)=>{if(e.pipeStrategy==="input")return ke(t.in._def,e);if(e.pipeStrategy==="output")return ke(t.out._def,e);const n=ke(t.in._def,{...e,currentPath:[...e.currentPath,"allOf","0"]}),r=ke(t.out._def,{...e,currentPath:[...e.currentPath,"allOf",n?"1":"0"]});return{allOf:[n,r].filter(s=>s!==void 0)}};function tz(t,e){return ke(t.type._def,e)}function nz(t,e){const r={type:"array",uniqueItems:!0,items:ke(t.valueType._def,{...e,currentPath:[...e.currentPath,"items"]})};return t.minSize&&Ne(r,"minItems",t.minSize.value,t.minSize.message,e),t.maxSize&&Ne(r,"maxItems",t.maxSize.value,t.maxSize.message,e),r}function rz(t,e){return t.rest?{type:"array",minItems:t.items.length,items:t.items.map((n,r)=>ke(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[]),additionalItems:ke(t.rest._def,{...e,currentPath:[...e.currentPath,"additionalItems"]})}:{type:"array",minItems:t.items.length,maxItems:t.items.length,items:t.items.map((n,r)=>ke(n._def,{...e,currentPath:[...e.currentPath,"items",`${r}`]})).reduce((n,r)=>r===void 0?n:[...n,r],[])}}function sz(){return{not:{}}}function iz(){return{}}const az=(t,e)=>ke(t.innerType._def,e);function ke(t,e,n=!1){const r=e.seen.get(t);if(e.override){const a=e.override?.(t,e,r,n);if(a!==AU)return a}if(r&&!n){const a=oz(r,e);if(a!==void 0)return"$ref"in a&&e.seenRefs.add(a.$ref),a}const s={def:t,path:e.currentPath,jsonSchema:void 0};e.seen.set(t,s);const i=lz(t,t.typeName,e,n);return i&&cz(t,e,i),s.jsonSchema=i,i}const oz=(t,e)=>{switch(e.$refStrategy){case"root":return{$ref:t.path.join("/")};case"extract-to-root":const n=t.path.slice(e.basePath.length+1).join("_");return n!==e.name&&e.nameStrategy==="duplicate-ref"&&(e.definitions[n]=t.def),{$ref:[...e.basePath,e.definitionPath,n].join("/")};case"relative":return{$ref:uz(e.currentPath,t.path)};case"none":case"seen":return t.path.length<e.currentPath.length&&t.path.every((r,s)=>e.currentPath[s]===r)?(console.warn(`Recursive reference detected at ${e.currentPath.join("/")}! Defaulting to any`),{}):e.$refStrategy==="seen"?{}:void 0}},uz=(t,e)=>{let n=0;for(;n<t.length&&n<e.length&&t[n]===e[n];n++);return[(t.length-n).toString(),...e.slice(n)].join("/")},lz=(t,e,n,r)=>{switch(e){case P.ZodString:return OA(t,n);case P.ZodNumber:return KU(t,n);case P.ZodObject:return XU(t,n);case P.ZodBigInt:return IU(t,n);case P.ZodBoolean:return RU();case P.ZodDate:return PA(t,n);case P.ZodUndefined:return sz();case P.ZodNull:return GU(n);case P.ZodArray:return NU(t,n);case P.ZodUnion:case P.ZodDiscriminatedUnion:return ZU(t,n);case P.ZodIntersection:return UU(t,n);case P.ZodTuple:return rz(t,n);case P.ZodRecord:return NA(t,n);case P.ZodLiteral:return zU(t,n);case P.ZodEnum:return FU(t);case P.ZodNativeEnum:return VU(t);case P.ZodNullable:return JU(t,n);case P.ZodOptional:return YU(t,n);case P.ZodMap:return HU(t,n);case P.ZodSet:return nz(t,n);case P.ZodLazy:return ke(t.getter()._def,n);case P.ZodPromise:return tz(t,n);case P.ZodNaN:case P.ZodNever:return WU();case P.ZodEffects:return DU(t,n,r);case P.ZodAny:return OU();case P.ZodUnknown:return iz();case P.ZodDefault:return MU(t,n);case P.ZodBranded:return jU(t,n);case P.ZodReadonly:return az(t,n);case P.ZodCatch:return $U(t,n);case P.ZodPipeline:return ez(t,n);case P.ZodFunction:case P.ZodVoid:case P.ZodSymbol:return;default:return(s=>{})()}},cz=(t,e,n)=>(t.description&&(n.description=t.description,e.markdownDescription&&(n.markdownDescription=t.description)),n),dz=(t,e)=>{const n=PU(e),r=typeof e=="string"?e:e?.nameStrategy==="title"?void 0:e?.name,s=ke(t._def,r===void 0?n:{...n,currentPath:[...n.basePath,n.definitionPath,r]},!1)??{},i=typeof e=="object"&&e.name!==void 0&&e.nameStrategy==="title"?e.name:void 0;i!==void 0&&(s.title=i);const a=(()=>{if(CU(n.definitions))return;const u={},l=new Set;for(let c=0;c<500;c++){const d=Object.entries(n.definitions).filter(([f])=>!l.has(f));if(d.length===0)break;for(const[f,h]of d)u[f]=ke(Og(h),{...n,currentPath:[...n.basePath,n.definitionPath,f]},!0)??{},l.add(f)}return u})(),o=r===void 0?a?{...s,[n.definitionPath]:a}:s:n.nameStrategy==="duplicate-ref"?{...s,...a||n.seenRefs.size?{[n.definitionPath]:{...a,...n.seenRefs.size?{[r]:s}:void 0}}:void 0}:{$ref:[...n.$refStrategy==="relative"?[]:n.basePath,n.definitionPath,r].join("/"),[n.definitionPath]:{...a,[r]:s}};return n.target==="jsonSchema7"?o.$schema="http://json-schema.org/draft-07/schema#":n.target==="jsonSchema2019-09"&&(o.$schema="https://json-schema.org/draft/2019-09/schema#"),o};function IA(t,e){return dz(t,{openaiStrictMode:!0,name:e.name,nameStrategy:"duplicate-ref",$refStrategy:"extract-to-root",nullableStrategy:"property"})}function fz(t,e,n){return NB({type:"json_schema",json_schema:{...n,name:e,strict:!0,schema:IA(t,{name:e})}},r=>t.parse(JSON.parse(r)))}function hz(t){return IB({type:"function",function:{name:t.name,parameters:IA(t.parameters,{name:t.name}),strict:!0,...t.description?{description:t.description}:void 0}},{callback:t.function,parser:e=>t.parameters.parse(JSON.parse(e))})}function RA(t){const{azureOpenAIApiDeploymentName:e,azureOpenAIApiInstanceName:n,azureOpenAIApiKey:r,azureOpenAIBasePath:s,baseURL:i,azureADTokenProvider:a,azureOpenAIEndpoint:o}=t;if((r||a)&&s&&e)return`${s}/${e}`;if((r||a)&&o&&e)return`${o}/openai/deployments/${e}`;if(r||a){if(!n)throw new Error("azureOpenAIApiInstanceName is required when using azureOpenAIApiKey");if(!e)throw new Error("azureOpenAIApiDeploymentName is a required parameter when using azureOpenAIApiKey");return`https://${n}.openai.azure.com/openai/deployments/${e}`}return i}function pz(t,e){const n=typeof e=="number"?void 0:e;return{name:t.name,description:t.description,parameters:Al(t.schema),...n?.strict!==void 0?{strict:n.strict}:{}}}function mz(t){return t!==void 0&&Array.isArray(t.lc_namespace)}function gz(t){return t!==void 0&&it.isRunnable(t)&&"lc_name"in t.constructor&&typeof t.constructor.lc_name=="function"&&t.constructor.lc_name()==="RunnableToolLike"}function yz(t){return!!t&&typeof t=="object"&&"name"in t&&"schema"in t&&kA(t.schema)}function bz(t){return yz(t)||gz(t)||mz(t)}function Ec(t,e){return t.lc_error_code=e,t.message=`${t.message}

Troubleshooting URL: https://js.langchain.com/docs/troubleshooting/errors/${e}/
`,t}function Ng(t){let e;return t.constructor.name===rh.name?(e=new Error(t.message),e.name="TimeoutError"):t.constructor.name===En.name?(e=new Error(t.message),e.name="AbortError"):t.status===400&&t.message.includes("tool_calls")?e=Ec(t,"INVALID_TOOL_RESULTS"):t.status===401?e=Ec(t,"MODEL_AUTHENTICATION"):t.status===429?e=Ec(t,"MODEL_RATE_LIMIT"):t.status===404?e=Ec(t,"MODEL_NOT_FOUND"):e=t,e}function wz(t){if(t)return t==="any"||t==="required"?"required":t==="auto"?"auto":t==="none"?"none":typeof t=="string"?{type:"function",function:{name:t}}:t}function _z(t){return t.anyOf!==void 0&&Array.isArray(t.anyOf)}function vz(t){const e=["namespace functions {",""];for(const n of t)n.description&&e.push(`// ${n.description}`),Object.keys(n.parameters.properties??{}).length>0?(e.push(`type ${n.name} = (_: {`),e.push(jA(n.parameters,0)),e.push("}) => any;")):e.push(`type ${n.name} = () => any;`),e.push("");return e.push("} // namespace functions"),e.join(`
`)}function jA(t,e){const n=[];for(const[r,s]of Object.entries(t.properties??{}))s.description&&e<2&&n.push(`// ${s.description}`),t.required?.includes(r)?n.push(`${r}: ${tf(s,e)},`):n.push(`${r}?: ${tf(s,e)},`);return n.map(r=>" ".repeat(e)+r).join(`
`)}function tf(t,e){if(_z(t))return t.anyOf.map(n=>tf(n,e)).join(" | ");switch(t.type){case"string":return t.enum?t.enum.map(n=>`"${n}"`).join(" | "):"string";case"number":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"integer":return t.enum?t.enum.map(n=>`${n}`).join(" | "):"number";case"boolean":return"boolean";case"null":return"null";case"object":return["{",jA(t,e+2),"}"].join(`
`);case"array":return t.items?`${tf(t.items,e)}[]`:"any[]";default:return""}}function xz(t,e){let n;if(bz(t)){const r=hz({name:t.name,parameters:t.schema,description:t.description});r.function.parameters?n={type:r.type,function:{name:r.function.name,description:r.function.description,parameters:r.function.parameters,...e?.strict!==void 0?{strict:e.strict}:{}}}:n={type:"function",function:pz(t,e)}}else n=t;return e?.strict!==void 0&&(n.function.strict=e.strict),n}function Sz(t){return t.role!=="system"&&t.role!=="developer"&&t.role!=="assistant"&&t.role!=="user"&&t.role!=="function"&&t.role!=="tool"&&console.warn(`Unknown message role: ${t.role}`),t.role}function $A(t){const e=t._getType();switch(e){case"system":return"system";case"ai":return"assistant";case"human":return"user";case"function":return"function";case"tool":return"tool";case"generic":{if(!El.isInstance(t))throw new Error("Invalid generic chat message");return Sz(t)}default:throw new Error(`Unknown message type: ${e}`)}}function kz(t,e,n){const r=t.tool_calls;switch(t.role){case"assistant":{const s=[],i=[];for(const u of r??[])try{s.push(TA(u,{returnId:!0}))}catch(l){i.push(kU(u,l.message))}const a={function_call:t.function_call,tool_calls:r};n!==void 0&&(a.__raw_response=e);const o={model_name:e.model,...e.system_fingerprint?{usage:{...e.usage},system_fingerprint:e.system_fingerprint}:{}};return t.audio&&(a.audio=t.audio),new el({content:t.content||"",tool_calls:s,invalid_tool_calls:i,additional_kwargs:a,response_metadata:o,id:e.id})}default:return new El(t.content||"",t.role??"unknown")}}function Ez(t,e,n,r){const s=t.role??n,i=t.content??"";let a;t.function_call?a={function_call:t.function_call}:t.tool_calls?a={tool_calls:t.tool_calls}:a={},r&&(a.__raw_response=e),t.audio&&(a.audio={...t.audio,index:e.choices[0].index});const o={usage:{...e.usage}};if(s==="user")return new Xf({content:i,response_metadata:o});if(s==="assistant"){const u=[];if(Array.isArray(t.tool_calls))for(const l of t.tool_calls)u.push({name:l.function?.name,args:l.function?.arguments,id:l.id,index:l.index,type:"tool_call_chunk"});return new $i({content:i,tool_call_chunks:u,additional_kwargs:a,id:e.id,response_metadata:o})}else return s==="system"?new tl({content:i,response_metadata:o}):s==="developer"?new tl({content:i,response_metadata:o,additional_kwargs:{__openai_role__:"developer"}}):s==="function"?new Qf({content:i,additional_kwargs:a,name:t.name,response_metadata:o}):s==="tool"?new ky({content:i,additional_kwargs:a,tool_call_id:t.tool_call_id,response_metadata:o}):new Kf({content:i,role:s,response_metadata:o})}function Vv(t,e){return t.flatMap(n=>{let r=$A(n);r==="system"&&e?.startsWith("o1")&&(r="developer");const s={role:r,content:n.content};if(n.name!=null&&(s.name=n.name),n.additional_kwargs.function_call!=null&&(s.function_call=n.additional_kwargs.function_call,s.content=null),Ey(n)&&n.tool_calls?.length?(s.tool_calls=n.tool_calls.map(SU),s.content=null):(n.additional_kwargs.tool_calls!=null&&(s.tool_calls=n.additional_kwargs.tool_calls),n.tool_call_id!=null&&(s.tool_call_id=n.tool_call_id)),n.additional_kwargs.audio&&typeof n.additional_kwargs.audio=="object"&&"id"in n.additional_kwargs.audio){const i={role:"assistant",audio:{id:n.additional_kwargs.audio.id}};return[s,i]}return s})}function Wv(t,e){return yU(t)?e?.strict!==void 0?{...t,function:{...t.function,strict:e.strict}}:t:xz(t,e)}class Az extends gs{static lc_name(){return"ChatOpenAI"}get callKeys(){return[...super.callKeys,"options","function_call","functions","tools","tool_choice","promptIndex","response_format","seed","reasoning_effort"]}get lc_secrets(){return{openAIApiKey:"OPENAI_API_KEY",apiKey:"OPENAI_API_KEY",azureOpenAIApiKey:"AZURE_OPENAI_API_KEY",organization:"OPENAI_ORGANIZATION"}}get lc_aliases(){return{modelName:"model",openAIApiKey:"openai_api_key",apiKey:"openai_api_key",azureOpenAIApiVersion:"azure_openai_api_version",azureOpenAIApiKey:"azure_openai_api_key",azureOpenAIApiInstanceName:"azure_openai_api_instance_name",azureOpenAIApiDeploymentName:"azure_openai_api_deployment_name"}}constructor(e,n){if(super(e??{}),Object.defineProperty(this,"lc_serializable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"temperature",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"topP",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"frequencyPenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"presencePenalty",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"n",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(this,"logitBias",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"gpt-3.5-turbo"}),Object.defineProperty(this,"modelKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stop",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"stopSequences",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"user",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"streaming",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"streamUsage",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"maxTokens",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"logprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"topLogprobs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"openAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"apiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIEndpoint",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"__includeRawResponse",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"supportsStrictToolCalling",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"audio",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"modalities",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"reasoningEffort",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.openAIApiKey=e?.apiKey??e?.openAIApiKey??e?.configuration?.apiKey??qe("OPENAI_API_KEY"),this.apiKey=this.openAIApiKey,this.azureOpenAIApiKey=e?.azureOpenAIApiKey??qe("AZURE_OPENAI_API_KEY"),this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!this.azureOpenAIApiKey&&!this.apiKey&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");if(this.azureOpenAIApiInstanceName=e?.azureOpenAIApiInstanceName??qe("AZURE_OPENAI_API_INSTANCE_NAME"),this.azureOpenAIApiDeploymentName=e?.azureOpenAIApiDeploymentName??qe("AZURE_OPENAI_API_DEPLOYMENT_NAME"),this.azureOpenAIApiVersion=e?.azureOpenAIApiVersion??qe("AZURE_OPENAI_API_VERSION"),this.azureOpenAIBasePath=e?.azureOpenAIBasePath??qe("AZURE_OPENAI_BASE_PATH"),this.organization=e?.configuration?.organization??qe("OPENAI_ORGANIZATION"),this.azureOpenAIEndpoint=e?.azureOpenAIEndpoint??qe("AZURE_OPENAI_ENDPOINT"),this.modelName=e?.model??e?.modelName??this.model,this.model=this.modelName,this.modelKwargs=e?.modelKwargs??{},this.timeout=e?.timeout,this.temperature=e?.temperature??this.temperature,this.topP=e?.topP??this.topP,this.frequencyPenalty=e?.frequencyPenalty??this.frequencyPenalty,this.presencePenalty=e?.presencePenalty??this.presencePenalty,this.maxTokens=e?.maxTokens,this.logprobs=e?.logprobs,this.topLogprobs=e?.topLogprobs,this.n=e?.n??this.n,this.logitBias=e?.logitBias,this.stop=e?.stopSequences??e?.stop,this.stopSequences=this?.stop,this.user=e?.user,this.__includeRawResponse=e?.__includeRawResponse,this.audio=e?.audio,this.modalities=e?.modalities,this.reasoningEffort=e?.reasoningEffort,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath&&!this.azureOpenAIEndpoint)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName&&this.azureOpenAIBasePath){const r=this.azureOpenAIBasePath.split("/openai/deployments/");if(r.length===2){const[,s]=r;this.azureOpenAIApiDeploymentName=s}}if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");this.apiKey=this.apiKey??"",this.streamUsage=!1}this.model==="o1"&&(this.disableStreaming=!0),this.streaming=e?.streaming??!1,this.streamUsage=e?.streamUsage??this.streamUsage,this.clientConfig={apiKey:this.apiKey,organization:this.organization,baseURL:n?.basePath??e?.configuration?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:n?.baseOptions?.headers??e?.configuration?.baseOptions?.headers,defaultQuery:n?.baseOptions?.params??e?.configuration?.baseOptions?.params,...n,...e?.configuration},e?.supportsStrictToolCalling!==void 0&&(this.supportsStrictToolCalling=e.supportsStrictToolCalling)}getLsParams(e){const n=this.invocationParams(e);return{ls_provider:"openai",ls_model_name:this.model,ls_model_type:"chat",ls_temperature:n.temperature??void 0,ls_max_tokens:n.max_tokens??void 0,ls_stop:e.stop}}bindTools(e,n){let r;return n?.strict!==void 0?r=n.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling),this.bind({tools:e.map(s=>Wv(s,{strict:r})),...n})}createResponseFormat(e){return e&&e.type==="json_schema"&&e.json_schema.schema&&Ac(e.json_schema.schema)?fz(e.json_schema.schema,e.json_schema.name,{description:e.json_schema.description}):e}invocationParams(e,n){let r;e?.strict!==void 0?r=e.strict:this.supportsStrictToolCalling!==void 0&&(r=this.supportsStrictToolCalling);let s={};e?.stream_options!==void 0?s={stream_options:e.stream_options}:this.streamUsage&&(this.streaming||n?.streaming)&&(s={stream_options:{include_usage:!0}});const i={model:this.model,temperature:this.temperature,top_p:this.topP,frequency_penalty:this.frequencyPenalty,presence_penalty:this.presencePenalty,max_tokens:this.maxTokens===-1?void 0:this.maxTokens,logprobs:this.logprobs,top_logprobs:this.topLogprobs,n:this.n,logit_bias:this.logitBias,stop:e?.stop??this.stopSequences,user:this.user,stream:this.streaming,functions:e?.functions,function_call:e?.function_call,tools:e?.tools?.length?e.tools.map(o=>Wv(o,{strict:r})):void 0,tool_choice:wz(e?.tool_choice),response_format:this.createResponseFormat(e?.response_format),seed:e?.seed,...s,parallel_tool_calls:e?.parallel_tool_calls,...this.audio||e?.audio?{audio:this.audio||e?.audio}:{},...this.modalities||e?.modalities?{modalities:this.modalities||e?.modalities}:{},...this.modelKwargs};e?.prediction!==void 0&&(i.prediction=e.prediction);const a=e?.reasoning_effort??this.reasoningEffort;return a!==void 0&&(i.reasoning_effort=a),i}_identifyingParams(){return{model_name:this.model,...this.invocationParams(),...this.clientConfig}}async*_streamResponseChunks(e,n,r){const s=Vv(e,this.model),i={...this.invocationParams(n,{streaming:!0}),messages:s,stream:!0};let a;const o=await this.completionWithRetry(i,n);let u;for await(const l of o){const c=l?.choices?.[0];if(l.usage&&(u=l.usage),!c)continue;const{delta:d}=c;if(!d)continue;const f=Ez(d,l,a,this.__includeRawResponse);a=d.role??a;const h={prompt:n.promptIndex??0,completion:c.index??0};if(typeof f.content!="string"){console.log("[WARNING]: Received non-string content from OpenAI. This is currently not supported.");continue}const m={...h};c.finish_reason!=null&&(m.finish_reason=c.finish_reason,m.system_fingerprint=l.system_fingerprint,m.model_name=l.model),this.logprobs&&(m.logprobs=c.logprobs);const y=new Ga({message:f,text:f.content,generationInfo:m});yield y,await r?.handleLLMNewToken(y.text??"",h,void 0,void 0,void 0,{chunk:y})}if(u){const l={...u.prompt_tokens_details?.audio_tokens!==null&&{audio:u.prompt_tokens_details?.audio_tokens},...u.prompt_tokens_details?.cached_tokens!==null&&{cache_read:u.prompt_tokens_details?.cached_tokens}},c={...u.completion_tokens_details?.audio_tokens!==null&&{audio:u.completion_tokens_details?.audio_tokens},...u.completion_tokens_details?.reasoning_tokens!==null&&{reasoning:u.completion_tokens_details?.reasoning_tokens}};yield new Ga({message:new $i({content:"",response_metadata:{usage:{...u}},usage_metadata:{input_tokens:u.prompt_tokens,output_tokens:u.completion_tokens,total_tokens:u.total_tokens,...Object.keys(l).length>0&&{input_token_details:l},...Object.keys(c).length>0&&{output_token_details:c}}}),text:""})}if(n.signal?.aborted)throw new Error("AbortError")}identifyingParams(){return this._identifyingParams()}async _generate(e,n,r){const s={},i=this.invocationParams(n),a=Vv(e,this.model);if(i.stream){const o=this._streamResponseChunks(e,n,r),u={};for await(const m of o){m.message.response_metadata={...m.generationInfo,...m.message.response_metadata};const y=m.generationInfo?.completion??0;u[y]===void 0?u[y]=m:u[y]=u[y].concat(m)}const l=Object.entries(u).sort(([m],[y])=>parseInt(m,10)-parseInt(y,10)).map(([m,y])=>y),{functions:c,function_call:d}=this.invocationParams(n),f=await this.getEstimatedTokenCountFromPrompt(e,c,d),h=await this.getNumTokensFromGenerations(l);return s.input_tokens=f,s.output_tokens=h,s.total_tokens=f+h,{generations:l,llmOutput:{estimatedTokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}else{let o;n.response_format&&n.response_format.type==="json_schema"?o=await this.betaParsedCompletionWithRetry({...i,stream:!1,messages:a},{signal:n?.signal,...n?.options}):o=await this.completionWithRetry({...i,stream:!1,messages:a},{signal:n?.signal,...n?.options});const{completion_tokens:u,prompt_tokens:l,total_tokens:c,prompt_tokens_details:d,completion_tokens_details:f}=o?.usage??{};u&&(s.output_tokens=(s.output_tokens??0)+u),l&&(s.input_tokens=(s.input_tokens??0)+l),c&&(s.total_tokens=(s.total_tokens??0)+c),(d?.audio_tokens!==null||d?.cached_tokens!==null)&&(s.input_token_details={...d?.audio_tokens!==null&&{audio:d?.audio_tokens},...d?.cached_tokens!==null&&{cache_read:d?.cached_tokens}}),(f?.audio_tokens!==null||f?.reasoning_tokens!==null)&&(s.output_token_details={...f?.audio_tokens!==null&&{audio:f?.audio_tokens},...f?.reasoning_tokens!==null&&{reasoning:f?.reasoning_tokens}});const h=[];for(const m of o?.choices??[]){const w={text:m.message?.content??"",message:kz(m.message??{role:"assistant"},o,this.__includeRawResponse)};w.generationInfo={...m.finish_reason?{finish_reason:m.finish_reason}:{},...m.logprobs?{logprobs:m.logprobs}:{}},Ey(w.message)&&(w.message.usage_metadata=s),w.message=new el(Object.fromEntries(Object.entries(w.message).filter(([p])=>!p.startsWith("lc_")))),h.push(w)}return{generations:h,llmOutput:{tokenUsage:{promptTokens:s.input_tokens,completionTokens:s.output_tokens,totalTokens:s.total_tokens}}}}}async getEstimatedTokenCountFromPrompt(e,n,r){let s=(await this.getNumTokensFromMessages(e)).totalCount;if(n&&r!=="auto"){const i=vz(n);s+=await this.getNumTokens(i),s+=9}return n&&e.find(i=>i._getType()==="system")&&(s-=4),r==="none"?s+=1:typeof r=="object"&&(s+=await this.getNumTokens(r.name)+4),s}async getNumTokensFromGenerations(e){return(await Promise.all(e.map(async r=>r.message.additional_kwargs?.function_call?(await this.getNumTokensFromMessages([r.message])).countPerMessage[0]:await this.getNumTokens(r.message.content)))).reduce((r,s)=>r+s,0)}async getNumTokensFromMessages(e){let n=0,r=0,s=0;this.model==="gpt-3.5-turbo-0301"?(r=4,s=-1):(r=3,s=1);const i=await Promise.all(e.map(async a=>{const o=await this.getNumTokens(a.content),u=await this.getNumTokens($A(a)),l=a.name!==void 0?s+await this.getNumTokens(a.name):0;let c=o+r+u+l;const d=a;if(d._getType()==="function"&&(c-=2),d.additional_kwargs?.function_call&&(c+=3),d?.additional_kwargs.function_call?.name&&(c+=await this.getNumTokens(d.additional_kwargs.function_call?.name)),d.additional_kwargs.function_call?.arguments)try{c+=await this.getNumTokens(JSON.stringify(JSON.parse(d.additional_kwargs.function_call?.arguments)))}catch(f){console.error("Error parsing function arguments",f,JSON.stringify(d.additional_kwargs.function_call)),c+=await this.getNumTokens(d.additional_kwargs.function_call?.arguments)}return n+=c,c}));return n+=3,{totalCount:n,countPerMessage:i}}async completionWithRetry(e,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.chat.completions.create(e,r)}catch(s){throw Ng(s)}})}async betaParsedCompletionWithRetry(e,n){const r=this._getClientOptions(n);return this.caller.call(async()=>{try{return await this.client.beta.chat.completions.parse(e,r)}catch(s){throw Ng(s)}})}_getClientOptions(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL,azureOpenAIEndpoint:this.azureOpenAIEndpoint},s=RA(r),i={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};i.baseURL||delete i.baseURL,this.client=new we(i)}const n={...this.clientConfig,...e};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),n}_llmType(){return"openai"}_combineLLMOutput(...e){return e.reduce((n,r)=>(r&&r.tokenUsage&&(n.tokenUsage.completionTokens+=r.tokenUsage.completionTokens??0,n.tokenUsage.promptTokens+=r.tokenUsage.promptTokens??0,n.tokenUsage.totalTokens+=r.tokenUsage.totalTokens??0),n),{tokenUsage:{completionTokens:0,promptTokens:0,totalTokens:0}})}withStructuredOutput(e,n){let r,s,i,a;Tz(e)?(r=e.schema,s=e.name,i=e.method,a=e.includeRaw):(r=e,s=n?.name,i=n?.method,a=n?.includeRaw);let o,u;if(n?.strict!==void 0&&i==="jsonMode")throw new Error("Argument `strict` is only supported for `method` = 'function_calling'");if(i==="jsonMode")o=this.bind({response_format:{type:"json_object"}}),Ac(r)?u=Fv.fromZodSchema(r):u=new Bv;else if(i==="jsonSchema")o=this.bind({response_format:{type:"json_schema",json_schema:{name:s??"extract",description:r.description,schema:r,strict:n?.strict}}}),Ac(r)?u=Fv.fromZodSchema(r):u=new Bv;else{let f=s??"extract";if(Ac(r)){const h=Al(r);o=this.bind({tools:[{type:"function",function:{name:f,description:h.description,parameters:h}}],tool_choice:{type:"function",function:{name:f}},...n?.strict!==void 0?{strict:n.strict}:{}}),u=new Uv({returnSingle:!0,keyName:f,zodSchema:r})}else{let h;typeof r.name=="string"&&typeof r.parameters=="object"&&r.parameters!=null?(h=r,f=r.name):(f=r.title??f,h={name:f,description:r.description??"",parameters:r}),o=this.bind({tools:[{type:"function",function:h}],tool_choice:{type:"function",function:{name:f}},...n?.strict!==void 0?{strict:n.strict}:{}}),u=new Uv({returnSingle:!0,keyName:f})}}if(!a)return o.pipe(u);const l=Yd.assign({parsed:(f,h)=>u.invoke(f.raw,h)}),c=Yd.assign({parsed:()=>null}),d=l.withFallbacks({fallbacks:[c]});return Hr.from([{raw:o},d])}}function Ac(t){return typeof t?.parse=="function"}function Tz(t){return t!==void 0&&typeof t.schema=="object"}const Cz=(t,e)=>t.reduce((n,r,s)=>{const i=Math.floor(s/e),a=n[i]||[];return n[i]=a.concat([r]),n},[]);class Pz{constructor(e){Object.defineProperty(this,"caller",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.caller=new eh(e??{})}}class Oz extends Pz{constructor(e,n){const r={maxConcurrency:2,...e};super(r),Object.defineProperty(this,"modelName",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"model",{enumerable:!0,configurable:!0,writable:!0,value:"text-embedding-ada-002"}),Object.defineProperty(this,"batchSize",{enumerable:!0,configurable:!0,writable:!0,value:512}),Object.defineProperty(this,"stripNewLines",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(this,"dimensions",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"timeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiVersion",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiKey",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureADTokenProvider",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiInstanceName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIApiDeploymentName",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"azureOpenAIBasePath",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"organization",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"client",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"clientConfig",{enumerable:!0,configurable:!0,writable:!0,value:void 0});let s=r?.apiKey??r?.openAIApiKey??qe("OPENAI_API_KEY");const i=r?.azureOpenAIApiKey??qe("AZURE_OPENAI_API_KEY");if(this.azureADTokenProvider=e?.azureADTokenProvider??void 0,!i&&!s&&!this.azureADTokenProvider)throw new Error("OpenAI or Azure OpenAI API key or Token Provider not found");const a=r?.azureOpenAIApiInstanceName??qe("AZURE_OPENAI_API_INSTANCE_NAME"),o=(r?.azureOpenAIApiEmbeddingsDeploymentName||r?.azureOpenAIApiDeploymentName)??(qe("AZURE_OPENAI_API_EMBEDDINGS_DEPLOYMENT_NAME")||qe("AZURE_OPENAI_API_DEPLOYMENT_NAME")),u=r?.azureOpenAIApiVersion??qe("AZURE_OPENAI_API_VERSION");if(this.azureOpenAIBasePath=r?.azureOpenAIBasePath??qe("AZURE_OPENAI_BASE_PATH"),this.organization=r?.configuration?.organization??qe("OPENAI_ORGANIZATION"),this.modelName=r?.model??r?.modelName??this.model,this.model=this.modelName,this.batchSize=r?.batchSize??(i?1:this.batchSize),this.stripNewLines=r?.stripNewLines??this.stripNewLines,this.timeout=r?.timeout,this.dimensions=r?.dimensions,this.azureOpenAIApiVersion=u,this.azureOpenAIApiKey=i,this.azureOpenAIApiInstanceName=a,this.azureOpenAIApiDeploymentName=o,this.azureOpenAIApiKey||this.azureADTokenProvider){if(!this.azureOpenAIApiInstanceName&&!this.azureOpenAIBasePath)throw new Error("Azure OpenAI API instance name not found");if(!this.azureOpenAIApiDeploymentName)throw new Error("Azure OpenAI API deployment name not found");if(!this.azureOpenAIApiVersion)throw new Error("Azure OpenAI API version not found");s=s??""}this.clientConfig={apiKey:s,organization:this.organization,baseURL:n?.basePath,dangerouslyAllowBrowser:!0,defaultHeaders:n?.baseOptions?.headers,defaultQuery:n?.baseOptions?.params,...n,...e?.configuration}}async embedDocuments(e){const n=Cz(this.stripNewLines?e.map(a=>a.replace(/\n/g," ")):e,this.batchSize),r=n.map(a=>{const o={model:this.model,input:a};return this.dimensions&&(o.dimensions=this.dimensions),this.embeddingWithRetry(o)}),s=await Promise.all(r),i=[];for(let a=0;a<s.length;a+=1){const o=n[a],{data:u}=s[a];for(let l=0;l<o.length;l+=1)i.push(u[l].embedding)}return i}async embedQuery(e){const n={model:this.model,input:this.stripNewLines?e.replace(/\n/g," "):e};this.dimensions&&(n.dimensions=this.dimensions);const{data:r}=await this.embeddingWithRetry(n);return r[0].embedding}async embeddingWithRetry(e){if(!this.client){const r={azureOpenAIApiDeploymentName:this.azureOpenAIApiDeploymentName,azureOpenAIApiInstanceName:this.azureOpenAIApiInstanceName,azureOpenAIApiKey:this.azureOpenAIApiKey,azureOpenAIBasePath:this.azureOpenAIBasePath,baseURL:this.clientConfig.baseURL},s=RA(r),i={...this.clientConfig,baseURL:s,timeout:this.timeout,maxRetries:0};i.baseURL||delete i.baseURL,this.client=new we(i)}const n={};return this.azureOpenAIApiKey&&(n.headers={"api-key":this.azureOpenAIApiKey,...n.headers},n.query={"api-version":this.azureOpenAIApiVersion,...n.query}),this.caller.call(async()=>{try{return await this.client.embeddings.create(e,n)}catch(r){throw Ng(r)}})}}var Pe;(function(t){t.Root="root",t.Text="text",t.Directive="directive",t.Comment="comment",t.Script="script",t.Style="style",t.Tag="tag",t.CDATA="cdata",t.Doctype="doctype"})(Pe||(Pe={}));function Nz(t){return t.type===Pe.Tag||t.type===Pe.Script||t.type===Pe.Style}const Iz=Pe.Root,Rz=Pe.Text,jz=Pe.Directive,$z=Pe.Comment,Lz=Pe.Script,Mz=Pe.Style,Dz=Pe.Tag,Fz=Pe.CDATA,Bz=Pe.Doctype;let LA=class{constructor(){this.parent=null,this.prev=null,this.next=null,this.startIndex=null,this.endIndex=null}get parentNode(){return this.parent}set parentNode(e){this.parent=e}get previousSibling(){return this.prev}set previousSibling(e){this.prev=e}get nextSibling(){return this.next}set nextSibling(e){this.next=e}cloneNode(e=!1){return UA(this,e)}};class Yy extends LA{constructor(e){super(),this.data=e}get nodeValue(){return this.data}set nodeValue(e){this.data=e}}class Ig extends Yy{constructor(){super(...arguments),this.type=Pe.Text}get nodeType(){return 3}}class MA extends Yy{constructor(){super(...arguments),this.type=Pe.Comment}get nodeType(){return 8}}class DA extends Yy{constructor(e,n){super(n),this.name=e,this.type=Pe.Directive}get nodeType(){return 1}}class eb extends LA{constructor(e){super(),this.children=e}get firstChild(){var e;return(e=this.children[0])!==null&&e!==void 0?e:null}get lastChild(){return this.children.length>0?this.children[this.children.length-1]:null}get childNodes(){return this.children}set childNodes(e){this.children=e}}class FA extends eb{constructor(){super(...arguments),this.type=Pe.CDATA}get nodeType(){return 4}}class Rg extends eb{constructor(){super(...arguments),this.type=Pe.Root}get nodeType(){return 9}}let BA=class extends eb{constructor(e,n,r=[],s=e==="script"?Pe.Script:e==="style"?Pe.Style:Pe.Tag){super(r),this.name=e,this.attribs=n,this.type=s}get nodeType(){return 1}get tagName(){return this.name}set tagName(e){this.name=e}get attributes(){return Object.keys(this.attribs).map(e=>{var n,r;return{name:e,value:this.attribs[e],namespace:(n=this["x-attribsNamespace"])===null||n===void 0?void 0:n[e],prefix:(r=this["x-attribsPrefix"])===null||r===void 0?void 0:r[e]}})}};function tb(t){return Nz(t)}function Uz(t){return t.type===Pe.CDATA}function zz(t){return t.type===Pe.Text}function qz(t){return t.type===Pe.Comment}function Hz(t){return t.type===Pe.Directive}function Vz(t){return t.type===Pe.Root}function UA(t,e=!1){let n;if(zz(t))n=new Ig(t.data);else if(qz(t))n=new MA(t.data);else if(tb(t)){const r=e?jp(t.children):[],s=new BA(t.name,{...t.attribs},r);r.forEach(i=>i.parent=s),t.namespace!=null&&(s.namespace=t.namespace),t["x-attribsNamespace"]&&(s["x-attribsNamespace"]={...t["x-attribsNamespace"]}),t["x-attribsPrefix"]&&(s["x-attribsPrefix"]={...t["x-attribsPrefix"]}),n=s}else if(Uz(t)){const r=e?jp(t.children):[],s=new FA(r);r.forEach(i=>i.parent=s),n=s}else if(Vz(t)){const r=e?jp(t.children):[],s=new Rg(r);r.forEach(i=>i.parent=s),t["x-mode"]&&(s["x-mode"]=t["x-mode"]),n=s}else if(Hz(t)){const r=new DA(t.name,t.data);t["x-name"]!=null&&(r["x-name"]=t["x-name"],r["x-publicId"]=t["x-publicId"],r["x-systemId"]=t["x-systemId"]),n=r}else throw new Error(`Not implemented yet: ${t.type}`);return n.startIndex=t.startIndex,n.endIndex=t.endIndex,t.sourceCodeLocation!=null&&(n.sourceCodeLocation=t.sourceCodeLocation),n}function jp(t){const e=t.map(n=>UA(n,!0));for(let n=1;n<e.length;n++)e[n].prev=e[n-1],e[n-1].next=e[n];return e}const Gv={withStartIndices:!1,withEndIndices:!1,xmlMode:!1};class Wz{constructor(e,n,r){this.dom=[],this.root=new Rg(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null,typeof n=="function"&&(r=n,n=Gv),typeof e=="object"&&(n=e,e=void 0),this.callback=e??null,this.options=n??Gv,this.elementCB=r??null}onparserinit(e){this.parser=e}onreset(){this.dom=[],this.root=new Rg(this.dom),this.done=!1,this.tagStack=[this.root],this.lastNode=null,this.parser=null}onend(){this.done||(this.done=!0,this.parser=null,this.handleCallback(null))}onerror(e){this.handleCallback(e)}onclosetag(){this.lastNode=null;const e=this.tagStack.pop();this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),this.elementCB&&this.elementCB(e)}onopentag(e,n){const r=this.options.xmlMode?Pe.Tag:void 0,s=new BA(e,n,void 0,r);this.addNode(s),this.tagStack.push(s)}ontext(e){const{lastNode:n}=this;if(n&&n.type===Pe.Text)n.data+=e,this.options.withEndIndices&&(n.endIndex=this.parser.endIndex);else{const r=new Ig(e);this.addNode(r),this.lastNode=r}}oncomment(e){if(this.lastNode&&this.lastNode.type===Pe.Comment){this.lastNode.data+=e;return}const n=new MA(e);this.addNode(n),this.lastNode=n}oncommentend(){this.lastNode=null}oncdatastart(){const e=new Ig(""),n=new FA([e]);this.addNode(n),e.parent=n,this.lastNode=e}oncdataend(){this.lastNode=null}onprocessinginstruction(e,n){const r=new DA(e,n);this.addNode(r)}handleCallback(e){if(typeof this.callback=="function")this.callback(e,this.dom);else if(e)throw e}addNode(e){const n=this.tagStack[this.tagStack.length-1],r=n.children[n.children.length-1];this.options.withStartIndices&&(e.startIndex=this.parser.startIndex),this.options.withEndIndices&&(e.endIndex=this.parser.endIndex),n.children.push(e),r&&(e.prev=r,r.next=e),e.parent=n,this.lastNode=null}}const Gz=/\n/g;function Zz(t){const e=[...t.matchAll(Gz)].map(r=>r.index||0);e.unshift(-1);const n=jg(e,0,e.length);return r=>zA(n,r)}function jg(t,e,n){if(n-e==1)return{offset:t[e],index:e+1};const r=Math.ceil((e+n)/2),s=jg(t,e,r),i=jg(t,r,n);return{offset:s.offset,low:s,high:i}}function zA(t,e){return function(n){return Object.prototype.hasOwnProperty.call(n,"index")}(t)?{line:t.index,column:e-t.offset}:zA(t.high.offset<e?t.high:t.low,e)}function qA(t,e="",n={}){const r=typeof e!="string"?e:n,s=typeof e=="string"?e:"",i=t.map(Jz),a=!!r.lineNumbers;return function(o,u=0){const l=a?Zz(o):()=>({line:0,column:0});let c=u;const d=[];e:for(;c<o.length;){let f=!1;for(const h of i){h.regex.lastIndex=c;const m=h.regex.exec(o);if(m&&m[0].length>0){if(!h.discard){const y=l(c),w=typeof h.replace=="string"?m[0].replace(new RegExp(h.regex.source,h.regex.flags),h.replace):m[0];d.push({state:s,name:h.name,text:w,offset:c,len:m[0].length,line:y.line,column:y.column})}if(c=h.regex.lastIndex,f=!0,h.push){const y=h.push(o,c);d.push(...y.tokens),c=y.offset}if(h.pop)break e;break}}if(!f)break}return{tokens:d,offset:c,complete:o.length<=c}}}function Jz(t,e){return{...t,regex:Kz(t,e)}}function Kz(t,e){if(t.name.length===0)throw new Error(`Rule #${e} has empty name, which is not allowed.`);if(function(n){return Object.prototype.hasOwnProperty.call(n,"regex")}(t))return function(n){if(n.global)throw new Error(`Regular expression /${n.source}/${n.flags} contains the global flag, which is not allowed.`);return n.sticky?n:new RegExp(n.source,n.flags+"y")}(t.regex);if(function(n){return Object.prototype.hasOwnProperty.call(n,"str")}(t)){if(t.str.length===0)throw new Error(`Rule #${e} ("${t.name}") has empty "str" property, which is not allowed.`);return new RegExp(Zv(t.str),"y")}return new RegExp(Zv(t.name),"y")}function Zv(t){return t.replace(/[-[\]{}()*+!<=:?./\\^$|#\s,]/g,"\\$&")}function rs(t,e){return(n,r)=>{let s=r,i;return r<n.tokens.length&&(i=t(n.tokens[r],n,r),i!==void 0&&s++),i===void 0?{matched:!1}:{matched:!0,position:s,value:i}}}function nb(t,e){return t.matched?{matched:!0,position:t.position,value:e(t.value,t.position)}:t}function nf(t,e){return t.matched?e(t):t}function tn(t,e){return(n,r)=>nb(t(n,r),(s,i)=>e(s,n,r,i))}function rf(t,e){return(n,r)=>{const s=t(n,r);return s.matched?s:{matched:!0,position:r,value:e}}}function uh(...t){return(e,n)=>{for(const r of t){const s=r(e,n);if(s.matched)return s}return{matched:!1}}}function Li(t,e){return(n,r)=>{const s=t(n,r);return s.matched?s:e(n,r)}}function Qz(t,e){return(n,r)=>{const s=[];let i=!0;do{const a=t(n,r);a.matched&&e(a.value,s.length+1,n,r,a.position)?(s.push(a.value),r=a.position):i=!1}while(i);return{matched:!0,position:r,value:s}}}function rb(t){return Qz(t,()=>!0)}function Xz(t){return $t(t,rb(t),(e,n)=>[e,...n])}function $t(t,e,n){return(r,s)=>nf(t(r,s),i=>nb(e(r,i.position),(a,o)=>n(i.value,a,r,s,o)))}function Yz(t,e){return $t(t,e,n=>n)}function Jv(t,e){return $t(t,e,(n,r)=>r)}function sb(t,e,n,r){return(s,i)=>nf(t(s,i),a=>nf(e(s,a.position),o=>nb(n(s,o.position),(u,l)=>r(a.value,o.value,u,s,i,l))))}function HA(t,e,n){return sb(t,e,n,(r,s)=>s)}function eq(...t){return(e,n)=>{const r=[];let s=n;for(const i of t){const a=i(e,s);if(a.matched)r.push(a.value),s=a.position;else return{matched:!1}}return{matched:!0,position:s,value:r}}}function tq(...t){return nq(eq(...t))}function nq(t){return tn(t,e=>e.flatMap(n=>n))}function rq(t,e){return(n,r)=>{let s=!0,i=t,a=r;do{const o=e(i,n,a)(n,a);o.matched?(i=o.value,a=o.position):s=!1}while(s);return{matched:!0,position:a,value:i}}}function sq(t,e,n){return rq(t,r=>tn(e,(s,i,a,o)=>n(r,s,i,a,o)))}function iq(t,e,n){return aq(t,r=>sq(r,$t(e,n,(s,i)=>[s,i]),(s,[i,a])=>i(s,a)))}function aq(t,e){return(n,r)=>nf(t(n,r),s=>e(s.value,n,r,s.position)(n,s.position))}const oq="(?:[ \\t\\r\\n\\f]*)",VA="(?:\\n|\\r\\n|\\r|\\f)",lh="[^\\x00-\\x7F]",Rl="(?:\\\\[0-9a-f]{1,6}(?:\\r\\n|[ \\n\\r\\t\\f])?)",jl="(?:\\\\[^\\n\\r\\f0-9a-f])",uq=`(?:[_a-z]|${lh}|${Rl}|${jl})`,WA=`(?:[_a-z0-9-]|${lh}|${Rl}|${jl})`,lq=`(?:${WA}+)`,cq=`(?:[-]?${uq}${WA}*)`,dq=`'([^\\n\\r\\f\\\\']|\\\\${VA}|${lh}|${Rl}|${jl})*'`,fq=`"([^\\n\\r\\f\\\\"]|\\\\${VA}|${lh}|${Rl}|${jl})*"`,hq=qA([{name:"ws",regex:new RegExp(oq)},{name:"hash",regex:new RegExp(`#${lq}`,"i")},{name:"ident",regex:new RegExp(cq,"i")},{name:"str1",regex:new RegExp(dq,"i")},{name:"str2",regex:new RegExp(fq,"i")},{name:"*"},{name:"."},{name:","},{name:"["},{name:"]"},{name:"="},{name:">"},{name:"|"},{name:"+"},{name:"~"},{name:"^"},{name:"$"}]),pq=qA([{name:"unicode",regex:new RegExp(Rl,"i")},{name:"escape",regex:new RegExp(jl,"i")},{name:"any",regex:new RegExp("[\\s\\S]","i")}]);function GA([t,e,n],[r,s,i]){return[t+r,e+s,n+i]}function mq(t){return t.reduce(GA,[0,0,0])}const gq=rs(t=>t.name==="unicode"?String.fromCodePoint(parseInt(t.text.slice(1),16)):void 0),yq=rs(t=>t.name==="escape"?t.text.slice(1):void 0),bq=rs(t=>t.name==="any"?t.text:void 0),wq=tn(rb(uh(gq,yq,bq)),t=>t.join(""));function ib(t){const e=pq(t);return wq({tokens:e.tokens,options:void 0},0).value}function ze(t){return rs(e=>e.name===t?!0:void 0)}const ab=rs(t=>t.name==="ws"?null:void 0),$g=rf(ab,null);function al(t){return HA($g,t,$g)}const ol=rs(t=>t.name==="ident"?ib(t.text):void 0),_q=rs(t=>t.name==="hash"?ib(t.text.slice(1)):void 0),vq=rs(t=>t.name.startsWith("str")?ib(t.text.slice(1,-1)):void 0),ZA=Yz(rf(ol,""),ze("|")),ob=Li($t(ZA,ol,(t,e)=>({name:e,namespace:t})),tn(ol,t=>({name:t,namespace:null}))),xq=Li($t(ZA,ze("*"),t=>({type:"universal",namespace:t,specificity:[0,0,0]})),tn(ze("*"),()=>({type:"universal",namespace:null,specificity:[0,0,0]}))),Sq=tn(ob,({name:t,namespace:e})=>({type:"tag",name:t,namespace:e,specificity:[0,0,1]})),kq=$t(ze("."),ol,(t,e)=>({type:"class",name:e,specificity:[0,1,0]})),Eq=tn(_q,t=>({type:"id",name:t,specificity:[1,0,0]})),Kv=rs(t=>{if(t.name==="ident"){if(t.text==="i"||t.text==="I")return"i";if(t.text==="s"||t.text==="S")return"s"}}),Aq=Li($t(vq,rf(Jv($g,Kv),null),(t,e)=>({value:t,modifier:e})),$t(ol,rf(Jv(ab,Kv),null),(t,e)=>({value:t,modifier:e}))),Tq=uh(tn(ze("="),()=>"="),$t(ze("~"),ze("="),()=>"~="),$t(ze("|"),ze("="),()=>"|="),$t(ze("^"),ze("="),()=>"^="),$t(ze("$"),ze("="),()=>"$="),$t(ze("*"),ze("="),()=>"*=")),Cq=sb(ze("["),al(ob),ze("]"),(t,{name:e,namespace:n})=>({type:"attrPresence",name:e,namespace:n,specificity:[0,1,0]})),Pq=HA(ze("["),sb(al(ob),Tq,al(Aq),({name:t,namespace:e},n,{value:r,modifier:s})=>({type:"attrValue",name:t,namespace:e,matcher:n,value:r,modifier:s,specificity:[0,1,0]})),ze("]")),Oq=Li(Cq,Pq),Nq=Li(xq,Sq),Qv=uh(Eq,kq,Oq),Xv=tn(Li(tq(Nq,rb(Qv)),Xz(Qv)),t=>({type:"compound",list:t,specificity:mq(t.map(e=>e.specificity))})),Iq=uh(tn(ze(">"),()=>">"),tn(ze("+"),()=>"+"),tn(ze("~"),()=>"~"),$t(ze("|"),ze("|"),()=>"||")),Rq=Li(al(Iq),tn(ab,()=>" ")),jq=iq(Xv,tn(Rq,t=>(e,n)=>({type:"compound",list:[...n.list,{type:"combinator",combinator:t,left:e,specificity:e.specificity}],specificity:GA(e.specificity,n.specificity)})),Xv);function $q(t,e){if(!(typeof e=="string"||e instanceof String))throw new Error("Expected a selector string. Actual input is not a string!");const n=hq(e);if(!n.complete)throw new Error(`The input "${e}" was only partially tokenized, stopped at offset ${n.offset}!
`+Yv(e,n.offset));const r=al(t)({tokens:n.tokens,options:void 0},0);if(!r.matched)throw new Error(`No match for "${e}" input!`);if(r.position<n.tokens.length){const s=n.tokens[r.position];throw new Error(`The input "${e}" was only partially parsed, stopped at offset ${s.offset}!
`+Yv(e,s.offset,s.len))}return r.value}function Yv(t,e,n=1){return`${t.replace(/(\t)|(\r)|(\n)/g,(r,s,i)=>s?"":i?"":"")}
${"".padEnd(e)}${"^".repeat(n)}`}function Lq(t){return $q(jq,t)}function _r(t){if(!t.type)throw new Error("This is not an AST node.");switch(t.type){case"universal":return Tc(t.namespace)+"*";case"tag":return Tc(t.namespace)+Yi(t.name);case"class":return"."+Yi(t.name);case"id":return"#"+Yi(t.name);case"attrPresence":return`[${Tc(t.namespace)}${Yi(t.name)}]`;case"attrValue":return`[${Tc(t.namespace)}${Yi(t.name)}${t.matcher}"${Mq(t.value)}"${t.modifier?t.modifier:""}]`;case"combinator":return _r(t.left)+t.combinator;case"compound":return t.list.reduce((e,n)=>n.type==="combinator"?_r(n)+e:e+_r(n),"");case"list":return t.list.map(_r).join(",")}}function Tc(t){return t||t===""?Yi(t)+"|":""}function ed(t){return`\\${t.codePointAt(0).toString(16)} `}function Yi(t){return t.replace(/(^[0-9])|(^-[0-9])|(^-$)|([-0-9a-zA-Z_]|[^\x00-\x7F])|(\x00)|([\x01-\x1f]|\x7f)|([\s\S])/g,(e,n,r,s,i,a,o,u)=>n?ed(n):r?"-"+ed(r.slice(1)):s?"\\-":i||(a?"":o?ed(o):"\\"+u))}function Mq(t){return t.replace(/(")|(\\)|(\x00)|([\x01-\x1f]|\x7f)/g,(e,n,r,s,i)=>n?'\\"':r?"\\\\":s?"":ed(i))}function td(t){if(!t.type)throw new Error("This is not an AST node.");switch(t.type){case"compound":{t.list.forEach(td),t.list.sort((e,n)=>KA(e1(e),e1(n)));break}case"combinator":{td(t.left);break}case"list":{t.list.forEach(td),t.list.sort((e,n)=>_r(e)<_r(n)?-1:1);break}}return t}function e1(t){switch(t.type){case"universal":return[1];case"tag":return[1];case"id":return[2];case"class":return[3,t.name];case"attrPresence":return[4,_r(t)];case"attrValue":return[5,_r(t)];case"combinator":return[15,_r(t)]}}function JA(t,e){return KA(t,e)}function KA(t,e){if(!Array.isArray(t)||!Array.isArray(e))throw new Error("Arguments must be arrays.");const n=t.length<e.length?t.length:e.length;for(let r=0;r<n;r++)if(t[r]!==e[r])return t[r]<e[r]?-1:1;return t.length-e.length}class t1{constructor(e){this.branches=Ja(Dq(e))}build(e){return e(this.branches)}}function Dq(t){const e=t.length,n=new Array(e);for(let r=0;r<e;r++){const[s,i]=t[r],a=Fq(Lq(s));n[r]={ast:a,terminal:{type:"terminal",valueContainer:{index:r,value:i,specificity:a.specificity}}}}return n}function Fq(t){return QA(t),td(t),t}function QA(t){const e=[];t.list.forEach(n=>{switch(n.type){case"class":e.push({matcher:"~=",modifier:null,name:"class",namespace:null,specificity:n.specificity,type:"attrValue",value:n.name});break;case"id":e.push({matcher:"=",modifier:null,name:"id",namespace:null,specificity:n.specificity,type:"attrValue",value:n.name});break;case"combinator":QA(n.left),e.push(n);break;case"universal":break;default:e.push(n);break}}),t.list=e}function Ja(t){const e=[];for(;t.length;){const n=eT(t,a=>!0,XA),{matches:r,nonmatches:s,empty:i}=Uq(t,n);t=s,r.length&&e.push(zq(n,r)),i.length&&e.push(...Bq(i))}return e}function Bq(t){const e=[];for(const n of t){const r=n.terminal;if(r.type==="terminal")e.push(r);else{const{matches:s,rest:i}=Gq(r.cont,a=>a.type==="terminal");s.forEach(a=>e.push(a)),i.length&&(r.cont=i,e.push(r))}}return e}function Uq(t,e){const n=[],r=[],s=[];for(const i of t){const a=i.ast.list;a.length?(a.some(u=>XA(u)===e)?n:r).push(i):s.push(i)}return{matches:n,nonmatches:r,empty:s}}function XA(t){switch(t.type){case"attrPresence":return`attrPresence ${t.name}`;case"attrValue":return`attrValue ${t.name}`;case"combinator":return`combinator ${t.combinator}`;default:return t.type}}function zq(t,e){if(t==="tag")return qq(e);if(t.startsWith("attrValue "))return Vq(t.substring(10),e);if(t.startsWith("attrPresence "))return Hq(t.substring(13),e);if(t==="combinator >")return n1(">",e);if(t==="combinator +")return n1("+",e);throw new Error(`Unsupported selector kind: ${t}`)}function qq(t){const e=ub(t,r=>r.type==="tag",r=>r.name);return{type:"tagName",variants:Object.entries(e).map(([r,s])=>({type:"variant",value:r,cont:Ja(s.items)}))}}function Hq(t,e){for(const n of e)YA(n,r=>r.type==="attrPresence"&&r.name===t);return{type:"attrPresence",name:t,cont:Ja(e)}}function Vq(t,e){const n=ub(e,s=>s.type==="attrValue"&&s.name===t,s=>`${s.matcher} ${s.modifier||""} ${s.value}`),r=[];for(const s of Object.values(n)){const i=s.oneSimpleSelector,a=Wq(i),o=Ja(s.items);r.push({type:"matcher",matcher:i.matcher,modifier:i.modifier,value:i.value,predicate:a,cont:o})}return{type:"attrValue",name:t,matchers:r}}function Wq(t){if(t.modifier==="i"){const e=t.value.toLowerCase();switch(t.matcher){case"=":return n=>e===n.toLowerCase();case"~=":return n=>n.toLowerCase().split(/[ \t]+/).includes(e);case"^=":return n=>n.toLowerCase().startsWith(e);case"$=":return n=>n.toLowerCase().endsWith(e);case"*=":return n=>n.toLowerCase().includes(e);case"|=":return n=>{const r=n.toLowerCase();return e===r||r.startsWith(e)&&r[e.length]==="-"}}}else{const e=t.value;switch(t.matcher){case"=":return n=>e===n;case"~=":return n=>n.split(/[ \t]+/).includes(e);case"^=":return n=>n.startsWith(e);case"$=":return n=>n.endsWith(e);case"*=":return n=>n.includes(e);case"|=":return n=>e===n||n.startsWith(e)&&n[e.length]==="-"}}}function n1(t,e){const n=ub(e,s=>s.type==="combinator"&&s.combinator===t,s=>_r(s.left)),r=[];for(const s of Object.values(n)){const i=Ja(s.items),a=s.oneSimpleSelector.left;r.push({ast:a,terminal:{type:"popElement",cont:i}})}return{type:"pushElement",combinator:t,cont:Ja(r)}}function ub(t,e,n){const r={};for(;t.length;){const s=eT(t,e,n),i=c=>e(c)&&n(c)===s,a=c=>c.ast.list.some(i),{matches:o,rest:u}=Zq(t,a);let l=null;for(const c of o){const d=YA(c,i);l||(l=d)}if(l==null)throw new Error("No simple selector is found.");r[s]={oneSimpleSelector:l,items:o},t=u}return r}function YA(t,e){const n=t.ast.list,r=new Array(n.length);let s=-1;for(let a=n.length;a-- >0;)e(n[a])&&(r[a]=!0,s=a);if(s==-1)throw new Error("Couldn't find the required simple selector.");const i=n[s];return t.ast.list=n.filter((a,o)=>!r[o]),i}function eT(t,e,n){const r={};for(const a of t){const o={};for(const u of a.ast.list.filter(e))o[n(u)]=!0;for(const u of Object.keys(o))r[u]?r[u]++:r[u]=1}let s="",i=0;for(const a of Object.entries(r))a[1]>i&&(s=a[0],i=a[1]);return s}function Gq(t,e){const n=[],r=[];for(const s of t)e(s)?n.push(s):r.push(s);return{matches:n,rest:r}}function Zq(t,e){const n=[],r=[];for(const s of t)e(s)?n.push(s):r.push(s);return{matches:n,rest:r}}class Jq{constructor(e){this.f=e}pickAll(e){return this.f(e)}pick1(e,n=!1){const r=this.f(e),s=r.length;if(s===0)return null;if(s===1)return r[0].value;const i=n?Kq:Qq;let a=r[0];for(let o=1;o<s;o++){const u=r[o];i(a,u)&&(a=u)}return a.value}}function Kq(t,e){const n=JA(e.specificity,t.specificity);return n>0||n===0&&e.index<t.index}function Qq(t,e){const n=JA(e.specificity,t.specificity);return n>0||n===0&&e.index>t.index}function r1(t){return new Jq(xo(t))}function xo(t){const e=t.map(Xq);return(n,...r)=>e.flatMap(s=>s(n,...r))}function Xq(t){switch(t.type){case"terminal":{const e=[t.valueContainer];return(n,...r)=>e}case"tagName":return Yq(t);case"attrValue":return tH(t);case"attrPresence":return eH(t);case"pushElement":return nH(t);case"popElement":return sH(t)}}function Yq(t){const e={};for(const n of t.variants)e[n.value]=xo(n.cont);return(n,...r)=>{const s=e[n.name];return s?s(n,...r):[]}}function eH(t){const e=t.name,n=xo(t.cont);return(r,...s)=>Object.prototype.hasOwnProperty.call(r.attribs,e)?n(r,...s):[]}function tH(t){const e=[];for(const r of t.matchers){const s=r.predicate,i=xo(r.cont);e.push((a,o,...u)=>s(a)?i(o,...u):[])}const n=t.name;return(r,...s)=>{const i=r.attribs[n];return i||i===""?e.flatMap(a=>a(i,r,...s)):[]}}function nH(t){const e=xo(t.cont),n=t.combinator==="+"?tT:rH;return(r,...s)=>{const i=n(r);return i===null?[]:e(i,r,...s)}}const tT=t=>{const e=t.prev;return e===null?null:tb(e)?e:tT(e)},rH=t=>{const e=t.parent;return e&&tb(e)?e:null};function sH(t){const e=xo(t.cont);return(n,r,...s)=>e(r,...s)}const nT=new Uint16Array('<\0\0\0\0\0\0EMabcfglmnoprstu\\bfmsligP&cutereve;iyx}rc;r;ravepha;acr;d;gpon;f;plyFunction;ingcsr;ign;ildemlaceforsucrkslash;;ed;y;crtause;noullis;a;r;pf;eve;cmpeq;HOacdefhilorsucy;PYcpyute;;italDifferentialD;leys;aeioron;dilrc;nint;ot;dnilla;terDot;i;rcleDMPTot;inus;lus;imes;ocskwiseContourIntegral;eCurlyDQoubleQuote;uote;lnpuon;e;gitruent;nt;ourIntegral;fr;oduct;nterClockwiseContourIntegral;oss;cr;p;Cap;DJSZacefios;otrahd;cy;cy;cy;grsger;r;hv;ayron;;l;ta;r;afcmriticalADGTcute;o;bleAcute;rave;ilde;ond;ferentialD;\0\0\0\0f;;DEot;qual;bleCDLRUVontourIntegrao\0\0nArrow;eoftARTrrow;ightArrow;engLReftARrrow;ightArrow;ightArrow;ightATrrow;ee;p\0\0rrow;ownArrow;erticalBar;nABLRTarrow;BUar;pArrow;reve;eft\0\0ightVector;eeVector;ector;Bar;ight\0eeVector;ector;Bar;ee;Arrow;ctr;rok;NTacdfglmopqstuxG;Hcuteaiyron;rc;ot;r;raveement;apcr;ty\0\0mallSquare;erySmallSquare;gpon;f;silon;uail;Tilde;librium;cir;m;a;mlipsts;onentialE;cfiosy;r;lled\0\0mallSquare;erySmallSquare;\0\0\0f;All;riertrf;cJTabcdfgorstcy;>mma;d;reve;eiydil;rc;;ot;r;;pf;eaterEFGLSTqual;Less;ullEqual;reater;ess;lantEqual;ilde;cr;;AacfiosuRDcy;ctek;;irc;r;lbertSpace;\0f;izontalLine;ctrok;mpownHumqual;EJOacdfgmnostucy;lig;cy;cuteiyrc;ot;r;rave;apcgr;inaryI;lie\0;egrral;section;isibleCTomma;imes;gpton;f;a;cr;ilde;\0cy;lcfosuiyrc;;r;pf;\0r;rcy;kcy;HJacfoscy;cy;ppa;eydil;;r;pf;cr;JTaceflmostcy;<cmnprute;bda;g;lacetrf;r;aeyron;dil;;fstACDFRTUVarnrgleBracket;row;BRar;ightArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ightAVrrow;ector;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;ightsEFGLSTqualGreater;ullEqual;reater;ess;lantEqual;ilde;r;;eftarrow;idot;npwgLRlreftARrrow;ightArrow;ightArrow;eftarightightf;erLReftArrow;ightArrow;cht;rok;;acefiosup;y;dliumSpace;lintrf;r;nusPlus;pf;c;Jacefostucy;cute;aeyron;dil;;gswativeMTVediumSpace;hicneryThitedGLreaterGreateessLesLine;r;Bnptreak;BreakingSpace;f;;CDEGHLNPRSTVoungruent;pCap;oubleVerticalBar;lqxement;ual;Tilde;ists;reater;EFGLSTqual;ullEqual;reater;ess;lantEqual;ilde;umpownHump;qual;efstTriangle;BEar;qual;s;EGLSTqual;reater;ess;lantEqual;ilde;estedGLreaterGreater;essLess;recedes;ESqual;lantEqual;eiverseElement;ghtTriangle;BEar;qual;quuareSubpset;Equal;erset;Equal;bcpset;Equal;ceeds;ESTqual;lantEqual;ilde;erset;Equal;ilde;EFTqual;ullEqual;ilde;erticalBar;cr;ilde;Eacdfgmoprstuvlig;cuteiyrc;blac;r;raveaeicr;ga;cron;pf;enCurlyDQoubleQuote;uote;;clr;ashidees;mlerBParr;acek;et;arenthesis;acfhilorsrtialD;y;r;i;;usMinus;ipncareplanf;;eiocedes;ESTqual;lantEqual;ilde;me;dpuct;ortion;al;cir;;UfosOT"r;pf;cr;BEacefhiorsuarr;Gcnrute;g;r;tl;aeyron;dil;;;verseEUlqement;uilibrium;pEquilibrium;ro;ghtACDFTUVanrgleBracket;row;BLar;eftArrow;eiling;o\0bleBracket;n\0eeVector;ector;Bar;loor;ere;AVrrow;ector;iangle;BEar;qual;pDTVownVector;eeVector;ector;Bar;ector;Bar;puf;ndImplies;ightarrow;chr;;leDelayed;HOacfhimoqstuCcHcy;y;FTcy;cute;;aeiyron;dil;rc;;r;ortDLRUownArroweftArrowightArrowpArrow;gma;allCircle;pf;\0\0t;are;ISUntersection;ubpset;Equal;erset;Equal;nion;cr;ar;bcmp;set;Equal;cheeds;ESTqual;lantEqual;ilde;Th;;esrset;Equal;etHRSacfhiorsORNADE;Hccy;y;bu;;aeyron;dil;;r;ei\0efore;a;cnkSpace;Space;lde;EFTqual;ullEqual;ilde;pf;ipleDot;ctr;rok;\0\0\0\0\0\0\0cruter;ocir;r\0y;ve;iyrc;blac;r;raveacr;dierBParr;acek;et;arenthesis;on;Plus;gpon;f;ADETadpsrrow;BDar;ownArrow;ownArrow;quilibrium;ee;Arrow;ownerLReftArrow;ightArrow;i;lon;ing;cr;ilde;mlDbcdefosvash;ar;y;ash;l;er;btyar;;icalBLSTar;ine;eparator;ilde;ThinSpace;r;pf;cr;dash;cefosirc;dge;r;pf;cr;fiosr;;pf;cr;AIUacfosucy;cy;cy;cuteiyrc;;r;pf;cr;ml;Hacdefoscy;cute;ayron;;ot;\0oWidta;r;pf;cr;\0\0\0\0\0\0\0cutereve;;Ediuy;;rcte;lig;r;raveepfpsym;ha;apcclr;g;\0\0;adsvnd;;lope;;;elmrsz;esd;a;;;;;;;;t;vb;d;pth;arr;gpon;f;;Eaeiop;cir;;d;s;rox;eingctyr;;mp;eildemlcioninnt;Nabcdefiklnoprsuot;crkcepsong;psilon;rime;im;eq;ee;ed;gerk;tbrk;oy;quo;cmprtaus;eptyv;snoahw;;een;r;gcostuvwaiurc;pdptot;lus;imes;\0\0cup;ar;riangleduown;p;plus;earow;akocnklstozenge;riangle;dlrown;eft;ight;k;\0\0;;4;ck;eo;q=uiv;t;ptwxf;;tomtie;DHUVbdhmptuvLRlr;;;;;DUdu;;;;LRlr;;;;;HLRhlr;;;;;;ox;LRlr;;;;;DUdu;;;;inus;lus;imes;LRlr;;;;;HLRhlr;;;;;;evbarceior;mi;m;el;bh;sub;l;etp;Ee;;q\0\0\0\0\0\0\0\0\0\0cprute;;abcdsnd;rcup;aup;p;ot;;eot;aeiu\0s;on;dilrc;ps;sm;ot;dmnilptyv;t;err;ceiy;ck;mark;r;Ecefms;;elq;e\0\0rrowlreft;ight;RSacd;st;irc;ash;nint;id;cir;ubs;uit\0on;e;q\0\0a;t;;flemxente\0;dot;nfry;o;sr;aorr;ss;cur;bp;e;;e;dot;delprvwarrlr;;\0\0r;c;arr;p;;bcdosrcap;aup;p;ot;r;;alrvrr;m;yevwq\0\0reuee;edge;enearrowlreftightecioninnt;lcty;AHabcdefhijlorstuwzrar;glrsger;eth;h;varow;aayron;;;aogrr;tseq;glmta;ptyv;irsht;;arlraegsvm;osnd;suit;amma;in;;iode;ontimes;ncy;c\0\0rn;op;lptuwlar;f;;empsq;dot;inus;lus;quare;blebarwedgnadhownarrowarpoonlrefighkaro\0\0rn;op;cotry;;l;rok;drot;i;fahraangle;ciy;grarr;DacdefglmnopqrstuxDoocsuteter;aioyron;r;clon;;ot;Drot;;;rsave;dot;;ilsnters;;;dot;apscr;ty;svetp1;;;gs;p;gpon;f;alsr;sl;us;i;lvon;csuviorc\0\0antgltressaeils;st;v;DD;parsl;Daot;rr;cdir;oah;mrlo;cipl;seoctationential\0\0\0\0\0\0\0llingdotsey;male;ilrlig;\0\0g;ig;;lig;lig;fjaltt;ig;ns;of;\0f;ak;v;artint;aocs\0\0;;;;\0;;\0\0;;5;\0;;8;l;wn;cr;Eabcdefgijlnorstv;l;cmpute;ma;d;reve;iyrc;;ot;;lqs;qslan;cdlc;ot;o;l;;es;r;;gmel;cy;;Eaj;;;Eaes;p;prox;q;qim;pf;cir;m;el;;>;cdlqrci;r;ot;Par;uest;adels\0pror;qlqlesienrtneqq;Aabcefkosyrilmrrsfildrcy;;cwir;;ar;irc;alrrts;uitlip;con;r;sewarow;arow;amoprrr;tht;klreftarrow;ightarrow;f;bar;cltr;asrok;bpull;hen\0\0\0\0\0\0cute;iyrc;cxy;clfr;rave;inoinnt;t;fin;ta;lig;aopcgtr;elpinarh;f;ed;;cfotare;in;tie;do;celpal;grerarhk;rod;cgpty;on;f;a;uestcir;n;Edsv;ot;;v;;ilde;\0cy;lcfmosuiyrc;;r;ath;pf;\0r;rcy;kcy;acfghjosppa;v;eydil;;r;reen;cy;cy;pf;cr;ABEHabcdefghjlmnoprstuvartrail;arr;;g;ar;\0\0\0\0\0\0\0\0\0ute;mptyv;rabda;g;dl;;uor;bfhlpst;fs;s;p;l;im;l;;aeil;;s;abrrr;rk;akcek;;es;ldu;;aeuyron;diil;;cqrsa;uo;rduhar;shar;h;;fgqstahlrtrrow;taarpoonduownpeftarrows;ightahsrrow;sarpoonquigarrohreetimes;;qslan;cdgsc;ot;o;r;;es;adegspproot;qgqgtiilrsht;;;E;rdu;l;lk;cy;;achtrorneard;ri;iodot;ust;acheEaes;p;prox;q;qim;abnoptwznrg;r;rglmreftarightapsto;ightparrowlrefight;aflr;;us;imes;st;;efngear;lt;achmtrornear;d;;ri;achiqtquo;r;m;eg;;buo;r;rok;<;cdhilqrci;r;remes;arr;uest;Piar;;efrdushar;har;enrtneqq;DacdefhilnopsuDot;clprret;;ese;sto;dluowefker;oymma;;ash;asuredangler;o;cdnro;acdsir;otus;bd;u;p;dpels;f;ctr;pos;lmtimap;GLRVabcdefghijlmoprstuvwgt;;veltftarrrow;ightarrow;;;vightarrow;Ddash;ash;bcnptlaute;g;;Eiop;d;s;rour;al;s\0pmp;eaeouy\0;on;dil;ng;dot;p;;ash;;Aadqsxrr;rhrk;;oot;uieiar;ist;sr;Eest;qs;qslani;rAaprrr;ar;;sv;d;cy;AEadestr;rr;r;;fqstarrroightarro;qslan;si;ri;eiptf;;inn;Edv;ot;;;i;v;;aorr;astllel;;lint;;ceu;c;eAaitrrr;cw;;ghtarrowri;echimpqu;ceru;ort\0\0arm;e;qsubpbcp;Ees;et;eq;qc;e;Ees;et;eq;qgilrldeianglelreft;eight;e;m;esro;p;DHadgilrsash;arr;p;ash;et;;>nfin;Aetrr;;;r<ie;Atrr;rie;im;Aanrr;rhrk;;oear;\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0\0csuteiyr;c;abioslac;v;old;lig;crir;;\0\0\0n;ave;bmar;acitrirr;oss;n;aeicr;ga;cdnron;;pf;aelr;rp;;adiosvr;efmr;ofgof;r;lope;;cloashl;idees;as;mlbar;\0\0\0\0\0\0\0\0\0r;ast;lle\0\0m;;y;rcimptnt;od;il;enk;r;imo;v;mane;;tvchfork;aunckk;h;s;abcdemstcir;ir;ou;;nim;wo;ipuntint;f;nd;Eaceinosu;p;u;c;acenspprourlyeaespprox;qq;im;ime;sEasdfpalslar;ine;urf;;trel;cir;;ncsp;fiopsur;pf;rime;cr;aeoteirnionnt;st;eABHabcdefhilmnoprstuxartrail;arar;cdenqrteu;te;imptyv;g;del;;uor;abcfhlpstwp;;fs;;s;l;im;l;;aiil;o;nalabrrrk;akcek;;es;ldu;;aeuyron;diil;;clqsa;dhar;uo;rh;acgl;ipsnart;ilrsht;;aordu;l;;v;gnshtahlrstrrow;taarpoonduowpeftahrrowarpoonightarrows;quigarrohreetimes;g;ingdotseahmra;oust;achemid;abptnrg;r;raflr;;us;imes;apr;gt;olint;arachqquo;r;buo;rhirremes;i;efltri;luhar;;\0\0\0\0\0\0\0cute;qu;Eaceinpsy;\0;on;u;dil;rc;Eas;p;im;olint;i;ot;be;Aacmstxrr;rhr;oti;war;minnut;r;oacoyrp;hycy;;rt\0\0iaragmma;fv;;deglnprot;;q;E;;E;e;lus;arr;araeitlslsetmhp;parsl;dle;;e;s;flptcy;;b;ar;f;adres;uitcsuaup;s;p;s;ubp;eset;e;eset;e;afrarcemtr;tmiararr;fanighteppsilohsbcmnp;Edemnprs;ot;;dot;ult;Ee;;lus;arr;eiut;enq;qeq;qm;bp;;c;acenspprourlyeaespproqg;123;Edehlmnps;ost;ub;;dot;soul;b;arr;ult;Ee;;lus;eiut;enq;qeq;qm;bp;;Aanrr;rhr;owar;lig\0\0\0\0\0\0\0\0\0\0\0\0get;;raeyron;dil;;lrec;r;eiko\0e4fa;svym;cnkaspproimsasrnes;bd;ar;;eps;bcfot;ir;;ork;rime;aipdadempstngle;dlqrowneft;e;ight;eot;inus;lus;b;ime;ezium;chtry;;cy;rok;ioxheadlreftarroightarrowAHabcdfghlmoprstuwrar;cruter\0y;ve;iyrc;abhrlac;airsht;;raverlrlk;ct\0\0rn;erop;ri;alcr;gpon;f;adhlsuownarpoonlrefighi;hlonparrows;cit\0\0rn;erop;ng;ri;cr;dirot;lde;i;famrlangle;ABDacdeflnoprszrar;v;asnrgrt;eknprstappothinhirop;hiugmbpsetneq;q;setneq;q;hretianglelreftighty;ashelr;bear;q;lip;btar;trsubppf;rotrcur;bpnEenEeigzag;cefoprsirc;dibgar;e;q;erp;r;pf;;eatcr;\0\0\0\0\0\0\0trr;Aarr;Aarrais;dptfl;imAarrcqr;ptracefiosucuyte;iyrc;;nr;cy;pf;cr;cmy;lacdefhioswcute;ayron;;ot;ettra;r;cy;grarr;pf;cr;jn;j;'.split("").map(t=>t.charCodeAt(0))),rT=new Uint16Array("aglq	\x1B\0\0p;os;t;t;uot;".split("").map(t=>t.charCodeAt(0)));var $p;const iH=new Map([[0,65533],[128,8364],[130,8218],[131,402],[132,8222],[133,8230],[134,8224],[135,8225],[136,710],[137,8240],[138,352],[139,8249],[140,338],[142,381],[145,8216],[146,8217],[147,8220],[148,8221],[149,8226],[150,8211],[151,8212],[152,732],[153,8482],[154,353],[155,8250],[156,339],[158,382],[159,376]]),Lg=($p=String.fromCodePoint)!==null&&$p!==void 0?$p:function(t){let e="";return t>65535&&(t-=65536,e+=String.fromCharCode(t>>>10&1023|55296),t=56320|t&1023),e+=String.fromCharCode(t),e};function sT(t){var e;return t>=55296&&t<=57343||t>1114111?65533:(e=iH.get(t))!==null&&e!==void 0?e:t}var yt;(function(t){t[t.NUM=35]="NUM",t[t.SEMI=59]="SEMI",t[t.EQUALS=61]="EQUALS",t[t.ZERO=48]="ZERO",t[t.NINE=57]="NINE",t[t.LOWER_A=97]="LOWER_A",t[t.LOWER_F=102]="LOWER_F",t[t.LOWER_X=120]="LOWER_X",t[t.LOWER_Z=122]="LOWER_Z",t[t.UPPER_A=65]="UPPER_A",t[t.UPPER_F=70]="UPPER_F",t[t.UPPER_Z=90]="UPPER_Z"})(yt||(yt={}));const aH=32;var Wn;(function(t){t[t.VALUE_LENGTH=49152]="VALUE_LENGTH",t[t.BRANCH_LENGTH=16256]="BRANCH_LENGTH",t[t.JUMP_TABLE=127]="JUMP_TABLE"})(Wn||(Wn={}));function Mg(t){return t>=yt.ZERO&&t<=yt.NINE}function oH(t){return t>=yt.UPPER_A&&t<=yt.UPPER_F||t>=yt.LOWER_A&&t<=yt.LOWER_F}function uH(t){return t>=yt.UPPER_A&&t<=yt.UPPER_Z||t>=yt.LOWER_A&&t<=yt.LOWER_Z||Mg(t)}function lH(t){return t===yt.EQUALS||uH(t)}var ft;(function(t){t[t.EntityStart=0]="EntityStart",t[t.NumericStart=1]="NumericStart",t[t.NumericDecimal=2]="NumericDecimal",t[t.NumericHex=3]="NumericHex",t[t.NamedEntity=4]="NamedEntity"})(ft||(ft={}));var ai;(function(t){t[t.Legacy=0]="Legacy",t[t.Strict=1]="Strict",t[t.Attribute=2]="Attribute"})(ai||(ai={}));class cH{constructor(e,n,r){this.decodeTree=e,this.emitCodePoint=n,this.errors=r,this.state=ft.EntityStart,this.consumed=1,this.result=0,this.treeIndex=0,this.excess=1,this.decodeMode=ai.Strict}startEntity(e){this.decodeMode=e,this.state=ft.EntityStart,this.result=0,this.treeIndex=0,this.excess=1,this.consumed=1}write(e,n){switch(this.state){case ft.EntityStart:return e.charCodeAt(n)===yt.NUM?(this.state=ft.NumericStart,this.consumed+=1,this.stateNumericStart(e,n+1)):(this.state=ft.NamedEntity,this.stateNamedEntity(e,n));case ft.NumericStart:return this.stateNumericStart(e,n);case ft.NumericDecimal:return this.stateNumericDecimal(e,n);case ft.NumericHex:return this.stateNumericHex(e,n);case ft.NamedEntity:return this.stateNamedEntity(e,n)}}stateNumericStart(e,n){return n>=e.length?-1:(e.charCodeAt(n)|aH)===yt.LOWER_X?(this.state=ft.NumericHex,this.consumed+=1,this.stateNumericHex(e,n+1)):(this.state=ft.NumericDecimal,this.stateNumericDecimal(e,n))}addToNumericResult(e,n,r,s){if(n!==r){const i=r-n;this.result=this.result*Math.pow(s,i)+parseInt(e.substr(n,i),s),this.consumed+=i}}stateNumericHex(e,n){const r=n;for(;n<e.length;){const s=e.charCodeAt(n);if(Mg(s)||oH(s))n+=1;else return this.addToNumericResult(e,r,n,16),this.emitNumericEntity(s,3)}return this.addToNumericResult(e,r,n,16),-1}stateNumericDecimal(e,n){const r=n;for(;n<e.length;){const s=e.charCodeAt(n);if(Mg(s))n+=1;else return this.addToNumericResult(e,r,n,10),this.emitNumericEntity(s,2)}return this.addToNumericResult(e,r,n,10),-1}emitNumericEntity(e,n){var r;if(this.consumed<=n)return(r=this.errors)===null||r===void 0||r.absenceOfDigitsInNumericCharacterReference(this.consumed),0;if(e===yt.SEMI)this.consumed+=1;else if(this.decodeMode===ai.Strict)return 0;return this.emitCodePoint(sT(this.result),this.consumed),this.errors&&(e!==yt.SEMI&&this.errors.missingSemicolonAfterCharacterReference(),this.errors.validateNumericCharacterReference(this.result)),this.consumed}stateNamedEntity(e,n){const{decodeTree:r}=this;let s=r[this.treeIndex],i=(s&Wn.VALUE_LENGTH)>>14;for(;n<e.length;n++,this.excess++){const a=e.charCodeAt(n);if(this.treeIndex=aT(r,s,this.treeIndex+Math.max(1,i),a),this.treeIndex<0)return this.result===0||this.decodeMode===ai.Attribute&&(i===0||lH(a))?0:this.emitNotTerminatedNamedEntity();if(s=r[this.treeIndex],i=(s&Wn.VALUE_LENGTH)>>14,i!==0){if(a===yt.SEMI)return this.emitNamedEntityData(this.treeIndex,i,this.consumed+this.excess);this.decodeMode!==ai.Strict&&(this.result=this.treeIndex,this.consumed+=this.excess,this.excess=0)}}return-1}emitNotTerminatedNamedEntity(){var e;const{result:n,decodeTree:r}=this,s=(r[n]&Wn.VALUE_LENGTH)>>14;return this.emitNamedEntityData(n,s,this.consumed),(e=this.errors)===null||e===void 0||e.missingSemicolonAfterCharacterReference(),this.consumed}emitNamedEntityData(e,n,r){const{decodeTree:s}=this;return this.emitCodePoint(n===1?s[e]&~Wn.VALUE_LENGTH:s[e+1],r),n===3&&this.emitCodePoint(s[e+2],r),r}end(){var e;switch(this.state){case ft.NamedEntity:return this.result!==0&&(this.decodeMode!==ai.Attribute||this.result===this.treeIndex)?this.emitNotTerminatedNamedEntity():0;case ft.NumericDecimal:return this.emitNumericEntity(0,2);case ft.NumericHex:return this.emitNumericEntity(0,3);case ft.NumericStart:return(e=this.errors)===null||e===void 0||e.absenceOfDigitsInNumericCharacterReference(this.consumed),0;case ft.EntityStart:return 0}}}function iT(t){let e="";const n=new cH(t,r=>e+=Lg(r));return function(s,i){let a=0,o=0;for(;(o=s.indexOf("&",o))>=0;){e+=s.slice(a,o),n.startEntity(i);const l=n.write(s,o+1);if(l<0){a=o+n.end();break}a=o+l,o=l===0?a+1:a}const u=e+s.slice(a);return e="",u}}function aT(t,e,n,r){const s=(e&Wn.BRANCH_LENGTH)>>7,i=e&Wn.JUMP_TABLE;if(s===0)return i!==0&&r===i?n:-1;if(i){const u=r-i;return u<0||u>=s?-1:t[n+u]-1}let a=n,o=a+s-1;for(;a<=o;){const u=a+o>>>1,l=t[u];if(l<r)a=u+1;else if(l>r)o=u-1;else return t[u+s]}return-1}iT(nT);iT(rT);var Q;(function(t){t[t.Tab=9]="Tab",t[t.NewLine=10]="NewLine",t[t.FormFeed=12]="FormFeed",t[t.CarriageReturn=13]="CarriageReturn",t[t.Space=32]="Space",t[t.ExclamationMark=33]="ExclamationMark",t[t.Number=35]="Number",t[t.Amp=38]="Amp",t[t.SingleQuote=39]="SingleQuote",t[t.DoubleQuote=34]="DoubleQuote",t[t.Dash=45]="Dash",t[t.Slash=47]="Slash",t[t.Zero=48]="Zero",t[t.Nine=57]="Nine",t[t.Semi=59]="Semi",t[t.Lt=60]="Lt",t[t.Eq=61]="Eq",t[t.Gt=62]="Gt",t[t.Questionmark=63]="Questionmark",t[t.UpperA=65]="UpperA",t[t.LowerA=97]="LowerA",t[t.UpperF=70]="UpperF",t[t.LowerF=102]="LowerF",t[t.UpperZ=90]="UpperZ",t[t.LowerZ=122]="LowerZ",t[t.LowerX=120]="LowerX",t[t.OpeningSquareBracket=91]="OpeningSquareBracket"})(Q||(Q={}));var N;(function(t){t[t.Text=1]="Text",t[t.BeforeTagName=2]="BeforeTagName",t[t.InTagName=3]="InTagName",t[t.InSelfClosingTag=4]="InSelfClosingTag",t[t.BeforeClosingTagName=5]="BeforeClosingTagName",t[t.InClosingTagName=6]="InClosingTagName",t[t.AfterClosingTagName=7]="AfterClosingTagName",t[t.BeforeAttributeName=8]="BeforeAttributeName",t[t.InAttributeName=9]="InAttributeName",t[t.AfterAttributeName=10]="AfterAttributeName",t[t.BeforeAttributeValue=11]="BeforeAttributeValue",t[t.InAttributeValueDq=12]="InAttributeValueDq",t[t.InAttributeValueSq=13]="InAttributeValueSq",t[t.InAttributeValueNq=14]="InAttributeValueNq",t[t.BeforeDeclaration=15]="BeforeDeclaration",t[t.InDeclaration=16]="InDeclaration",t[t.InProcessingInstruction=17]="InProcessingInstruction",t[t.BeforeComment=18]="BeforeComment",t[t.CDATASequence=19]="CDATASequence",t[t.InSpecialComment=20]="InSpecialComment",t[t.InCommentLike=21]="InCommentLike",t[t.BeforeSpecialS=22]="BeforeSpecialS",t[t.SpecialStartSequence=23]="SpecialStartSequence",t[t.InSpecialTag=24]="InSpecialTag",t[t.BeforeEntity=25]="BeforeEntity",t[t.BeforeNumericEntity=26]="BeforeNumericEntity",t[t.InNamedEntity=27]="InNamedEntity",t[t.InNumericEntity=28]="InNumericEntity",t[t.InHexEntity=29]="InHexEntity"})(N||(N={}));function $r(t){return t===Q.Space||t===Q.NewLine||t===Q.Tab||t===Q.FormFeed||t===Q.CarriageReturn}function Cc(t){return t===Q.Slash||t===Q.Gt||$r(t)}function s1(t){return t>=Q.Zero&&t<=Q.Nine}function dH(t){return t>=Q.LowerA&&t<=Q.LowerZ||t>=Q.UpperA&&t<=Q.UpperZ}function fH(t){return t>=Q.UpperA&&t<=Q.UpperF||t>=Q.LowerA&&t<=Q.LowerF}var gr;(function(t){t[t.NoValue=0]="NoValue",t[t.Unquoted=1]="Unquoted",t[t.Single=2]="Single",t[t.Double=3]="Double"})(gr||(gr={}));const Vt={Cdata:new Uint8Array([67,68,65,84,65,91]),CdataEnd:new Uint8Array([93,93,62]),CommentEnd:new Uint8Array([45,45,62]),ScriptEnd:new Uint8Array([60,47,115,99,114,105,112,116]),StyleEnd:new Uint8Array([60,47,115,116,121,108,101]),TitleEnd:new Uint8Array([60,47,116,105,116,108,101])};class hH{constructor({xmlMode:e=!1,decodeEntities:n=!0},r){this.cbs=r,this.state=N.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=N.Text,this.isSpecial=!1,this.running=!0,this.offset=0,this.currentSequence=void 0,this.sequenceIndex=0,this.trieIndex=0,this.trieCurrent=0,this.entityResult=0,this.entityExcess=0,this.xmlMode=e,this.decodeEntities=n,this.entityTrie=e?rT:nT}reset(){this.state=N.Text,this.buffer="",this.sectionStart=0,this.index=0,this.baseState=N.Text,this.currentSequence=void 0,this.running=!0,this.offset=0}write(e){this.offset+=this.buffer.length,this.buffer=e,this.parse()}end(){this.running&&this.finish()}pause(){this.running=!1}resume(){this.running=!0,this.index<this.buffer.length+this.offset&&this.parse()}getIndex(){return this.index}getSectionStart(){return this.sectionStart}stateText(e){e===Q.Lt||!this.decodeEntities&&this.fastForwardTo(Q.Lt)?(this.index>this.sectionStart&&this.cbs.ontext(this.sectionStart,this.index),this.state=N.BeforeTagName,this.sectionStart=this.index):this.decodeEntities&&e===Q.Amp&&(this.state=N.BeforeEntity)}stateSpecialStartSequence(e){const n=this.sequenceIndex===this.currentSequence.length;if(!(n?Cc(e):(e|32)===this.currentSequence[this.sequenceIndex]))this.isSpecial=!1;else if(!n){this.sequenceIndex++;return}this.sequenceIndex=0,this.state=N.InTagName,this.stateInTagName(e)}stateInSpecialTag(e){if(this.sequenceIndex===this.currentSequence.length){if(e===Q.Gt||$r(e)){const n=this.index-this.currentSequence.length;if(this.sectionStart<n){const r=this.index;this.index=n,this.cbs.ontext(this.sectionStart,n),this.index=r}this.isSpecial=!1,this.sectionStart=n+2,this.stateInClosingTagName(e);return}this.sequenceIndex=0}(e|32)===this.currentSequence[this.sequenceIndex]?this.sequenceIndex+=1:this.sequenceIndex===0?this.currentSequence===Vt.TitleEnd?this.decodeEntities&&e===Q.Amp&&(this.state=N.BeforeEntity):this.fastForwardTo(Q.Lt)&&(this.sequenceIndex=1):this.sequenceIndex=+(e===Q.Lt)}stateCDATASequence(e){e===Vt.Cdata[this.sequenceIndex]?++this.sequenceIndex===Vt.Cdata.length&&(this.state=N.InCommentLike,this.currentSequence=Vt.CdataEnd,this.sequenceIndex=0,this.sectionStart=this.index+1):(this.sequenceIndex=0,this.state=N.InDeclaration,this.stateInDeclaration(e))}fastForwardTo(e){for(;++this.index<this.buffer.length+this.offset;)if(this.buffer.charCodeAt(this.index-this.offset)===e)return!0;return this.index=this.buffer.length+this.offset-1,!1}stateInCommentLike(e){e===this.currentSequence[this.sequenceIndex]?++this.sequenceIndex===this.currentSequence.length&&(this.currentSequence===Vt.CdataEnd?this.cbs.oncdata(this.sectionStart,this.index,2):this.cbs.oncomment(this.sectionStart,this.index,2),this.sequenceIndex=0,this.sectionStart=this.index+1,this.state=N.Text):this.sequenceIndex===0?this.fastForwardTo(this.currentSequence[0])&&(this.sequenceIndex=1):e!==this.currentSequence[this.sequenceIndex-1]&&(this.sequenceIndex=0)}isTagStartChar(e){return this.xmlMode?!Cc(e):dH(e)}startSpecial(e,n){this.isSpecial=!0,this.currentSequence=e,this.sequenceIndex=n,this.state=N.SpecialStartSequence}stateBeforeTagName(e){if(e===Q.ExclamationMark)this.state=N.BeforeDeclaration,this.sectionStart=this.index+1;else if(e===Q.Questionmark)this.state=N.InProcessingInstruction,this.sectionStart=this.index+1;else if(this.isTagStartChar(e)){const n=e|32;this.sectionStart=this.index,!this.xmlMode&&n===Vt.TitleEnd[2]?this.startSpecial(Vt.TitleEnd,3):this.state=!this.xmlMode&&n===Vt.ScriptEnd[2]?N.BeforeSpecialS:N.InTagName}else e===Q.Slash?this.state=N.BeforeClosingTagName:(this.state=N.Text,this.stateText(e))}stateInTagName(e){Cc(e)&&(this.cbs.onopentagname(this.sectionStart,this.index),this.sectionStart=-1,this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateBeforeClosingTagName(e){$r(e)||(e===Q.Gt?this.state=N.Text:(this.state=this.isTagStartChar(e)?N.InClosingTagName:N.InSpecialComment,this.sectionStart=this.index))}stateInClosingTagName(e){(e===Q.Gt||$r(e))&&(this.cbs.onclosetag(this.sectionStart,this.index),this.sectionStart=-1,this.state=N.AfterClosingTagName,this.stateAfterClosingTagName(e))}stateAfterClosingTagName(e){(e===Q.Gt||this.fastForwardTo(Q.Gt))&&(this.state=N.Text,this.baseState=N.Text,this.sectionStart=this.index+1)}stateBeforeAttributeName(e){e===Q.Gt?(this.cbs.onopentagend(this.index),this.isSpecial?(this.state=N.InSpecialTag,this.sequenceIndex=0):this.state=N.Text,this.baseState=this.state,this.sectionStart=this.index+1):e===Q.Slash?this.state=N.InSelfClosingTag:$r(e)||(this.state=N.InAttributeName,this.sectionStart=this.index)}stateInSelfClosingTag(e){e===Q.Gt?(this.cbs.onselfclosingtag(this.index),this.state=N.Text,this.baseState=N.Text,this.sectionStart=this.index+1,this.isSpecial=!1):$r(e)||(this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e))}stateInAttributeName(e){(e===Q.Eq||Cc(e))&&(this.cbs.onattribname(this.sectionStart,this.index),this.sectionStart=-1,this.state=N.AfterAttributeName,this.stateAfterAttributeName(e))}stateAfterAttributeName(e){e===Q.Eq?this.state=N.BeforeAttributeValue:e===Q.Slash||e===Q.Gt?(this.cbs.onattribend(gr.NoValue,this.index),this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e)):$r(e)||(this.cbs.onattribend(gr.NoValue,this.index),this.state=N.InAttributeName,this.sectionStart=this.index)}stateBeforeAttributeValue(e){e===Q.DoubleQuote?(this.state=N.InAttributeValueDq,this.sectionStart=this.index+1):e===Q.SingleQuote?(this.state=N.InAttributeValueSq,this.sectionStart=this.index+1):$r(e)||(this.sectionStart=this.index,this.state=N.InAttributeValueNq,this.stateInAttributeValueNoQuotes(e))}handleInAttributeValue(e,n){e===n||!this.decodeEntities&&this.fastForwardTo(n)?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(n===Q.DoubleQuote?gr.Double:gr.Single,this.index),this.state=N.BeforeAttributeName):this.decodeEntities&&e===Q.Amp&&(this.baseState=this.state,this.state=N.BeforeEntity)}stateInAttributeValueDoubleQuotes(e){this.handleInAttributeValue(e,Q.DoubleQuote)}stateInAttributeValueSingleQuotes(e){this.handleInAttributeValue(e,Q.SingleQuote)}stateInAttributeValueNoQuotes(e){$r(e)||e===Q.Gt?(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=-1,this.cbs.onattribend(gr.Unquoted,this.index),this.state=N.BeforeAttributeName,this.stateBeforeAttributeName(e)):this.decodeEntities&&e===Q.Amp&&(this.baseState=this.state,this.state=N.BeforeEntity)}stateBeforeDeclaration(e){e===Q.OpeningSquareBracket?(this.state=N.CDATASequence,this.sequenceIndex=0):this.state=e===Q.Dash?N.BeforeComment:N.InDeclaration}stateInDeclaration(e){(e===Q.Gt||this.fastForwardTo(Q.Gt))&&(this.cbs.ondeclaration(this.sectionStart,this.index),this.state=N.Text,this.sectionStart=this.index+1)}stateInProcessingInstruction(e){(e===Q.Gt||this.fastForwardTo(Q.Gt))&&(this.cbs.onprocessinginstruction(this.sectionStart,this.index),this.state=N.Text,this.sectionStart=this.index+1)}stateBeforeComment(e){e===Q.Dash?(this.state=N.InCommentLike,this.currentSequence=Vt.CommentEnd,this.sequenceIndex=2,this.sectionStart=this.index+1):this.state=N.InDeclaration}stateInSpecialComment(e){(e===Q.Gt||this.fastForwardTo(Q.Gt))&&(this.cbs.oncomment(this.sectionStart,this.index,0),this.state=N.Text,this.sectionStart=this.index+1)}stateBeforeSpecialS(e){const n=e|32;n===Vt.ScriptEnd[3]?this.startSpecial(Vt.ScriptEnd,4):n===Vt.StyleEnd[3]?this.startSpecial(Vt.StyleEnd,4):(this.state=N.InTagName,this.stateInTagName(e))}stateBeforeEntity(e){this.entityExcess=1,this.entityResult=0,e===Q.Number?this.state=N.BeforeNumericEntity:e===Q.Amp||(this.trieIndex=0,this.trieCurrent=this.entityTrie[0],this.state=N.InNamedEntity,this.stateInNamedEntity(e))}stateInNamedEntity(e){if(this.entityExcess+=1,this.trieIndex=aT(this.entityTrie,this.trieCurrent,this.trieIndex+1,e),this.trieIndex<0){this.emitNamedEntity(),this.index--;return}this.trieCurrent=this.entityTrie[this.trieIndex];const n=this.trieCurrent&Wn.VALUE_LENGTH;if(n){const r=(n>>14)-1;if(!this.allowLegacyEntity()&&e!==Q.Semi)this.trieIndex+=r;else{const s=this.index-this.entityExcess+1;s>this.sectionStart&&this.emitPartial(this.sectionStart,s),this.entityResult=this.trieIndex,this.trieIndex+=r,this.entityExcess=0,this.sectionStart=this.index+1,r===0&&this.emitNamedEntity()}}}emitNamedEntity(){if(this.state=this.baseState,this.entityResult===0)return;switch((this.entityTrie[this.entityResult]&Wn.VALUE_LENGTH)>>14){case 1:{this.emitCodePoint(this.entityTrie[this.entityResult]&~Wn.VALUE_LENGTH);break}case 2:{this.emitCodePoint(this.entityTrie[this.entityResult+1]);break}case 3:this.emitCodePoint(this.entityTrie[this.entityResult+1]),this.emitCodePoint(this.entityTrie[this.entityResult+2])}}stateBeforeNumericEntity(e){(e|32)===Q.LowerX?(this.entityExcess++,this.state=N.InHexEntity):(this.state=N.InNumericEntity,this.stateInNumericEntity(e))}emitNumericEntity(e){const n=this.index-this.entityExcess-1;n+2+ +(this.state===N.InHexEntity)!==this.index&&(n>this.sectionStart&&this.emitPartial(this.sectionStart,n),this.sectionStart=this.index+Number(e),this.emitCodePoint(sT(this.entityResult))),this.state=this.baseState}stateInNumericEntity(e){e===Q.Semi?this.emitNumericEntity(!0):s1(e)?(this.entityResult=this.entityResult*10+(e-Q.Zero),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}stateInHexEntity(e){e===Q.Semi?this.emitNumericEntity(!0):s1(e)?(this.entityResult=this.entityResult*16+(e-Q.Zero),this.entityExcess++):fH(e)?(this.entityResult=this.entityResult*16+((e|32)-Q.LowerA+10),this.entityExcess++):(this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state=this.baseState,this.index--)}allowLegacyEntity(){return!this.xmlMode&&(this.baseState===N.Text||this.baseState===N.InSpecialTag)}cleanup(){this.running&&this.sectionStart!==this.index&&(this.state===N.Text||this.state===N.InSpecialTag&&this.sequenceIndex===0?(this.cbs.ontext(this.sectionStart,this.index),this.sectionStart=this.index):(this.state===N.InAttributeValueDq||this.state===N.InAttributeValueSq||this.state===N.InAttributeValueNq)&&(this.cbs.onattribdata(this.sectionStart,this.index),this.sectionStart=this.index))}shouldContinue(){return this.index<this.buffer.length+this.offset&&this.running}parse(){for(;this.shouldContinue();){const e=this.buffer.charCodeAt(this.index-this.offset);switch(this.state){case N.Text:{this.stateText(e);break}case N.SpecialStartSequence:{this.stateSpecialStartSequence(e);break}case N.InSpecialTag:{this.stateInSpecialTag(e);break}case N.CDATASequence:{this.stateCDATASequence(e);break}case N.InAttributeValueDq:{this.stateInAttributeValueDoubleQuotes(e);break}case N.InAttributeName:{this.stateInAttributeName(e);break}case N.InCommentLike:{this.stateInCommentLike(e);break}case N.InSpecialComment:{this.stateInSpecialComment(e);break}case N.BeforeAttributeName:{this.stateBeforeAttributeName(e);break}case N.InTagName:{this.stateInTagName(e);break}case N.InClosingTagName:{this.stateInClosingTagName(e);break}case N.BeforeTagName:{this.stateBeforeTagName(e);break}case N.AfterAttributeName:{this.stateAfterAttributeName(e);break}case N.InAttributeValueSq:{this.stateInAttributeValueSingleQuotes(e);break}case N.BeforeAttributeValue:{this.stateBeforeAttributeValue(e);break}case N.BeforeClosingTagName:{this.stateBeforeClosingTagName(e);break}case N.AfterClosingTagName:{this.stateAfterClosingTagName(e);break}case N.BeforeSpecialS:{this.stateBeforeSpecialS(e);break}case N.InAttributeValueNq:{this.stateInAttributeValueNoQuotes(e);break}case N.InSelfClosingTag:{this.stateInSelfClosingTag(e);break}case N.InDeclaration:{this.stateInDeclaration(e);break}case N.BeforeDeclaration:{this.stateBeforeDeclaration(e);break}case N.BeforeComment:{this.stateBeforeComment(e);break}case N.InProcessingInstruction:{this.stateInProcessingInstruction(e);break}case N.InNamedEntity:{this.stateInNamedEntity(e);break}case N.BeforeEntity:{this.stateBeforeEntity(e);break}case N.InHexEntity:{this.stateInHexEntity(e);break}case N.InNumericEntity:{this.stateInNumericEntity(e);break}default:this.stateBeforeNumericEntity(e)}this.index++}this.cleanup()}finish(){this.state===N.InNamedEntity&&this.emitNamedEntity(),this.sectionStart<this.index&&this.handleTrailingData(),this.cbs.onend()}handleTrailingData(){const e=this.buffer.length+this.offset;this.state===N.InCommentLike?this.currentSequence===Vt.CdataEnd?this.cbs.oncdata(this.sectionStart,e,0):this.cbs.oncomment(this.sectionStart,e,0):this.state===N.InNumericEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===N.InHexEntity&&this.allowLegacyEntity()?this.emitNumericEntity(!1):this.state===N.InTagName||this.state===N.BeforeAttributeName||this.state===N.BeforeAttributeValue||this.state===N.AfterAttributeName||this.state===N.InAttributeName||this.state===N.InAttributeValueSq||this.state===N.InAttributeValueDq||this.state===N.InAttributeValueNq||this.state===N.InClosingTagName||this.cbs.ontext(this.sectionStart,e)}emitPartial(e,n){this.baseState!==N.Text&&this.baseState!==N.InSpecialTag?this.cbs.onattribdata(e,n):this.cbs.ontext(e,n)}emitCodePoint(e){this.baseState!==N.Text&&this.baseState!==N.InSpecialTag?this.cbs.onattribentity(e):this.cbs.ontextentity(e)}}const Ji=new Set(["input","option","optgroup","select","button","datalist","textarea"]),$e=new Set(["p"]),i1=new Set(["thead","tbody"]),a1=new Set(["dd","dt"]),o1=new Set(["rt","rp"]),pH=new Map([["tr",new Set(["tr","th","td"])],["th",new Set(["th"])],["td",new Set(["thead","th","td"])],["body",new Set(["head","link","script"])],["li",new Set(["li"])],["p",$e],["h1",$e],["h2",$e],["h3",$e],["h4",$e],["h5",$e],["h6",$e],["select",Ji],["input",Ji],["output",Ji],["button",Ji],["datalist",Ji],["textarea",Ji],["option",new Set(["option"])],["optgroup",new Set(["optgroup","option"])],["dd",a1],["dt",a1],["address",$e],["article",$e],["aside",$e],["blockquote",$e],["details",$e],["div",$e],["dl",$e],["fieldset",$e],["figcaption",$e],["figure",$e],["footer",$e],["form",$e],["header",$e],["hr",$e],["main",$e],["nav",$e],["ol",$e],["pre",$e],["section",$e],["table",$e],["ul",$e],["rt",o1],["rp",o1],["tbody",i1],["tfoot",i1]]),mH=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]),u1=new Set(["math","svg"]),l1=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignobject","desc","title"]),gH=/\s|\//;class yH{constructor(e,n={}){var r,s,i,a,o;this.options=n,this.startIndex=0,this.endIndex=0,this.openTagStart=0,this.tagname="",this.attribname="",this.attribvalue="",this.attribs=null,this.stack=[],this.foreignContext=[],this.buffers=[],this.bufferOffset=0,this.writeIndex=0,this.ended=!1,this.cbs=e??{},this.lowerCaseTagNames=(r=n.lowerCaseTags)!==null&&r!==void 0?r:!n.xmlMode,this.lowerCaseAttributeNames=(s=n.lowerCaseAttributeNames)!==null&&s!==void 0?s:!n.xmlMode,this.tokenizer=new((i=n.Tokenizer)!==null&&i!==void 0?i:hH)(this.options,this),(o=(a=this.cbs).onparserinit)===null||o===void 0||o.call(a,this)}ontext(e,n){var r,s;const i=this.getSlice(e,n);this.endIndex=n-1,(s=(r=this.cbs).ontext)===null||s===void 0||s.call(r,i),this.startIndex=n}ontextentity(e){var n,r;const s=this.tokenizer.getSectionStart();this.endIndex=s-1,(r=(n=this.cbs).ontext)===null||r===void 0||r.call(n,Lg(e)),this.startIndex=s}isVoidElement(e){return!this.options.xmlMode&&mH.has(e)}onopentagname(e,n){this.endIndex=n;let r=this.getSlice(e,n);this.lowerCaseTagNames&&(r=r.toLowerCase()),this.emitOpenTag(r)}emitOpenTag(e){var n,r,s,i;this.openTagStart=this.startIndex,this.tagname=e;const a=!this.options.xmlMode&&pH.get(e);if(a)for(;this.stack.length>0&&a.has(this.stack[this.stack.length-1]);){const o=this.stack.pop();(r=(n=this.cbs).onclosetag)===null||r===void 0||r.call(n,o,!0)}this.isVoidElement(e)||(this.stack.push(e),u1.has(e)?this.foreignContext.push(!0):l1.has(e)&&this.foreignContext.push(!1)),(i=(s=this.cbs).onopentagname)===null||i===void 0||i.call(s,e),this.cbs.onopentag&&(this.attribs={})}endOpenTag(e){var n,r;this.startIndex=this.openTagStart,this.attribs&&((r=(n=this.cbs).onopentag)===null||r===void 0||r.call(n,this.tagname,this.attribs,e),this.attribs=null),this.cbs.onclosetag&&this.isVoidElement(this.tagname)&&this.cbs.onclosetag(this.tagname,!0),this.tagname=""}onopentagend(e){this.endIndex=e,this.endOpenTag(!1),this.startIndex=e+1}onclosetag(e,n){var r,s,i,a,o,u;this.endIndex=n;let l=this.getSlice(e,n);if(this.lowerCaseTagNames&&(l=l.toLowerCase()),(u1.has(l)||l1.has(l))&&this.foreignContext.pop(),this.isVoidElement(l))!this.options.xmlMode&&l==="br"&&((s=(r=this.cbs).onopentagname)===null||s===void 0||s.call(r,"br"),(a=(i=this.cbs).onopentag)===null||a===void 0||a.call(i,"br",{},!0),(u=(o=this.cbs).onclosetag)===null||u===void 0||u.call(o,"br",!1));else{const c=this.stack.lastIndexOf(l);if(c!==-1)if(this.cbs.onclosetag){let d=this.stack.length-c;for(;d--;)this.cbs.onclosetag(this.stack.pop(),d!==0)}else this.stack.length=c;else!this.options.xmlMode&&l==="p"&&(this.emitOpenTag("p"),this.closeCurrentTag(!0))}this.startIndex=n+1}onselfclosingtag(e){this.endIndex=e,this.options.xmlMode||this.options.recognizeSelfClosing||this.foreignContext[this.foreignContext.length-1]?(this.closeCurrentTag(!1),this.startIndex=e+1):this.onopentagend(e)}closeCurrentTag(e){var n,r;const s=this.tagname;this.endOpenTag(e),this.stack[this.stack.length-1]===s&&((r=(n=this.cbs).onclosetag)===null||r===void 0||r.call(n,s,!e),this.stack.pop())}onattribname(e,n){this.startIndex=e;const r=this.getSlice(e,n);this.attribname=this.lowerCaseAttributeNames?r.toLowerCase():r}onattribdata(e,n){this.attribvalue+=this.getSlice(e,n)}onattribentity(e){this.attribvalue+=Lg(e)}onattribend(e,n){var r,s;this.endIndex=n,(s=(r=this.cbs).onattribute)===null||s===void 0||s.call(r,this.attribname,this.attribvalue,e===gr.Double?'"':e===gr.Single?"'":e===gr.NoValue?void 0:null),this.attribs&&!Object.prototype.hasOwnProperty.call(this.attribs,this.attribname)&&(this.attribs[this.attribname]=this.attribvalue),this.attribvalue=""}getInstructionName(e){const n=e.search(gH);let r=n<0?e:e.substr(0,n);return this.lowerCaseTagNames&&(r=r.toLowerCase()),r}ondeclaration(e,n){this.endIndex=n;const r=this.getSlice(e,n);if(this.cbs.onprocessinginstruction){const s=this.getInstructionName(r);this.cbs.onprocessinginstruction(`!${s}`,`!${r}`)}this.startIndex=n+1}onprocessinginstruction(e,n){this.endIndex=n;const r=this.getSlice(e,n);if(this.cbs.onprocessinginstruction){const s=this.getInstructionName(r);this.cbs.onprocessinginstruction(`?${s}`,`?${r}`)}this.startIndex=n+1}oncomment(e,n,r){var s,i,a,o;this.endIndex=n,(i=(s=this.cbs).oncomment)===null||i===void 0||i.call(s,this.getSlice(e,n-r)),(o=(a=this.cbs).oncommentend)===null||o===void 0||o.call(a),this.startIndex=n+1}oncdata(e,n,r){var s,i,a,o,u,l,c,d,f,h;this.endIndex=n;const m=this.getSlice(e,n-r);this.options.xmlMode||this.options.recognizeCDATA?((i=(s=this.cbs).oncdatastart)===null||i===void 0||i.call(s),(o=(a=this.cbs).ontext)===null||o===void 0||o.call(a,m),(l=(u=this.cbs).oncdataend)===null||l===void 0||l.call(u)):((d=(c=this.cbs).oncomment)===null||d===void 0||d.call(c,`[CDATA[${m}]]`),(h=(f=this.cbs).oncommentend)===null||h===void 0||h.call(f)),this.startIndex=n+1}onend(){var e,n;if(this.cbs.onclosetag){this.endIndex=this.startIndex;for(let r=this.stack.length;r>0;this.cbs.onclosetag(this.stack[--r],!0));}(n=(e=this.cbs).onend)===null||n===void 0||n.call(e)}reset(){var e,n,r,s;(n=(e=this.cbs).onreset)===null||n===void 0||n.call(e),this.tokenizer.reset(),this.tagname="",this.attribname="",this.attribs=null,this.stack.length=0,this.startIndex=0,this.endIndex=0,(s=(r=this.cbs).onparserinit)===null||s===void 0||s.call(r,this),this.buffers.length=0,this.bufferOffset=0,this.writeIndex=0,this.ended=!1}parseComplete(e){this.reset(),this.end(e)}getSlice(e,n){for(;e-this.bufferOffset>=this.buffers[0].length;)this.shiftBuffer();let r=this.buffers[0].slice(e-this.bufferOffset,n-this.bufferOffset);for(;n-this.bufferOffset>this.buffers[0].length;)this.shiftBuffer(),r+=this.buffers[0].slice(0,n-this.bufferOffset);return r}shiftBuffer(){this.bufferOffset+=this.buffers[0].length,this.writeIndex--,this.buffers.shift()}write(e){var n,r;if(this.ended){(r=(n=this.cbs).onerror)===null||r===void 0||r.call(n,new Error(".write() after done!"));return}this.buffers.push(e),this.tokenizer.running&&(this.tokenizer.write(e),this.writeIndex++)}end(e){var n,r;if(this.ended){(r=(n=this.cbs).onerror)===null||r===void 0||r.call(n,new Error(".end() after done!"));return}e&&this.write(e),this.ended=!0,this.tokenizer.end()}pause(){this.tokenizer.pause()}resume(){for(this.tokenizer.resume();this.tokenizer.running&&this.writeIndex<this.buffers.length;)this.tokenizer.write(this.buffers[this.writeIndex++]);this.ended&&this.tokenizer.end()}parseChunk(e){this.write(e)}done(e){this.end(e)}}const c1=/["&'<>$\x80-\uFFFF]/g,bH=new Map([[34,"&quot;"],[38,"&amp;"],[39,"&apos;"],[60,"&lt;"],[62,"&gt;"]]),wH=String.prototype.codePointAt!=null?(t,e)=>t.codePointAt(e):(t,e)=>(t.charCodeAt(e)&64512)===55296?(t.charCodeAt(e)-55296)*1024+t.charCodeAt(e+1)-56320+65536:t.charCodeAt(e);function oT(t){let e="",n=0,r;for(;(r=c1.exec(t))!==null;){const s=r.index,i=t.charCodeAt(s),a=bH.get(i);a!==void 0?(e+=t.substring(n,s)+a,n=s+1):(e+=`${t.substring(n,s)}&#x${wH(t,s).toString(16)};`,n=c1.lastIndex+=+((i&64512)===55296))}return e+t.substr(n)}function uT(t,e){return function(r){let s,i=0,a="";for(;s=t.exec(r);)i!==s.index&&(a+=r.substring(i,s.index)),a+=e.get(s[0].charCodeAt(0)),i=s.index+1;return a+r.substring(i)}}const _H=uT(/["&\u00A0]/g,new Map([[34,"&quot;"],[38,"&amp;"],[160,"&nbsp;"]])),vH=uT(/[&<>\u00A0]/g,new Map([[38,"&amp;"],[60,"&lt;"],[62,"&gt;"],[160,"&nbsp;"]])),xH=new Map(["altGlyph","altGlyphDef","altGlyphItem","animateColor","animateMotion","animateTransform","clipPath","feBlend","feColorMatrix","feComponentTransfer","feComposite","feConvolveMatrix","feDiffuseLighting","feDisplacementMap","feDistantLight","feDropShadow","feFlood","feFuncA","feFuncB","feFuncG","feFuncR","feGaussianBlur","feImage","feMerge","feMergeNode","feMorphology","feOffset","fePointLight","feSpecularLighting","feSpotLight","feTile","feTurbulence","foreignObject","glyphRef","linearGradient","radialGradient","textPath"].map(t=>[t.toLowerCase(),t])),SH=new Map(["definitionURL","attributeName","attributeType","baseFrequency","baseProfile","calcMode","clipPathUnits","diffuseConstant","edgeMode","filterUnits","glyphRef","gradientTransform","gradientUnits","kernelMatrix","kernelUnitLength","keyPoints","keySplines","keyTimes","lengthAdjust","limitingConeAngle","markerHeight","markerUnits","markerWidth","maskContentUnits","maskUnits","numOctaves","pathLength","patternContentUnits","patternTransform","patternUnits","pointsAtX","pointsAtY","pointsAtZ","preserveAlpha","preserveAspectRatio","primitiveUnits","refX","refY","repeatCount","repeatDur","requiredExtensions","requiredFeatures","specularConstant","specularExponent","spreadMethod","startOffset","stdDeviation","stitchTiles","surfaceScale","systemLanguage","tableValues","targetX","targetY","textLength","viewBox","viewTarget","xChannelSelector","yChannelSelector","zoomAndPan"].map(t=>[t.toLowerCase(),t])),kH=new Set(["style","script","xmp","iframe","noembed","noframes","plaintext","noscript"]);function EH(t){return t.replace(/"/g,"&quot;")}function AH(t,e){var n;if(!t)return;const r=((n=e.encodeEntities)!==null&&n!==void 0?n:e.decodeEntities)===!1?EH:e.xmlMode||e.encodeEntities!=="utf8"?oT:_H;return Object.keys(t).map(s=>{var i,a;const o=(i=t[s])!==null&&i!==void 0?i:"";return e.xmlMode==="foreign"&&(s=(a=SH.get(s))!==null&&a!==void 0?a:s),!e.emptyAttrs&&!e.xmlMode&&o===""?s:`${s}="${r(o)}"`}).join(" ")}const d1=new Set(["area","base","basefont","br","col","command","embed","frame","hr","img","input","isindex","keygen","link","meta","param","source","track","wbr"]);function ch(t,e={}){const n="length"in t?t:[t];let r="";for(let s=0;s<n.length;s++)r+=TH(n[s],e);return r}function TH(t,e){switch(t.type){case Iz:return ch(t.children,e);case Bz:case jz:return NH(t);case $z:return jH(t);case Fz:return RH(t);case Lz:case Mz:case Dz:return OH(t,e);case Rz:return IH(t,e)}}const CH=new Set(["mi","mo","mn","ms","mtext","annotation-xml","foreignObject","desc","title"]),PH=new Set(["svg","math"]);function OH(t,e){var n;e.xmlMode==="foreign"&&(t.name=(n=xH.get(t.name))!==null&&n!==void 0?n:t.name,t.parent&&CH.has(t.parent.name)&&(e={...e,xmlMode:!1})),!e.xmlMode&&PH.has(t.name)&&(e={...e,xmlMode:"foreign"});let r=`<${t.name}`;const s=AH(t.attribs,e);return s&&(r+=` ${s}`),t.children.length===0&&(e.xmlMode?e.selfClosingTags!==!1:e.selfClosingTags&&d1.has(t.name))?(e.xmlMode||(r+=" "),r+="/>"):(r+=">",t.children.length>0&&(r+=ch(t.children,e)),(e.xmlMode||!d1.has(t.name))&&(r+=`</${t.name}>`)),r}function NH(t){return`<${t.data}>`}function IH(t,e){var n;let r=t.data||"";return((n=e.encodeEntities)!==null&&n!==void 0?n:e.decodeEntities)!==!1&&!(!e.xmlMode&&t.parent&&kH.has(t.parent.name))&&(r=e.xmlMode||e.encodeEntities!=="utf8"?oT(r):vH(r)),r}function RH(t){return`<![CDATA[${t.children[0].data}]]>`}function jH(t){return`<!--${t.data}-->`}function $H(t,e){const n=new Wz(void 0,e);return new yH(n,e).end(t),n.root}var LH=function(e){return MH(e)&&!DH(e)};function MH(t){return!!t&&typeof t=="object"}function DH(t){var e=Object.prototype.toString.call(t);return e==="[object RegExp]"||e==="[object Date]"||UH(t)}var FH=typeof Symbol=="function"&&Symbol.for,BH=FH?Symbol.for("react.element"):60103;function UH(t){return t.$$typeof===BH}function zH(t){return Array.isArray(t)?[]:{}}function ul(t,e){return e.clone!==!1&&e.isMergeableObject(t)?Ka(zH(t),t,e):t}function qH(t,e,n){return t.concat(e).map(function(r){return ul(r,n)})}function HH(t,e){if(!e.customMerge)return Ka;var n=e.customMerge(t);return typeof n=="function"?n:Ka}function VH(t){return Object.getOwnPropertySymbols?Object.getOwnPropertySymbols(t).filter(function(e){return Object.propertyIsEnumerable.call(t,e)}):[]}function f1(t){return Object.keys(t).concat(VH(t))}function lT(t,e){try{return e in t}catch{return!1}}function WH(t,e){return lT(t,e)&&!(Object.hasOwnProperty.call(t,e)&&Object.propertyIsEnumerable.call(t,e))}function GH(t,e,n){var r={};return n.isMergeableObject(t)&&f1(t).forEach(function(s){r[s]=ul(t[s],n)}),f1(e).forEach(function(s){WH(t,s)||(lT(t,s)&&n.isMergeableObject(e[s])?r[s]=HH(s,n)(t[s],e[s],n):r[s]=ul(e[s],n))}),r}function Ka(t,e,n){n=n||{},n.arrayMerge=n.arrayMerge||qH,n.isMergeableObject=n.isMergeableObject||LH,n.cloneUnlessOtherwiseSpecified=ul;var r=Array.isArray(e),s=Array.isArray(t),i=r===s;return i?r?n.arrayMerge(t,e,n):GH(t,e,n):ul(e,n)}Ka.all=function(e,n){if(!Array.isArray(e))throw new Error("first argument should be an array");return e.reduce(function(r,s){return Ka(r,s,n)},{})};var ZH=Ka,JH=ZH;const cT=Xa(JH);function lb(t,e,n=()=>{}){if(t===void 0){const r=function(...s){return e(r,...s)};return r}return t>=0?function(...r){return e(lb(t-1,e,n),...r)}:n}function dT(t,e){let n=0,r=t.length;for(;n<r&&t[n]===e;)++n;for(;r>n&&t[r-1]===e;)--r;return n>0||r<t.length?t.substring(n,r):t}function KH(t,e){let n=t.length;for(;n>0&&t[n-1]===e;)--n;return n<t.length?t.substring(0,n):t}function QH(t){return t.replace(/[\s\S]/g,e=>"\\u"+e.charCodeAt().toString(16).padStart(4,"0"))}function fT(t,e){const n=new Map;for(let r=t.length;r-- >0;){const s=t[r],i=e(s);n.set(i,n.has(i)?cT(s,n.get(i),{arrayMerge:XH}):s)}return[...n.values()].reverse()}const XH=(t,e,n)=>[...e];function Qa(t,e){for(const n of e){if(!t)return;t=t[n]}return t}function h1(t,e="a",n=26){const r=[];do t-=1,r.push(t%n),t=t/n>>0;while(t>0);const s=e.charCodeAt(0);return r.reverse().map(i=>String.fromCharCode(s+i)).join("")}const Lp=["I","X","C","M"],p1=["V","L","D"];function m1(t){return[...t+""].map(e=>+e).reverse().map((e,n)=>e%5<4?(e<5?"":p1[n])+Lp[n].repeat(e%5):Lp[n]+(e<5?p1[n]:Lp[n+1])).reverse().join("")}class hT{constructor(e,n=void 0){this.lines=[],this.nextLineWords=[],this.maxLineLength=n||e.wordwrap||Number.MAX_VALUE,this.nextLineAvailableChars=this.maxLineLength,this.wrapCharacters=Qa(e,["longWordSplit","wrapCharacters"])||[],this.forceWrapOnLimit=Qa(e,["longWordSplit","forceWrapOnLimit"])||!1,this.stashedSpace=!1,this.wordBreakOpportunity=!1}pushWord(e,n=!1){this.nextLineAvailableChars<=0&&!n&&this.startNewLine();const r=this.nextLineWords.length===0,s=e.length+(r?0:1);if(s<=this.nextLineAvailableChars||n)this.nextLineWords.push(e),this.nextLineAvailableChars-=s;else{const[i,...a]=this.splitLongWord(e);r||this.startNewLine(),this.nextLineWords.push(i),this.nextLineAvailableChars-=i.length;for(const o of a)this.startNewLine(),this.nextLineWords.push(o),this.nextLineAvailableChars-=o.length}}popWord(){const e=this.nextLineWords.pop();if(e!==void 0){const n=this.nextLineWords.length===0,r=e.length+(n?0:1);this.nextLineAvailableChars+=r}return e}concatWord(e,n=!1){if(this.wordBreakOpportunity&&e.length>this.nextLineAvailableChars)this.pushWord(e,n),this.wordBreakOpportunity=!1;else{const r=this.popWord();this.pushWord(r?r.concat(e):e,n)}}startNewLine(e=1){this.lines.push(this.nextLineWords),e>1&&this.lines.push(...Array.from({length:e-1},()=>[])),this.nextLineWords=[],this.nextLineAvailableChars=this.maxLineLength}isEmpty(){return this.lines.length===0&&this.nextLineWords.length===0}clear(){this.lines.length=0,this.nextLineWords.length=0,this.nextLineAvailableChars=this.maxLineLength}toString(){return[...this.lines,this.nextLineWords].map(e=>e.join(" ")).join(`
`)}splitLongWord(e){const n=[];let r=0;for(;e.length>this.maxLineLength;){const s=e.substring(0,this.maxLineLength),i=e.substring(this.maxLineLength),a=s.lastIndexOf(this.wrapCharacters[r]);if(a>-1)e=s.substring(a+1)+i,n.push(s.substring(0,a+1));else if(r++,r<this.wrapCharacters.length)e=s+i;else{if(this.forceWrapOnLimit){if(n.push(s),e=i,e.length>this.maxLineLength)continue}else e=s+i;break}}return n.push(e),n}}class $l{constructor(e=null){this.next=e}getRoot(){return this.next?this.next:this}}class fr extends $l{constructor(e,n=null,r=1,s=void 0){super(n),this.leadingLineBreaks=r,this.inlineTextBuilder=new hT(e,s),this.rawText="",this.stashedLineBreaks=0,this.isPre=n&&n.isPre,this.isNoWrap=n&&n.isNoWrap}}class g1 extends fr{constructor(e,n=null,{interRowLineBreaks:r=1,leadingLineBreaks:s=2,maxLineLength:i=void 0,maxPrefixLength:a=0,prefixAlign:o="left"}={}){super(e,n,s,i),this.maxPrefixLength=a,this.prefixAlign=o,this.interRowLineBreaks=r}}class oi extends fr{constructor(e,n=null,{leadingLineBreaks:r=1,maxLineLength:s=void 0,prefix:i=""}={}){super(e,n,r,s),this.prefix=i}}class y1 extends $l{constructor(e=null){super(e),this.rows=[],this.isPre=e&&e.isPre,this.isNoWrap=e&&e.isNoWrap}}class b1 extends $l{constructor(e=null){super(e),this.cells=[],this.isPre=e&&e.isPre,this.isNoWrap=e&&e.isNoWrap}}class ui extends $l{constructor(e,n=null,r=void 0){super(n),this.inlineTextBuilder=new hT(e,r),this.rawText="",this.stashedLineBreaks=0,this.isPre=n&&n.isPre,this.isNoWrap=n&&n.isNoWrap}}class YH extends $l{constructor(e=null,n){super(e),this.transform=n}}function eV(t){return[...t].map(e=>"\\u"+e.charCodeAt(0).toString(16).padStart(4,"0")).join("")}class tV{constructor(e){this.whitespaceChars=e.preserveNewlines?e.whitespaceCharacters.replace(/\n/g,""):e.whitespaceCharacters;const n=eV(this.whitespaceChars);if(this.leadingWhitespaceRe=new RegExp(`^[${n}]`),this.trailingWhitespaceRe=new RegExp(`[${n}]$`),this.allWhitespaceOrEmptyRe=new RegExp(`^[${n}]*$`),this.newlineOrNonWhitespaceRe=new RegExp(`(\\n|[^\\n${n}])`,"g"),this.newlineOrNonNewlineStringRe=new RegExp("(\\n|[^\\n]+)","g"),e.preserveNewlines){const r=new RegExp(`\\n|[^\\n${n}]+`,"gm");this.shrinkWrapAdd=function(s,i,a=u=>u,o=!1){if(!s)return;const u=i.stashedSpace;let l=!1,c=r.exec(s);if(c)for(l=!0,c[0]===`
`?i.startNewLine():u||this.testLeadingWhitespace(s)?i.pushWord(a(c[0]),o):i.concatWord(a(c[0]),o);(c=r.exec(s))!==null;)c[0]===`
`?i.startNewLine():i.pushWord(a(c[0]),o);i.stashedSpace=u&&!l||this.testTrailingWhitespace(s)}}else{const r=new RegExp(`[^${n}]+`,"g");this.shrinkWrapAdd=function(s,i,a=u=>u,o=!1){if(!s)return;const u=i.stashedSpace;let l=!1,c=r.exec(s);if(c)for(l=!0,u||this.testLeadingWhitespace(s)?i.pushWord(a(c[0]),o):i.concatWord(a(c[0]),o);(c=r.exec(s))!==null;)i.pushWord(a(c[0]),o);i.stashedSpace=u&&!l||this.testTrailingWhitespace(s)}}}addLiteral(e,n,r=!0){if(!e)return;const s=n.stashedSpace;let i=!1,a=this.newlineOrNonNewlineStringRe.exec(e);if(a)for(i=!0,a[0]===`
`?n.startNewLine():s?n.pushWord(a[0],r):n.concatWord(a[0],r);(a=this.newlineOrNonNewlineStringRe.exec(e))!==null;)a[0]===`
`?n.startNewLine():n.pushWord(a[0],r);n.stashedSpace=s&&!i}testLeadingWhitespace(e){return this.leadingWhitespaceRe.test(e)}testTrailingWhitespace(e){return this.trailingWhitespaceRe.test(e)}testContainsWords(e){return!this.allWhitespaceOrEmptyRe.test(e)}countNewlinesNoWords(e){this.newlineOrNonWhitespaceRe.lastIndex=0;let n=0,r;for(;(r=this.newlineOrNonWhitespaceRe.exec(e))!==null;)if(r[0]===`
`)n++;else return 0;return n}}class nV{constructor(e,n,r=void 0){this.options=e,this.picker=n,this.metadata=r,this.whitespaceProcessor=new tV(e),this._stackItem=new fr(e),this._wordTransformer=void 0}pushWordTransform(e){this._wordTransformer=new YH(this._wordTransformer,e)}popWordTransform(){if(!this._wordTransformer)return;const e=this._wordTransformer.transform;return this._wordTransformer=this._wordTransformer.next,e}startNoWrap(){this._stackItem.isNoWrap=!0}stopNoWrap(){this._stackItem.isNoWrap=!1}_getCombinedWordTransformer(){const e=this._wordTransformer?r=>pT(r,this._wordTransformer):void 0,n=this.options.encodeCharacters;return e?n?r=>n(e(r)):e:n}_popStackItem(){const e=this._stackItem;return this._stackItem=e.next,e}addLineBreak(){(this._stackItem instanceof fr||this._stackItem instanceof oi||this._stackItem instanceof ui)&&(this._stackItem.isPre?this._stackItem.rawText+=`
`:this._stackItem.inlineTextBuilder.startNewLine())}addWordBreakOpportunity(){(this._stackItem instanceof fr||this._stackItem instanceof oi||this._stackItem instanceof ui)&&(this._stackItem.inlineTextBuilder.wordBreakOpportunity=!0)}addInline(e,{noWordTransform:n=!1}={}){if(this._stackItem instanceof fr||this._stackItem instanceof oi||this._stackItem instanceof ui){if(this._stackItem.isPre){this._stackItem.rawText+=e;return}if(!(e.length===0||this._stackItem.stashedLineBreaks&&!this.whitespaceProcessor.testContainsWords(e))){if(this.options.preserveNewlines){const r=this.whitespaceProcessor.countNewlinesNoWords(e);if(r>0){this._stackItem.inlineTextBuilder.startNewLine(r);return}}this._stackItem.stashedLineBreaks&&this._stackItem.inlineTextBuilder.startNewLine(this._stackItem.stashedLineBreaks),this.whitespaceProcessor.shrinkWrapAdd(e,this._stackItem.inlineTextBuilder,n?void 0:this._getCombinedWordTransformer(),this._stackItem.isNoWrap),this._stackItem.stashedLineBreaks=0}}}addLiteral(e){if((this._stackItem instanceof fr||this._stackItem instanceof oi||this._stackItem instanceof ui)&&e.length!==0){if(this._stackItem.isPre){this._stackItem.rawText+=e;return}this._stackItem.stashedLineBreaks&&this._stackItem.inlineTextBuilder.startNewLine(this._stackItem.stashedLineBreaks),this.whitespaceProcessor.addLiteral(e,this._stackItem.inlineTextBuilder,this._stackItem.isNoWrap),this._stackItem.stashedLineBreaks=0}}openBlock({leadingLineBreaks:e=1,reservedLineLength:n=0,isPre:r=!1}={}){const s=Math.max(20,this._stackItem.inlineTextBuilder.maxLineLength-n);this._stackItem=new fr(this.options,this._stackItem,e,s),r&&(this._stackItem.isPre=!0)}closeBlock({trailingLineBreaks:e=1,blockTransform:n=void 0}={}){const r=this._popStackItem(),s=n?n(ni(r)):ni(r);Pc(this._stackItem,s,r.leadingLineBreaks,Math.max(r.stashedLineBreaks,e))}openList({maxPrefixLength:e=0,prefixAlign:n="left",interRowLineBreaks:r=1,leadingLineBreaks:s=2}={}){this._stackItem=new g1(this.options,this._stackItem,{interRowLineBreaks:r,leadingLineBreaks:s,maxLineLength:this._stackItem.inlineTextBuilder.maxLineLength,maxPrefixLength:e,prefixAlign:n})}openListItem({prefix:e=""}={}){if(!(this._stackItem instanceof g1))throw new Error("Can't add a list item to something that is not a list! Check the formatter.");const n=this._stackItem,r=Math.max(e.length,n.maxPrefixLength),s=Math.max(20,n.inlineTextBuilder.maxLineLength-r);this._stackItem=new oi(this.options,n,{prefix:e,maxLineLength:s,leadingLineBreaks:n.interRowLineBreaks})}closeListItem(){const e=this._popStackItem(),n=e.next,r=Math.max(e.prefix.length,n.maxPrefixLength),s=`
`+" ".repeat(r),a=(n.prefixAlign==="right"?e.prefix.padStart(r):e.prefix.padEnd(r))+ni(e).replace(/\n/g,s);Pc(n,a,e.leadingLineBreaks,Math.max(e.stashedLineBreaks,n.interRowLineBreaks))}closeList({trailingLineBreaks:e=2}={}){const n=this._popStackItem(),r=ni(n);r&&Pc(this._stackItem,r,n.leadingLineBreaks,e)}openTable(){this._stackItem=new y1(this._stackItem)}openTableRow(){if(!(this._stackItem instanceof y1))throw new Error("Can't add a table row to something that is not a table! Check the formatter.");this._stackItem=new b1(this._stackItem)}openTableCell({maxColumnWidth:e=void 0}={}){if(!(this._stackItem instanceof b1))throw new Error("Can't add a table cell to something that is not a table row! Check the formatter.");this._stackItem=new ui(this.options,this._stackItem,e)}closeTableCell({colspan:e=1,rowspan:n=1}={}){const r=this._popStackItem(),s=dT(ni(r),`
`);r.next.cells.push({colspan:e,rowspan:n,text:s})}closeTableRow(){const e=this._popStackItem();e.next.rows.push(e.cells)}closeTable({tableToString:e,leadingLineBreaks:n=2,trailingLineBreaks:r=2}){const s=this._popStackItem(),i=e(s.rows);i&&Pc(this._stackItem,i,n,r)}toString(){return ni(this._stackItem.getRoot())}}function ni(t){if(!(t instanceof fr||t instanceof oi||t instanceof ui))throw new Error("Only blocks, list items and table cells can be requested for text contents.");return t.inlineTextBuilder.isEmpty()?t.rawText:t.rawText+t.inlineTextBuilder.toString()}function Pc(t,e,n,r){if(!(t instanceof fr||t instanceof oi||t instanceof ui))throw new Error("Only blocks, list items and table cells can contain text.");const s=ni(t),i=Math.max(t.stashedLineBreaks,n);t.inlineTextBuilder.clear(),s?t.rawText=s+`
`.repeat(i)+e:(t.rawText=e,t.leadingLineBreaks=i),t.stashedLineBreaks=r}function pT(t,e){return e?pT(e.transform(t),e.next):t}function rV(t={}){const e=t.selectors.filter(a=>!a.format);if(e.length)throw new Error("Following selectors have no specified format: "+e.map(a=>`\`${a.selector}\``).join(", "));const n=new t1(t.selectors.map(a=>[a.selector,a])).build(r1);typeof t.encodeCharacters!="function"&&(t.encodeCharacters=oV(t.encodeCharacters));const r=new t1(t.baseElements.selectors.map((a,o)=>[a,o+1])).build(r1);function s(a){return iV(a,t,r)}const i=lb(t.limits.maxDepth,aV,function(a,o){o.addInline(t.limits.ellipsis||"")});return function(a,o=void 0){return sV(a,o,t,n,s,i)}}function sV(t,e,n,r,s,i){const a=n.limits.maxInputLength;a&&t&&t.length>a&&(console.warn(`Input length ${t.length} is above allowed limit of ${a}. Truncating without ellipsis.`),t=t.substring(0,a));const o=$H(t,{decodeEntities:n.decodeEntities}),u=s(o.children),l=new nV(n,r,e);return i(u,l),l.toString()}function iV(t,e,n){const r=[];function s(a,o){o=o.slice(0,e.limits.maxChildNodes);for(const u of o){if(u.type!=="tag")continue;const l=n.pick1(u);if(l>0?r.push({selectorIndex:l,element:u}):u.children&&a(u.children),r.length>=e.limits.maxBaseElements)return}}return lb(e.limits.maxDepth,s)(t),e.baseElements.orderBy!=="occurrence"&&r.sort((a,o)=>a.selectorIndex-o.selectorIndex),e.baseElements.returnDomByDefault&&r.length===0?t:r.map(a=>a.element)}function aV(t,e,n){if(!e)return;const r=n.options;e.length>r.limits.maxChildNodes&&(e=e.slice(0,r.limits.maxChildNodes),e.push({data:r.limits.ellipsis,type:"text"}));for(const i of e)switch(i.type){case"text":{n.addInline(i.data);break}case"tag":{const a=n.picker.pick1(i),o=r.formatters[a.format];o(i,t,n,a.options||{});break}}}function oV(t){if(!t||Object.keys(t).length===0)return;const e=Object.entries(t).filter(([,i])=>i!==!1),n=new RegExp(e.map(([i])=>`(${QH([...i][0])})`).join("|"),"g"),r=e.map(([,i])=>i),s=(i,...a)=>r[a.findIndex(o=>o)];return i=>i.replace(n,s)}function uV(t,e,n,r){}function lV(t,e,n,r){n.addLiteral(r.string||"")}function cV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),n.addLiteral(r.string||""),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function dV(t,e,n,r){e(t.children,n)}function fV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function mT(t){const e=t.attribs&&t.attribs.length?" "+Object.entries(t.attribs).map(([n,r])=>r===""?n:`${n}=${r.replace(/"/g,"&quot;")}`).join(" "):"";return`<${t.name}${e}>`}function gT(t){return`</${t.name}>`}function hV(t,e,n,r){n.startNoWrap(),n.addLiteral(mT(t)),n.stopNoWrap(),e(t.children,n),n.startNoWrap(),n.addLiteral(gT(t)),n.stopNoWrap()}function pV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),n.startNoWrap(),n.addLiteral(mT(t)),n.stopNoWrap(),e(t.children,n),n.startNoWrap(),n.addLiteral(gT(t)),n.stopNoWrap(),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function mV(t,e,n,r){n.startNoWrap(),n.addLiteral(ch(t,{decodeEntities:n.options.decodeEntities})),n.stopNoWrap()}function gV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),n.startNoWrap(),n.addLiteral(ch(t,{decodeEntities:n.options.decodeEntities})),n.stopNoWrap(),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function yV(t,e,n,r){n.addLiteral(r.prefix||""),e(t.children,n),n.addLiteral(r.suffix||"")}var bV=Object.freeze({__proto__:null,block:fV,blockHtml:gV,blockString:cV,blockTag:pV,inline:dV,inlineHtml:mV,inlineString:lV,inlineSurround:yV,inlineTag:hV,skip:uV});function sf(t,e){return t[e]||(t[e]=[]),t[e]}function wV(t,e=0){for(;t[e];)e++;return e}function _V(t,e){for(let n=0;n<e;n++){const r=sf(t,n);for(let s=0;s<n;s++){const i=sf(t,s);if(r[s]||i[n]){const a=r[s];r[s]=i[n],i[n]=a}}}}function vV(t,e,n,r){for(let s=0;s<t.rowspan;s++){const i=sf(e,n+s);for(let a=0;a<t.colspan;a++)i[r+a]=t}}function Dg(t,e){return t[e]===void 0&&(t[e]=e===0?0:1+Dg(t,e-1)),t[e]}function w1(t,e,n,r){t[e+n]=Math.max(Dg(t,e+n),Dg(t,e)+r)}function xV(t,e,n){const r=[];let s=0;const i=t.length,a=[0];for(let l=0;l<i;l++){const c=sf(r,l),d=t[l];let f=0;for(let h=0;h<d.length;h++){const m=d[h];f=wV(c,f),vV(m,r,l,f),f+=m.colspan,m.lines=m.text.split(`
`);const y=m.lines.length;w1(a,l,m.rowspan,y+e)}s=c.length>s?c.length:s}_V(r,i>s?i:s);const o=[],u=[0];for(let l=0;l<s;l++){let c=0,d;const f=Math.min(i,r[l].length);for(;c<f;)if(d=r[l][c],d){if(!d.rendered){let h=0;for(let m=0;m<d.lines.length;m++){const y=d.lines[m],w=a[c]+m;o[w]=(o[w]||"").padEnd(u[l])+y,h=y.length>h?y.length:h}w1(u,l,d.colspan,h+n),d.rendered=!0}c+=d.rowspan}else{const h=a[c];o[h]=o[h]||"",c++}}return o.join(`
`)}function SV(t,e,n,r){n.addLineBreak()}function kV(t,e,n,r){n.addWordBreakOpportunity()}function EV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),n.addInline("-".repeat(r.length||n.options.wordwrap||40)),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function AV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function TV(t,e,n,r){n.openBlock({isPre:!0,leadingLineBreaks:r.leadingLineBreaks||2}),e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function CV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2}),r.uppercase!==!1?(n.pushWordTransform(s=>s.toUpperCase()),e(t.children,n),n.popWordTransform()):e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2})}function PV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks||2,reservedLineLength:2}),e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks||2,blockTransform:s=>(r.trimEmptyLines!==!1?dT(s,`
`):s).split(`
`).map(i=>"> "+i).join(`
`)})}function Fg(t,e){if(!e)return t;const n=typeof e[0]=="string"?e[0]:"[",r=typeof e[1]=="string"?e[1]:"]";return n+t+r}function yT(t,e,n,r,s){const i=typeof e=="function"?e(t,r,s):t;return i[0]==="/"&&n?KH(n,"/")+i:i}function OV(t,e,n,r){const s=t.attribs||{},i=s.alt?s.alt:"",a=s.src?yT(s.src,r.pathRewrite,r.baseUrl,n.metadata,t):"",o=a?i?i+" "+Fg(a,r.linkBrackets):Fg(a,r.linkBrackets):i;n.addInline(o,{noWordTransform:!0})}function NV(t,e,n,r){function s(){if(r.ignoreHref||!t.attribs||!t.attribs.href)return"";let a=t.attribs.href.replace(/^mailto:/,"");return r.noAnchorUrl&&a[0]==="#"?"":(a=yT(a,r.pathRewrite,r.baseUrl,n.metadata,t),a)}const i=s();if(!i)e(t.children,n);else{let a="";n.pushWordTransform(u=>(u&&(a+=u),u)),e(t.children,n),n.popWordTransform(),r.hideLinkHrefIfSameAsText&&i===a||n.addInline(a?" "+Fg(i,r.linkBrackets):i,{noWordTransform:!0})}}function bT(t,e,n,r,s){const i=Qa(t,["parent","name"])==="li";let a=0;const o=(t.children||[]).filter(u=>u.type!=="text"||!/^\s*$/.test(u.data)).map(function(u){if(u.name!=="li")return{node:u,prefix:""};const l=i?s().trimStart():s();return l.length>a&&(a=l.length),{node:u,prefix:l}});if(o.length){n.openList({interRowLineBreaks:1,leadingLineBreaks:i?1:r.leadingLineBreaks||2,maxPrefixLength:a,prefixAlign:"left"});for(const{node:u,prefix:l}of o)n.openListItem({prefix:l}),e([u],n),n.closeListItem();n.closeList({trailingLineBreaks:i?1:r.trailingLineBreaks||2})}}function IV(t,e,n,r){const s=r.itemPrefix||" * ";return bT(t,e,n,r,()=>s)}function RV(t,e,n,r){let s=Number(t.attribs.start||"1");const i=jV(t.attribs.type);return bT(t,e,n,r,()=>" "+i(s++)+". ")}function jV(t="1"){switch(t){case"a":return e=>h1(e,"a");case"A":return e=>h1(e,"A");case"i":return e=>m1(e).toLowerCase();case"I":return e=>m1(e);case"1":default:return e=>e.toString()}}function $V(t){const e=[],n=[];for(const r of t)r.startsWith(".")?e.push(r.substring(1)):r.startsWith("#")&&n.push(r.substring(1));return{classes:e,ids:n}}function LV(t,e){if(e===!0)return!0;if(!t)return!1;const{classes:n,ids:r}=$V(e),s=(t.class||"").split(" "),i=(t.id||"").split(" ");return s.some(a=>n.includes(a))||i.some(a=>r.includes(a))}function MV(t,e,n,r){return LV(t.attribs,n.options.tables)?wT(t,e,n,r):DV(t,e,n,r)}function DV(t,e,n,r){n.openBlock({leadingLineBreaks:r.leadingLineBreaks}),e(t.children,n),n.closeBlock({trailingLineBreaks:r.trailingLineBreaks})}function wT(t,e,n,r){n.openTable(),t.children.forEach(i),n.closeTable({tableToString:a=>xV(a,r.rowSpacing??0,r.colSpacing??3),leadingLineBreaks:r.leadingLineBreaks,trailingLineBreaks:r.trailingLineBreaks});function s(a){const o=+Qa(a,["attribs","colspan"])||1,u=+Qa(a,["attribs","rowspan"])||1;n.openTableCell({maxColumnWidth:r.maxColumnWidth}),e(a.children,n),n.closeTableCell({colspan:o,rowspan:u})}function i(a){if(a.type!=="tag")return;const o=r.uppercaseHeaderCells!==!1?u=>{n.pushWordTransform(l=>l.toUpperCase()),s(u),n.popWordTransform()}:s;switch(a.name){case"thead":case"tbody":case"tfoot":case"center":a.children.forEach(i);return;case"tr":{n.openTableRow();for(const u of a.children)if(u.type==="tag")switch(u.name){case"th":{o(u);break}case"td":{s(u);break}}n.closeTableRow();break}}}}var FV=Object.freeze({__proto__:null,anchor:NV,blockquote:PV,dataTable:wT,heading:CV,horizontalLine:EV,image:OV,lineBreak:SV,orderedList:RV,paragraph:AV,pre:TV,table:MV,unorderedList:IV,wbr:kV});const BV={baseElements:{selectors:["body"],orderBy:"selectors",returnDomByDefault:!0},decodeEntities:!0,encodeCharacters:{},formatters:{},limits:{ellipsis:"...",maxBaseElements:void 0,maxChildNodes:void 0,maxDepth:void 0,maxInputLength:1<<24},longWordSplit:{forceWrapOnLimit:!1,wrapCharacters:[]},preserveNewlines:!1,selectors:[{selector:"*",format:"inline"},{selector:"a",format:"anchor",options:{baseUrl:null,hideLinkHrefIfSameAsText:!1,ignoreHref:!1,linkBrackets:["[","]"],noAnchorUrl:!0}},{selector:"article",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"aside",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"blockquote",format:"blockquote",options:{leadingLineBreaks:2,trailingLineBreaks:2,trimEmptyLines:!0}},{selector:"br",format:"lineBreak"},{selector:"div",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"footer",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"form",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"h1",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h2",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h3",format:"heading",options:{leadingLineBreaks:3,trailingLineBreaks:2,uppercase:!0}},{selector:"h4",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"h5",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"h6",format:"heading",options:{leadingLineBreaks:2,trailingLineBreaks:2,uppercase:!0}},{selector:"header",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"hr",format:"horizontalLine",options:{leadingLineBreaks:2,length:void 0,trailingLineBreaks:2}},{selector:"img",format:"image",options:{baseUrl:null,linkBrackets:["[","]"]}},{selector:"main",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"nav",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"ol",format:"orderedList",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"p",format:"paragraph",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"pre",format:"pre",options:{leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"section",format:"block",options:{leadingLineBreaks:1,trailingLineBreaks:1}},{selector:"table",format:"table",options:{colSpacing:3,leadingLineBreaks:2,maxColumnWidth:60,rowSpacing:0,trailingLineBreaks:2,uppercaseHeaderCells:!0}},{selector:"ul",format:"unorderedList",options:{itemPrefix:" * ",leadingLineBreaks:2,trailingLineBreaks:2}},{selector:"wbr",format:"wbr"}],tables:[],whitespaceCharacters:` 	\r
\f`,wordwrap:80},UV=(t,e,n)=>[...t,...e],_T=(t,e,n)=>[...e],zV=(t,e,n)=>t.some(r=>typeof r=="object")?UV(t,e):_T(t,e);function qV(t={}){return t=cT(BV,t,{arrayMerge:_T,customMerge:e=>e==="selectors"?zV:void 0}),t.formatters=Object.assign({},bV,FV,t.formatters),t.selectors=fT(t.selectors,e=>e.selector),VV(t),rV(t)}function HV(t,e={},n=void 0){return qV(e)(t,n)}function VV(t){if(t.tags){const n=Object.entries(t.tags).map(([r,s])=>({...s,selector:r||"*"}));t.selectors.push(...n),t.selectors=fT(t.selectors,r=>r.selector)}function e(n,r,s){const i=r.pop();for(const a of r){let o=n[a];o||(o={},n[a]=o),n=o}n[i]=s}if(t.baseElement){const n=t.baseElement;e(t,["baseElements","selectors"],Array.isArray(n)?n:[n])}t.returnDomByDefault!==void 0&&e(t,["baseElements","returnDomByDefault"],t.returnDomByDefault);for(const n of t.selectors)n.format==="anchor"&&Qa(n,["options","noLinkBrackets"])&&e(n,["options","linkBrackets"],!1)}class WV extends HF{static lc_name(){return"HtmlToTextTransformer"}constructor(e={}){super(e),Object.defineProperty(this,"options",{enumerable:!0,configurable:!0,writable:!0,value:e})}async _transformDocument(e){const n=HV(e.pageContent,this.options);return new da({pageContent:n,metadata:{...e.metadata}})}}class GV extends it{constructor(e){super(e),Object.defineProperty(this,"callbacks",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"tags",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"metadata",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"verbose",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.callbacks=e?.callbacks,this.tags=e?.tags??[],this.metadata=e?.metadata??{},this.verbose=e?.verbose??!1}_getRelevantDocuments(e,n){throw new Error("Not implemented!")}async invoke(e,n){return this.getRelevantDocuments(e,Se(n))}async getRelevantDocuments(e,n){const r=Se(C7(n)),i=await(await Lt.configure(r.callbacks,this.callbacks,r.tags,this.tags,r.metadata,this.metadata,{verbose:this.verbose}))?.handleRetrieverStart(this.toJSON(),e,r.runId,void 0,void 0,void 0,r.runName);try{const a=await this._getRelevantDocuments(e,i);return await i?.handleRetrieverEnd(a),a}catch(a){throw await i?.handleRetrieverError(a),a}}}class Mp extends GV{static lc_name(){return"VectorStoreRetriever"}get lc_namespace(){return["langchain_core","vectorstores"]}_vectorstoreType(){return this.vectorStore._vectorstoreType()}constructor(e){super(e),Object.defineProperty(this,"vectorStore",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"k",{enumerable:!0,configurable:!0,writable:!0,value:4}),Object.defineProperty(this,"searchType",{enumerable:!0,configurable:!0,writable:!0,value:"similarity"}),Object.defineProperty(this,"searchKwargs",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.vectorStore=e.vectorStore,this.k=e.k??this.k,this.searchType=e.searchType??this.searchType,this.filter=e.filter,e.searchType==="mmr"&&(this.searchKwargs=e.searchKwargs)}async _getRelevantDocuments(e,n){if(this.searchType==="mmr"){if(typeof this.vectorStore.maxMarginalRelevanceSearch!="function")throw new Error(`The vector store backing this retriever, ${this._vectorstoreType()} does not support max marginal relevance search.`);return this.vectorStore.maxMarginalRelevanceSearch(e,{k:this.k,filter:this.filter,...this.searchKwargs},n?.getChild("vectorstore"))}return this.vectorStore.similaritySearch(e,this.k,this.filter,n?.getChild("vectorstore"))}async addDocuments(e,n){return this.vectorStore.addDocuments(e,n)}}class ZV extends Bs{constructor(e,n){super(n),Object.defineProperty(this,"lc_namespace",{enumerable:!0,configurable:!0,writable:!0,value:["langchain","vectorstores",this._vectorstoreType()]}),Object.defineProperty(this,"embeddings",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.embeddings=e}async delete(e){throw new Error("Not implemented.")}async similaritySearch(e,n=4,r=void 0,s=void 0){return(await this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)).map(a=>a[0])}async similaritySearchWithScore(e,n=4,r=void 0,s=void 0){return this.similaritySearchVectorWithScore(await this.embeddings.embedQuery(e),n,r)}static fromTexts(e,n,r,s){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}static fromDocuments(e,n,r){throw new Error("the Langchain vectorstore implementation you are using forgot to override this, please report a bug")}asRetriever(e,n,r,s,i,a){if(typeof e=="number")return new Mp({vectorStore:this,k:e,filter:n,tags:[...s??[],this._vectorstoreType()],metadata:i,verbose:a,callbacks:r});{const o={vectorStore:this,k:e?.k,filter:e?.filter,tags:[...e?.tags??[],this._vectorstoreType()],metadata:e?.metadata,verbose:e?.verbose,callbacks:e?.callbacks,searchType:e?.searchType};return e?.searchType==="mmr"?new Mp({...o,searchKwargs:e.searchKwargs}):new Mp({...o})}}}function JV(t,e){let n=0,r=0,s=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i],r+=t[i]*t[i],s+=e[i]*e[i];return n/(Math.sqrt(r)*Math.sqrt(s))}function KV(t,e){let n=0,r=0,s=0;for(let i=0;i<t.length;i++)n+=t[i]*e[i],r+=t[i]*t[i],s+=e[i]*e[i];return n/(Math.sqrt(r)*Math.sqrt(s))}function QV(t,e,n){if(t.length===0||t[0].length===0||e.length===0||e[0].length===0)return[[]];if(t[0].length!==e[0].length)throw new Error(`Number of columns in X and Y must be the same. X has shape ${[t.length,t[0].length]} and Y has shape ${[e.length,e[0].length]}.`);return t.map(r=>e.map(s=>n(r,s)).map(s=>Number.isNaN(s)?0:s))}function _1(t,e){return QV(t,e,KV)}function XV(t,e,n=.5,r=4){if(Math.min(r,e.length)<=0)return[];const s=Array.isArray(t[0])?t:[t],i=_1(s,e)[0],a=YV(i).maxIndex,o=[e[a]],u=[a];for(;u.length<Math.min(r,e.length);){let l=-1/0,c=-1;const d=_1(e,o);i.forEach((f,h)=>{if(u.includes(h))return;const m=Math.max(...d[h]),y=n*f-(1-n)*m;y>l&&(l=y,c=h)}),o.push(e[c]),u.push(c)}return u}function YV(t){if(t.length===0)return{maxIndex:-1,maxValue:NaN};let e=t[0],n=0;for(let r=1;r<t.length;r+=1)t[r]>e&&(n=r,e=t[r]);return{maxIndex:n,maxValue:e}}class cb extends ZV{_vectorstoreType(){return"memory"}constructor(e,{similarity:n,...r}={}){super(e,r),Object.defineProperty(this,"memoryVectors",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(this,"similarity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),this.similarity=n??JV}async addDocuments(e){const n=e.map(({pageContent:r})=>r);return this.addVectors(await this.embeddings.embedDocuments(n),e)}async addVectors(e,n){const r=e.map((s,i)=>({content:n[i].pageContent,embedding:s,metadata:n[i].metadata,id:n[i].id}));this.memoryVectors=this.memoryVectors.concat(r)}async _queryVectors(e,n,r){const s=a=>{if(!r)return!0;const o=new da({metadata:a.metadata,pageContent:a.content,id:a.id});return r(o)};return this.memoryVectors.filter(s).map((a,o)=>({similarity:this.similarity(e,a.embedding),index:o,metadata:a.metadata,content:a.content,embedding:a.embedding,id:a.id})).sort((a,o)=>a.similarity>o.similarity?-1:0).slice(0,n)}async similaritySearchVectorWithScore(e,n,r){return(await this._queryVectors(e,n,r)).map(a=>[new da({metadata:a.metadata,pageContent:a.content,id:a.id}),a.similarity])}async maxMarginalRelevanceSearch(e,n){const r=await this.embeddings.embedQuery(e),s=await this._queryVectors(r,n.fetchK??20,n.filter),i=s.map(o=>o.embedding);return XV(r,i,n.lambda,n.k).map(o=>new da({metadata:s[o].metadata,pageContent:s[o].content,id:s[o].id}))}static async fromTexts(e,n,r,s){const i=[];for(let a=0;a<e.length;a+=1){const o=Array.isArray(n)?n[a]:n,u=new da({pageContent:e[a],metadata:o});i.push(u)}return cb.fromDocuments(i,r,s)}static async fromDocuments(e,n,r){const s=new this(n,r);return await s.addDocuments(e),s}static async fromExistingIndex(e,n){return new this(e,n)}}class eW{vectorStore;embeddings;constructor(){this.embeddings=new Oz({model:"text-embedding-3-large"}),this.vectorStore=new cb(this.embeddings)}async initializeKnowledgeBase(e){const n=new WV,r=e.map(i=>new da({pageContent:i.content.replace("{kbtitle}",i.title),metadata:{organization_id:i.organization_id,category:i.category,id:i.id}})),s=await n.transformDocuments(r);await this.vectorStore.addDocuments(s)}async findRelevantArticles(e,n){const r=s=>s.metadata.organization_id===n||s.metadata.organization_id===oy.id;return await this.vectorStore.similaritySearch(e,3,r)}}class tW{model;kbService;constructor(e){this.model=new Az({modelName:"gpt-4o-mini",temperature:.2}),this.kbService=e}async generatePrompt(e,n,r,s){const i=`You are a helpful customer support AI agent. 
    You have access to knowledge base articles and, should one be directly relevant, provide the article ID
        - JSON response format: {"article_id": "ID HERE"}.
    If a question cannot be answered using the knowledge base and requires human expertise, suggest creating a ticket with a human agent. Possible teams to create a ticket for are: ${r.map(o=>o.name).join(", ")}.
        - JSON response format: {"ticket": {"team_name": "TEAM NAME HERE", "subject": "SUBJECT HERE", "description": "DESCRIPTION HERE"}}.
    If you're unsure, respond with: {"response": "Sorry, I'm not sure how best to help with that. Please feel free to rephrase the question or to open a ticket with a human agent."}`,a=[new hu(i)];if(s&&s.messages.forEach(o=>{o.isAI?a.push(new el(o.content)):a.push(new wi(o.content))}),n.length>0){const o=n.map(u=>`[ID:${u.metadata.id}] [CATEGORY:${u.metadata.category}]
${u.pageContent}`).join(`

`);a.push(new hu(`Relevant knowledge base articles:
${o}`))}return a.push(new wi(e)),a}async handleChatQuery(e,n,r=[],s){const i=await this.kbService.findRelevantArticles(e,n),a=await this.generatePrompt(e,i,r,s),u=await this.model.bind({response_format:{type:"json_object"}}).invoke(a);return typeof u.content=="string"?JSON.parse(u.content):u.content}async evaluateTicket(e){const n=await this.kbService.findRelevantArticles(`${e.team_name}
${e.subject}
${e.description}`,e.organization_id),r=[new hu(`You are a helpful customer support AI agent.
        Your task is to determine if this support ticket could be resolved using existing knowledge base articles.
        If yes, provide the relevant article ID via the JSON response format {"article_id": "ID HERE"}. If no, explain why human support is needed via the JSON response format {"response": "REASON HERE"}.
        Consider the ticket priority and complexity when making your decision.`),new wi(JSON.stringify({ticket:e,relevantArticles:n.map(o=>o.pageContent)}))],i=await this.model.bind({response_format:{type:"json_object"}}).invoke(r);return typeof i.content=="string"?JSON.parse(i.content):i.content}}const{data:nW,error:v1}=await _e.from("knowledge_base").select("*");v1&&console.error(v1);const vT=new eW;await vT.initializeKnowledgeBase(nW);const rW=new tW(vT);function sW({currentUser:t,isActive:e,onClose:n,teams:r,onTicketCreate:s}){const[i,a]=v.useState([]),[o,u]=v.useState(null),[l,c]=v.useState(""),[d,f]=v.useState(!1),h=v.useRef(null);v.useEffect(()=>{const _=localStorage.getItem("aiChats");if(_){const S=JSON.parse(_).map(k=>({id:k.id,title:k.title,messages:k.messages,funcArgs:new Map(k.funcArgs)}));a(S);const E=localStorage.getItem("activeAIChatTab");E&&S.find(k=>k.id===E)?u(E):S.length>0?u(S[0].id):m()}},[]),v.useEffect(()=>{if(i.length>0){const _=i.map(x=>({id:x.id,title:x.title,messages:x.messages,funcArgs:Array.from(x.funcArgs.entries())}));localStorage.setItem("aiChats",JSON.stringify(_))}o&&localStorage.setItem("activeAIChatTab",o)},[i,o]),v.useEffect(()=>{h.current&&(h.current.scrollTop=h.current.scrollHeight)},[i]);const m=()=>{const _={id:`chat-${Date.now()}`,title:"New Chat",messages:[],funcArgs:new Map};a(x=>[...x,_]),u(_.id)},y=(_,x)=>{x.stopPropagation();const S=i.filter(E=>E.id!==_);o===_&&S.length>0&&u(S[S.length-1].id),a(S),S.length===0&&m()},w=_=>{const x=i.find(S=>S.id===o)?.funcArgs.get(_);x&&s&&(console.log(x),s(x))},p=async()=>{if(!(!l.trim()||d||!o))try{f(!0);const _=new Date().toISOString(),S={id:`msg-${_}`,content:l.trim(),timestamp:_,isAI:!1,userId:t?.id};a(H=>H.map(q=>{if(q.id===o){const X=[...q.messages,S];return{...q,title:q.messages.length===0?l.trim():q.title,messages:X}}return q})),c("");let E="I'm an AI assistant. How can I help you today?";const k=new Date().toISOString(),T=`msg-${k}`;let $=!1;if(t){const H={userId:t.id,messages:[]};for(const X of i)X.id===o&&(H.messages=X.messages.slice(0,-1));const q=await rW.handleChatQuery(l,t.organization_id,r.filter(X=>X.organization_id===oy.id),H);if(q.article_id)E=`I found an article that might help you: <a href="/kb/${q.article_id}" target="_blank" class="text-blue-500 hover:text-blue-700 underline">Here</a>`;else if(q.ticket){const X=q.ticket,O=r.find(L=>L.name===X.team_name);if(!O)throw new Error(`Team ${X.team_name} not found`);i.find(L=>L.id===o)?.funcArgs.set(T,{team_id:O.id,subject:X.subject,description:X.description});const I=`<button onclick="handleButtonClick('${T}')" className="w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50">Create Ticket</button>`;E="It sounds like you might need to talk to a human agent. Here's a button to create a ticket:",$=!0}else E=q.response}const j={id:T,content:E,timestamp:k,isAI:!0,isTicket:$};a(H=>H.map(q=>q.id===o?{...q,messages:[...q.messages,j]}:q)),f(!1)}catch(_){console.error("Failed to send message:",_),f(!1)}},b=_=>{_.key==="Enter"&&!_.shiftKey&&(_.preventDefault(),p())};return e?g.jsxs("div",{className:"relative bg-gray-100 border-r w-80 transition-all duration-300 ease-in-out flex flex-col overflow-hidden",children:[g.jsx("div",{className:"p-4 border-b bg-white items-center",children:g.jsx("h2",{className:"font-medium",children:"AI Support"})}),g.jsx("div",{className:"border-b bg-white",children:g.jsxs("div",{className:"flex items-center overflow-x-auto",children:[i.map(_=>g.jsx("div",{className:`
                                flex items-center px-4 py-2 border-r cursor-pointer font-medium
                                ${o===_.id?"bg-gray-100":"bg-white hover:bg-gray-50"}
                            `,onClick:()=>u(_.id),children:g.jsxs("div",{className:"flex items-center w-full",children:[g.jsx("div",{className:"truncate max-w-[120px]",title:_.title,children:_.title}),g.jsx("button",{className:"ml-2 p-0.5 hover:bg-gray-200 rounded flex-shrink-0",onClick:x=>y(_.id,x),children:g.jsx(Rf,{size:14})})]})},_.id)),g.jsx("button",{onClick:m,className:"px-3 py-2 hover:bg-gray-100 text-gray-600 hover:text-gray-900 border-r flex items-center",children:g.jsx(If,{size:20})})]})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-6",ref:h,children:o&&i.find(_=>_.id===o)?.messages.map(_=>g.jsx("div",{className:`flex space-x-3 ${_.isAI?"":"justify-end"}`,children:g.jsxs("div",{className:`max-w-[85%] ${_.isAI?"":"ml-auto"}`,children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[g.jsx("span",{className:"font-medium",children:_.isAI?"AI Support":jt(t)}),g.jsx("span",{className:"text-sm text-gray-500",children:new Date(_.timestamp).toLocaleString()})]}),g.jsx("div",{className:`rounded-lg p-3 ${_.isAI?"bg-white":"bg-blue-400 ml-auto text-white"}`,children:g.jsx("p",{className:`text-left ${_.isAI?"":"text-right"}`,dangerouslySetInnerHTML:{__html:_.content}})}),_.isTicket&&g.jsx("div",{className:"flex items-center space-x-2 mt-2",children:g.jsx("button",{onClick:()=>w(_.id),className:"w-full flex justify-center py-2 px-4 border border-transparent rounded-md shadow-sm text-sm font-medium text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50",children:"Create Ticket"})})]})},_.id))}),g.jsx("div",{className:"border-t p-4 bg-white",children:g.jsxs("div",{className:"border rounded-lg",children:[g.jsx("div",{className:"p-3",children:g.jsx("textarea",{placeholder:"Write a message...",className:"w-full resize-none focus:outline-none",rows:3,value:l,onChange:_=>c(_.target.value),onKeyPress:b})}),g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-t bg-gray-50",children:[g.jsx("div",{}),g.jsx("button",{className:"px-4 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:p,disabled:!l.trim()||d,children:d?"Sending...":"Send"})]})]})})]}):null}function xT({onTicketSelect:t,realtimeEvent:e,userRole:n="member"}){const[r,s]=v.useState([]),[i,a]=v.useState({requireAction:[],urgent:[],high:[],normal:[],low:[],closed:[]}),[o,u]=v.useState({open:0,pending:0,solved:0,new:0}),[l,c]=v.useState(!0),[d,f]=v.useState(null),[h,m]=v.useState(new Set),[y,w]=v.useState(!1),[p,b]=v.useState(!0),[_,x]=v.useState(!1),[S,E]=v.useState({checkbox:48,status:90,subject:30,requester:15,updated:15,organization:15,assignee:15}),[k,T]=v.useState(null),[$,j]=v.useState(0),[H,q]=v.useState(0),X=v.useRef(null),[O,I]=v.useState(""),[L,F]=v.useState(null),[A,C]=v.useState([]),[M,W]=v.useState(null);v.useEffect(()=>{async function R(){try{const{data:{session:te}}=await _e.auth.getSession();if(!te)return;const Y=await(await fetch("/teams",{headers:{Authorization:`Bearer ${te.access_token}`,"Content-Type":"application/json"}})).json();C(Y.teams||[])}catch(te){f(te instanceof Error?te.message:"Failed to fetch teams")}}R()},[]),v.useEffect(()=>{async function R(){const{data:{session:te}}=await _e.auth.getSession();if(te){const z=await fetch(`/users/${te.user.id}`,{headers:{Authorization:`Bearer ${te.access_token}`,"Content-Type":"application/json"}}),{user:Y,error:et}=await z.json();if(et){console.error("Error fetching user:",et),f(et);return}F(Y),I(Y.id)}}R()},[]);const J=(R,te)=>{const z={requireAction:[],urgent:[],high:[],normal:[],low:[],closed:[]};return R.forEach(Y=>{new Date(Y.updated_at||"")>new Date(Date.now()-1e3*60*60*6);const et=Y.assigned_to===te;if(Y.status==="New"&&et)z.requireAction.push(Y);else if(Y.closed_at)z.closed.push(Y);else switch(Y.priority){case"urgent":z.urgent.push(Y);break;case"high":z.high.push(Y);break;case"normal":z.normal.push(Y);break;case"low":z.low.push(Y);break;default:z.normal.push(Y)}}),z},fe=R=>{const te=R.reduce((z,Y)=>(z[Y.status]=(z[Y.status]||0)+1,z),{});return{open:te.open||0,pending:te.pending||0,solved:te.solved||0,new:te.new||0}};v.useEffect(()=>{async function R(){try{const{data:{session:te}}=await _e.auth.getSession();if(!te)return;const z=await fetch("/tickets",{method:"GET",headers:{Authorization:`Bearer ${te.access_token}`,"Content-Type":"application/json"}}),{tickets:Y}=await z.json();if(console.log(Y),d)throw new Error(d);s(Y),a(J(Y,te.user.id)),u(fe(Y))}catch(te){f(te instanceof Error?te.message:"Failed to fetch tickets")}finally{c(!1)}}R()},[]),v.useEffect(()=>{if(!e)return;(async()=>{const{data:{session:te}}=await _e.auth.getSession();if(te&&e.table==="tickets"){const z=await fetch(`/tickets/${e.payload.new.id}`,{headers:{Authorization:`Bearer ${te.access_token}`,"Content-Type":"application/json"}}),{data:Y,error:et}=await z.json();if(et){console.error("Error fetching ticket:",et);return}if(Y&&Y.ticket){const Js=Y.ticket;s(dh=>{let So;if(e.eventType==="INSERT")So=[...dh,Js];else if(e.eventType==="UPDATE")So=dh.map(db=>db.id===Js.id?Js:db);else return dh;return a(J(So,te.user.id)),u(fe(So)),So})}}})()},[e]);const pe=R=>{if(R){const te=r.map(z=>z.id);m(new Set(te))}else m(new Set);w(R)},me=(R,te)=>{const z=new Set(h);te?z.add(R):z.delete(R),m(z),w(z.size===r.length)},De=R=>{switch(R){case"new":return"text-orange-500";case"open":return"text-red-500";case"pending":return"text-blue-500";case"on_hold":return"text-gray-700";case"solved":case"closed":return"text-gray-400";default:return"text-gray-400"}},ee=(R,te)=>te.length===0?null:g.jsxs(g.Fragment,{children:[g.jsx("tr",{children:g.jsxs("td",{colSpan:7,className:"text-sm text-gray-500 bg-gray-50 pl-4 py-2 border-t text-left",children:[R," (",te.length,")"]})}),te.map(z=>g.jsxs("tr",{className:"border-t hover:bg-gray-50 cursor-pointer h-12",children:[g.jsx("td",{className:"py-3 px-4",style:{width:S.checkbox},children:g.jsx("div",{className:"flex items-center justify-center",children:g.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0 transition-all duration-150 ease-in-out cursor-pointer hover:border-blue-400",checked:h.has(z.id),onChange:Y=>{Y.stopPropagation(),me(z.id,Y.target.checked)}})})}),g.jsx("td",{className:"py-3 px-4 text-left",style:{width:S.status},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:g.jsxs("div",{className:"flex items-start space-x-2 overflow-visible",children:[g.jsxs("div",{className:"relative group",children:[g.jsx(G0,{size:16,className:`flex-shrink-0 fill-current ${De(z.status)}`}),g.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 invisible group-hover:visible bg-gray-900 text-white text-xs rounded py-1 px-2 w-64 whitespace-normal text-left",style:{zIndex:1e5},children:[g.jsx("div",{className:"font-medium mb-1 capitalize",children:z.status.replace("_"," ")}),z.status,g.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1",children:g.jsx("div",{className:"border-4 border-transparent border-t-gray-900"})})]})]}),g.jsxs("span",{className:"text-blue-600 flex-shrink-0",children:["#",z.ticketNumber]})]})}),g.jsxs("td",{className:"py-3 px-4 text-left relative group",style:{width:`${S.subject}%`},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:[g.jsx("span",{className:"truncate block",children:z.subject}),g.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 invisible group-hover:visible bg-gray-900 text-white text-xs rounded py-1 px-2 whitespace-nowrap",children:["Created ",new Date(z.created_at||"").toLocaleString(),g.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1",children:g.jsx("div",{className:"border-4 border-transparent border-t-gray-900"})})]})]}),g.jsx("td",{className:"py-3 px-4 text-left",style:{width:`${S.requester}%`},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:g.jsx("span",{className:"truncate block",children:jt(z.requester)})}),g.jsxs("td",{className:"py-3 px-4 text-left relative group",style:{width:`${S.updated}%`},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:[g.jsx("span",{className:"truncate block",children:NL(z.updated_at||"")}),g.jsxs("div",{className:"absolute left-1/2 -translate-x-1/2 bottom-full mb-2 invisible group-hover:visible bg-gray-900 text-white text-xs rounded py-1 px-2 whitespace-nowrap",children:[new Date(z.updated_at||"").toLocaleString(),g.jsx("div",{className:"absolute top-full left-1/2 -translate-x-1/2 -mt-1",children:g.jsx("div",{className:"border-4 border-transparent border-t-gray-900"})})]})]}),g.jsx("td",{className:"py-3 px-4 text-left",style:{width:`${S.organization}%`},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:g.jsx("span",{className:"truncate block",children:z.organization?.name||""})}),g.jsx("td",{className:"py-3 px-4 text-left",style:{width:`${S.assignee}%`},onClick:()=>t(z.id,z.subject,z.priority,z.ticketNumber),children:g.jsx("span",{className:"truncate block",children:jt(z.assignee)})})]},z.id))]}),Ee=(R,te,z)=>{R.preventDefault(),T(te),j(R.clientX),q(z)},Ye=R=>{if(!k)return;const te=R.clientX-$,z=Math.max(50,H+te);E(Y=>({...Y,[k]:k.includes("%")?z/(X.current?.clientWidth||1)*100:z}))},Ce=()=>{T(null)};v.useEffect(()=>{if(k)return window.addEventListener("mousemove",Ye),window.addEventListener("mouseup",Ce),()=>{window.removeEventListener("mousemove",Ye),window.removeEventListener("mouseup",Ce)}},[k,$,H]);const D=()=>{_?x(!1):(b(!1),x(!0))},K=()=>{p?b(!1):(x(!1),b(!0))};return l?g.jsx("div",{children:"Loading..."}):d?g.jsxs("div",{children:["Error: ",d]}):g.jsxs("div",{className:"flex h-full",children:[g.jsxs("div",{className:"w-14 bg-[#1f73b7] flex flex-col items-center py-4 text-white",children:[g.jsx("div",{className:"mb-8",children:g.jsx("div",{className:`w-8 h-8 ${_?"bg-white text-[#1f73b7]":"bg-white/20"} rounded flex items-center justify-center cursor-pointer hover:bg-white hover:text-[#1f73b7] transition-colors`,onClick:D,children:g.jsx(Z0,{size:20})})}),g.jsxs("nav",{className:"space-y-4",children:[g.jsx("button",{className:"p-2 hover:bg-white/10 rounded",children:g.jsx(JR,{size:20})}),g.jsx("button",{className:"p-2 hover:bg-white/10 rounded",children:g.jsx(_6,{size:20})}),g.jsx("button",{className:"p-2 hover:bg-white/10 rounded",children:g.jsx(jR,{size:20})}),g.jsx("button",{className:"p-2 hover:bg-white/10 rounded",children:g.jsx(p6,{size:20})})]})]}),g.jsxs("div",{className:"flex-1 flex",children:[p&&g.jsxs("div",{className:"relative bg-gray-100 border-r w-80 transition-all duration-300 ease-in-out flex flex-col overflow-hidden",children:[g.jsx("div",{className:"p-4 border-b bg-white",children:g.jsx("h2",{className:"font-medium",children:"Updates to tickets"})}),g.jsx("div",{className:"flex-1 overflow-y-auto p-4 space-y-4",children:g.jsx("div",{className:"bg-white rounded-lg shadow-sm p-4",children:"Updates to tickets will appear here"})})]}),g.jsx(sW,{currentUser:L,isActive:_,onClose:()=>x(!1),teams:A,onTicketCreate:W}),g.jsx("div",{className:"relative z-50",children:g.jsx("div",{className:`absolute top-1/2 ${p||_?"-right-3":"-right-2"} transform -translate-y-1/2`,children:g.jsx("button",{onClick:_?D:K,className:"bg-white rounded-full p-1 shadow-md hover:bg-gray-50 transition-colors",children:p||_?g.jsx(FR,{size:16}):g.jsx(UR,{size:16})})})}),g.jsxs("div",{className:"flex-1 flex flex-col",children:[g.jsx("div",{className:"flex-none p-6 bg-gray-50",children:g.jsx("div",{className:"mb-6",children:g.jsxs("div",{className:"flex divide-x",children:[g.jsxs("div",{className:"pr-6 w-[300px]",children:[g.jsx("h2",{className:"text-lg font-medium mb-4 text-left",children:"Open Tickets"}),g.jsxs("div",{className:"flex",children:[g.jsxs("div",{className:"bg-white p-4 rounded-l-lg border-l border-y w-[138px]",children:[g.jsx("div",{className:"text-sm font-medium mb-2",children:"You"}),g.jsx("div",{className:"text-2xl font-bold",children:"999"})]}),g.jsxs("div",{className:"bg-white p-4 rounded-r-lg border w-[138px]",children:[g.jsx("div",{className:"text-sm font-medium mb-2",children:"Groups"}),g.jsx("div",{className:"text-2xl font-bold",children:"999"})]})]})]}),n==="manager"||n==="member"?g.jsx(IL,{userId:O,teams:A,initialValues:M}):g.jsxs("div",{className:"pl-6 w-[450px]",children:[g.jsx("h2",{className:"text-lg font-medium mb-4 text-left",children:"Ticket Statistics"}),g.jsxs("div",{className:"flex",children:[g.jsxs("div",{className:"bg-white p-4 rounded-l-lg border-l border-y border-r w-[138px]",children:[g.jsx("div",{className:"text-sm font-medium mb-2",children:"Good"}),g.jsx("div",{className:"text-2xl font-bold",children:"999"})]}),g.jsxs("div",{className:"bg-white p-4 border-y w-[138px]",children:[g.jsx("div",{className:"text-sm font-medium mb-2",children:"Bad"}),g.jsx("div",{className:"text-2xl font-bold",children:"999"})]}),g.jsxs("div",{className:"bg-white p-4 rounded-r-lg border w-[138px]",children:[g.jsx("div",{className:"text-sm font-medium mb-2",children:"Solved"}),g.jsx("div",{className:"text-2xl font-bold",children:"999"})]})]})]})]})})}),g.jsx("div",{className:"flex-1 overflow-y-auto px-6 pb-6",children:g.jsx("div",{className:"bg-white rounded-lg border p-4",style:{overflow:"visible"},children:g.jsx("div",{className:"overflow-auto",children:g.jsxs("table",{ref:X,className:"w-full table-fixed relative",style:{minWidth:"600px"},children:[g.jsx("thead",{className:"bg-gray-50 text-sm text-gray-500 sticky top-0",children:g.jsxs("tr",{className:"relative",children:[g.jsxs("th",{className:"py-3 px-4 text-left font-medium",style:{width:S.checkbox},children:[g.jsx("div",{className:"flex items-center justify-center",children:g.jsx("input",{type:"checkbox",className:"h-3.5 w-3.5 rounded border-gray-300 text-blue-600 focus:ring-blue-500 focus:ring-offset-0 transition-all duration-150 ease-in-out cursor-pointer hover:border-blue-400",checked:y,onChange:R=>pe(R.target.checked)})}),g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"checkbox",S.checkbox),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})]}),g.jsx("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:S.status},children:g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"status",S.status),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})}),g.jsxs("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:`${S.subject}%`},children:["Subject",g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"subject",S.subject),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})]}),g.jsxs("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:`${S.requester}%`},children:["Requester",g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"requester",S.requester),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})]}),g.jsxs("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:`${S.updated}%`},children:["Last updated",g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"updated",S.updated),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})]}),g.jsxs("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:`${S.organization}%`},children:["Org",g.jsx("div",{className:"absolute right-0 top-0 h-full w-1 cursor-col-resize hover:bg-blue-500 group",onMouseDown:R=>Ee(R,"organization",S.organization),children:g.jsx("div",{className:"absolute inset-y-0 right-0 w-4 -translate-x-1/2 group-hover:bg-blue-500/10"})})]}),g.jsx("th",{className:"py-3 px-4 text-left font-medium relative",style:{width:`${S.assignee}%`},children:"Agent"})]})}),g.jsxs("tbody",{children:[ee("Require Action",i.requireAction),ee("Urgent Tickets",i.urgent),ee("High Priority",i.high),ee("Normal Priority",i.normal),ee("Low Priority",i.low),ee("Closed Tickets",i.closed)]})]})})})})]})]})]})}function ST({ticketId:t,realtimeEvent:e,userRole:n}){const[r,s]=v.useState(null),[i,a]=v.useState(null),[o,u]=v.useState(null),[l,c]=v.useState(null),[d,f]=v.useState([]),[h,m]=v.useState([]),[y,w]=v.useState([]),[p,b]=v.useState(!0),[_,x]=v.useState(null),[S,E]=v.useState(!1),[k,T]=v.useState(""),[$,j]=v.useState(!1),[H,q]=v.useState(""),[X,O]=v.useState({}),[I,L]=v.useState(!1),F=v.useRef(null),A=v.useRef(!1),C=v.useRef(!1),M=()=>{const D=F.current;return D?D.scrollHeight-D.scrollTop-D.clientHeight<=50:!1},W=()=>{F.current&&(F.current.scrollTop=F.current.scrollHeight,L(!1))};v.useEffect(()=>{!p&&y.length>0&&!A.current&&(W(),A.current=!0);const D=F.current;if(!D)return;const K=()=>{const R=M();C.current=R,R&&L(!1)};return D.addEventListener("scroll",K),D.addEventListener("wheel",K),window.addEventListener("resize",K),()=>{D.removeEventListener("scroll",K),D.removeEventListener("wheel",K),window.removeEventListener("resize",K)}},[p,y.length]);const J=async D=>{try{const K=await fetch(`/tickets/${t}`,{headers:{Authorization:`Bearer ${D.access_token}`,"Content-Type":"application/json"}});console.log(K);const{data:R,error:te}=await K.json();if(te)throw new Error(te);if(!R)throw new Error("No data returned from API");s(D.user.id===R.ticket.requester.id?R.ticket.requester:R.ticket.assignee),a(R.ticket),w(R.messages),c(R.ticket.assignee),u(R.ticket.requester),["member","manager"].includes(n)?f(R.statuses.filter(Y=>Y.customer_access||Y.status===R.ticket.status)):f(R.statuses),m(R.ticket.ticket_status_history),R.ticket.requester&&O(Y=>({...Y,[R.ticket.requester.id]:{id:R.ticket.requester.id,name:jt(R.ticket.requester,"Unknown User"),profile:R.ticket.requester.profile,email:R.ticket.requester.email,role:R.ticket.requester.role.roleCategory}})),R.ticket.assignee&&O(Y=>({...Y,[R.ticket.assignee.id]:{id:R.ticket.assignee.id,name:jt(R.ticket.assignee,"Unknown User"),profile:R.ticket.assignee.profile,email:R.ticket.assignee.email,role:R.ticket.assignee.role.roleCategory}}));const z=Array.from(new Set(R.messages.map(Y=>Y.user.id).filter(Y=>Y&&Y!==R.ticket.requester?.id&&Y!==R.ticket.assignee?.id)));for(const Y of z){const et=await pe(Y,D);et&&O(Js=>({...Js,[Y]:et}))}for(const Y of h)if(!X[Y.changed_by]){const et=await pe(Y.changed_by,D);et&&O(Js=>({...Js,[Y.changed_by]:et}))}}catch(K){x(K instanceof Error?K.message:"Failed to fetch data")}},fe=async(D,K)=>{try{const R=await fetch(`/users/${D}`,{headers:{Authorization:`Bearer ${K.access_token}`,"Content-Type":"application/json"}}),{user:te,error:z}=await R.json();if(z)throw new Error(z);return O(Y=>({...Y,[D]:te})),te}catch(R){return console.error(`Failed to fetch user profile for ${D}:`,R),null}},pe=async(D,K)=>X[D]?X[D]:await fe(D,K);v.useEffect(()=>{async function D(){try{const{data:{session:K}}=await _e.auth.getSession();if(!K){x("No active session");return}await J(K)}catch(K){x(K instanceof Error?K.message:"Failed to fetch data")}finally{b(!1)}}D()},[]),v.useEffect(()=>{if(console.log("realtimeEvent",e),!e)return;(async()=>{const{data:{session:K}}=await _e.auth.getSession();if(K&&(C.current=M(),e.table==="tickets"&&e.eventType==="UPDATE"&&e.payload.new.id===t&&await J(K),e.table==="messages")){const R=e.payload.new;if(R.ticket_id===t)if(e.eventType==="INSERT"){const te=await pe(R.user_id,K);if(te){const z={id:R.id,content:R.content,is_internal:R.is_internal,created_at:R.created_at,user:te};w(Y=>{const et=[...Y,z];return C.current?setTimeout(W,15):L(!0),et})}}else e.eventType==="UPDATE"&&w(te=>te.map(z=>z.id===R.id?{...z,content:R.content,is_internal:R.is_internal}:z))}})()},[e]),v.useEffect(()=>{i&&q(i.status)},[i]);const me=async()=>{if(!(!k.trim()||$))try{j(!0);const{data:{session:D}}=await _e.auth.getSession();if(!D)throw new Error("No active session");if(console.log(D),!await pe(D.user.id,D))throw new Error("Failed to fetch user profile");const{error:R}=await _e.from("messages").insert({ticket_id:t,content:k.trim(),is_internal:!1,user_id:D.user.id});if(R)throw R;T("")}catch(D){x(D instanceof Error?D.message:"Failed to send message")}finally{j(!1)}},De=D=>{D.key==="Enter"&&!D.shiftKey&&(D.preventDefault(),me())},ee=async()=>{if(!(!i||H===i.status))try{const{data:{session:D}}=await _e.auth.getSession();if(!D)throw new Error("No active session");if(!(await fetch(`/tickets/${t}`,{method:"PATCH",headers:{Authorization:`Bearer ${D.access_token}`,"Content-Type":"application/json"},body:JSON.stringify({status:H})})).ok)throw new Error("Failed to update ticket status")}catch(D){x(D instanceof Error?D.message:"Failed to update ticket status")}},Ee=D=>{const K=X[D.user.id],R=K?K.name:jt(D.user,"Unknown User");return g.jsxs("div",{className:"flex space-x-3",children:[g.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex-shrink-0"}),g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-1",children:[g.jsx("span",{className:"font-medium",children:R}),g.jsx("span",{className:"text-sm text-gray-500",children:new Date(D.created_at).toLocaleString()}),D.is_internal&&g.jsx("span",{className:"text-xs bg-gray-100 px-2 py-0.5 rounded",children:"Internal Note"})]}),g.jsx("div",{className:`rounded-lg p-3 ${D.is_internal?"bg-gray-100":"bg-blue-50"}`,children:g.jsx("p",{className:"text-left",children:D.content})})]})]},`${D.id}-${D.created_at}`)},Ye=D=>{const K=X[D.changed_by],R=K?jt(K,"Unknown User"):"Unknown User";return g.jsx("div",{className:"flex space-x-3 justify-end ml-auto",children:g.jsxs("div",{children:[g.jsxs("div",{className:"flex items-center space-x-2 mb-1 justify-end",children:[g.jsx("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex-shrink-0"}),g.jsx("span",{className:"font-medium",children:R}),g.jsx("span",{className:"text-sm text-gray-500",children:new Date(D.changed_at).toLocaleString()})]}),g.jsx("div",{className:"rounded-lg p-3 bg-orange-100 text-orange-700 max-w-[80%] ml-auto",children:g.jsx("p",{className:"text-right",children:D.old_status?`${D.old_status}  ${D.new_status}`:"Created Ticket"})})]})},`${D.id}-${D.changed_at}`)},Ce=()=>{const D=[...y,...h];return D.sort((K,R)=>{const te="created_at"in K?K.created_at:K.changed_at,z="created_at"in R?R.created_at:R.changed_at;return new Date(te).getTime()-new Date(z).getTime()}),D.map(K=>"created_at"in K?Ee(K):Ye(K))};return p?g.jsx("div",{children:"Loading..."}):_?g.jsxs("div",{children:["Error: ",_]}):!r||!i?g.jsx("div",{children:"Data not found"}):g.jsxs("div",{className:"flex h-full",children:[g.jsxs("div",{className:"w-80 flex-shrink-0 border-r bg-white",children:[g.jsxs("div",{className:"p-4 border-b",children:[g.jsx("div",{className:"flex items-center justify-between mb-4",children:g.jsx("span",{className:"font-medium",children:jt(o,"Unknown Requester")})}),g.jsxs("div",{className:"flex items-center space-x-2 mb-4",children:[g.jsx("span",{children:i.subject}),g.jsx("span",{className:"px-2 py-0.5 bg-orange-100 text-orange-700 rounded text-sm",children:i.status}),g.jsx("span",{className:"text-gray-500",children:"Ticket #123"})]})]}),g.jsx("div",{className:"p-4",children:g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Organization"}),g.jsx("select",{className:"w-full p-2 border rounded",children:g.jsx("option",{children:i.organization?.name||"No Organization"})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Requester"}),g.jsx("select",{className:"w-full p-2 border rounded",children:g.jsx("option",{children:jt(o,"Unknown Requester")})})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Assignee"}),g.jsx("select",{className:"w-full p-2 border rounded",children:g.jsx("option",{children:l?.email||"Unassigned"})})]})]})})]}),g.jsxs("div",{className:"flex-1 flex flex-col bg-white min-w-0",children:[g.jsxs("div",{className:"px-6 py-4 border-b",children:[g.jsxs("div",{className:"flex items-center justify-between mb-1",children:[g.jsxs("h1",{className:"text-xl font-medium text-left",children:["Conversation with ",jt(o,"Unknown Requester")]}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("select",{className:"p-2 border rounded",value:H,onChange:D=>q(D.target.value),children:d.map(D=>g.jsx("option",{value:D.status,children:D.status},D.status))}),g.jsx("button",{onClick:ee,disabled:!i||H===i.status,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Update"})]})]}),g.jsxs("div",{className:"text-sm text-red-500 text-left mb-2",children:["Via ",i.channel||"unknown channel"]}),g.jsxs("div",{className:"relative text-sm text-gray-600 text-left cursor-pointer group",onClick:()=>E(!S),children:[g.jsx("div",{className:`${S?"":"line-clamp-2"}`,children:i.description}),g.jsx("button",{className:"absolute right-0 top-1/2 -translate-y-1/2 p-1 hover:bg-gray-100 rounded-full transition-colors","aria-label":S?"Collapse description":"Expand description",children:S?g.jsx(MS,{size:16}):g.jsx(bl,{size:16})})]})]}),g.jsxs("div",{className:"flex-1 flex flex-col min-h-0",children:[g.jsx("div",{ref:F,className:"flex-1 overflow-y-auto p-4 space-y-6",children:Ce()}),g.jsx("div",{className:"relative h-0",children:I&&g.jsx("div",{className:"absolute left-1/2 -top-4 -translate-x-1/2 bg-blue-500 text-white text-sm px-3 py-1.5 rounded-full shadow-lg cursor-pointer hover:bg-blue-600 transition-colors mx-auto w-fit z-10",onClick:W,children:"New messages "})})]}),g.jsx("div",{className:"border-t p-4 bg-white",children:g.jsxs("div",{className:"border rounded-lg",children:[g.jsx("div",{className:"p-3",children:g.jsx("textarea",{placeholder:"Write a message...",className:"w-full resize-none focus:outline-none",rows:3,value:k,onChange:D=>T(D.target.value),onKeyPress:De})}),g.jsxs("div",{className:"flex items-center justify-between px-3 py-2 border-t bg-gray-50",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(l6,{size:20})}),g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(g6,{size:20})}),g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(QR,{size:20})})]}),g.jsx("button",{className:"px-4 py-1.5 bg-green-600 text-white rounded hover:bg-green-700 disabled:opacity-50 disabled:cursor-not-allowed",onClick:me,disabled:!k.trim()||$,children:$?"Sending...":"Send"})]})]})})]}),g.jsx("div",{className:"w-70 flex-shrink-0 border-l bg-white",children:g.jsxs("div",{className:"p-4",children:[g.jsxs("div",{className:"flex items-center justify-between mb-6",children:[g.jsxs("div",{className:"flex items-center space-x-3",children:[g.jsx("div",{className:"w-10 h-10 bg-gray-200 rounded-full"}),g.jsx("span",{className:"font-medium",children:jt(o,"Unknown Requester")})]}),g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(s6,{size:16})})]}),g.jsxs("div",{className:"space-y-4",children:[g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Email"}),g.jsx("div",{className:"text-blue-600",children:o?.email})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Role"}),g.jsx("div",{className:"capitalize",children:o?.role?.roleCategory||"Unknown Role"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Local time"}),g.jsx("div",{children:new Date(i.created_at||"").toLocaleString()})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Language"}),g.jsx("div",{children:"English (United States)"})]}),g.jsxs("div",{children:[g.jsx("label",{className:"block text-sm text-gray-600 mb-1",children:"Notes"}),g.jsx("textarea",{className:"w-full p-2 border rounded",defaultValue:"Valuable Customer since 2010"})]})]})]})})]})}function kT({isOpen:t,onClose:e}){return t?g.jsx("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:g.jsxs("div",{className:"bg-white rounded-lg shadow-lg w-[500px] max-w-full",children:[g.jsxs("div",{className:"flex items-center justify-between px-4 py-3 border-b",children:[g.jsx("h2",{className:"text-lg font-medium",children:"Add New Tab"}),g.jsx("button",{onClick:e,className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(Rf,{size:20})})]}),g.jsx("div",{className:"p-4",children:g.jsx("p",{className:"text-gray-600",children:"Placeholder content for new tab dialog"})}),g.jsxs("div",{className:"px-4 py-3 bg-gray-50 flex justify-end space-x-2 rounded-b-lg",children:[g.jsx("button",{onClick:e,className:"px-4 py-2 text-gray-700 hover:bg-gray-100 rounded",children:"Cancel"}),g.jsx("button",{onClick:e,className:"px-4 py-2 bg-blue-600 text-white rounded hover:bg-blue-700",children:"Add"})]})]})}):null}const iW=t=>{switch(t){case"urgent":return"text-red-500";case"high":return"text-orange-500";case"normal":return"text-blue-500";case"low":return"text-gray-500";default:return"text-gray-400"}};function aW({currentUser:t,variant:e="conversation"}){const[n,r]=v.useState(!1),s=v.useRef(null);v.useEffect(()=>{const u=l=>{s.current&&!s.current.contains(l.target)&&r(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);const i=async()=>{await _e.auth.signOut(),r(!1),window.location.href="/"},a=()=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("h1",{className:"text-lg font-medium mr-8",children:"Dashboard"}),g.jsx("span",{className:"text-sm text-gray-600 mr-4",children:jt(t)})]}),o=()=>g.jsxs("div",{className:"flex items-center space-x-4",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(FS,{size:20})}),g.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 rounded text-sm",children:[g.jsx(Z0,{size:16}),g.jsx("span",{children:"Conversations"}),g.jsx("span",{className:"bg-gray-200 px-1.5 rounded",children:"0"})]})]}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(US,{size:20})}),g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(LS,{size:20})})]})]});return g.jsxs("header",{className:`flex items-center justify-between px-4 py-2 border-b ${e==="dashboard"?"h-14":""}`,children:[e==="dashboard"?a():o(),g.jsxs("div",{className:"flex items-center space-x-4",children:[g.jsx("button",{className:"p-1 hover:bg-gray-200 rounded",children:g.jsx(zS,{size:20})}),g.jsx(kf,{to:"/kb",className:"p-1 hover:bg-gray-200 rounded",children:g.jsx(DS,{size:20})}),g.jsxs("div",{className:"relative",ref:s,children:[g.jsxs("button",{onClick:()=>r(!n),className:"flex items-center space-x-2",children:[g.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white",children:jt(t).toUpperCase()[0]}),g.jsx(bl,{size:16})]}),n&&g.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:i,className:"w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[g.jsx(BS,{className:"w-4 h-4 mr-2"}),"Sign out"]})})})]})]})]})}function oW(){const t=Ii(),[e,n]=V2(),[r,s]=v.useState({tabs:[],activeTabId:null}),[i,a]=v.useState(!1),[o,u]=v.useState(null),[l,c]=v.useState(null),[d,f]=v.useState(null);v.useEffect(()=>{async function y(){const{data:{user:w}}=await _e.auth.getUser();if(w){const{data:p}=await _e.from("users").select().eq("id",w.id).single();if(!p){t("/");return}c(p);const{data:b}=await _e.from("employees").select().eq("user_id",w.id).single();if(!b){t("/");return}f(b.role)}}y()},[]),v.useEffect(()=>{async function y(){const{data:{session:w}}=await _e.auth.getSession();if(!w){t("/");return}}y()},[t]),v.useEffect(()=>{if(r.tabs.length===0){const y={id:"dashboard",type:"dashboard",title:"Dashboard"};s({tabs:[y],activeTabId:y.id})}},[]),v.useEffect(()=>{(async()=>{const{data:{session:w}}=await _e.auth.getSession();if(!w)return;const p=_e.channel("workspace-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"tickets"},b=>{u({table:"tickets",schema:"public",eventType:"INSERT",payload:{new:b.new,old:b.old}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"tickets"},b=>{console.log("payload",b),u({table:"tickets",schema:"public",eventType:"UPDATE",payload:{new:b.new,old:b.old}})}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},b=>{u({table:"messages",schema:"public",eventType:"INSERT",payload:{new:b.new,old:b.old}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},b=>{u({table:"messages",schema:"public",eventType:"UPDATE",payload:{new:b.new,old:b.old}})}).subscribe();return()=>{_e.removeChannel(p)}})()},[]),v.useEffect(()=>{const y=r.tabs.find(w=>w.id===r.activeTabId);if(y){const w={view:y.type};y.data?.ticketId&&(w.ticketId=y.data.ticketId),n(w)}},[r.activeTabId,r.tabs,n]);const h=(y,w,p,b)=>{const _=r.tabs.find(S=>S.type==="ticket"&&S.data?.ticketId===y);if(_){s(S=>({...S,activeTabId:_.id}));return}const x={id:`ticket-${y}`,type:"ticket",title:w,data:{ticketId:y,subject:w,priority:p,ticketNumber:b}};s(S=>({tabs:[...S.tabs,x],activeTabId:x.id}))},m=y=>{s(w=>{const p=w.tabs.filter(_=>_.id!==y);let b=w.activeTabId;if(y===w.activeTabId){const _=w.tabs.findIndex(x=>x.id===y);b=p[Math.max(0,_-1)]?.id||null}return{tabs:p,activeTabId:b}})};return g.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[g.jsx("div",{className:"bg-white border-b relative",children:g.jsxs("div",{className:"flex items-center",children:[r.tabs.map(y=>g.jsx("div",{className:`
                flex items-center px-4 border-r cursor-pointer font-medium h-[3.5rem]
                ${r.activeTabId===y.id?"bg-gray-100 border-b border-gray-100 relative -mb-px":"bg-white shadow-[inset_0_-4px_8px_-4px_rgba(0,0,0,0.1)]"}
                ${r.activeTabId===y.id?"text-gray-900":"text-gray-600 hover:text-gray-900"}
              `,onClick:()=>s(w=>({...w,activeTabId:y.id})),children:g.jsxs("div",{className:"flex items-center w-full",children:[y.type==="ticket"&&g.jsx(G0,{size:8,className:`mr-2 flex-shrink-0 fill-current ${iW(y.data?.priority)}`}),g.jsxs("div",{className:"flex flex-col items-start min-w-0 flex-1",children:[g.jsx("span",{className:"truncate max-w-[200px]",children:y.title}),y.type==="ticket"&&y.data?.ticketNumber&&g.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["#",y.data.ticketNumber]})]}),y.type!=="dashboard"&&g.jsx("button",{className:"ml-2 p-0.5 hover:bg-gray-200 rounded flex-shrink-0",onClick:w=>{w.stopPropagation(),m(y.id)},children:g.jsx(Rf,{size:14})})]})},y.id)),g.jsx("button",{onClick:()=>a(!0),className:"px-3 h-[3.5rem] hover:bg-gray-100 text-gray-600 hover:text-gray-900 border-r flex items-center",children:g.jsx(If,{size:20})})]})}),g.jsx("div",{className:"bg-gray-100",children:g.jsx(aW,{currentUser:l,variant:r.tabs.find(y=>y.id===r.activeTabId)?.type==="dashboard"?"dashboard":"conversation"})}),g.jsx("div",{className:"flex-1 overflow-hidden",children:r.tabs.map(y=>g.jsxs("div",{className:`h-full ${r.activeTabId===y.id?"":"hidden"}`,children:[y.type==="dashboard"&&g.jsx(xT,{onTicketSelect:(w,p,b,_)=>h(w,p,b,_),realtimeEvent:o,userRole:d}),y.type==="ticket"&&y.data?.ticketId&&g.jsx(ST,{ticketId:y.data.ticketId,realtimeEvent:o,userRole:d})]},y.id))}),g.jsx(kT,{isOpen:i,onClose:()=>a(!1)})]})}const uW=({accountName:t})=>g.jsx("footer",{className:"bg-white border-t border-gray-200",children:g.jsx("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:g.jsxs("div",{className:"flex justify-between items-center py-8",children:[g.jsxs("div",{className:"text-gray-600",children:[" ",new Date().getFullYear()," ",t,". All rights reserved."]}),g.jsxs("div",{className:"flex space-x-6",children:[g.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500","aria-label":"Twitter",children:g.jsx(b6,{className:"h-6 w-6"})}),g.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500","aria-label":"Facebook",children:g.jsx(WR,{className:"h-6 w-6"})}),g.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500","aria-label":"YouTube",children:g.jsx(S6,{className:"h-6 w-6"})}),g.jsx("a",{href:"#",className:"text-gray-400 hover:text-gray-500","aria-label":"LinkedIn",children:g.jsx(YR,{className:"h-6 w-6"})})]})]})})}),lW=t=>{switch(t){case"urgent":return"text-red-500";case"high":return"text-orange-500";case"normal":return"text-blue-500";case"low":return"text-gray-500";default:return"text-gray-400"}};function cW({currentUser:t,variant:e="conversation"}){const[n,r]=v.useState(!1),s=v.useRef(null);v.useEffect(()=>{const u=l=>{s.current&&!s.current.contains(l.target)&&r(!1)};return document.addEventListener("mousedown",u),()=>{document.removeEventListener("mousedown",u)}},[]);const i=async()=>{await _e.auth.signOut(),r(!1),window.location.href="/"},a=()=>g.jsxs("div",{className:"flex items-center",children:[g.jsx("h1",{className:"text-lg font-medium mr-8",children:"Dashboard"}),g.jsx("span",{className:"text-sm text-gray-600 mr-4",children:jt(t)})]}),o=()=>g.jsxs("div",{className:"flex items-center space-x-4",children:[g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(FS,{size:20})}),g.jsxs("div",{className:"flex items-center space-x-1 px-3 py-1 bg-gray-100 rounded text-sm",children:[g.jsx(Z0,{size:16}),g.jsx("span",{children:"Conversations"}),g.jsx("span",{className:"bg-gray-200 px-1.5 rounded",children:"0"})]})]}),g.jsxs("div",{className:"flex items-center space-x-2",children:[g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(US,{size:20})}),g.jsx("button",{className:"p-1 hover:bg-gray-100 rounded",children:g.jsx(LS,{size:20})})]})]});return g.jsxs("header",{className:`flex items-center justify-between px-4 py-2 border-b ${e==="dashboard"?"h-14":""}`,children:[e==="dashboard"?a():o(),g.jsxs("div",{className:"flex items-center space-x-4",children:[g.jsx("button",{className:"p-1 hover:bg-gray-200 rounded",children:g.jsx(zS,{size:20})}),g.jsx(kf,{to:"/kb",className:"p-1 hover:bg-gray-200 rounded",children:g.jsx(DS,{size:20})}),g.jsxs("div",{className:"relative",ref:s,children:[g.jsxs("button",{onClick:()=>r(!n),className:"flex items-center space-x-2",children:[g.jsx("div",{className:"w-8 h-8 bg-blue-500 rounded-full flex items-center justify-center text-white",children:jt(t).toUpperCase()[0]}),g.jsx(bl,{size:16})]}),n&&g.jsx("div",{className:"absolute right-0 mt-2 w-48 rounded-md shadow-lg bg-white ring-1 ring-black ring-opacity-5",children:g.jsx("div",{className:"py-1",children:g.jsxs("button",{onClick:i,className:"w-full px-4 py-2 text-sm text-gray-700 hover:bg-gray-100 flex items-center",children:[g.jsx(BS,{className:"w-4 h-4 mr-2"}),"Sign out"]})})})]})]})]})}function dW(){const t=Ii(),[e,n]=V2(),[r,s]=v.useState({tabs:[],activeTabId:null}),[i,a]=v.useState(!1),[o,u]=v.useState(null),[l,c]=v.useState(null),[d,f]=v.useState(null),[h,m]=v.useState(null);v.useEffect(()=>{async function p(){const{data:{user:b}}=await _e.auth.getUser();if(b){const{data:_}=await _e.from("users").select("*, organizations(*), customers(*)").eq("id",b.id).single();if(!_){t("/");return}if(c(_),!_.customers||!_.organizations){t("/");return}f(_.organizations),m(_.customers.is_org_admin?"manager":"member")}}p()},[]),v.useEffect(()=>{async function p(){const{data:{session:b}}=await _e.auth.getSession();if(!b){t("/");return}}p()},[t]),v.useEffect(()=>{if(r.tabs.length===0){const p={id:"dashboard",type:"dashboard",title:"Dashboard"};s({tabs:[p],activeTabId:p.id})}},[]),v.useEffect(()=>{(async()=>{const{data:{session:b}}=await _e.auth.getSession();if(!b)return;const _=_e.channel("workspace-changes").on("postgres_changes",{event:"INSERT",schema:"public",table:"tickets"},x=>{u({table:"tickets",schema:"public",eventType:"INSERT",payload:{new:x.new,old:x.old}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"tickets"},x=>{console.log("payload",x),u({table:"tickets",schema:"public",eventType:"UPDATE",payload:{new:x.new,old:x.old}})}).on("postgres_changes",{event:"INSERT",schema:"public",table:"messages"},x=>{u({table:"messages",schema:"public",eventType:"INSERT",payload:{new:x.new,old:x.old}})}).on("postgres_changes",{event:"UPDATE",schema:"public",table:"messages"},x=>{u({table:"messages",schema:"public",eventType:"UPDATE",payload:{new:x.new,old:x.old}})}).subscribe();return()=>{_e.removeChannel(_)}})()},[]),v.useEffect(()=>{const p=r.tabs.find(b=>b.id===r.activeTabId);if(p){const b={view:p.type};p.data?.ticketId&&(b.ticketId=p.data.ticketId),n(b)}},[r.activeTabId,r.tabs,n]);const y=(p,b,_,x)=>{const S=r.tabs.find(k=>k.type==="ticket"&&k.data?.ticketId===p);if(S){s(k=>({...k,activeTabId:S.id}));return}const E={id:`ticket-${p}`,type:"ticket",title:b,data:{ticketId:p,subject:b,priority:_,ticketNumber:x}};s(k=>({tabs:[...k.tabs,E],activeTabId:E.id}))},w=p=>{s(b=>{const _=b.tabs.filter(S=>S.id!==p);let x=b.activeTabId;if(p===b.activeTabId){const S=b.tabs.findIndex(E=>E.id===p);x=_[Math.max(0,S-1)]?.id||null}return{tabs:_,activeTabId:x}})};return g.jsxs("div",{children:[g.jsxs("div",{className:"flex flex-col h-screen bg-gray-50",children:[g.jsx("div",{className:"bg-white border-b relative",children:g.jsxs("div",{className:"flex items-center",children:[r.tabs.map(p=>g.jsx("div",{className:`
                    flex items-center px-4 border-r cursor-pointer font-medium h-[3.5rem]
                    ${r.activeTabId===p.id?"bg-gray-100 border-b border-gray-100 relative -mb-px":"bg-white shadow-[inset_0_-4px_8px_-4px_rgba(0,0,0,0.1)]"}
                    ${r.activeTabId===p.id?"text-gray-900":"text-gray-600 hover:text-gray-900"}
                `,onClick:()=>s(b=>({...b,activeTabId:p.id})),children:g.jsxs("div",{className:"flex items-center w-full",children:[p.type==="ticket"&&g.jsx(G0,{size:8,className:`mr-2 flex-shrink-0 fill-current ${lW(p.data?.priority)}`}),g.jsxs("div",{className:"flex flex-col items-start min-w-0 flex-1",children:[g.jsx("span",{className:"truncate max-w-[200px]",children:p.title}),p.type==="ticket"&&p.data?.ticketNumber&&g.jsxs("span",{className:"text-xs font-normal text-gray-500",children:["#",p.data.ticketNumber]})]}),p.type!=="dashboard"&&g.jsx("button",{className:"ml-2 p-0.5 hover:bg-gray-200 rounded flex-shrink-0",onClick:b=>{b.stopPropagation(),w(p.id)},children:g.jsx(Rf,{size:14})})]})},p.id)),g.jsx("button",{onClick:()=>a(!0),className:"px-3 h-[3.5rem] hover:bg-gray-100 text-gray-600 hover:text-gray-900 border-r flex items-center",children:g.jsx(If,{size:20})})]})}),g.jsx("div",{className:"bg-gray-100",children:g.jsx(cW,{currentUser:l,variant:r.tabs.find(p=>p.id===r.activeTabId)?.type==="dashboard"?"dashboard":"conversation"})}),g.jsx("div",{className:"flex-1 overflow-hidden",children:r.tabs.map(p=>g.jsxs("div",{className:`h-full ${r.activeTabId===p.id?"":"hidden"}`,children:[p.type==="dashboard"&&g.jsx(xT,{onTicketSelect:(b,_,x,S)=>y(b,_,x,S),realtimeEvent:o,userRole:h}),p.type==="ticket"&&p.data?.ticketId&&g.jsx(ST,{ticketId:p.data.ticketId,realtimeEvent:o,userRole:h})]},p.id))}),g.jsx(kT,{isOpen:i,onClose:()=>a(!1)})]}),g.jsx(uW,{accountName:d?.name||"AutoCRM"})]})}const x1=()=>{const[t,e]=v.useState({}),[n,r]=v.useState(null),[s,i]=v.useState(!0),[a,o]=v.useState(null),u=Ii(),{articleId:l}=LO(),c=(h,m)=>{console.log(m);for(const y of Object.values(h))for(const w of Object.values(y)){const p=w.find(b=>b.id===m);if(p)return p}return null};v.useEffect(()=>{(async()=>{try{const{data:{session:m}}=await _e.auth.getSession(),y=await fetch("/kb",{method:"GET",headers:m?{Authorization:`Bearer ${m.access_token}`,"Content-Type":"application/json"}:{"Content-Type":"application/json"}}),{articles:w,error:p}=await y.json();if(p)throw p;if(e(w),l){const b=c(w,l);b?r(b):(o("Article not found"),u("/kb"))}o(null)}catch(m){o("Failed to fetch knowledge base articles"),console.error("Error fetching articles:",m)}finally{i(!1)}})()},[l]);const d=h=>{r(h),u(`/kb/${h.id}`)},f=()=>{r(null),u("/kb")};return s?g.jsx("div",{className:"flex justify-center items-center h-screen",children:"Loading..."}):a?g.jsx("div",{className:"text-red-500 p-4",children:a}):n?g.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[g.jsx("button",{onClick:f,className:"mb-4 text-blue-500 hover:text-blue-700",children:" Back to Articles"}),g.jsx("h1",{className:"text-2xl font-bold mb-4",children:n.title}),g.jsx("hr",{}),g.jsx("div",{dangerouslySetInnerHTML:{__html:n.content.replace(/{kbtitle}/g,n.title)}})]}):g.jsxs("div",{className:"max-w-4xl mx-auto p-6",children:[g.jsx("h1",{className:"text-3xl font-bold mb-8",children:"Knowledge Base"}),Object.entries(t).map(([h,m])=>g.jsxs("div",{className:"mb-8",children:[g.jsx("h2",{className:"text-2xl font-semibold mb-4",children:h}),Object.entries(m).map(([y,w])=>g.jsxs("div",{className:"mb-6",children:[g.jsx("h3",{className:"text-xl font-medium mb-3",children:y}),g.jsx("ul",{className:"space-y-2",children:w.map(p=>g.jsx("li",{children:g.jsx("button",{onClick:()=>d(p),className:"text-blue-500 hover:text-blue-700 text-left",children:p.title})},p.id))})]},y))]},h))]})},Dp=({children:t})=>{const{user:e,loading:n}=gS();return n?g.jsx("div",{children:"Loading..."}):e?g.jsx(g.Fragment,{children:t}):g.jsx(B2,{to:"/login"})};function fW(){return g.jsx(F4,{children:g.jsx(xN,{children:g.jsxs(QO,{children:[g.jsx(ei,{path:"/login",element:g.jsx(xL,{})}),g.jsx(ei,{path:"/",element:g.jsx(Dp,{children:g.jsx(B2,{to:"/customer"})})}),g.jsx(ei,{path:"/employee/*",element:g.jsx(Dp,{children:g.jsx(oW,{})})}),g.jsx(ei,{path:"/customer/*",element:g.jsx(Dp,{children:g.jsx(dW,{})})}),g.jsx(ei,{path:"/kb",element:g.jsx(x1,{}),children:g.jsx(ei,{path:":articleId",element:g.jsx(x1,{})})})]})})})}const hW=Fp.createRoot(document.getElementById("root"));hW.render(g.jsx(Lr.StrictMode,{children:g.jsx(fW,{})}));export{Xa as g};
